

1. Перейдите к [https://apps.dev.microsoft.com/](https://apps.dev.microsoft.com).

1. Войдите в клиент Office 365, используя учетные данные администратора. Пример: MyName@contoso.onmicrosoft.com

1. Нажмите **Добавить приложение**.

1. При появлении запроса введите **$ИМЯ-НАДСТРОЙКИ$** в качестве имени приложения, а затем нажмите **Создать приложение**.

1. Когда откроется страница настройки, скопируйте и сохраните **Идентификатор приложения**. Он понадобится позже.

    > [!NOTE]
    > Этот идентификатор представляет собой значение аудитории, используемое, когда другие приложения, например ведущее приложение Office (PowerPoint, Word, Excel и т. д.), пытаются получить авторизованный доступ к вашему приложению. Кроме того, он используется как идентификатор клиента, когда приложение, в свою очередь, пытается получить авторизованный доступ к Microsoft Graph.

1. В разделе **Секреты приложения** нажмите **Создать новый пароль**. Откроется всплывающее диалоговое окно с новым паролем (его также называют секретом приложения). *Сразу скопируйте пароль и сохраните его вместе с идентификатором приложения.* Он понадобится вам позже. Затем закройте диалоговое окно.

1. В разделе **Платформы** нажмите **Добавление платформы**.

1. В открывшемся диалоговом окне выберите **Веб-API**.

1.  **URI идентификатора приложения** сгенерирован в форме “api://$App ID GUID$”. Вставьте **$FQDN-БЕЗ-ПРОТОКОЛА$** (с косой чертой "/", на конце) между двойной косой чертой и GUID. Весь идентификатор должен иметь форму `api://$FQDN-WITHOUT-PROTOCOL$/$App ID GUID$`, например: `api://localhost:6789/c6c1f32b-5e55-4997-881a-753cc1d563b7`.

    > [!NOTE]
    > Если возникает ошибка с сообщением о том, что домен уже занят, но при этом вы являетесь его владельцем, следуйте процедуре в статье [Краткое руководство. Добавление личного домена в Azure Active Directory](https://docs.microsoft.com/en-us/azure/active-directory/add-custom-domain), чтобы зарегистрировать его, а затем повторите этот шаг.

    > [!NOTE]
    > Доменная часть имени в поле **Область**, указанная под **URI идентификатора приложения**, автоматически изменится соответствующим образом с добавлением `/access_as_user` на конец, например: `api://localhost:6789/c6c1f32b-5e55-4997-881a-753cc1d563b7/access_as_user`.

1. В разделе **Предварительно авторизованные приложения** укажите приложения, которые необходимо авторизовать для веб-приложения надстройки. Необходимо обеспечить предварительную авторизацию для всех указанных ниже идентификаторов. После ввода каждого из них будет появляться новое пустое текстовое поле. (Введите только GUID.)
    * `d3590ed6-52b3-4102-aeff-aad2292ab01c` (Microsoft Office).
    * `57fb890c-0dab-4253-a5e0-7188c88b2bb4` (Office Online).
    * `bc59ab01-8403-45c6-8796-ac3ef710b3e3` (Office Online).

1. Откройте раскрывающийся список **Область** рядом с каждым полем **Идентификатор приложения** и установите флажок `api://$FQDN-WITHOUT-PROTOCOL$/$App ID GUID$/access_as_user`.

1. В верхней части раздела **Платформы** снова нажмите кнопку **Добавление платформы** и выберите **Веб**.

1. В новом подразделе **Веб** раздела **Платформы** введите следующий **URL-адрес перенаправления**: `https://$FQDN-WITHOUT-PROTOCOL$`.

1. Прокрутите вниз до подраздела **Делегированные разрешения** в разделе **Разрешения Microsoft Graph**. Нажмите кнопку **Добавить**, чтобы открыть диалоговое окно **Выбор разрешения**.

1. В диалоговом окне установите флажки для `profile` и других разрешений AAD и Microsoft Graph, необходимых вашей надстройке. Примеры:

    * Files.Read.All
    * offline_access
    * openid
    * профиль

    > [!NOTE]
    > Разрешение `User.Read` может быть уже указано по умолчанию. Незачем запрашивать ненужные разрешения, поэтому рекомендуем снять флажок рядом с этим разрешением, если оно не требуется вашей надстройке.

1. Нажмите кнопку **ОК** в нижней части диалогового окна.

1. Нажмите кнопку **Сохранить** в нижней части страницы регистрации.
