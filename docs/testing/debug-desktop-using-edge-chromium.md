---
title: Отладка настроек в Windows с использованием Visual Studio Code и Microsoft Edge WebView2 (на основе Chromium)
description: Узнайте, как осуществлять отладку надстроек Office, в которых используется Microsoft Edge WebView2 (на основе Chromium) с помощью отладчика для расширения Microsoft Edge в коде VS.
ms.date: 01/07/2022
ms.localizationpriority: high
ms.openlocfilehash: 370aee798b40631000310f65b7ace931d0c2ae3e
ms.sourcegitcommit: 33824aa3995a2e0bcc6d8e67ada46f296c224642
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/12/2022
ms.locfileid: "61765901"
---
# <a name="debug-add-ins-on-windows-using-visual-studio-code-and-microsoft-edge-webview2-chromium-based"></a>Отладка настроек в Windows с использованием Visual Studio Code и Microsoft Edge WebView2 (на основе Chromium)

Надстройки Office, работающие в Windows, могут использовать отладчик для расширения Microsoft Edge в коде Visual Studio Code для отладки среды Edge Chromium WebView2.

> [!TIP]
> Если вы не можете или не хотите выполнять отладку с помощью инструментов, встроенных в Visual Studio Code; или вы столкнулись с проблемой, которая возникает только тогда, когда надстройка запускается вне Visual Studio Code, вы можете отлаживать среду выполнения Microsoft Edge Chromium WebView2 с помощью средств разработчика Microsoft Edge (на основе Chromium), как описано в разделе [Отладка надстроек с помощью средств разработчика для Microsoft Edge WebView2](debug-add-ins-using-devtools-edge-chromium.md).

## <a name="prerequisites"></a>Необходимые компоненты

- [Код Visual Studio](https://code.visualstudio.com/) (необходимо запускать от имени администратора)
- [Node.js (версия 10. или более поздняя)](https://nodejs.org/)
- Windows 10, 11
- Сочетание платформы и приложения Office, которое поддерживает Microsoft Edge с WebView2 (на основе Chromium), как описано в статье [Браузеры, используемые надстройками Office](../concepts/browsers-used-by-office-web-add-ins.md). Если вы используете Microsoft 365 с версией до 2101, установите WebView2. Воспользуйтесь инструкциями по установке на странице [Microsoft Edge WebView2 / Внедрение веб-контента ... с помощью Microsoft Edge WebView2](https://developer.microsoft.com/microsoft-edge/webview2/).

## <a name="install-and-use-the-debugger"></a>Установка и использование отладчика

1. Создайте проект с помощью [генератора Yeoman для надстроек Office](https://github.com/OfficeDev/generator-office). Для этого можно использовать любые краткие руководства по началу работы, например [Краткое руководство по надстройкам Outlook](../quickstarts/outlook-quickstart.md).

   > [!TIP]
   > Если вы не используете надстройку, основанную на генераторе Yeoman, вам может быть предложено настроить ключ реестра. В корневой папке проекта выполните указанные ниже действия в командной строке.
   >
   > ``` command&nbsp;line
   > npx office-addin-debugging start <your manifest path>
   > ```

1. Откройте проект в VS Code. Находясь в коде VS, нажмите клавиши **CTRL+SHIFT+X**, чтобы открыть меню расширений. Выполните поиск расширения"[Microsoft Edge DevTools](/microsoft-edge/visual-studio-code/microsoft-edge-devtools-extension)" и установите его.

1. Чтобы перейти к представлению отладки, выберите **Просмотр > Выполнить** или нажмите клавиши **CTRL+SHIFT+D**.

1. В разделе параметров **ВЫПОЛНЕНИЕ И ОТЛАДКА** выберите параметр Edge Chromium для ведущего приложения, например **классическое приложение Excel (Edge Chromium)**. Чтобы начать отладку, нажмите **F5** или выберите **Выполнить > Начать отладку** в меню. Это действие автоматически запускает локальный сервер в окне Node для размещения вашей надстройки, а затем автоматически открывает ведущее приложение, например Excel или Word. Это может занять несколько секунд.

1. Теперь надстройка готова к использованию в ведущем приложении. Нажмите кнопку **Показать область задач** или выполнить другие дополнительные команды надстройки. Появится диалоговое окно подтверждения действия с надписью

   > WebView Stop On Load.
   > Чтобы выполнить отладку WebView, вложите код VS в экземпляр WebView с помощью отладчика Microsoft для Edge и нажмите кнопку ОК. Чтобы предотвратить появление диалогового окна в дальнейшем, нажмите кнопку "Отмена".

   Нажмите **ОК**.

   > [!NOTE]
   > После нажатия кнопки **Отмена** диалоговое окно не будет отображаться в процессе работы с этим экземпляром надстройки. Однако при перезапуске надстройки диалоговое окно снова появится.

1. Теперь можно задать точки останова в коде проекта и выполнить отладку.

   > [!NOTE]
   > Точки останова в вызовах `Office.initialize` или `Office.onReady` игнорируются. Дополнительные сведения об этих методах см. в статье [Инициализация надстройки Office](../develop/initialize-add-in.md).

> [!IMPORTANT]
> Лучший способ остановить сеанс отладки — нажать клавиши **SHIFT+F5** или выбрать **Выполнить > Остановить отладку** в меню. Это действие должно закрыть окно сервера Node и попытаться закрыть ведущее приложение, но в ведущем приложении появится запрос о необходимости сохранения документа. Сделайте соответствующий выбор и позвольте закрыть ведущее приложение. Избегайте закрытия окна Node или ведущего приложения вручную. Это может привести к ошибкам, особенно при многократной остановке и запуске сеансов отладки.
>
> Если отладка перестает работать (например, если игнорируются точки останова), остановите отладку. Затем при необходимости закройте все окна ведущего приложения и окно Node. Наконец, закройте Visual Studio Code и снова откройте его.

## <a name="see-also"></a>См. также

- [Тестирование и отладка надстроек Office](test-debug-office-add-ins.md)
- [Надстройка Microsoft Office "Расширение отладчика для Visual Studio Code"](debug-with-vs-extension.md)
- [Подключение отладчика из области задач](attach-debugger-from-task-pane.md)
