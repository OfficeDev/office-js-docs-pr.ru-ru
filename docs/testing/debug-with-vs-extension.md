---
title: Отладка настроек в Windows с использованием Visual Studio Code и WebView в устаревшей версии Microsoft Edge (EdgeHTML)
description: Узнайте, как выполнять отладку надстроек Office, использующих устаревшая версия Microsoft Edge WebView (EdgeHTML) с помощью расширения отладчика надстроек Office в VS Code.
ms.date: 02/15/2022
ms.localizationpriority: medium
ms.openlocfilehash: 8dc709893070e4bfd9d7ae39adb591496594c6ab
ms.sourcegitcommit: eef2064d7966db91f8401372dd255a32d76168c2
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/31/2022
ms.locfileid: "67464848"
---
# <a name="microsoft-office-add-in-debugger-extension-for-visual-studio-code"></a>Надстройка Microsoft Office "Расширение отладчика для Visual Studio Code"

Надстройки Office, работающие в Windows, могут использовать расширение отладчика надстроек Office в Visual Studio Code для отладки устаревшая версия Microsoft Edge с исходной средой выполнения WebView (EdgeHTML). 

> [!IMPORTANT]
> Эта статья применима только в том случае, если office запускает надстройки в исходной среде выполнения WebView (EdgeHTML), как описано в браузерах, используемых надстройки [Office](../concepts/browsers-used-by-office-web-add-ins.md). Инструкции по отладке в Visual Studio Code в Microsoft Edge WebView2 (на Chromium) см. в разделе "Расширение отладчика надстроек [Microsoft Office" Visual Studio Code](debug-desktop-using-edge-chromium.md).

> [!TIP]
> Если вы не можете или не хотите выполнять отладку с помощью встроенных в Visual Studio Code; средств или возникает проблема, которая возникает только при запуске надстройки за пределами Visual Studio Code, можно выполнить отладку среды выполнения Edge Legacy (EdgeHTML) с помощью средств разработчика устаревшей версии Edge, как описано в разделе "Отладка надстроек" с помощью средств разработчика в [ устаревшая версия Microsoft Edge](debug-add-ins-using-devtools-edge-legacy.md).

Это динамический режим отладки, в нем можно устанавливать точки останова во время выполнения кода. Изменения в коде можно увидеть сразу же, когда отладчик подключен, без потери сеанса отладки. Изменения кода также сохраняются, поэтому вы можете просмотреть результаты нескольких изменений в коде. Работа этого расширения показана на следующем рисунке.

![Расширение отладчика надстроек Office отлаживает раздел надстроек Excel.](../images/vs-debugger-extension-for-office-addins.jpg)

## <a name="prerequisites"></a>Предварительные требования

- [Visual Studio Code](https://code.visualstudio.com/)
- [Node.js (версия 10. или более поздняя)](https://nodejs.org/)
- Windows 10, 11
- [Microsoft Edge](https://www.microsoft.com/edge) Сочетание платформы и приложения Office, которое поддерживает устаревшая версия Microsoft Edge с исходным [веб-представлением](../concepts/browsers-used-by-office-web-add-ins.md) (EdgeHTML), как описано в браузерах, используемых надстройки Office.

## <a name="install-and-use-the-debugger"></a>Установка и использование отладчика

В этих инструкциях предполагается, что у вас есть опыт работы с командной строкой, вы понимаете базовый код JavaScript и создали проект надстройки Office, прежде чем использовать генератор [Yeoman](../develop/yeoman-generator-overview.md) для надстроек Office. Если вы еще не сделали этого, рекомендуем посетить одно из наших учебников, например это руководство по надстройке [Excel для Office](../tutorials/excel-tutorial.md).

1. Первый шаг зависит от проекта и от порядка его создания.

   - Если вы хотите создать проект для экспериментов с отладкой в Visual Studio Code, используйте генератор [Yeoman для надстроек Office](../develop/yeoman-generator-overview.md). Для этого используйте любое из наших кратких руководств по началу работы, например краткое руководство по надстройке [Outlook](../quickstarts/outlook-quickstart.md).
   - Если нужно отладить существующий проект, созданный с помощью Yo Office, перейдите к следующем шагу.
   - Если вы хотите выполнить отладку существующего проекта, который не был создан с помощью Yo Office, выполните процедуру [](#appendix) в приложении, а затем вернитесь к следующему шагу этой процедуры.


1. Откройте VS Code, откройте проект в этом решении. 

1. Находясь в коде VS, нажмите клавиши **CTRL+SHIFT+X**, чтобы открыть меню расширений. Найдите расширение "Отладчик надстроек Microsoft Office" и установите его.

1. Выберите **Просмотр > Выполнить** или нажмите клавиши **CTRL+SHIFT+D**, чтобы переключить представление отладки.

1. В **параметрах ЗАПУСКА И ОТЛАДКИ** выберите вариант "Устаревшая версия Edge" для ведущего приложения, например **Outlook Desktop (устаревшая версия Edge).** Чтобы начать отладку, нажмите **F5** или выберите **Выполнить > Начать отладку** в меню. Это действие автоматически запускает локальный сервер в окне Node для размещения вашей надстройки, а затем автоматически открывает ведущее приложение, например Excel или Word. Это может занять несколько секунд.

1. Теперь надстройка готова к использованию в ведущем приложении. Нажмите кнопку **Показать область задач** или выполнить другие дополнительные команды надстройки. Диалоговое окно будет выглядеть примерно так:

   > WebView Stop On Load.
   > Чтобы выполнить отладку WebView, присоедините VS Code к экземпляру WebView с помощью расширения Microsoft Debugger for Edge и нажмите кнопку **"** ОК", чтобы продолжить. Чтобы предотвратить отображение этого диалогового окна в будущем, нажмите кнопку " **Отмена"**.

   Нажмите **ОК**.

   > [!NOTE]
   > После нажатия кнопки **Отмена** диалоговое окно не будет отображаться в процессе работы с этим экземпляром надстройки. Однако при перезапуске надстройки диалоговое окно снова появится.

1. Установите точку останова в файле области задач проекта. Чтобы установить точки останова в Visual Studio Code, наведите указатель мыши на строку кода выберите появившийся красный кружок.

    ![Кружок на строке кода в Visual Studio Code.](../images/set-breakpoint.jpg)

1. Запустите в надстройке функциональность, которая вызывает строки с точками останова. Вы увидите, что достигнуты точки останова, и можно изучить локальные переменные.

   > [!NOTE]
   > Точки останова в вызовах `Office.initialize` или `Office.onReady` игнорируются. Дополнительные сведения об этих методах см. в статье [Инициализация надстройки Office](../develop/initialize-add-in.md).

> [!IMPORTANT]
> Лучший способ остановить сеанс отладки — нажать клавиши **SHIFT+F5** или выбрать **Выполнить > Остановить отладку** в меню. Это действие должно закрыть окно сервера Node и попытаться закрыть ведущее приложение, но в ведущем приложении появится запрос о необходимости сохранения документа. Сделайте соответствующий выбор и позвольте закрыть ведущее приложение. Избегайте закрытия окна Node или ведущего приложения вручную. Это может привести к ошибкам, особенно при многократной остановке и запуске сеансов отладки.
>
> Если отладка перестает работать (например, если игнорируются точки останова), остановите отладку. Затем при необходимости закройте все окна ведущего приложения и окно Node. Наконец, закройте Visual Studio Code и снова откройте его.

### <a name="appendix"></a>Приложение

Если проект не был создан с помощью Yo Office, нужно создать конфигурацию отладки для Visual Studio Code. 

1. Создайте файл с именем `launch.json` в папке проекта `\.vscode`, если такого файла там нет. 
1. Убедитесь, что в файле есть массив `configurations`. Ниже приведен простой пример `launch.json`.

    ```json
    {
      // other properities may be here.

      "configurations": [

        // configuration objects may be here.

      ]

      //other properies may be here.
    }
    ```

1. Добавьте следующий объект в массив `configurations`.

    ```json
    {
      "name": "HOST Desktop (Edge Legacy)",
      "type": "office-addin",
      "request": "attach",
      "url": "https://localhost:3000/taskpane.html?_host_Info=HOST$Win32$16.01$en-US$$$$0",
      "port": 9222,
      "timeout": 600000,
      "webRoot": "${workspaceRoot}",
      "preLaunchTask": "Debug: HOST Desktop",
      "postDebugTask": "Stop Debug"
    }
    ```

1. Замените заполнитель `HOST` во всех трех местах именем приложения Office, `Outlook` `Word`в котором работает надстройка, например .
1. Сохраните и закройте файл.

## <a name="see-also"></a>См. также

- [Тестирование и отладка надстроек Office](test-debug-office-add-ins.md)
- [Отладка надстроек в Windows с помощью Visual Studio Code и Microsoft Edge WebView2 (Chromium основе)](debug-desktop-using-edge-chromium.md).
- [Отладка надстроек с помощью средств разработчика для Internet Explorer](debug-add-ins-using-f12-tools-ie.md)
- [Отладка надстроек с помощью средств разработчика для устаревшей версии Microsoft Edge](debug-add-ins-using-devtools-edge-legacy.md)
- [Отладка надстроек с помощью средств разработчика в Microsoft Edge (на основе Chromium)](debug-add-ins-using-devtools-edge-chromium.md)
- [Подключение отладчика из области задач](attach-debugger-from-task-pane.md)
- [Среды выполнения в надстройки Office](runtimes.md)