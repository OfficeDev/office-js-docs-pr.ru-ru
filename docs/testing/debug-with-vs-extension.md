---
title: Отламывка надстроек на Windows с Visual Studio Code и Microsoft Edge WebView (EdgeHTML)
description: Узнайте, как отладить Office надстроек, использующих устаревшая версия Microsoft Edge WebView (EdgeHTML) с помощью расширения Office надстройки Debugger в VS Code.
ms.date: 02/01/2022
ms.localizationpriority: medium
ms.openlocfilehash: 11b728f9b3f467017711c9d75cfd07767957deae
ms.sourcegitcommit: d01aa8101630031515bf27f14361c5a3062c3ec4
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/09/2022
ms.locfileid: "62467696"
---
# <a name="microsoft-office-add-in-debugger-extension-for-visual-studio-code"></a>Надстройка Microsoft Office "Расширение отладчика для Visual Studio Code"

Office надстройки, работающие на Windows, могут использовать расширение debugger Office надстройки в Visual Studio Code для отладки устаревшая версия Microsoft Edge с исходным временем работы WebView (EdgeHTML). 

> [!IMPORTANT]
> Эта статья применяется только Office запуска надстройки в исходном времени запуска WebView (EdgeHTML), как это объясняется в [браузерах](../concepts/browsers-used-by-office-web-add-ins.md), используемых Office надстройки. Инструкции по отладки Visual Studio кода Microsoft Edge WebView2 (Chromium на основе) см. в Microsoft Office расширение надстройки для [Visual Studio Code](debug-desktop-using-edge-chromium.md).

> [!TIP]
> Если вы не можете или не хотите отлаговка с помощью средств, встроенных в Visual Studio Code; или вы столкнулись с проблемой, которая возникает только при запуске надстройки за пределами Visual Studio Code, вы можете отрезать время работы Edge Legacy (EdgeHTML) с помощью средств разработки Edge Legacy, как описано в надстройке Debug с помощью средств разработчика [в устаревшая версия Microsoft Edge](debug-add-ins-using-devtools-edge-legacy.md).

Этот режим отладки динамический, что позволяет устанавливать точки разрыва во время работы кода. Вы можете видеть изменения в коде сразу же, когда отладка присоединена, все без потери сеанса отладки. Изменения кода также сохраняются, поэтому вы можете видеть результаты нескольких изменений в коде. На следующем изображении показано это расширение в действии.

![Office надстройки отладки расширения отладки надстроек Excel надстроек.](../images/vs-debugger-extension-for-office-addins.jpg)

## <a name="prerequisites"></a>Предварительные требования

- [Visual Studio Code](https://code.visualstudio.com/)
- [Node.js (версия 10. или более поздняя)](https://nodejs.org/)
- Windows 10, 11
- [Microsoft Edge](https://www.microsoft.com/edge) сочетание платформы и Office, которое поддерживает устаревшая версия Microsoft Edge с оригинальным [веб-просмотром](../concepts/browsers-used-by-office-web-add-ins.md) (EdgeHTML), как это объясняется в Браузерах, используемых Office надстройки.

## <a name="install-and-use-the-debugger"></a>Установка и использование отладчика

Эти инструкции предполагают, что вы имеете опыт использования командной строки, понимаете базовый JavaScript и создали проект Office надстройки перед использованием генератора Yo Office. Если вы еще не сделали этого раньше, рассмотрите возможность посещения одного из наших учебников, например Excel Office [надстройки](../tutorials/excel-tutorial.md).

1. Первый шаг зависит от проекта и его создания.

   - Если вы хотите создать проект, чтобы поэкспериментировать с отладки в Visual Studio Code, используйте генератор [Yeoman для Office надстроек](https://github.com/OfficeDev/generator-office). Для этого используйте любой из наших руководств по быстрому запуску, например Outlook надстройки [quickstart](../quickstarts/outlook-quickstart.md). 
   - Если вы хотите отлучить существующий проект, созданный с помощью Yo Office, перейти к следующему шагу.
   - Если вы хотите отчудить существующий проект, который не был создан с помощью Yo Office, выполнить процедуру в приложении, [](#appendix) а затем вернуться к следующему шагу этой процедуры.


1. Откройте VS Code и откройте проект в нем. 

1. Находясь в коде VS, нажмите клавиши **CTRL+SHIFT+X**, чтобы открыть меню расширений. Поиск расширения "Microsoft Office надстройки Debugger" и установка его.

1. Выберите  **просмотр > выполнить** или ввести **Ctrl+Shift+D,** чтобы перейти на отлагивание представления.

1. Из **параметров RUN и DEBUG** выберите параметр Edge Legacy для вашего хост-приложения, например **Outlook Desktop (Edge Legacy)**. Чтобы начать отладку, нажмите **F5** или выберите **Выполнить > Начать отладку** в меню. Это действие автоматически запускает локальный сервер в окне Node для размещения вашей надстройки, а затем автоматически открывает ведущее приложение, например Excel или Word. Это может занять несколько секунд.

1. Теперь надстройка готова к использованию в ведущем приложении. Нажмите кнопку **Показать область задач** или выполнить другие дополнительные команды надстройки. Диалоговое окно будет выглядеть так же, как и следующее:

   > WebView Stop On Load.
   > Чтобы отладить webView, VS Code к экземпляру WebView с помощью расширения Microsoft Debugger for Edge и нажмите кнопку ОК для продолжения. Чтобы этот диалоговое окно не появлялись в будущем, нажмите кнопку **Отмена**.

   Нажмите **ОК**.

   > [!NOTE]
   > После нажатия кнопки **Отмена** диалоговое окно не будет отображаться в процессе работы с этим экземпляром надстройки. Однако при перезапуске надстройки диалоговое окно снова появится.

1. Установите точку разлома в файле области задач проекта. Чтобы установить точки Visual Studio Code, наведите курсор рядом с строкой кода и выберите красный круг, который появится.

    ![Красный круг отображается на строке кода в Visual Studio Code.](../images/set-breakpoint.jpg)

1. Запустите функции в надстройки, которая вызывает строки с точками разрыва. Вы увидите, что были поражены точки разрыва, и вы можете проверить локальные переменные.

   > [!NOTE]
   > Точки останова в вызовах `Office.initialize` или `Office.onReady` игнорируются. Дополнительные сведения об этих методах см. в статье [Инициализация надстройки Office](../develop/initialize-add-in.md).

> [!IMPORTANT]
> Лучший способ остановить сеанс отладки — нажать клавиши **SHIFT+F5** или выбрать **Выполнить > Остановить отладку** в меню. Это действие должно закрыть окно сервера Node и попытаться закрыть ведущее приложение, но в ведущем приложении появится запрос о необходимости сохранения документа. Сделайте соответствующий выбор и позвольте закрыть ведущее приложение. Избегайте закрытия окна Node или ведущего приложения вручную. Это может привести к ошибкам, особенно при многократной остановке и запуске сеансов отладки.
>
> Если отладка перестает работать (например, если игнорируются точки останова), остановите отладку. Затем при необходимости закройте все окна ведущего приложения и окно Node. Наконец, закройте Visual Studio Code и снова откройте его.

### <a name="appendix"></a>Приложение

Если проект не был создан с помощью Yo Office, необходимо создать конфигурацию отлаговки для Visual Studio Code. 

1. Создайте файл с `launch.json` именем `\.vscode` в папке проекта, если его уже нет. 
1. Убедитесь, что в файле есть массив `configurations` . Ниже приводится простой пример `launch.json`.

    ```json
    {
      // other properities may be here.

      "configurations": [

        // configuration objects may be here.

      ]

      //other properies may be here.
    }
    ```

1. Добавьте следующий объект в массив `configurations` .

    ```json
    {
      "name": "$HOST$ Desktop (Edge Legacy)",
      "type": "office-addin",
      "request": "attach",
      "url": "https://localhost:3000/taskpane.html?_host_Info=Excel$Win32$16.01$en-US$$$$0",
      "port": 9222,
      "timeout": 600000,
      "webRoot": "${workspaceRoot}",
      "preLaunchTask": "Debug: Excel Desktop",
      "postDebugTask": "Stop Debug"
    }
    ```

1. Замените местообладатель `$HOST$` и имя приложения Office, в которое выполняется надстройка; например, `Outlook` или `Word`.
1. Сохраните и закройте файл.

## <a name="see-also"></a>См. также

- [Тестирование и отладка надстроек Office](test-debug-office-add-ins.md)
- Отламывка надстроек на Windows с Visual Studio Code и [Microsoft Edge WebView2 (Chromium основе)](debug-desktop-using-edge-chromium.md).
- [Отладка надстроек с помощью средств разработчика для Internet Explorer](debug-add-ins-using-f12-tools-ie.md)
- [Отладка надстроек с помощью средств разработчика для устаревшей версии Microsoft Edge](debug-add-ins-using-devtools-edge-legacy.md)
- [Отладка надстроек с помощью средств разработчика в Microsoft Edge (на основе Chromium)](debug-add-ins-using-devtools-edge-chromium.md)
- [Подключение отладчика из области задач](attach-debugger-from-task-pane.md)
