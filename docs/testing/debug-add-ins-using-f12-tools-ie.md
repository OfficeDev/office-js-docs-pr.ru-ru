---
title: Отладка надстроек с помощью средств разработчика для Internet Explorer
description: Отламывка надстроек с помощью средств разработчика в Internet Explorer.
ms.date: 11/02/2021
ms.localizationpriority: medium
ms.openlocfilehash: fb830f90c23b64e19420c73bee695bef669d93d1
ms.sourcegitcommit: a3debae780126e03a1b566efdec4d8be83e405b8
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/03/2021
ms.locfileid: "60809092"
---
# <a name="debug-add-ins-using-developer-tools-in-internet-explorer"></a>Отламывка надстроек с помощью средств разработчика в Internet Explorer

В этой статье показано, как отлагировать клиентский код (JavaScript или TypeScript) надстройки при условии, при которых будут выполнены следующие условия.

- Вы не можете или не хотите отлаговка с помощью инструментов, встроенных в ваш IDE; или вы столкнулись с проблемой, которая возникает только при запуске надстройки за пределами IDE.
- На компьютере используется сочетание Windows и Office, использующих управление веб-просмотром Internet Explorer Trident.

Чтобы определить, какой браузер используется на компьютере, см. в Office [надстройки.](../concepts/browsers-used-by-office-web-add-ins.md)

> [!TIP]
> [!INCLUDE[Identify the webview through the add-in UI](../includes/identify-webview-in-ui.md)]

> [!NOTE]
> Чтобы установить версию Office веб-браузера Internet Explorer или заставить текущую версию использовать Internet Explorer, см. в странице [Switch to the Internet Explorer 11 webview.](#switch-to-the-internet-explorer-11-webview)

## <a name="debug-a-task-pane-add-in-using-the-f12-tools"></a>Отламывка надстройки области задач с помощью средств F12

Windows 10 и 11 включают средство веб-разработки под названием "F12", так как изначально оно было запущено путем нажатия F12 в Internet Explorer. F12 теперь является независимым приложением, используемым для отламывателя надстройки, когда она запущена в области управления веб-просмотром Internet Explorer Trident. Приложение не доступно в более ранних версиях Windows.

> [!NOTE]
> Если надстройка [](../design/add-in-commands.md) имеет команду надстройки, которая выполняет функцию, функция выполняется в скрытом процессе браузера, который средства F12 не могут обнаружить или прикрепить, поэтому описанный в этой статье метод не может использоваться для отлагирования кода в функции.

Ниже указаны инструкции по отладки надстройки. Если вы просто хотите проверить сами средства F12, см. в примере надстройки для тестирования [средств F12.](#example-add-in-to-test-the-f12-tools)

1. [Боковая](create-a-network-shared-folder-catalog-for-task-pane-and-content-add-ins.md) загрузка и запуск надстройки.
1. Запустите средства разработки F12, соответствующие вашей версии Office.

   - Путь к файлу для 32-разрядной версии Office — C:\Windows\System32\F12\IEChooser.exe
   - Путь к файлу для 64-разрядной версии Office — C:\Windows\SysWOW64\F12\IEChooser.exe

   IEChooser открывает окно с именем Выберите цель для **отладки**. Ваша надстройка появится в окне с именем файла домашней страницы надстройки. На следующем скриншоте это `Home.html` . Отображаются только процессы, запущенные в Internet Explorer или Trident. Средство не может присоединяться к процессам, запущенным в других браузерах или веб-Microsoft Edge.

    :::image type="content" source="../images/choose-target-to-debug.png" alt-text="Экран IEChooser с несколькими процессами Internet Explorer и Trident. Один из них называется Home.html.":::

1. Выберите процесс надстройки; то есть имя файла домашней страницы. Это действие прикрепит средства F12 к процессу и откроет основной пользовательский интерфейс F12.
1. Перейдите на вкладку **Отладчик**.
1. В верхней левой части вкладки, чуть ниже ленты средства отладки, находится значок небольшой папки. Выберите это, чтобы открыть список файлов в надстройки. Ниже приведен пример.

    :::image type="content" source="../images/f12-file-dropdown.png" alt-text="Снимок экрана верхнего левого угла вкладки отладка с открытой папкой и списком файлов.":::

1. Выберите файл, который необходимо отладить, и он откроется в области **скрипта** (слева) вкладки **Debugger.** Если вы используете transpiler, bundler или minifier, который изменяет имя файла, он будет иметь окончательное имя, которое фактически загружено, а не исходное имя исходного файла.

1. Прокрутите строку, в которой необходимо установить точку разрыва и нажмите на поле слева от номера строки. Слева от строки появится красная точка, а соответствующая строка появится на вкладке **Breakpoints** нижней правой области. Ниже показан снимок экрана с примером.

    :::image type="content" source="../images/debugger-home-js-02.png" alt-text="Отладка с брейк-пойнтом в home.js файле.":::

1. Выполните функции в надстройке, необходимые для срабатывания точки останова. При попадании точки разрыва на красной точке точки разрыва появляется стрелка правой точки. Ниже показан снимок экрана с примером.

    :::image type="content" source="../images/debugger-home-js-01.png" alt-text="Отладка результатов с срабатывуемой точкой разрыва.":::

> [!TIP]
> Дополнительные сведения об использовании средств F12 см. в дополнительных сведениях о запуске JavaScript с [помощью debugger.](/previous-versions/windows/internet-explorer/ie-developer/samples/dn255007(v=vs.85))

### <a name="example-add-in-to-test-the-f12-tools"></a>Пример надстройки для тестирования средств F12

В этом примере используются Word и бесплатная надстройка из AppSource.

1. Откройте Word и выберите пустой документ. 
1. На вкладке **Вставка** в группе надстройки выберите мои **надстройки,** чтобы открыть диалоговое окно Office надстройки, а затем выберите вкладку **STORE.**  
1. Выберите **надстройка QR4Office.** Он открывается в области задач.
1. Запустите средства разработки F12, соответствующие вашей версии Office, как описано в предыдущем разделе.
1. В окне F12 выберите **Home.html**.
1. На **вкладке Debugger** откройте файл **Home.js,** как описано в предыдущем разделе.
1. Установите точки разрыва на строках 310 и 312.
1. В надстройке выберите кнопку **Вставить.** Одна или другая точка взлома поражена.

## <a name="debug-a-dialog-in-an-add-in"></a>Отламыв диалоговое окно надстройки

Если надстройка использует API Office диалогов, диалоговое окно запускается в отдельном процессе от области задач (если таковое имеется), и средства должны присоединяться к этому процессу. Выполните указанные ниже действия.

1. Запустите надстройку и средства. 
1. Откройте диалоговое окно и выберите кнопку **Обновить** в средствах. Показан диалоговое окно. Его имя — имя файла, открытого в диалоговом ок.
1. Выберите процесс, чтобы открыть его и отлагировать так же, как описано в разделе Отлаговка надстройки области задач с помощью [средств F12](#debug-a-task-pane-add-in-using-the-f12-tools).

## <a name="switch-to-the-internet-explorer-11-webview"></a>Переключиться на веб-просмотр Internet Explorer 11

Существует два способа переключения веб-браузера Internet Explorer. Вы можете запустить простую команду в командной подсказке или установить версию Office, использующую Internet Explorer по умолчанию. Рекомендуем первый метод. Но второй вариант следует использовать в следующих сценариях.

- Ваш проект был разработан с Visual Studio и IIS. Это не node.js основе.
- Вы хотите быть абсолютно надежным в тестировании.
- Если по какой-либо причине средство командной строки не работает.

### <a name="switch-via-the-command-line"></a>Переключение через командную строку

[!INCLUDE [Steps to switch browsers with the command line tool](../includes/use-legacy-edge-or-ie.md)]

### <a name="install-a-version-of-office-that-uses-internet-explorer"></a>Установите версию Office, использующую Internet Explorer

[!INCLUDE [Steps to install Office that uses Edge Legacy or Internet Explorer](../includes/install-office-that-uses-legacy-edge-or-ie.md)]

## <a name="see-also"></a>См. также

- [Проверка выполнения кода JavaScript с помощью отладчика](/previous-versions/windows/internet-explorer/ie-developer/samples/dn255007(v=vs.85))
- [Использование средств разработчика F12](/previous-versions/windows/internet-explorer/ie-developer/samples/bg182326(v=vs.85))
