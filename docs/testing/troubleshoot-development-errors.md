---
title: Устранение ошибок разработки с помощью надстройки Office
description: Узнайте, как устранять ошибки разработки в надстройки Office.
ms.date: 01/04/2021
localization_priority: Normal
ms.openlocfilehash: 48216230db4bf90ca53ef10d98786877bd3905c2
ms.sourcegitcommit: 2f75a37de349251bc0e0fc402c5ae6dc5c3b8b08
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/06/2021
ms.locfileid: "49771426"
---
# <a name="troubleshoot-development-errors-with-office-add-ins"></a><span data-ttu-id="692f3-103">Устранение ошибок разработки с помощью надстройки Office</span><span class="sxs-lookup"><span data-stu-id="692f3-103">Troubleshoot development errors with Office Add-ins</span></span>

## <a name="add-in-doesnt-load-in-task-pane-or-other-issues-with-the-add-in-manifest"></a><span data-ttu-id="692f3-104">Надстройка не загружается в область задач или возникают другие проблемы с манифестом надстройки</span><span class="sxs-lookup"><span data-stu-id="692f3-104">Add-in doesn't load in task pane or other issues with the add-in manifest</span></span>

<span data-ttu-id="692f3-105">Сведения об отладке проблем с манифестом см. в статьях [Проверка манифеста надстройки Office](troubleshoot-manifest.md) и [Отладка надстройки с помощью журнала среды выполнения](runtime-logging.md).</span><span class="sxs-lookup"><span data-stu-id="692f3-105">See [Validate an Office Add-in's manifest](troubleshoot-manifest.md) and [Debug your add-in with runtime logging](runtime-logging.md) to debug add-in manifest issues.</span></span>

## <a name="changes-to-add-in-commands-including-ribbon-buttons-and-menu-items-do-not-take-effect"></a><span data-ttu-id="692f3-106">Изменения команд надстройки, в том числе кнопок ленты и элементов меню, не отображаются</span><span class="sxs-lookup"><span data-stu-id="692f3-106">Changes to add-in commands including ribbon buttons and menu items do not take effect</span></span>

<span data-ttu-id="692f3-107">Если внесенные в манифест изменения (например, имена значков кнопок на ленте или текст элементов меню) не вступили в силу, попробуйте очистить кэш Office на своем компьютере.</span><span class="sxs-lookup"><span data-stu-id="692f3-107">If changes you've made in the manifest, such as file names of ribbon button icons or text of menu items, do not seem to take effect, try clearing the Office cache on your computer.</span></span> 

#### <a name="for-windows"></a><span data-ttu-id="692f3-108">Для Windows:</span><span class="sxs-lookup"><span data-stu-id="692f3-108">For Windows:</span></span>

<span data-ttu-id="692f3-109">Удалите содержимое папки и удалите ее( `%LOCALAPPDATA%\Microsoft\Office\16.0\Wef\` если `%userprofile%\AppData\Local\Packages\Microsoft.Win32WebViewHost_cw5n1h2txyewy\AC\#!123\INetCache\` она существует).</span><span class="sxs-lookup"><span data-stu-id="692f3-109">Delete the contents of the folder `%LOCALAPPDATA%\Microsoft\Office\16.0\Wef\`, and delete the contents of the folder `%userprofile%\AppData\Local\Packages\Microsoft.Win32WebViewHost_cw5n1h2txyewy\AC\#!123\INetCache\`, if it exists.</span></span>

#### <a name="for-mac"></a><span data-ttu-id="692f3-110">Для Mac</span><span class="sxs-lookup"><span data-stu-id="692f3-110">For Mac:</span></span>

[!include[additional cache folders on Mac](../includes/mac-cache-folders.md)]

#### <a name="for-ios"></a><span data-ttu-id="692f3-111">Для iOS</span><span class="sxs-lookup"><span data-stu-id="692f3-111">For iOS:</span></span>
<span data-ttu-id="692f3-p101">Для принудительной перезагрузки вызовите метод JavaScript `window.location.reload(true)` в надстройке. Вы также можете переустановить Office.</span><span class="sxs-lookup"><span data-stu-id="692f3-p101">Call `window.location.reload(true)` from JavaScript in the add-in to force a reload. Alternatively, you can reinstall Office.</span></span>

## <a name="changes-to-static-files-such-as-javascript-html-and-css-do-not-take-effect"></a><span data-ttu-id="692f3-114">Изменения статических файлов, таких как JavaScript, HTML и CSS, не отображаются.</span><span class="sxs-lookup"><span data-stu-id="692f3-114">Changes to static files, such as JavaScript, HTML, and CSS do not take effect</span></span>

<span data-ttu-id="692f3-115">Браузер может кэшировать эти файлы.</span><span class="sxs-lookup"><span data-stu-id="692f3-115">The browser may be caching these files.</span></span> <span data-ttu-id="692f3-116">Чтобы избежать этого, отключите кэширование на стороне клиента при разработке.</span><span class="sxs-lookup"><span data-stu-id="692f3-116">To prevent this, turn off client-side caching when developing.</span></span> <span data-ttu-id="692f3-117">Сведения будут зависеть от того, какой тип сервера вы используете.</span><span class="sxs-lookup"><span data-stu-id="692f3-117">The details will depend on what kind of server you are using.</span></span> <span data-ttu-id="692f3-118">В большинстве случаев необходимо добавить определенные заголовки в HTTP-ответы.</span><span class="sxs-lookup"><span data-stu-id="692f3-118">In most cases, it involves adding certain headers to the HTTP Responses.</span></span> <span data-ttu-id="692f3-119">Мы предлагаем следующий набор заголовков:</span><span class="sxs-lookup"><span data-stu-id="692f3-119">We suggest the following set:</span></span>

- <span data-ttu-id="692f3-120">Cache-Control: "private, no-cache, no-store"</span><span class="sxs-lookup"><span data-stu-id="692f3-120">Cache-Control: "private, no-cache, no-store"</span></span>
- <span data-ttu-id="692f3-121">Pragma: "No-cache"</span><span class="sxs-lookup"><span data-stu-id="692f3-121">Pragma: "no-cache"</span></span>
- <span data-ttu-id="692f3-122">Expires: "-1"</span><span class="sxs-lookup"><span data-stu-id="692f3-122">Expires: "-1"</span></span>

<span data-ttu-id="692f3-123">Пример использования на сервере Node.JS Express см. в [этом файле app.js](https://github.com/OfficeDev/Office-Add-in-NodeJS-SSO/blob/master/Complete/app.js).</span><span class="sxs-lookup"><span data-stu-id="692f3-123">For an example of doing this in an Node.JS Express server, see [this app.js file](https://github.com/OfficeDev/Office-Add-in-NodeJS-SSO/blob/master/Complete/app.js).</span></span> <span data-ttu-id="692f3-124">Пример использования в проекте ASP.NET см. в [этом файле cshtml](https://github.com/OfficeDev/Office-Add-in-ASPNET-SSO/blob/master/Complete/Office-Add-in-ASPNET-SSO-WebAPI/Views/Shared/_Layout.cshtml).</span><span class="sxs-lookup"><span data-stu-id="692f3-124">For an example in an ASP.NET project, see [this cshtml file](https://github.com/OfficeDev/Office-Add-in-ASPNET-SSO/blob/master/Complete/Office-Add-in-ASPNET-SSO-WebAPI/Views/Shared/_Layout.cshtml).</span></span>

<span data-ttu-id="692f3-125">Если надстройка размещена на сервере Internet Information Server (IIS), можно также добавить указанные сведения в файл web.config.</span><span class="sxs-lookup"><span data-stu-id="692f3-125">If your add-in is hosted in Internet Information Server (IIS), you could also add the following to the web.config.</span></span>

```xml
<system.webServer>
  <staticContent>
    <clientCache cacheControlMode="UseMaxAge" cacheControlMaxAge="0.00:00:00" cacheControlCustom="must-revalidate" />
  </staticContent>
```

<span data-ttu-id="692f3-126">Если сначала эти действия безуспешны, вам, возможно, потребуется очистить кэш браузера.</span><span class="sxs-lookup"><span data-stu-id="692f3-126">If these steps don't seem to work at first, you may need to clear the browser's cache.</span></span> <span data-ttu-id="692f3-127">Сделайте это в интерфейсе браузера.</span><span class="sxs-lookup"><span data-stu-id="692f3-127">Do this through the UI of the browser.</span></span> <span data-ttu-id="692f3-128">Иногда очистить кэш браузера Microsoft Edge, используя пользовательский интерфейс, не удается.</span><span class="sxs-lookup"><span data-stu-id="692f3-128">Sometimes the Edge cache isn't successfully cleared when you try to clear it in the Edge UI.</span></span> <span data-ttu-id="692f3-129">В таком случае выполните следующую команду в командной строке Windows.</span><span class="sxs-lookup"><span data-stu-id="692f3-129">If that happens, run the following command in a Windows Command Prompt.</span></span>

```bash
del /s /f /q %LOCALAPPDATA%\Packages\Microsoft.Win32WebViewHost_cw5n1h2txyewy\AC\#!123\INetCache\
```

## <a name="changes-made-to-property-values-dont-happen-and-there-is-no-error-message"></a><span data-ttu-id="692f3-130">Изменения значений свойств не происходят, и сообщение об ошибке не сообщается</span><span class="sxs-lookup"><span data-stu-id="692f3-130">Changes made to property values don't happen and there is no error message</span></span>

<span data-ttu-id="692f3-131">Проверьте справочную документацию по свойству, чтобы узнать, прочитано ли оно только.</span><span class="sxs-lookup"><span data-stu-id="692f3-131">Check the reference documentation for the property to see if it is read only.</span></span> <span data-ttu-id="692f3-132">Кроме того, определения [TypeScript](../develop/referencing-the-javascript-api-for-office-library-from-its-cdn.md) для Office JS указывают, какие свойства объекта являются только для чтения.</span><span class="sxs-lookup"><span data-stu-id="692f3-132">Also, the [TypeScript definitions](../develop/referencing-the-javascript-api-for-office-library-from-its-cdn.md) for Office JS specify which object properties are read-only.</span></span> <span data-ttu-id="692f3-133">Если попытаться установить свойство только для чтения, операция записи будет неудачной без ошибок.</span><span class="sxs-lookup"><span data-stu-id="692f3-133">If you attempt to set a read-only property, the write operation will fail silently, with no error thrown.</span></span> <span data-ttu-id="692f3-134">В следующем примере ошибочно предпринимается попытка установить свойство только [для Chart.id.](/javascript/api/excel/excel.chart#id) См. [также, что некоторые свойства нельзя настроить напрямую.](../develop/application-specific-api-model.md#some-properties-cannot-be-set-directly)</span><span class="sxs-lookup"><span data-stu-id="692f3-134">The following example erroneously attempts to set the read-only property [Chart.id](/javascript/api/excel/excel.chart#id). See also [Some properties cannot be set directly](../develop/application-specific-api-model.md#some-properties-cannot-be-set-directly).</span></span>

```js
// This will do nothing, since `id` is a read-only property.
myChart.id = "5";
```

## <a name="getting-error-this-add-in-is-no-longer-available"></a><span data-ttu-id="692f3-135">Ошибка при получении: "Эта надстройка больше недоступна"</span><span class="sxs-lookup"><span data-stu-id="692f3-135">Getting error: "This add-in is no longer available"</span></span>

<span data-ttu-id="692f3-136">Ниже следующую часть причин этой ошибки.</span><span class="sxs-lookup"><span data-stu-id="692f3-136">The following are some of the causes of this error.</span></span> <span data-ttu-id="692f3-137">Если вы обнаружите дополнительные причины, сообщите нам с помощью средства обратной связи в нижней части страницы.</span><span class="sxs-lookup"><span data-stu-id="692f3-137">If you discover additional causes, please tell us with the feedback tool at the bottom of the page.</span></span>

- <span data-ttu-id="692f3-138">Если вы используете Visual Studio, возможно, возникла проблема с загрузкой неогрузки.</span><span class="sxs-lookup"><span data-stu-id="692f3-138">If you are using Visual Studio, there may be a problem with the sideloading.</span></span> <span data-ttu-id="692f3-139">Закроем все экземпляры ведущего экземпляра Office и Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="692f3-139">Close all instances of the Office host and Visual Studio.</span></span> <span data-ttu-id="692f3-140">Перезапустите Visual Studio и повторите нажатие F5.</span><span class="sxs-lookup"><span data-stu-id="692f3-140">Restart Visual Studio and try pressing F5 again.</span></span>
- <span data-ttu-id="692f3-141">Манифест надстройки удален из расположения развертывания, например централизованного развертывания, каталога SharePoint или сетевой сети.</span><span class="sxs-lookup"><span data-stu-id="692f3-141">The add-in's manifest has been removed from its deployment location, such as Centralized Deployment, a SharePoint catalog, or a network share.</span></span>
- <span data-ttu-id="692f3-142">Значение элемента [ID](../reference/manifest/id.md) в манифесте было изменено непосредственно в развернутой копии.</span><span class="sxs-lookup"><span data-stu-id="692f3-142">The value of the [ID](../reference/manifest/id.md) element in the manifest has been changed directly in the deployed copy.</span></span> <span data-ttu-id="692f3-143">Если по какой-либо причине вы хотите изменить этот ИД, сначала удалите надстройки из ведущего office, а затем замените исходный манифест на измененный манифест.</span><span class="sxs-lookup"><span data-stu-id="692f3-143">If for any reason, you want to change this ID, first remove the add-in from the Office host, then replace the original manifest with the changed manifest.</span></span> <span data-ttu-id="692f3-144">Многим необходимо очистить кэш Office, чтобы удалить все трассировки исходного.</span><span class="sxs-lookup"><span data-stu-id="692f3-144">You many need to clear the Office cache to remove all traces of the original.</span></span> <span data-ttu-id="692f3-145">См. раздел "Изменения команд [надстройки",](#changes-to-add-in-commands-including-ribbon-buttons-and-menu-items-do-not-take-effect) включая кнопки ленты и пункты меню, которые не вступили в силу ранее в этой статье.</span><span class="sxs-lookup"><span data-stu-id="692f3-145">See the section [Changes to add-in commands including ribbon buttons and menu items do not take effect](#changes-to-add-in-commands-including-ribbon-buttons-and-menu-items-do-not-take-effect) earlier in this article.</span></span>
- <span data-ttu-id="692f3-146">Манифест надстройки имеет манифест, который не определен ни в разделе "Ресурсы" манифеста, либо имеется несоответствие в орфографии между местом ее использования и местом, где оно определено в `resid` [](../reference/manifest/resources.md) `resid` `<Resources>` разделе.</span><span class="sxs-lookup"><span data-stu-id="692f3-146">The add-in's manifest has a `resid` that is not defined anywhere in the [Resources](../reference/manifest/resources.md) section of the manifest, or there is a mismatch in the spelling of the `resid` between where it is used and where it is defined in the `<Resources>` section.</span></span>
- <span data-ttu-id="692f3-147">В `resid` манифесте есть атрибут, в который вмеется более 32 символов.</span><span class="sxs-lookup"><span data-stu-id="692f3-147">There is a `resid` attribute somewhere in the manifest with more than 32 characters.</span></span> <span data-ttu-id="692f3-148">Атрибут и атрибут соответствующего ресурса в разделе не могут быть больше `resid` `id` `<Resources>` 32 символов.</span><span class="sxs-lookup"><span data-stu-id="692f3-148">A `resid` attribute, and the `id` attribute of the corresponding resource in the `<Resources>` section, cannot be more than 32 characters.</span></span>
- <span data-ttu-id="692f3-149">Надстройка имеет пользовательскую команду надстройки, но вы пытаетесь запустить ее на платформе, которая их не поддерживает.</span><span class="sxs-lookup"><span data-stu-id="692f3-149">The add-in has a custom Add-in Command but you are trying to run it on a platform that doesn't support them.</span></span> <span data-ttu-id="692f3-150">Дополнительные сведения см. в наборах требований [для команд надстройки.](../reference/requirement-sets/add-in-commands-requirement-sets.md)</span><span class="sxs-lookup"><span data-stu-id="692f3-150">For more information, see [Add-in commands requirement sets](../reference/requirement-sets/add-in-commands-requirement-sets.md).</span></span>

## <a name="add-in-doesnt-work-on-edge-but-it-works-on-other-browsers"></a><span data-ttu-id="692f3-151">Надстройка не работает в Edge, но работает в других браузерах</span><span class="sxs-lookup"><span data-stu-id="692f3-151">Add-in doesn't work on Edge but it works on other browsers</span></span>

<span data-ttu-id="692f3-152">См. [устранение неполадок Microsoft Edge.](../concepts/browsers-used-by-office-web-add-ins.md#troubleshooting-microsoft-edge-issues)</span><span class="sxs-lookup"><span data-stu-id="692f3-152">See [Troubleshooting Microsoft Edge issues](../concepts/browsers-used-by-office-web-add-ins.md#troubleshooting-microsoft-edge-issues).</span></span>

## <a name="excel-add-in-throws-errors-but-not-consistently"></a><span data-ttu-id="692f3-153">Надстройка Excel высылает ошибки, но не постоянно</span><span class="sxs-lookup"><span data-stu-id="692f3-153">Excel add-in throws errors, but not consistently</span></span>

<span data-ttu-id="692f3-154">Возможные причины см. в устранении [неполадок](../excel/excel-add-ins-troubleshooting.md) надстройки Excel.</span><span class="sxs-lookup"><span data-stu-id="692f3-154">See [Troubleshoot Excel add-ins](../excel/excel-add-ins-troubleshooting.md) for possible causes.</span></span>

## <a name="see-also"></a><span data-ttu-id="692f3-155">См. также</span><span class="sxs-lookup"><span data-stu-id="692f3-155">See also</span></span>

- [<span data-ttu-id="692f3-156">Отладка надстроек в Office в Интернете</span><span class="sxs-lookup"><span data-stu-id="692f3-156">Debug add-ins in Office on the web</span></span>](debug-add-ins-in-office-online.md)
- [<span data-ttu-id="692f3-157">Загрузка неопубликованной надстройки Office на iPad и Mac</span><span class="sxs-lookup"><span data-stu-id="692f3-157">Sideload an Office Add-in on iPad and Mac</span></span>](sideload-an-office-add-in-on-ipad-and-mac.md)  
- [<span data-ttu-id="692f3-158">Отладка надстроек Office на iPad и Mac</span><span class="sxs-lookup"><span data-stu-id="692f3-158">Debug Office Add-ins on iPad and Mac</span></span>](debug-office-add-ins-on-ipad-and-mac.md)  
- [<span data-ttu-id="692f3-159">Надстройка Microsoft Office "Расширение отладчика для Visual Studio Code"</span><span class="sxs-lookup"><span data-stu-id="692f3-159">Microsoft Office Add-in Debugger Extension for Visual Studio Code</span></span>](debug-with-vs-extension.md)
- [<span data-ttu-id="692f3-160">Проверка манифеста надстройки Office</span><span class="sxs-lookup"><span data-stu-id="692f3-160">Validate an Office Add-in's manifest</span></span>](troubleshoot-manifest.md)
- [<span data-ttu-id="692f3-161">Отладка надстройки с помощью журнала среды выполнения</span><span class="sxs-lookup"><span data-stu-id="692f3-161">Debug your add-in with runtime logging</span></span>](runtime-logging.md)
- [<span data-ttu-id="692f3-162">Устранение ошибок, с которыми сталкиваются пользователи при работе с надстройками Office</span><span class="sxs-lookup"><span data-stu-id="692f3-162">Troubleshoot user errors with Office Add-ins</span></span>](testing-and-troubleshooting.md)
