---
title: Загрузка Office неопубликованных надстроек для тестирования из сетевой папки
description: Узнайте, как загрузить неопубликованную надстройку Office для тестирования из сетевой папки.
ms.date: 05/26/2022
ms.localizationpriority: medium
ms.openlocfilehash: a8b6e61464633a18e29c72b9e983368ea803b258
ms.sourcegitcommit: 690c1cc5f9027fd9859e650f3330801fe45e6e67
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/27/2022
ms.locfileid: "65752885"
---
# <a name="sideload-office-add-ins-for-testing-from-a-network-share"></a>Загрузка Office неопубликованных надстроек для тестирования из сетевой папки

Вы можете протестировать надстройку Office в клиенте Office, который Windows, опубликуя манифест в сетевом файловом ресурсе (инструкции ниже). Этот вариант развертывания предназначен для использования, когда вы завершили разработку и тестирование на localhost и хотите протестировать надстройку с не локального сервера или облачной учетной записи.

> [!IMPORTANT]
> Развертывание по сетевому ресурсу не поддерживается для рабочих надстроек. Этот метод имеет следующие ограничения.
>
> - Надстройку можно установить только на Windows компьютерах.
> - Если новая версия надстройки изменяет ленту, например путем добавления к ней настраиваемой вкладки или настраиваемой кнопки, каждому пользователю придется переустановить надстройку.

> [!NOTE]
> Если проект надстройки создан с помощью достаточно новой версии [генератора Yeoman для надстроек Office](../develop/yeoman-generator-overview.md), неопубликованная надстройка автоматически загружается в классический клиент Office, когда вы запускаете команду `npm start`.

Эта статья относится только к тестированию надстроек Word, Excel, PowerPoint и Project и только Windows. Если вы хотите протестировать на другой платформе или Outlook надстройку, ознакомьтесь с одним из следующих разделов, чтобы загрузить неопубликованную надстройку.

- [Загрузка неопубликованных надстроек Office в Office в Интернете для тестирования](sideload-office-add-ins-for-testing.md)
- [Загрузка неопубликованных надстроек Office на iPad и Mac для тестирования](sideload-an-office-add-in-on-ipad-and-mac.md)
- [Загрузка неопубликованных надстроек Outlook для тестирования](../outlook/sideload-outlook-add-ins-for-testing.md)

В приведенном ниже видео показано, как загрузить неопубликованную надстройку в классическое приложение Office или Office в Интернете с помощью каталога общих папок.  

> [!VIDEO https://www.youtube.com/embed/XXsAw2UUiQo]

## <a name="share-a-folder"></a>Общий доступ к папке

1. На том компьютере с Windows, где должна размещаться надстройка, перейдите к родительской папке или диску с папкой, которую требуется использовать в качестве каталога общих папок.

1. Откройте контекстное меню для папки, которую нужно использовать в качестве каталога общих папок (щелкните папку правой кнопкой мыши), и выберите пункт **Свойства**.

1. В диалоговом окне **Свойства** откройте вкладку **Доступ** и нажмите кнопку **Общий доступ**.

    ![Диалоговое окно "Свойства папки" с выделенной вкладкой "Общий доступ" и кнопкой "Общий доступ".](../images/sideload-windows-properties-dialog.png)

1. В диалоговом окне **Доступ к сети** добавьте себя и любых других пользователей и/или группы пользователей, которым следует предоставить доступ к вашей надстройке. Вам потребуются разрешения на **чтение и запись** папки. Завершив выбор пользователей, которым предоставляется совместный доступ, нажмите кнопку **Поделиться**.

1. Когда появится подтверждение, что **папка открыта для общего доступа**, запишите полный сетевой путь, отображаемый сразу после имени папки. (Это значение нужно вводить как **URL-адрес каталога** при [указании общей папки в качестве доверенного каталога](#specify-the-shared-folder-as-a-trusted-catalog), как описано в следующем разделе этой статьи). Нажмите кнопку **Готово**, чтобы закрыть диалоговое окно **Доступ к сети**.

   ![Диалоговое окно сетевого доступа с выделенным путем к общей папке.](../images/sideload-windows-network-access-dialog.png)

1. Нажмите кнопку **Закрыть**, чтобы закрыть диалоговое окно **Свойства**.

## <a name="specify-the-shared-folder-as-a-trusted-catalog"></a>Указание общей папки в качестве доверенного каталога

### <a name="configure-the-trust-manually"></a>Настройка доверия вручную

1. Откройте новый документ в Excel, Word, PowerPoint или Project.

1. Перейдите на вкладку **Файл**, а затем выберите **Параметры**.

1. Выберите **Центр управления безопасностью**, а затем нажмите кнопку **Параметры центра управления безопасностью**.

1. Выберите пункт **Доверенные каталоги надстроек**.

1. В поле **URL-адрес каталога** введите полный сетевой путь к папке, к которой вы ранее предоставили [общий доступ](#share-a-folder). Если вы не записали полный сетевой путь к папке при предоставлении к ней общего доступа, его можно получить в диалоговом окне **Свойства** папки, как показано на снимке экрана ниже.

    ![Диалоговое окно "Свойства папки" с выделенной вкладкой "Общий доступ" и сетевым путем.](../images/sideload-windows-properties-dialog-2.png)

1. После ввода полного сетевого пути доступа к папке в поле **URL-адрес каталога**, нажмите кнопку **Добавить каталог**.

1. Установите флажок **Показывать в меню** для только что добавленного элемента и нажмите кнопку **ОК**, чтобы закрыть диалоговое окно **Центр управления безопасностью**. 

    ![Диалоговое окно центра управления безопасностью с выбранным каталогом.](../images/sideload-windows-trust-center-dialog.png)

1. Нажмите **кнопку "** ОК", чтобы закрыть диалоговое окно **"** Параметры".

1. Закройте и снова откройте приложение Office, чтобы изменения вступили в силу.

### <a name="configure-the-trust-with-a-registry-script"></a>Настройка доверия с помощью сценария реестра

1. В текстовом редакторе создайте файл с именем TrustNetworkShareCatalog.reg.

1. Добавьте в файл следующее содержимое.

    ```text
    Windows Registry Editor Version 5.00

    [HKEY_CURRENT_USER\Software\Microsoft\Office\16.0\WEF\TrustedCatalogs\{-random-GUID-here-}]
    "Id"="{-random-GUID-here-}"
    "Url"="\\\\-share-\\-folder-"
    "Flags"=dword:00000001
    ```

1. Используйте одно из многочисленных средств создания GUID в Интернете, например [Генератор GUID](https://guidgenerator.com/), для создания случайного GUID и в файле TrustNetworkShareCatalog.reg замените строку "-random-GUID-here-" *в обоих местах* идентификатором GUID. (Символы `{}` должны сохраняться.)

1. Замените значение `Url` полным сетевым путем к папке, к которой вы ранее предоставили [общий доступ](#share-a-folder). (Обратите внимание, что все знаки `\` в URL-адресе должны дублироваться.) Если вы не записали полный сетевой путь к папке при предоставлении к ней общего доступа, его можно получить в диалоговом окне **Свойства** папки, как показано на снимке экрана ниже.

    ![Диалоговое окно "Свойства папки" с выделенной вкладкой "Общий доступ" и сетевым путем.](../images/sideload-windows-properties-dialog-2.png)

1. Файл теперь должен выглядеть так, как показано ниже. Сохраните его.

    ```text
    Windows Registry Editor Version 5.00

    [HKEY_CURRENT_USER\Software\Microsoft\Office\16.0\WEF\TrustedCatalogs\{01234567-89ab-cedf-0123-456789abcedf}]
    "Id"="{01234567-89ab-cedf-0123-456789abcedf}"
    "Url"="\\\\TestServer\\OfficeAddinManifests"
    "Flags"=dword:00000001
    ```

1. Закройте *все* приложения Office.

1. Запустите файл TrustNetworkShareCatalog.reg как любой исполняемый файл, например, дважды щелкнув его.

## <a name="sideload-your-add-in"></a>Загрузка неопубликованной надстройки

1. XML-файл манифеста тестируемой надстройки необходимо поместить в каталог общих папок. Обратите внимание, что вы развертываете веб-приложение непосредственно на веб-сервере. Не забудьте указать URL-адрес в элементе **SourceLocation** файла манифеста.

    > [!IMPORTANT]
    > [!include[HTTPS guidance](../includes/https-guidance.md)]

    > [!NOTE]
    > Для Visual Studio проектов используйте манифест, созданный проектом в папке`{projectfolder}\bin\Debug\OfficeAppManifests`.

1. В Excel, Word или PowerPoint откройте на ленте вкладку **Вставка** и выберите **Мои надстройки**. В Project выберите **Мои надстройки** на вкладке **Project** ленты.

1. Нажмите **ОБЩАЯ ПАПКА** в верхней части диалогового окна **Надстройки Office**.

1. Выберите имя надстройки и нажмите кнопку **Добавить**, чтобы вставить надстройку.

## <a name="remove-a-sideloaded-add-in"></a>Удаление неопубликоваемой надстройки

Вы можете удалить ранее загруженную неопубликованную надстройку, очистите кэш Office на компьютере. Сведения о том, как очистить кэш Windows, см. в статье "Очистка Office [кэша"](clear-cache.md#clear-the-office-cache-on-windows).

## <a name="see-also"></a>См. также

- [Проверка манифеста надстройки Office](troubleshoot-manifest.md)
- [Очистка кэша Office](clear-cache.md)
- [Публикация надстройки Office](../publish/publish.md)
