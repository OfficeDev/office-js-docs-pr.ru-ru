---
title: Коды ошибок общего API для Office
description: В этой статье описаны сообщения об ошибках, которые могут возникнуть при использовании общего API Office.
ms.date: 02/08/2022
ms.localizationpriority: medium
ms.openlocfilehash: 80637e1573e120664ee89685a9c9579dbcfe6b2e
ms.sourcegitcommit: df7964b6509ee6a807d754fbe895d160bc52c2d3
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/20/2022
ms.locfileid: "66889613"
---
# <a name="office-common-api-error-codes"></a>Коды ошибок общего API для Office

В этой статье описаны сообщения об ошибках, которые могут возникнуть при использовании модели Common API. Эти коды ошибок не применяются к API для конкретных приложений, таким как API JavaScript для Excel или API JavaScript для Word.

[Дополнительные сведения о различиях](../develop/understanding-the-javascript-api-for-office.md#api-models) между общимИ API и моделями API для конкретных приложений см. в моделях API.

## <a name="error-codes"></a>Коды ошибок

В представленной ниже таблице перечислены коды и названия ошибок, отображаемые сообщения и условия, на которые они указывают.

|**Error.code**|**Error.name**|**Error.message**|**Условие**|
|:-----|:-----|:-----|:-----|
|1000|Недопустимый тип приведения|Указанный тип приведения не поддерживается|Тип приведения не поддерживается в приложении Office. Например, типы приведений OOXML и HTML не поддерживаются в Excel.|
|1001|Ошибка чтения данных|Текущий выделенный фрагмент не поддерживается.|Текущий фрагмент, выделенный пользователем, не поддерживается (то есть он не является приведением поддерживаемого типа).|
|1002|Недопустимый тип приведения|Указанный тип приведения несовместим с этим типом привязки.|Разработчик решения создал несовместимое сочетание типа приведения и типа привязки.|
|1003|Ошибка чтения данных|Указано недопустимое значение параметра rowCount или columnCount.|Пользователь указал недопустимый индекс столбца или строки.|
|1004|Ошибка чтения данных|Выделенный фрагмент несовместим с указанным типом приведения.|Выделенный фрагмент не поддерживается типом приведения, который указало приложение.|
|1005|Ошибка чтения данных|Указано недопустимое значение параметра startRow или startColumn.|Пользователь указал недопустимое значение параметра startRow или startCol.|
|1006|Ошибка чтения данных|Использование параметров координации с типом приведения "Таблица" не допускается, если таблица содержит объединенные ячейки.|Пользователь пытается считать часть данных из неоднородной таблицы (таблицы, содержащей объединенные ячейки). |
|1007|Ошибка чтения данных|Размер документа превышает допустимый.|Пользователь пытается считать документ, размер которого превышает допустимый.|
|1008|Ошибка чтения данных|Размер запрошенного набора данных превышает допустимый.|Пользователь запрашивает чтение данных за пределами ограничений данных, определенных приложением Office.|
|1009|Ошибка чтения данных|Указанный тип файлов не поддерживается.|Пользователь отправляет файл недопустимого типа.|
|2000|Ошибка записи данных|Заданный объект данных не поддерживается. |Задан неподдерживаемый объект данных.|
|2001|Ошибка записи данных|Не удается записать данные в текущий выделенный фрагмент.|Выделенный пользователем фрагмент не поддерживает операцию записи. Например, пользователь выделил изображение.|
|2002|Ошибка записи данных|Предоставленный объект данных несовместим с формой или измерениями текущего выделенного фрагмента.|Выделено несколько ячеек, а форма выделенного фрагмента не совпадает с формой данных. Выделено несколько ячеек, а измерения выделенного фрагмента не совпадают с измерениями данных.|
|2003|Ошибка записи данных|Не удалось выполнить операцию задания, так заданный объект данных перезапишет данные.|Выделена одна ячейка, а заданный объект перезаписывает данные листа.|
|2004|Ошибка записи данных|Заданный объект данных не соответствует размеру выделенного фрагмента.|Пользователь задает объект, размер которого превышает размер текущего выделенного фрагмента.|
|2005|Ошибка записи данных|Указано недопустимое значение параметра startRow или startColumn.|Пользователь указал недопустимое значение параметра startRow или startCol.|
|2006|Ошибка недопустимого формата|Формат указанного объекта данных недопустим.|Разработчик решения указывает недопустимую строку HTML и OOXML, деформированную строку HTML или недопустимую строку OOXML.|
|2007|Недопустимый объект данных|Тип указанного объекта данных несовместим с выделенным фрагментом.|Разработчик решения задает объект данных, несовместимый с указанным типом приведения.|
|2008|Ошибка записи данных|Подлежит определению.|Подлежит определению.|
|2009|Ошибка записи данных|Размер указанного объекта данных превышает допустимый.|Пользователь пытается задать данные за пределами ограничений данных, определенных приложением Office.|
|2010|Ошибка записи данных|Использование параметров координации с типом приведения "Таблица" не допускается, если таблица содержит объединенные ячейки.|Пользователь пытается записать часть данных в неоднородную таблицу (таблицу, содержащую объединенные ячейки).|
|3000|Ошибка создания привязки|Не удается выполнить привязку к выделенному фрагменту.|Выделенный пользователем фрагмент не поддерживает привязку. Например, пользователь выделяет изображение или другой неподдерживаемый объект.|
|3001|Ошибка создания привязки|Подлежит определению.|Подлежит определению.|
|3002|Ошибка недопустимой привязки|Указанная привязка не существует.|Разработчик пытается выполнить привязку к несуществующей или удаленной привязке.|
|3003|Ошибка создания привязки|Выделение несмежных фрагментов не поддерживается.|Пользователь выделил несколько фрагментов.|
|3004|Ошибка создания привязки|Невозможно создать привязку для текущего выделения и указанного типа привязки.|Эта ошибка может возникать в нескольких случаях. См. раздел "Условия ошибок создания привязки" далее в этой статье.|
|3005|Недопустимая операция привязки|Операция не поддерживается для этого типа привязки.|Разработчик отправляет операцию добавления строки или столбца для типа привязки, который не имеет тип приведения `table`.|
|3006|Ошибка создания привязки|Именованный элемент не существует.|Не удалось найти именованный элемент. Элемента управления контентом или таблицы с таким именем не существует.|
|3007|Ошибка создания привязки|Найдено несколько объектов с одинаковыми именами.|Ошибка конфликта: существует несколько элементов управления содержимым с одинаковым именем, а для параметра fail on collision задано значение `true`.|
|3008|Ошибка создания привязки|Указанный тип привязки несовместим с заданным именованным элементом.|Именованный элемент нельзя привязать к типу. Например, элемент управления содержимым содержит текст, но разработчик попытался выполнить привязку с помощью типа приведения `table`.|
|3009|Недопустимая операция привязки|Тип привязки не поддерживается.|Используется для обратной совместимости.|
|3010|Неподдерживаемая операция привязки|Выбранное содержимое должно быть представлено в формате таблицы. Отформатируйте данные как таблицу и повторите попытку.|Разработчик пытается использовать объект или `addRowsAsync` `deleteAllDataValuesAsync` `TableBinding` методы для данных типа приведения.`matrix`|
|4000|Ошибка чтения параметров|Указанное имя параметра не существует.|Задано несуществующее имя параметра.|
|4001|Ошибка сохранения параметров|Не удалось сохранить параметры.|Не удалось сохранить параметры.|
|4002|Ошибка устаревших параметров|Не удалось сохранить параметры, так как они устарели.|Параметры устарели, а разработчик не переопределил их.|
|5000|Ошибка устаревших параметров|Операция не поддерживается.|Операция не поддерживается в текущем приложении Office. Например, вызывается `document.getSelectionAsync` из Outlook.|
|5001|Внутренняя ошибка|Внутренняя ошибка.|Указывает на состояние внутренней ошибки, которая может возникнуть по одной из указанных ниже причин.<br/><table><tr><td>С надстройкой работает другой пользователь, который совместно применяет рабочую книгу с привязкой, созданной в приблизительно то же время. Надстройке необходимо повторно выполнить привязку.</tr></td><tr><td>Возникла неизвестная ошибка.</tr></td><tr><td>Сбой операции.</tr></td><tr><td>Доступ был заблокирован, так как пользователь не имеет авторизованную роль.</tr></td><tr><td>Доступ заблокирован, так как требуется безопасное, зашифрованное соединение.</tr></td><tr><td>Данные устарели, пользователю необходимо подтвердить их, включив запросы для обновления.</tr></td><tr><td>Квота на ЦП для семейства веб-сайтов превышена.</tr></td><tr><td>Квота на память для семейства веб-сайтов превышена.</tr></td><tr><td>Квота на память сеанса превышена.</tr></td><tr><td>Рабочая книга находится в недопустимом состоянии, операцию не удается выполнить.</tr></td><tr><td>Время ожидания сеанса истекло из-за неактивности. Пользователю необходимо перезагрузить рабочую книгу.</tr></td><tr><td>Максимальное количество разрешенных сеансов на пользователя превышено.</tr></td><tr><td>Операция отменена пользователем.</tr></td><tr><td>Операцию не удается завершить, так как она выполняется слишком долго.</tr></td><tr><td>Запрос не удается выполнить, его необходимо отправить повторно.</tr></td><tr><td>Срок действия пробной версии подошел к концу.</tr></td><tr><td>Время ожидания сеанса истекло из-за неактивности.</tr></td><tr><td>У пользователя нет прав на выполнение операции над указанным диапазоном.</tr></td><tr><td>Региональные параметры пользователя не соответствуют текущему сеансу совместной работы.</tr></td><tr><td>Пользователь больше не подключен и должен обновить или открыть рабочую книгу повторно.</tr></td><tr><td>Запрошенный диапазон не существует на листе.</tr></td><tr><td>У пользователя нет прав на редактирование рабочей книги.</tr></td><tr><td>Рабочую книгу недоступна для редактирования, так как она заблокирована.</tr></td><tr><td>Сеанс не может автоматически сохранить рабочую книгу.</tr></td><tr><td>Сеанс не может обновить блокировку файла рабочей книги.</tr></td><tr><td>Запрос не удается обработать. Повторите попытку.</tr></td><tr><td>Не удается проверить данные пользователя для входа. Введите их повторно.</tr></td><tr><td>Доступ для пользователя заблокирован.</tr></td><tr><td>Общую книгу необходимо обновить.</tr></td></table>|
|5002|Отказ в разрешении|Запрошенная операция не допускается в текущем режиме документа.|Разработчик выполняет операцию записи, но документ находится в режиме, запрещающем изменения, например "Ограничить редактирование".|
|5003|Ошибка регистрации события|Указанный тип события не поддерживается для текущего объекта.|Разработчик решения пытается зарегистрировать обработчик для несуществующего события или отменить его регистрацию.|
|5004|Недопустимый вызов API|Недопустимый вызов API в текущем контексте.|Для контекста выполняется недопустимый вызов, например при попытке использовать `CustomXMLPart` объект в Excel.|
|5005|Устаревшие данные|Сбой операции в связи с устаревшими данными на сервере.|Необходимо обновить данные на сервере.|
|5006|Время ожидания сеанса|Время ожидания сеанса работы с документом истекло. Перезагрузите документ. |Истекло время ожидания сеанса.|
|5007|Недопустимый вызов API|В текущем контексте перечисление не поддерживается.|В текущем контексте перечисление не поддерживается.|
|5009|Отказ в разрешении|Отказано в доступе|У надстройки нет разрешения на вызов определенного API.|
|5012|Недопустимый или истекший сеанс|Срок действия сеанса браузера Office истек или недопустим. Для продолжения обновите страницу.|Истек срок действия сеанса между клиентом Office и сервером либо дата, время или часовой пояс на вашем компьютере установлены неправильно.|
|6000|Недопустимый узел|Указанный узел не найден.|Узел `CustomXmlPart` не найден.|
|6100|Ошибка настраиваемого XML-документа|Ошибка настраиваемого XML-документа|Недопустимый вызов API.|
|7000|Недопустимый идентификатор|Указанный идентификатор не существует.|Недопустимый идентификатор.|
|7001|Недопустимый переход|Объект находится в таком месте, где не поддерживается навигация.|Пользователь может найти объект, но не может перейти к нему. Например, в Word можно выполнять привязку к верхним и нижним колонтитулами, а также примечаниям.|
|7002|Недопустимый переход|Объект заблокирован или защищен.|Пользователь пытается перейти к заблокированному или защищенному диапазону.|
|7004|Недопустимый переход|Произошел сбой операции, так как индекс находится вне диапазона.|Пользователь пытается перейти к индексу, находящемуся вне диапазона.|
|8000|Отсутствующий параметр|Не удалось отформатировать ячейку таблицы, так как отсутствуют некоторые значения параметров. Проверьте параметры и повторите попытку.|В методе cellFormat отсутствуют некоторые параметры, например ячейки, формат или параметры tableOptions.|
|8010|Недопустимое значение|Один или несколько параметров ячеек имеют недопустимые значения. Проверьте параметры и повторите попытку.|Не определено общее перечисление ссылок на ячейки, например "Все", "Данные", "Заголовки".|
|8011|Недопустимое значение|Один или несколько параметров таблицы имеют недопустимые значения. Проверьте параметры и повторите попытку.|Одно из значений параметра tableOptions является недопустимым.|
|8012|Недопустимое значение|Один или несколько параметров формата имеют недопустимые значения. Проверьте параметры и повторите попытку.|Одно из значений формата является недопустимым.|
|8020|Выход на пределы диапазона|Значение индекса строки находится вне допустимого диапазона. Используйте положительное значение (0 или больше), которое меньше числа строк.|Индекс строки превышает максимальный индекс строки в таблице или является отрицательным.|
|8021|Выход на пределы диапазона|Значение индекса столбца находится вне допустимого диапазона. Используйте положительное значение (0 или больше), которое меньше числа столбцов.|Индекс столбца превышает максимальный индекс столбца в таблице или является отрицательным.|
|8022|Выход на пределы диапазона|Значение находится вне допустимого диапазона.|Некоторые значения формата находятся вне поддерживаемых диапазонов.|
|9016|Отказ в разрешении|В разрешении отказано|Отказ в доступе.|
|9020|Ошибка универсального ответа|Внутренняя ошибка.|Относится к внутреннему условию ошибки, которое может возникнуть по любому ряду причин.|
|9021|Ошибка сохранения|При попытке сохранить элемент на сервере произошла ошибка подключения.|Не удалось сохранить элемент. Это может быть вызвано ошибкой подключения к серверу при использовании режима "В сети" в классическом приложении Outlook или попыткой повторно сохранить черновик элемента, который был удален с сервера Exchange Server.|
|9022|Сообщение об ошибке в другом хранилище|Не удается получить идентификатор EWS, так как сообщение сохраняется в другом хранилище.|Не удалось получить идентификатор EWS для текущего сообщения, так как возможно, сообщение было перемещено или почтовый ящик отправки изменился.|
|9041|Ошибка сети|Пользователь отключен от сети. Проверьте сетевое подключение и повторите попытку.|У пользователя больше нет доступа к сети или Интернету.|
|9043|Тип вложения не поддерживается|Тип вложения не поддерживается.|API не поддерживает тип вложения. Например, `item.getAttachmentContentAsync` эта ошибка возникает, если вложение является внедренным изображением в формате RTF или типом элемента, отличного от элемента электронной почты или календаря (например, контакта или элемента задачи).|
|12002|||Одно из следующих:<br> – По URL-адресу, переданному в `displayDialogAsync`, не существует страницы.<br> – Страница, переданная в метод `displayDialogAsync`, загружена, но выполнена попытка открыть из диалогового окна страницу, которую не удается найти или загрузить, или для которой указан URL-адрес с недопустимым синтаксисом. Появляется в диалоговом окне и запускает событие `DialogEventReceived` на странице ведущего приложения.|
|12003|||Выполнена попытка открыть из диалогового окна страницу, для URL-адреса которой используется протокол HTTP. Необходим протокол HTTPS. Появляется в диалоговом окне и запускает событие `DialogEventReceived` на странице ведущего приложения.|
|12004|||Домен URL-адреса, передаваемого в метод `displayDialogAsync`, не является доверенным. Домен должен быть таким же, как и для страницы ведущего приложения (а также протокол и номер порта). Появляется при вызове `displayDialogAsync`.|
|12005|||URL-адрес, передаваемый в метод `displayDialogAsync`, использует протокол HTTP. Необходим протокол HTTPS. Появляется при вызове `displayDialogAsync`. (В некоторых версиях Office сообщение об ошибке 12005 совпадает с сообщением 12004.)|
|12006|||Диалоговое окно закрыто. Скорее всего, пользователь нажал кнопку **X**. Появляется в диалоговом окне и запускает событие `DialogEventReceived` на странице ведущего приложения.|
|12007|||Диалоговое окно уже открыто из этого главного окна. Для окна ведущего приложения (например, области задач) невозможно открыть сразу несколько диалоговых окон. Появляется при вызове `displayDialogAsync`.|
|12009|||Пользователь проигнорировал диалоговое окно. Эта ошибка может возникнуть в веб-версиях Office, где пользователи могут не разрешить надстройке открыть диалоговое окно. Появляется при вызове `displayDialogAsync`.|
|13nnn|||См [. сведения о причинах и обработке ошибок в getAccessToken](../develop/troubleshoot-sso-in-office-add-ins.md#causes-and-handling-of-errors-from-getaccesstoken).|

## <a name="binding-creation-error-conditions"></a>Условия ошибок создания привязки

При создании в API привязки укажите тип привязки, который вы хотите использовать. В следующих таблицах перечислены типы привязок и ожидаемое связанное с ними поведение.

### <a name="behavior-in-excel"></a>Поведение в Excel

В таблице ниже описано поведение привязок в Excel.

|**Указанный тип привязки**|**Выделенный фрагмент**|**Поведение**|
|:-----|:-----|:-----|
|Матрица|Диапазон ячеек (в том числе части таблиц и отдельные ячейки)|Для выделенных ячеек `matrix` создается привязка типа. В документе не ожидается каких-либо изменений.|
|Матрица|Текст в ячейке|Привязка типа создается `matrix` во всей ячейке. В документе не ожидается каких-либо изменений.|
|Матрица|Несколько фрагментов или недопустимое выделение (например, пользователь выделяет изображение, объект или Word Art)|Создать привязку невозможно.|
|Таблица|Диапазон ячеек (в том числе отдельные ячейки)|Создать привязку невозможно.|
|Таблица|Диапазон ячеек в таблице (в том числе, отдельные ячейки таблицы, вся таблица или текст внутри ячейки таблицы)|Привязка создается для всей таблицы.|
|Таблица|Частичное выделение в таблице и за ее пределами|Создать привязку невозможно.|
|Таблица|Текст в ячейке (не в таблице)|Создать привязку невозможно.|
|Таблица|Несколько фрагментов или недопустимое выделение (например, пользователь выделяет изображение, объект, Word Art и т. д.)|Создать привязку невозможно.|
|Текст|Диапазон ячеек|Создать привязку невозможно.|
|Текст|Диапазон ячеек в таблице|Создать привязку невозможно.|
|Текст|Одна ячейка|Создается привязка `text` типа.|
|Текст|Одна ячейка в таблице|Создается привязка `text` типа.|
|Текст|Текст в ячейке|Создается привязка типа `text` во всей ячейке.|

### <a name="behavior-in-word"></a>Поведение в Word

В таблице ниже описано поведение привязок в Word.

|**Указанный тип привязки**|**Выделенный фрагмент**|**Поведение**|
|:-----|:-----|:-----|
|Матрица|Текст|Создать привязку невозможно.|
|Матрица|Вся таблица|Создается привязка `matrix` типа. Документ изменен, и элемент управления содержимым должен обтекать таблицу. |
|Матрица|Диапазон в таблице|Создать привязку невозможно.|
|Матрица|Недопустимое выделение (например, несколько объектов, недопустимые объекты и т. д.)|Создать привязку невозможно.|
|Таблица|Текст|Создать привязку невозможно.|
|Таблица|Вся таблица|Создается привязка `text` типа.|
|Таблица|Диапазон в таблице|Создать привязку невозможно.|
|Таблица|Недопустимое выделение (например, несколько объектов, недопустимые объекты и т. д.)|Создать привязку невозможно.|
|Текст|Вся таблица|Создается привязка `text` типа.|
|Текст|Диапазон в таблице|Создать привязку невозможно.|
|Текст|Несколько фрагментов|Для последнего выделенного фрагмента создается оболочка из элемента управления содержимым и привязки к нему. Создается элемент управления содержимым `text` типа.|
|Текст|Недопустимое выделение (например, несколько объектов, недопустимые объекты и т. д.)|Создать привязку невозможно.|

## <a name="see-also"></a>См. также

- [Жизненный цикл разработки надстроек Office](../overview/office-add-ins.md)
- [Общие сведения об API JavaScript для Office](../develop/understanding-the-javascript-api-for-office.md)
- [Обработка ошибок с помощью API JavaScript для конкретного приложения](../testing/application-specific-api-error-handling.md)
- [Устранение ошибок единого входа](../develop/troubleshoot-sso-in-office-add-ins.md)
- [Устранение ошибок разработки в надстройках Office](../testing/troubleshoot-development-errors.md)
