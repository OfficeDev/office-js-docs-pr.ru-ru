---
title: Наборы обязательных элементов API JavaScript для Excel
description: Сведения о наборе обязательных элементов надстройки Office для сборок Excel.
ms.date: 11/02/2021
ms.prod: excel
ms.localizationpriority: high
ms.openlocfilehash: 8770f91531b74442561d93d76daf57492d4c13f5
ms.sourcegitcommit: a3debae780126e03a1b566efdec4d8be83e405b8
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/03/2021
ms.locfileid: "60683793"
---
# <a name="excel-javascript-api-requirement-sets"></a>Наборы обязательных элементов API JavaScript для Excel

Наборы обязательных элементов — именованные группы элементов API. Надстройки Office с помощью наборов обязательных элементов, указанных в манифесте, или проверки в среде выполнения определяют, поддерживает ли приложение Office необходимые API. Дополнительные сведения см. в статье [Версии Office и наборы обязательных элементов](../../develop/office-versions-and-requirement-sets.md).

## <a name="requirement-set-availability"></a>Доступность набора обязательных элементов

Надстройки Excel работают в нескольких версиях Office: во всех версиях для Windows начиная с Office 2016, Office для iPad, Office для Mac и Office в Интернете. В приведенной ниже таблице перечислены наборы обязательных элементов для Excel, клиентские приложения Office, поддерживающие каждый набор обязательных элементов, а также номера сборок или версий для этих приложений.

> [!NOTE]
> Чтобы использовать API в любом из нумерованных наборов обязательных элементов или `ExcelApiOnline`, следует ссылаться на **рабочую** библиотеку в сети CDN https://appsforoffice.microsoft.com/lib/1/hosted/office.js.
>
> Сведения об использовании API предварительных версий см. в статье [Предварительные версии API JavaScript для Excel](excel-preview-apis.md).

|  Набор обязательных элементов  |  Office для Windows<br>(подключено к подписке на Microsoft 365)  |  Office для iPad<br>(подключено к подписке на Microsoft 365)  |  Office для Mac<br>(подключено к подписке на Microsoft 365)  | Office в Интернете |
|:-----|-----|:-----|:-----|:-----|:-----|
| [Предварительная версия](excel-preview-apis.md)  | Используйте последнюю версию Office, чтобы воспользоваться предварительными версиями API (может потребоваться присоединиться к [программе предварительной оценки Office](https://insider.office.com)). |
| [ExcelApiOnline](excel-api-online-requirement-set.md) | Н/Д | Н/Д | Н/Д | Последние (см. [набор обязательных элементов, стр.](excel-api-online-requirement-set.md)) |
| [ExcelApi 1.14](excel-api-1-14-requirement-set.md) | Версия 2108 (сборка 14326.20508) или более поздней версии | 16.53 или более поздней версии | 16.52 или более поздней версии | Октябрь 2021 г. |
| [ExcelApi 1.13](excel-api-1-13-requirement-set.md) | Версия 2102 (сборка 13801.20738) или более поздняя | 16.50 или более поздняя | 16.50 или более поздняя | Июнь 2021 г. |
| [ExcelApi 1.12](excel-api-1-12-requirement-set.md) | Версия 2008 (сборка 13127.20408) или более поздняя | 16.40 или более поздняя | 16.40 или более поздняя | Сентябрь 2020 г. |
| [ExcelApi 1.11](excel-api-1-11-requirement-set.md) | Версия 2002 (сборка 12527.20470) или более поздняя | 16.35 или более поздняя | 16.33 или более поздняя | Май 2020 г. |
| [ExcelApi 1.10](excel-api-1-10-requirement-set.md) | Версия 1907 (сборка 11929.20306) или более поздняя | 16.0 или более поздняя | 16.30 или более поздняя версия | Октябрь 2019 г. |
| [ExcelApi 1.9](excel-api-1-9-requirement-set.md)  | Версия 1903 (сборка 11425.20204) или более поздняя | 16.0 или более поздняя | 16.24 или более поздняя версия | Май 2019 г. |
| [ExcelApi 1.8](excel-api-1-8-requirement-set.md)  | Версия 1808 (сборка 10730.20102) или более поздняя | 16.0 или более поздняя | 16.17 или более поздняя | Сентябрь 2018 г. |
| [ExcelApi 1.7](excel-api-1-7-requirement-set.md)  | Версия 1801 (сборка 9001.2171) или более поздняя   | 16.0 или более поздняя  | 16.9 или более поздняя  | Апрель 2018 г. |
| [ExcelApi 1.6](excel-api-1-6-requirement-set.md)  | Версия 1704 (сборка 8201.2001) или более поздняя   | 15.0 или более поздняя  | Версия 15.36 или более поздняя | Апрель 2017 г. |
| [ExcelApi 1.5](excel-api-1-5-requirement-set.md)  | Версия 1703 (сборка 8067.2070) или более поздняя   | 15.0 или более поздняя  | Версия 15.36 или более поздняя | Март 2017 г. |
| [ExcelApi 1.4](excel-api-1-4-requirement-set.md)  | Версия 1701 (сборка 7870.2024) или более поздняя   | 15.0 или более поздняя  | Версия 15.36 или более поздняя | Январь 2017 г. |
| [ExcelApi 1.3](excel-api-1-3-requirement-set.md)  | Версия 1608 (сборка 7369.2055) или выше   | 15.0 или более поздняя | 15.27 или более поздняя | Сентябрь 2016 г. |
| [ExcelApi 1.2](excel-api-1-2-requirement-set.md)  | Версия 1601 (сборка 6741.2088) или выше   | 15.0 или более поздняя | 15.22 или более поздняя | Январь 2016 г. |
| [ExcelApi 1.1](excel-api-1-1-requirement-set.md)  | Версия 1509 (сборка 4266.1001) или более поздняя   | 15.0 или более поздняя | 15.20 или более поздняя | Январь 2016 г. |

> [!NOTE]
> Бессрочные версии Office поддерживают следующие наборы обязательных элементов:
>
> - Office 2021 поддерживает ExcelApi 1.14 и более ранние версии.
> - Office 2019 поддерживает ExcelApi 1.8 и более ранние версии.
> - Office 2016 поддерживает только набор обязательных элементов ExcelApi 1.1.

## <a name="office-versions-and-build-numbers"></a>Номера версий и сборок Office

Дополнительные сведения о номерах версий и сборок Office см. в следующих статьях:

[!INCLUDE [Links to get Office versions and how to find Office client version](../../includes/links-get-office-versions-builds.md)]

## <a name="how-to-use-excel-requirement-sets-at-runtime-and-in-the-manifest"></a>Использование наборов обязательных элементов Excel в среде выполнения и в манифесте

> [!NOTE]
> В этом разделе предполагается, что вы знакомы с общими сведениями о наборах обязательных элементов, изложенными в статьях [Версии и наборы обязательных элементов Office](../../develop/office-versions-and-requirement-sets.md) и [Указание приложений и обязательных элементов API Office](../../develop/specify-office-hosts-and-api-requirements.md).

Наборы обязательных элементов — это именованные группы элементов API. Надстройка Office может проверить наличие обязательных элементов или использовать их наборы, указанные в манифесте, чтобы определить, поддерживает ли приложение Office API, необходимые данной надстройке.

### <a name="checking-for-requirement-set-support-at-runtime"></a>Проверка поддержки наборов обязательных элементов в среде выполнения

В следующем примере кода показано, как определить, поддерживает ли приложение Office, в котором запускается надстройка, указанный набор обязательных элементов API.

```js
if (Office.context.requirements.isSetSupported('ExcelApi', '1.3')) {
  // Perform actions.
}
else {
  // Provide alternate flow/logic.
}
```

### <a name="defining-requirement-set-support-in-the-manifest"></a>Определение поддержки наборов обязательных элементов в манифесте

С помощью [элемента Requirements](../manifest/requirements.md) в манифесте надстройки можно указать минимальные наборы требований и/или методы API, необходимые надстройке для активации. Если приложение или платформа Office не поддерживает наборы требований или методы API, указанные в элементе манифеста `Requirements`, надстройка не будет работать в этом приложении или на этой платформе и не будет отображаться в списке надстроек, представленном в разделе **Мои надстройки**. Если для полноценной работы надстройки необходим определенный набор обязательных элементов, но она может быть полезна пользователям даже на тех платформах, которые не поддерживают этот набор, рекомендуем проверить поддержку обязательных элементов в среде выполнения, как описано выше, а не определять поддерживаемые наборы требований в манифесте.

В следующем примере кода показан элемент `Requirements` в манифесте надстройки, где указано, что надстройка должна загружаться во всех клиентских приложениях Office, поддерживающих набор обязательных элементов ExcelApi версии 1.3 или выше.

```xml
<Requirements>
   <Sets DefaultMinVersion="1.3">
      <Set Name="ExcelApi" MinVersion="1.3"/>
   </Sets>
</Requirements>
```

## <a name="see-also"></a>См. также

- [Справочная документация по API JavaScript для Excel](/javascript/api/excel)
- [XML-манифест надстроек Office](../../develop/add-in-manifests.md)
