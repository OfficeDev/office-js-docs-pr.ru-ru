---
title: Наборы обязательных элементов API JavaScript для Excel
description: Сведения о наборе обязательных элементов надстройки Office для сборок Excel.
ms.date: 05/05/2021
ms.prod: excel
localization_priority: Priority
ms.openlocfilehash: 6fb5587b7eb3120a1e4b7db7dc6327bdcadc6691
ms.sourcegitcommit: 132f5082f5bf9500dad0a2eaf89d924c823e575d
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/07/2021
ms.locfileid: "52266091"
---
# <a name="excel-javascript-api-requirement-sets"></a><span data-ttu-id="3c454-103">Наборы обязательных элементов API JavaScript для Excel</span><span class="sxs-lookup"><span data-stu-id="3c454-103">Excel JavaScript API requirement sets</span></span>

<span data-ttu-id="3c454-p101">Наборы обязательных элементов — именованные группы элементов API. Надстройки Office с помощью наборов обязательных элементов, указанных в манифесте, или проверки в среде выполнения определяют, поддерживает ли приложение Office необходимые API. Дополнительные сведения см. в статье [Версии Office и наборы обязательных элементов](../../develop/office-versions-and-requirement-sets.md).</span><span class="sxs-lookup"><span data-stu-id="3c454-p101">Requirement sets are named groups of API members. Office Add-ins use requirement sets specified in the manifest or use a runtime check to determine whether an Office application supports APIs that an add-in needs. For more information, see [Office versions and requirement sets](../../develop/office-versions-and-requirement-sets.md).</span></span>

## <a name="requirement-set-availability"></a><span data-ttu-id="3c454-107">Доступность набора обязательных элементов</span><span class="sxs-lookup"><span data-stu-id="3c454-107">Requirement set availability</span></span>

<span data-ttu-id="3c454-p102">Надстройки Excel работают в нескольких версиях Office: во всех версиях для Windows начиная с Office 2016, Office для iPad, Office для Mac и Office в Интернете. В приведенной ниже таблице перечислены наборы обязательных элементов для Excel, клиентские приложения Office, поддерживающие каждый набор обязательных элементов, а также номера сборок или версий для этих приложений.</span><span class="sxs-lookup"><span data-stu-id="3c454-p102">Excel add-ins run across multiple versions of Office, including Office 2016 or later on Windows, and Office on the web, Mac, and iPad. The following table lists the Excel requirement sets, the Office client applications that support each requirement set, and the build versions or number for those applications.</span></span>

> [!NOTE]
> <span data-ttu-id="3c454-110">Чтобы использовать API в любом из нумерованных наборов обязательных элементов или `ExcelApiOnline`, следует ссылаться на **рабочую** библиотеку в сети CDN https://appsforoffice.microsoft.com/lib/1/hosted/office.js.</span><span class="sxs-lookup"><span data-stu-id="3c454-110">To use APIs in any of the numbered requirement sets or `ExcelApiOnline`, you should reference the **production** library on the CDN: https://appsforoffice.microsoft.com/lib/1/hosted/office.js.</span></span>
>
> <span data-ttu-id="3c454-111">Сведения об использовании API предварительных версий см. в статье [Предварительные версии API JavaScript для Excel](excel-preview-apis.md).</span><span class="sxs-lookup"><span data-stu-id="3c454-111">For information about using preview APIs, see the [Excel JavaScript preview APIs](excel-preview-apis.md) article.</span></span>

|  <span data-ttu-id="3c454-112">Набор обязательных элементов</span><span class="sxs-lookup"><span data-stu-id="3c454-112">Requirement set</span></span>  |  <span data-ttu-id="3c454-113">Office для Windows</span><span class="sxs-lookup"><span data-stu-id="3c454-113">Office on Windows</span></span><br><span data-ttu-id="3c454-114">(подключено к подписке на Microsoft 365)</span><span class="sxs-lookup"><span data-stu-id="3c454-114">(connected to a Microsoft 365 subscription)</span></span>  |  <span data-ttu-id="3c454-115">Office для iPad</span><span class="sxs-lookup"><span data-stu-id="3c454-115">Office on iPad</span></span><br><span data-ttu-id="3c454-116">(подключено к подписке на Microsoft 365)</span><span class="sxs-lookup"><span data-stu-id="3c454-116">(connected to a Microsoft 365 subscription)</span></span>  |  <span data-ttu-id="3c454-117">Office для Mac</span><span class="sxs-lookup"><span data-stu-id="3c454-117">Office on Mac</span></span><br><span data-ttu-id="3c454-118">(подключено к подписке на Microsoft 365)</span><span class="sxs-lookup"><span data-stu-id="3c454-118">(connected to a Microsoft 365 subscription)</span></span>  | <span data-ttu-id="3c454-119">Office в Интернете</span><span class="sxs-lookup"><span data-stu-id="3c454-119">Office on the web</span></span> |
|:-----|-----|:-----|:-----|:-----|:-----|
| [<span data-ttu-id="3c454-120">Предварительная версия</span><span class="sxs-lookup"><span data-stu-id="3c454-120">Preview</span></span>](excel-preview-apis.md)  | <span data-ttu-id="3c454-121">Используйте последнюю версию Office, чтобы воспользоваться предварительными версиями API (может потребоваться присоединиться к [программе предварительной оценки Office](https://insider.office.com)).</span><span class="sxs-lookup"><span data-stu-id="3c454-121">Please use the latest Office version to try preview APIs (you may need to join the [Office Insider program](https://insider.office.com)).</span></span> |
| [<span data-ttu-id="3c454-122">ExcelApiOnline</span><span class="sxs-lookup"><span data-stu-id="3c454-122">ExcelApiOnline</span></span>](excel-api-online-requirement-set.md) | <span data-ttu-id="3c454-123">Н/Д</span><span class="sxs-lookup"><span data-stu-id="3c454-123">N/A</span></span> | <span data-ttu-id="3c454-124">Н/Д</span><span class="sxs-lookup"><span data-stu-id="3c454-124">N/A</span></span> | <span data-ttu-id="3c454-125">Н/Д</span><span class="sxs-lookup"><span data-stu-id="3c454-125">N/A</span></span> | <span data-ttu-id="3c454-126">Последние (см. [набор обязательных элементов, стр.](excel-api-online-requirement-set.md))</span><span class="sxs-lookup"><span data-stu-id="3c454-126">Latest (see [requirement set page](excel-api-online-requirement-set.md))</span></span> |
| [<span data-ttu-id="3c454-127">ExcelApi 1.12</span><span class="sxs-lookup"><span data-stu-id="3c454-127">ExcelApi 1.12</span></span>](excel-api-1-12-requirement-set.md) | <span data-ttu-id="3c454-128">Версия 2008 (сборка 13127.20408) или более поздняя</span><span class="sxs-lookup"><span data-stu-id="3c454-128">Version 2008 (Build 13127.20408) or later</span></span> | <span data-ttu-id="3c454-129">16.40 или более поздняя</span><span class="sxs-lookup"><span data-stu-id="3c454-129">16.40 or later</span></span> | <span data-ttu-id="3c454-130">16.40 или более поздняя</span><span class="sxs-lookup"><span data-stu-id="3c454-130">16.40 or later</span></span> | <span data-ttu-id="3c454-131">Сентябрь 2020 г.</span><span class="sxs-lookup"><span data-stu-id="3c454-131">September 2020</span></span> |
| [<span data-ttu-id="3c454-132">ExcelApi 1.11</span><span class="sxs-lookup"><span data-stu-id="3c454-132">ExcelApi 1.11</span></span>](excel-api-1-11-requirement-set.md) | <span data-ttu-id="3c454-133">Версия 2002 (сборка 12527.20470) или более поздняя</span><span class="sxs-lookup"><span data-stu-id="3c454-133">Version 2002 (Build 12527.20470) or later</span></span> | <span data-ttu-id="3c454-134">16.35 или более поздняя</span><span class="sxs-lookup"><span data-stu-id="3c454-134">16.35 or later</span></span> | <span data-ttu-id="3c454-135">16.33 или более поздняя</span><span class="sxs-lookup"><span data-stu-id="3c454-135">16.33 or later</span></span> | <span data-ttu-id="3c454-136">Май 2020 г.</span><span class="sxs-lookup"><span data-stu-id="3c454-136">May 2020</span></span> |
| [<span data-ttu-id="3c454-137">ExcelApi 1.10</span><span class="sxs-lookup"><span data-stu-id="3c454-137">ExcelApi 1.10</span></span>](excel-api-1-10-requirement-set.md) | <span data-ttu-id="3c454-138">Версия 1907 (сборка 11929.20306) или более поздняя</span><span class="sxs-lookup"><span data-stu-id="3c454-138">Version 1907 (Build 11929.20306) or later</span></span> | <span data-ttu-id="3c454-139">16.0 или более поздняя</span><span class="sxs-lookup"><span data-stu-id="3c454-139">16.0 or later</span></span> | <span data-ttu-id="3c454-140">16.30 или более поздняя версия</span><span class="sxs-lookup"><span data-stu-id="3c454-140">16.30 or later</span></span> | <span data-ttu-id="3c454-141">Октябрь 2019 г.</span><span class="sxs-lookup"><span data-stu-id="3c454-141">October 2019</span></span> |
| [<span data-ttu-id="3c454-142">ExcelApi 1.9</span><span class="sxs-lookup"><span data-stu-id="3c454-142">ExcelApi 1.9</span></span>](excel-api-1-9-requirement-set.md)  | <span data-ttu-id="3c454-143">Версия 1903 (сборка 11425.20204) или более поздняя</span><span class="sxs-lookup"><span data-stu-id="3c454-143">Version 1903 (Build 11425.20204) or later</span></span> | <span data-ttu-id="3c454-144">16.0 или более поздняя</span><span class="sxs-lookup"><span data-stu-id="3c454-144">16.0 or later</span></span> | <span data-ttu-id="3c454-145">16.24 или более поздняя версия</span><span class="sxs-lookup"><span data-stu-id="3c454-145">16.24 or later</span></span> | <span data-ttu-id="3c454-146">Май 2019 г.</span><span class="sxs-lookup"><span data-stu-id="3c454-146">May 2019</span></span> |
| [<span data-ttu-id="3c454-147">ExcelApi 1.8</span><span class="sxs-lookup"><span data-stu-id="3c454-147">ExcelApi 1.8</span></span>](excel-api-1-8-requirement-set.md)  | <span data-ttu-id="3c454-148">Версия 1808 (сборка 10730.20102) или более поздняя</span><span class="sxs-lookup"><span data-stu-id="3c454-148">Version 1808 (Build 10730.20102) or later</span></span> | <span data-ttu-id="3c454-149">16.0 или более поздняя</span><span class="sxs-lookup"><span data-stu-id="3c454-149">16.0 or later</span></span> | <span data-ttu-id="3c454-150">16.17 или более поздняя</span><span class="sxs-lookup"><span data-stu-id="3c454-150">16.17 or later</span></span> | <span data-ttu-id="3c454-151">Сентябрь 2018 г.</span><span class="sxs-lookup"><span data-stu-id="3c454-151">September 2018</span></span> |
| [<span data-ttu-id="3c454-152">ExcelApi 1.7</span><span class="sxs-lookup"><span data-stu-id="3c454-152">ExcelApi 1.7</span></span>](excel-api-1-7-requirement-set.md)  | <span data-ttu-id="3c454-153">Версия 1801 (сборка 9001.2171) или более поздняя</span><span class="sxs-lookup"><span data-stu-id="3c454-153">Version 1801 (Build 9001.2171) or later</span></span>   | <span data-ttu-id="3c454-154">16.0 или более поздняя</span><span class="sxs-lookup"><span data-stu-id="3c454-154">16.0 or later</span></span>  | <span data-ttu-id="3c454-155">16.9 или более поздняя</span><span class="sxs-lookup"><span data-stu-id="3c454-155">16.9 or later</span></span>  | <span data-ttu-id="3c454-156">Апрель 2018 г.</span><span class="sxs-lookup"><span data-stu-id="3c454-156">April 2018</span></span> |
| [<span data-ttu-id="3c454-157">ExcelApi 1.6</span><span class="sxs-lookup"><span data-stu-id="3c454-157">ExcelApi 1.6</span></span>](excel-api-1-6-requirement-set.md)  | <span data-ttu-id="3c454-158">Версия 1704 (сборка 8201.2001) или более поздняя</span><span class="sxs-lookup"><span data-stu-id="3c454-158">Version 1704 (Build 8201.2001) or later</span></span>   | <span data-ttu-id="3c454-159">15.0 или более поздняя</span><span class="sxs-lookup"><span data-stu-id="3c454-159">15.0 or later</span></span>  | <span data-ttu-id="3c454-160">Версия 15.36 или более поздняя</span><span class="sxs-lookup"><span data-stu-id="3c454-160">15.36 or later</span></span> | <span data-ttu-id="3c454-161">Апрель 2017 г.</span><span class="sxs-lookup"><span data-stu-id="3c454-161">April 2017</span></span> |
| [<span data-ttu-id="3c454-162">ExcelApi 1.5</span><span class="sxs-lookup"><span data-stu-id="3c454-162">ExcelApi 1.5</span></span>](excel-api-1-5-requirement-set.md)  | <span data-ttu-id="3c454-163">Версия 1703 (сборка 8067.2070) или более поздняя</span><span class="sxs-lookup"><span data-stu-id="3c454-163">Version 1703 (Build 8067.2070) or later</span></span>   | <span data-ttu-id="3c454-164">15.0 или более поздняя</span><span class="sxs-lookup"><span data-stu-id="3c454-164">15.0 or later</span></span>  | <span data-ttu-id="3c454-165">Версия 15.36 или более поздняя</span><span class="sxs-lookup"><span data-stu-id="3c454-165">15.36 or later</span></span> | <span data-ttu-id="3c454-166">Март 2017 г.</span><span class="sxs-lookup"><span data-stu-id="3c454-166">March 2017</span></span> |
| [<span data-ttu-id="3c454-167">ExcelApi 1.4</span><span class="sxs-lookup"><span data-stu-id="3c454-167">ExcelApi 1.4</span></span>](excel-api-1-4-requirement-set.md)  | <span data-ttu-id="3c454-168">Версия 1701 (сборка 7870.2024) или более поздняя</span><span class="sxs-lookup"><span data-stu-id="3c454-168">Version 1701 (Build 7870.2024) or later</span></span>   | <span data-ttu-id="3c454-169">15.0 или более поздняя</span><span class="sxs-lookup"><span data-stu-id="3c454-169">15.0 or later</span></span>  | <span data-ttu-id="3c454-170">Версия 15.36 или более поздняя</span><span class="sxs-lookup"><span data-stu-id="3c454-170">15.36 or later</span></span> | <span data-ttu-id="3c454-171">Январь 2017 г.</span><span class="sxs-lookup"><span data-stu-id="3c454-171">January 2017</span></span> |
| [<span data-ttu-id="3c454-172">ExcelApi 1.3</span><span class="sxs-lookup"><span data-stu-id="3c454-172">ExcelApi 1.3</span></span>](excel-api-1-3-requirement-set.md)  | <span data-ttu-id="3c454-173">Версия 1608 (сборка 7369.2055) или выше</span><span class="sxs-lookup"><span data-stu-id="3c454-173">Version 1608 (Build 7369.2055) or later</span></span>   | <span data-ttu-id="3c454-174">15.0 или более поздняя</span><span class="sxs-lookup"><span data-stu-id="3c454-174">15.0 or later</span></span> | <span data-ttu-id="3c454-175">15.27 или более поздняя</span><span class="sxs-lookup"><span data-stu-id="3c454-175">15.27 or later</span></span> | <span data-ttu-id="3c454-176">Сентябрь 2016 г.</span><span class="sxs-lookup"><span data-stu-id="3c454-176">September 2016</span></span> |
| [<span data-ttu-id="3c454-177">ExcelApi 1.2</span><span class="sxs-lookup"><span data-stu-id="3c454-177">ExcelApi 1.2</span></span>](excel-api-1-2-requirement-set.md)  | <span data-ttu-id="3c454-178">Версия 1601 (сборка 6741.2088) или выше</span><span class="sxs-lookup"><span data-stu-id="3c454-178">Version 1601 (Build 6741.2088) or later</span></span>   | <span data-ttu-id="3c454-179">15.0 или более поздняя</span><span class="sxs-lookup"><span data-stu-id="3c454-179">15.0 or later</span></span> | <span data-ttu-id="3c454-180">15.22 или более поздняя</span><span class="sxs-lookup"><span data-stu-id="3c454-180">15.22 or later</span></span> | <span data-ttu-id="3c454-181">Январь 2016 г.</span><span class="sxs-lookup"><span data-stu-id="3c454-181">January 2016</span></span> |
| [<span data-ttu-id="3c454-182">ExcelApi 1.1</span><span class="sxs-lookup"><span data-stu-id="3c454-182">ExcelApi 1.1</span></span>](excel-api-1-1-requirement-set.md)  | <span data-ttu-id="3c454-183">Версия 1509 (сборка 4266.1001) или более поздняя</span><span class="sxs-lookup"><span data-stu-id="3c454-183">Version 1509 (Build 4266.1001) or later</span></span>   | <span data-ttu-id="3c454-184">15.0 или более поздняя</span><span class="sxs-lookup"><span data-stu-id="3c454-184">15.0 or later</span></span> | <span data-ttu-id="3c454-185">15.20 или более поздняя</span><span class="sxs-lookup"><span data-stu-id="3c454-185">15.20 or later</span></span> | <span data-ttu-id="3c454-186">Январь 2016 г.</span><span class="sxs-lookup"><span data-stu-id="3c454-186">January 2016</span></span> |

> [!NOTE]
> <span data-ttu-id="3c454-187">Бессрочные версии Office поддерживают следующие наборы обязательных элементов:</span><span class="sxs-lookup"><span data-stu-id="3c454-187">Non-subscription versions of Office support requirement sets as follows:</span></span>
>
> - <span data-ttu-id="3c454-188">Office 2019 поддерживает ExcelApi 1.8 и более ранние версии.</span><span class="sxs-lookup"><span data-stu-id="3c454-188">Office 2019 supports ExcelApi 1.8 and earlier.</span></span>
> - <span data-ttu-id="3c454-189">Office 2016 поддерживает только набор обязательных элементов ExcelApi 1.1.</span><span class="sxs-lookup"><span data-stu-id="3c454-189">Office 2016 only supports the ExcelApi 1.1 requirement set.</span></span>

## <a name="office-versions-and-build-numbers"></a><span data-ttu-id="3c454-190">Номера версий и сборок Office</span><span class="sxs-lookup"><span data-stu-id="3c454-190">Office versions and build numbers</span></span>

<span data-ttu-id="3c454-191">Дополнительные сведения о номерах версий и сборок Office см. в следующих статьях:</span><span class="sxs-lookup"><span data-stu-id="3c454-191">For more information about Office versions and build numbers, see:</span></span>

[!INCLUDE [Links to get Office versions and how to find Office client version](../../includes/links-get-office-versions-builds.md)]

## <a name="how-to-use-excel-requirement-sets-at-runtime-and-in-the-manifest"></a><span data-ttu-id="3c454-192">Использование наборов обязательных элементов Excel в среде выполнения и в манифесте</span><span class="sxs-lookup"><span data-stu-id="3c454-192">How to use Excel requirement sets at runtime and in the manifest</span></span>

> [!NOTE]
> <span data-ttu-id="3c454-193">В этом разделе предполагается, что вы знакомы с общими сведениями о наборах обязательных элементов, изложенными в статьях [Версии и наборы обязательных элементов Office](../../develop/office-versions-and-requirement-sets.md) и [Указание приложений и обязательных элементов API Office](../../develop/specify-office-hosts-and-api-requirements.md).</span><span class="sxs-lookup"><span data-stu-id="3c454-193">This section assumes you're familiar with the overview of requirement sets at [Office versions and requirement sets](../../develop/office-versions-and-requirement-sets.md) and [Specify Office applications and API requirements](../../develop/specify-office-hosts-and-api-requirements.md).</span></span>

<span data-ttu-id="3c454-p103">Наборы обязательных элементов — это именованные группы элементов API. Надстройка Office может проверить наличие обязательных элементов или использовать их наборы, указанные в манифесте, чтобы определить, поддерживает ли приложение Office API, необходимые данной надстройке.</span><span class="sxs-lookup"><span data-stu-id="3c454-p103">Requirement sets are named groups of API members. An Office Add-in can perform a runtime check or use requirement sets specified in the manifest to determine whether an Office application supports the APIs that the add-in needs.</span></span>

### <a name="checking-for-requirement-set-support-at-runtime"></a><span data-ttu-id="3c454-196">Проверка поддержки наборов обязательных элементов в среде выполнения</span><span class="sxs-lookup"><span data-stu-id="3c454-196">Checking for requirement set support at runtime</span></span>

<span data-ttu-id="3c454-197">В следующем примере кода показано, как определить, поддерживает ли приложение Office, в котором запускается надстройка, указанный набор обязательных элементов API.</span><span class="sxs-lookup"><span data-stu-id="3c454-197">The following code sample shows how to determine whether the Office application where the add-in is running supports the specified API requirement set.</span></span>

```js
if (Office.context.requirements.isSetSupported('ExcelApi', '1.3')) {
  // Perform actions.
}
else {
  // Provide alternate flow/logic.
}
```

### <a name="defining-requirement-set-support-in-the-manifest"></a><span data-ttu-id="3c454-198">Определение поддержки наборов обязательных элементов в манифесте</span><span class="sxs-lookup"><span data-stu-id="3c454-198">Defining requirement set support in the manifest</span></span>

<span data-ttu-id="3c454-199">С помощью [элемента Requirements](../manifest/requirements.md) в манифесте надстройки можно указать минимальные наборы обязательных элементов и/или методы API, необходимые надстройке для активации.</span><span class="sxs-lookup"><span data-stu-id="3c454-199">You can use the [Requirements element](../manifest/requirements.md) in the add-in manifest to specify the minimal requirement sets and/or API methods that your add-in requires to activate.</span></span> <span data-ttu-id="3c454-200">Если приложение или платформа Office не поддерживает наборы обязательных элементов или методы API, указанные в элементе манифеста `Requirements`, надстройка не будет работать в этом приложении или на этой платформе и не будет отображать список надстроек, показанный в разделе **Мои надстройки**. Если вашей надстройке для полной функциональности необходим определенный набор обязательных элементов, но она может быть полезна пользователям даже на тех платформах, которые не поддерживают этот набор, мы рекомендуем проверить поддержку обязательных элементов в среде выполнения как описано выше, а не прописывать поддержку набора обязательных элементов в манифесте.</span><span class="sxs-lookup"><span data-stu-id="3c454-200">If the Office application or platform doesn't support the requirement sets or API methods that are specified in the `Requirements` element of the manifest, the add-in won't run in that application or platform, and it won't display in the list of add-ins that are shown in **My Add-ins**. If your add-in requires a specific requirement set for full functionality, but it can provide value even to users on platforms that do not support the requirement set, we recommend that you check for requirement support at runtime as described above, instead of defining requirement set support in the manifest.</span></span>

<span data-ttu-id="3c454-201">В следующем примере кода показан элемент `Requirements` в манифесте надстройки, где указано, что надстройка должна загружаться во всех клиентских приложениях Office, поддерживающих набор обязательных элементов ExcelApi версии 1.3 или выше.</span><span class="sxs-lookup"><span data-stu-id="3c454-201">The following code sample shows the `Requirements` element in an add-in manifest which specifies that the add-in should load in all Office client applications that support ExcelApi requirement set version 1.3 or greater.</span></span>

```xml
<Requirements>
   <Sets DefaultMinVersion="1.3">
      <Set Name="ExcelApi" MinVersion="1.3"/>
   </Sets>
</Requirements>
```

## <a name="see-also"></a><span data-ttu-id="3c454-202">См. также</span><span class="sxs-lookup"><span data-stu-id="3c454-202">See also</span></span>

- [<span data-ttu-id="3c454-203">Справочная документация по API JavaScript для Excel</span><span class="sxs-lookup"><span data-stu-id="3c454-203">Excel JavaScript API Reference Documentation</span></span>](/javascript/api/excel)
- [<span data-ttu-id="3c454-204">XML-манифест надстроек Office</span><span class="sxs-lookup"><span data-stu-id="3c454-204">Office Add-ins XML manifest</span></span>](../../develop/add-in-manifests.md)
