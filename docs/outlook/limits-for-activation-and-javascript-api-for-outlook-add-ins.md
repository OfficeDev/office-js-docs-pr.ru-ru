---
title: Ограничения на активацию и использование API в надстройках Outlook
description: Обратите внимание на определенные правила активации и использования API и учитывайте эти ограничения при реализации своих надстроек.
ms.date: 08/30/2022
ms.localizationpriority: medium
ms.openlocfilehash: b09886e49b0d980dbbf2465df7d077cd16a04f4d
ms.sourcegitcommit: 889d23061a9413deebf9092d675655f13704c727
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/07/2022
ms.locfileid: "67616016"
---
# <a name="limits-for-activation-and-javascript-api-for-outlook-add-ins"></a>Ограничения на активацию и API JavaScript для надстроек Outlook

Чтобы предоставить пользователям удобные возможности работы в надстройках Outlook, следует помнить об определенных рекомендациях по активации и использованию интерфейса API и разрабатывать надстройки в соответствии с ними. Эти рекомендации существуют таким образом, что отдельной надстройке не может потребоваться Exchange Server или Outlook на обработку правил активации или вызовов API JavaScript для Office, что влияет на общий пользовательский интерфейс Outlook и других надстроек. Эти ограничения применяются к разработке правил активации в манифесте надстройки и использованию настраиваемых свойств, параметров перемещения, получателей, запросов и ответов веб-служб Exchange (EWS), а также асинхронных вызовов.

> [!NOTE]
> Если надстройка работает в полнофункциональных клиентах Outlook, необходимо также убедиться, что надстройка работает в рамках определенных ограничений использования ресурсов среды выполнения.

## <a name="limits-on-where-add-ins-activate"></a>Где активируются надстройки

Дополнительные сведения о том, где надстройки поддерживают и не активируются, см. [](outlook-add-ins-overview.md#mailbox-items-available-to-add-ins) в разделе "Почтовые ящики", доступном для надстроек, на странице обзора надстроек Outlook.

## <a name="limits-for-activation-rules"></a>Ограничения для правил активации

При разработке правил активации надстроек Outlook придерживайтесь следующих рекомендаций.

- Размер манифеста не должен превышать 256 КБ. Вы не можете установить надстройку Outlook для почтового ящика Exchange, если превышено это ограничение.

- Задавайте не более 15 правил активации для надстройки. Вы не сможете установить надстройку, если превысите это ограничение.

- Если правило [ItemHasKnownEntity](/javascript/api/manifest/rule#itemhasknownentity-rule) применяется к тексту сообщения выбранного элемента, следует ожидать, что полнофункциональный клиент Outlook будет применять его только к первому мегабайту текста сообщения, а не ко всему тексту, если его объем превышает это ограничение. Ваша надстройка не активируется, если совпадения существуют только после первого МБ текста. Если вы считаете такой сценарий вероятным, измените условия активации.

- `ItemHasKnownEntity` При использовании регулярных выражений в правилах [ItemHasRegularExpressionMatch](/javascript/api/manifest/rule#itemhasregularexpressionmatch-rule) следует учитывать следующие ограничения и рекомендации, которые обычно применяются к любому приложению Outlook, и те, которые описаны в таблицах 1, 2 и 3, которые отличаются в зависимости от приложения.
  - Укажите до пяти регулярных выражений в правилах активации в надстройке. Невозможно установить надстройку, если превышено это ограничение.
  - Укажите регулярные выражения таким образом `getRegExMatches` , чтобы результаты, которые вы ожидаете, возвращались вызовом метода в течение первых 50 совпадений.
  - **Важно**! Текст выделяется на основе строк, полученных в результате сопоставления регулярного выражения. Однако выделенные вхождения могут не совпадать с тем, что должно быть результатом фактических утверждений регулярных выражений, `(?!text)`таких как отрицательный просмотр вперед, `(?<=text)`поиск программной части и отрицательный поиск программной части `(?<!text)`. Например, если `under(?!score)` используется регулярное выражение "Like under, under, under score, and underscore", строка "under" выделяется для всех вхождений, а не только для первых двух.

В таблице 1 перечислены ограничения и описаны различия в поддержке регулярных выражений между полнофункционалированным клиентом Outlook и Outlook в Интернете или мобильными устройствами. Поддержка не зависит от типа устройства и основного текста элемента.

**Таблица 1. Основные различия в поддержке регулярных выражений**

|Полнофункциональный клиент Outlook|Outlook в Интернете или на мобильных устройствах|
|:-----|:-----|
|Использует обработчик регулярных выражений C++, который предоставляется как часть библиотеки стандартных шаблонов Visual Studio. Этот обработчик выполняет компиляцию в соответствии со стандартами ECMAScript 5. |Использует оценку регулярных выражений, которая является частью JavaScript, предоставляется браузером и поддерживает расширенный набор стандартов ECMAScript 5.|
|Из-за различных обработчика регулярных выражений ожидается регулярное выражение, включающее пользовательский класс символов, основанный на предопределенных классах символов, для возврата различных результатов в полнофункциональный клиент Outlook, чем на Outlook в Интернете или мобильных устройствах.<br/><br/>Например, `[\s\S]{0,100}` регулярное выражение соответствует любому числу (от 0 до 100) одного символа, которое является пробелом или не пробелом. Это регулярное выражение возвращает разные результаты в полнофункциональных клиентах Outlook, Outlook в Интернете и мобильных устройствах.<br/><br/>Регулярное выражение следует переписать `(\s\|\S){0,100}` в качестве обходного решения. Такое регулярное выражение соответствует любому количеству символов (от 0 до 100), включая пробелы.<br/><br/>Необходимо тщательно протестировать каждое регулярное выражение на каждом клиенте Outlook, и если регулярное выражение возвращает разные результаты, перепишите регулярное выражение. |Необходимо тщательно протестировать каждое регулярное выражение на каждом клиенте Outlook, и если регулярное выражение возвращает разные результаты, перепишите регулярное выражение.|
|По умолчанию продолжительность оценки всех регулярных выражений для надстройки ограничивается 1 секундой. При превышении этого ограничения выполняется повторная оценка до 3 раз. За пределами ограничения повторной оценки полнофункциональный клиент Outlook отключает запуск надстройки для одного почтового ящика на любом из клиентов Outlook.<br/><br/>Администраторы могут переопределить эти ограничения оценки с помощью разделов `OutlookActivationAlertThreshold` реестра `OutlookActivationManagerRetryLimit` и разделов реестра.|Не поддерживаются те же параметры мониторинга ресурсов или реестра, что и в полнофункциональных клиентах Outlook. Однако надстройки с регулярными выражениями, для которых требуется слишком много времени на оценку в полнофункциональных клиентах Outlook, отключены для одного и того же почтового ящика на всех клиентах Outlook.|

В таблице 2 перечислены ограничения и описаны различия частей основного текста элемента, к которым каждое приложение Outlook применяет регулярные выражения. Некоторые из этих ограничений зависят от типа устройства и основного текста элемента, если регулярное выражение применяется к основному тексту элемента.

**Таблица 2. Ограничения на размер оцениваемого содержания элемента**

||Полнофункциональный клиент Outlook|Outlook на мобильных устройствах|Outlook в Интернете|
|:-----|:-----|:-----|:-----|
|**Форм-фактор**|Любое поддерживаемое устройство.|Смартфоны Android, iPad или iPhone.|Любое поддерживаемое устройство, кроме смартфонов Android, iPad и iPhone.|
|**Основной текст элемента в виде обычного текста**|Регулярное выражение применяется к первому мегабайту данных в основном тексте. К остальной части основного текста свыше этого ограничения регулярное выражение не применяется.|Надстройка активируется, только если основной текст сообщения содержит < 16 000 символов.|Надстройка активируется, только если основной текст сообщения содержит < 500 000 символов.|
|**Основной текст элемента в формате HTML**|Регулярное выражение применяется к первым 512 КБ данных в основном тексте. К остальной части основного текста свыше этого ограничения регулярное выражение не применяется. (Фактическое количество знаков зависит от кодировки, в которой может использоваться от 1 до 4 байтов на каждый знак.)|Регулярное выражение применяется к первым 64 000 знаков (включая знаки HTML-тегов). К остальной части основного текста свыше этого ограничения регулярное выражение не применяется.|Надстройка активируется, только если основной текст сообщения содержит < 500 000 символов.|

В таблице 3 перечислены ограничения и описаны различия в совпадениях, возвращаемых каждым клиентом Outlook после вычисления регулярного выражения. Поддержка не зависит от конкретного типа устройства, но может зависеть от типа основного текста элемента, если регулярное выражение применяется к основному тексту элемента.

**Таблица 3. Ограничения на возвращаемые соответствия**

||Полнофункциональный клиент Outlook|Outlook в Интернете или на мобильных устройствах|
|:-----|:-----|:-----|
|**Порядок возвращаемых соответствий**|Предположим`getRegExMatches`, что возвращаемые совпадения для того же регулярного выражения, применяемого к одному элементу, отличаются в полнофункциональных клиентах Outlook, чем на Outlook в Интернете или мобильных устройствах.|Предположим`getRegExMatches`, что в полнофункциональных клиентах Outlook совпадения возвращаются в Outlook в Интернете или мобильных устройствах.|
|**Основной текст элемента в виде обычного текста**|`getRegExMatches` возвращает все совпадения размером до 1536 символов (1,5 КБ) для максимум 50 совпадений.<br/><br/>**Примечание**. `getRegExMatches` Не возвращает совпадения в определенном порядке в возвращаемом массиве. Как правило, предполагается, что порядок совпадений в полнофункциональных клиентах Outlook для того же регулярного выражения, применяемого к одному элементу, отличается от порядка совпадений в Outlook в Интернете и мобильных устройствах.|`getRegExMatches` возвращает все совпадения размером до 3072 символов (3 КБ) для максимум 50 совпадений.|
|**Основной текст элемента в формате HTML**|`getRegExMatches` возвращает все совпадения размером до 3072 символов (3 КБ) для максимум 50 совпадений.<br/> <br/> **Примечание**. `getRegExMatches` Не возвращает совпадения в определенном порядке в возвращаемом массиве. Как правило, предполагается, что порядок совпадений в полнофункциональных клиентах Outlook для того же регулярного выражения, применяемого к одному элементу, отличается от порядка совпадений в Outlook в Интернете и мобильных устройствах.|`getRegExMatches` возвращает все совпадения размером до 3072 символов (3 КБ) для максимум 50 совпадений.|

## <a name="limits-for-javascript-api"></a>Ограничения для API JavaScript

Помимо приведенных выше рекомендаций по правилам активации, каждый клиент Outlook применяет определенные ограничения в объектной модели JavaScript, как описано в таблице 4.

**Таблица 4. Ограничения на получение или настройку определенных данных с помощью API JavaScript для Office**

|Функция|Ограничение|Связанный API|Описание|
|:-----|:-----|:-----|:-----|
|Настраиваемые свойства|2500 символов|Объект [CustomProperties](/javascript/api/outlook/office.customproperties)<br/> <br/>Метод [item.loadCustomPropertiesAsync](/javascript/api/requirement-sets/outlook/preview-requirement-set/office.context.mailbox.item#methods)|Ограничение для всех настраиваемых свойств элемента встречи или сообщения. Все клиенты Outlook возвращают ошибку, если общий размер всех настраиваемых свойств надстройки превышает это ограничение.|
|Параметры перемещения|32 КБ символов|Объект [RoamingSettings](/javascript/api/outlook/office.roamingsettings)<br/><br/> Свойство [context.roamingSettings](/javascript/api/requirement-sets/outlook/preview-requirement-set/office.context#properties)|Ограничение для всех параметров перемещения надстройки. Все клиенты Outlook возвращают ошибку, если параметры превышают это ограничение.|
|Заголовки Интернета|256 КБ на сообщение в Exchange Online<br/><br/>Ограничение размера заголовка, определяемого администраторами организации в локальной среде Exchange|[Метод InternetHeaders.setAsync](/javascript/api/outlook/office.internetheaders)|Ограничение общего размера заголовков, которые могут применяться к сообщению.|
|Извлечение известных сущностей|2000 символов|Метод [item.getEntities](/javascript/api/requirement-sets/outlook/preview-requirement-set/office.context.mailbox.item#methods)<br/> <br/>Метод [item.getEntitiesByType](/javascript/api/requirement-sets/outlook/preview-requirement-set/office.context.mailbox.item#methods)<br/> <br/>Метод [item.getFilteredEntitiesByName](/javascript/api/requirement-sets/outlook/preview-requirement-set/office.context.mailbox.item#methods)|Ограничение для Exchange Server для извлечения известных сущностей в основном тексте элемента. Exchange Server игнорирует сущности сверх этого предела. Обратите внимание, что это ограничение не зависит от `ItemHasKnownEntity` того, использует ли надстройка правило.|
|Веб-службы Exchange|1 МБ символов|Метод [mailbox.makeEwsRequestAsync](/javascript/api/requirement-sets/outlook/preview-requirement-set/office.context.mailbox#methods)|Ограничение для запроса или ответа на `Mailbox.makeEwsRequestAsync` вызов.|
|Получатели|100 получателей|Свойство [item.requiredAttendees](/javascript/api/requirement-sets/outlook/preview-requirement-set/office.context.mailbox.item#properties)<br/> <br/>Свойство [item.optionalAttendees](/javascript/api/requirement-sets/outlook/preview-requirement-set/office.context.mailbox.item#properties)<br/> <br/>Свойство [item.to](/javascript/api/requirement-sets/outlook/preview-requirement-set/office.context.mailbox.item#properties)<br/> <br/>Свойство [item.cc](/javascript/api/requirement-sets/outlook/preview-requirement-set/office.context.mailbox.item#properties)<br/> <br/>Метод [Recipients.addAsync](/javascript/api/outlook/office.recipients#outlook-office-recipients-addasync-member(1))<br/> <br/>Метод [Recipient.getAsync](/javascript/api/outlook/office.recipients#outlook-office-recipients-getasync-member(1))<br/> <br/>Метод [Recipient.setAsync](/javascript/api/outlook/office.recipients#outlook-office-recipients-setasync-member(1))|Ограничение для получателей, указанных в каждом свойстве.|
|Отображаемое имя|255 символов|Свойство [EmailAddressDetails.displayName](/javascript/api/outlook/office.emailaddressdetails#outlook-office-emailaddressdetails-displayname-member)<br/><br/> Объект [Recipients](/javascript/api/outlook/office.recipients)<br/><br/> `item.requiredAttendees` Свойство<br/><br/> `item.optionalAttendees` Свойство <br/><br/>`item.to` Свойство <br/><br/>`item.cc` Свойство|Ограничение длины отображаемого имени в сообщении или встрече.|
|Настройка темы|255 символов|Метод [mailbox.displayNewAppointmentForm](/javascript/api/requirement-sets/outlook/preview-requirement-set/office.context.mailbox#methods)<br/><br/> Метод [Subject.setAsync](/javascript/api/outlook/office.subject#outlook-office-subject-setasync-member(1))|Ограничение для темы в форме новой встречи или для настройки темы встречи или сообщения.|
|Установка расположения|255 символов|Метод [Location.setAsync](/javascript/api/outlook/office.location#outlook-office-location-setasync-member(1))|Ограничение для установки расположении встречи или приглашения на собрание.|
|Текст в форме новой встречи|32 КБ символов|`Mailbox.displayNewAppointmentForm` Метод|Ограничение текста в форме новой встречи.|
|Отображение текста существующего элемента|32 КБ символов|Метод [mailbox.displayAppointmentForm](/javascript/api/requirement-sets/outlook/preview-requirement-set/office.context.mailbox#methods)<br/><br/> Метод [mailbox.displayMessageForm](/javascript/api/requirement-sets/outlook/preview-requirement-set/office.context.mailbox#methods)|Для Outlook в Интернете и мобильных устройств: ограничение текста в существующей форме встречи или сообщения.|
|Настройка текста|1 МБ символов|Метод [Body.prependAsync](/javascript/api/outlook/office.body#outlook-office-body-prependasync-member(1))<br/> <br/>[Body.setAsync](/javascript/api/outlook/office.body#outlook-office-body-setasync-member(1))<br/><br/>Метод [Body.setSelectedDataAsync](/javascript/api/outlook/office.body#outlook-office-body-setselecteddataasync-member(1))|Ограничение для установки текста элемента встречи или сообщения.|
|Число вложений|499 файлов на Outlook в Интернете и мобильных устройствах|Метод [item.addFileAttachmentAsync](/javascript/api/requirement-sets/outlook/preview-requirement-set/office.context.mailbox.item#methods)|Ограничение количества файлов, которые можно вложить в отправляемый элемент. Outlook в Интернете и мобильных устройствах обычно ограничивают вложение до 499 файлов с помощью пользовательского интерфейса и `addFileAttachmentAsync`. В полнофункциональном клиенте Outlook нет определенного ограничения на количество вложенных файлов. Однако все клиенты Outlook отслеживают ограничение на размер вложений, с которыми Exchange Server настроен пользователь. См. следующую строку — "Размер вложений".|
|Размер вложений|В зависимости от Exchange Server|`item.addFileAttachmentAsync` Метод|Существует ограничение на размер всех вложений элемента, которое администратор может настроить на сервере Exchange Server для почтового ящика пользователя. В полнофункциональном клиенте Outlook это ограничивает количество вложений в элементе. Для Outlook в Интернете и мобильных устройств меньшее из двух ограничений — количество вложений и размер всех вложений — ограничивает фактические вложения для элемента.|
|Имя файла вложения|255 символов|`item.addFileAttachmentAsync` Метод|Ограничение длины имени файла вложения, добавляемого в элемент.|
|URI вложения|2048 символов|`item.addFileAttachmentAsync` Метод|Ограничение URI имени файла, добавляемого в элемент как вложение.|
|Идентификатор вложения|100 символов|Метод [item.addItemAttachmentAsync](/javascript/api/requirement-sets/outlook/preview-requirement-set/office.context.mailbox.item#methods)<br/><br/> Метод [item.removeAttachmentAsync](/javascript/api/requirement-sets/outlook/preview-requirement-set/office.context.mailbox.item#methods)|Ограничение длины идентификатора вложения, добавляемого в элемент или удаляемого из него.|
|Асинхронные вызовы|3 вызова|`item.addFileAttachmentAsync` Метод<br/><br/>`item.addItemAttachmentAsync` Метод<br/><br/><br/>`item.removeAttachmentAsync` Метод<br/><br/> Метод [Body.getTypeAsync](/javascript/api/outlook/office.body#outlook-office-body-gettypeasync-member(1))<br/><br/>`Body.prependAsync` Метод<br/><br/>`Body.setSelectedDataAsync` Метод<br/><br/> Метод [CustomProperties.saveAsync](/javascript/api/outlook/office.customproperties#outlook-office-customproperties-saveasync-member(1))<br/><br/><br/> [Элемента. Метод LoadCustomPropertiesAsync](/javascript/api/requirement-sets/outlook/preview-requirement-set/office.context.mailbox.item#methods)<br/><br/><br/> Метод [Location.getAsync](/javascript/api/outlook/office.location#outlook-office-location-getasync-member(1))<br/><br/>`Location.setAsync` Метод<br/><br/> Метод [mailbox.getCallbackTokenAsync](/javascript/api/requirement-sets/outlook/preview-requirement-set/office.context.mailbox#methods)<br/><br/> Метод [mailbox.getUserIdentityTokenAsync](/javascript/api/requirement-sets/outlook/preview-requirement-set/office.context.mailbox#methods)<br/><br/> Метод [mailbox.makeEwsRequestAsync](/javascript/api/requirement-sets/outlook/preview-requirement-set/office.context.mailbox#methods)<br/><br/>`Recipients.addAsync` Метод<br/><br/> Метод [Recipients.getAsync](/javascript/api/outlook/office.recipients#outlook-office-recipients-getasync-member(1))<br/><br/>`Recipients.setAsync` Метод<br/><br/> Метод [RoamingSettings.saveAsync](/javascript/api/outlook/office.roamingsettings#outlook-office-roamingsettings-saveasync-member(1))<br/><br/> Метод [Subject.getAsync](/javascript/api/outlook/office.subject#outlook-office-subject-getasync-member(1))<br/><br/>`Subject.setAsync` Метод<br/><br/> Метод [Time.getAsync](/javascript/api/outlook/office.time#outlook-office-time-getasync-member(1))<br/><br/> Метод [Time.setAsync](/javascript/api/outlook/office.time#outlook-office-time-setasync-member(1))|Для Outlook в Интернете или мобильных устройств: ограничение количества одновременных асинхронных вызовов в любое время, так как браузеры разрешают только ограниченное количество асинхронных вызовов к серверам. |

## <a name="see-also"></a>См. также

- [Развертывание и установка надстроек Outlook для тестирования](testing-and-tips.md)
- [Конфиденциальность, разрешения и безопасность для надстроек Outlook](../concepts/privacy-and-security.md)
