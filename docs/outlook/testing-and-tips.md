---
title: Развертывание и установка надстроек Outlook для тестирования
description: Создайте файл манифеста, разверните файл пользовательского интерфейса надстройки на веб-сервере, установите надстройку в своем почтовом ящике, а затем протестируйте ее.
ms.date: 07/08/2021
localization_priority: Priority
ms.openlocfilehash: 7a8c6a22d053f58b38e6dbb432c2ad151c0fee94f3a512eea0611e28ab3595f6
ms.sourcegitcommit: 4f2c76b48d15e7d03c5c5f1f809493758fcd88ec
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/07/2021
ms.locfileid: "57086247"
---
# <a name="deploy-and-install-outlook-add-ins-for-testing"></a>Развертывание и установка надстроек Outlook для тестирования

В рамках разработки надстройки Outlook вам, скорее всего, понадобится несколько раз развертывать и устанавливать надстройку для тестирования, что подразумевает выполнение указанных ниже шагов.

1. Создание файла манифеста, в котором описывается надстройка.
1. Развертывание файлов пользовательского интерфейса надстройки на веб-сервере.
1. Установка надстройки в почтовом ящике пользователя.
1. Тестирование надстройки с внесением соответствующих изменений в пользовательский интерфейс или файлы манифеста и повторение этапов 2 и 3 для тестирования изменений.

> [!NOTE]
> Поскольку [настраиваемые области устарели](https://developer.microsoft.com/outlook/blogs/make-your-add-ins-available-in-the-office-ribbon/), следует убедиться, что вы используете [поддерживаемую точку расширения надстройки](outlook-add-ins-overview.md#extension-points).

## <a name="create-a-manifest-file-for-the-add-in"></a>Создание файла манифеста для надстройки

Каждая надстройка описывается XML-манифестом, то есть документом, который предоставляет серверу сведения о почтовой надстройке, сообщает пользователям подробные сведения о надстройке и определяет местоположение HTML-файла пользовательского интерфейса надстройки. Вы можете хранить манифест в локальной папке или на сервере. Его расположение должно быть доступным для сервера Exchange Server проверяемого почтового ящика. Сведения о создании файла манифеста см. в разделе [Манифесты надстроек Outlook](manifests.md).

## <a name="deploy-an-add-in-to-a-web-server"></a>Развертывание надстройки на веб-сервере

Для создания надстройки можно использовать HTML и JavaScript. Конечные исходные файлы хранятся на веб-сервере, к которому может обращаться сервер Exchange Server, на котором размещена надстройка. После развертывания исходных файлов надстройки вы можете обновить ее пользовательский интерфейс и поведение, обновив файлы HTML или JavaScript на веб-сервере.

## <a name="install-the-add-in"></a>Установка надстройки

После подготовки файла манифеста и развертывания пользовательского интерфейса надстройки на доступном веб-сервере, вы можете загрузить неопубликованную надстройку для почтового ящика на сервере Exchange Server, используя клиент Outlook, или установить ее с помощью командлетов Windows PowerShell.

### <a name="sideload-the-add-in"></a>Загрузка неопубликованной надстройки

Вы можете установить надстройку, если ваш почтовый ящик находится в Exchange Online, Exchange 2013 или более поздней версии. Для загрузки неопубликованных надстроек требуется по крайней мере роль **My Custom Apps** для сервера Exchange Server. Чтобы проверить надстройку или иметь возможность устанавливать надстройки, указывая URL-адрес или имя файла манифеста, попросите своего администратора Exchange предоставить вам необходимые разрешения.

Администратор Exchange может выполнить следующий командлет PowerShell, чтобы назначить необходимые разрешения одному пользователю. В этом примере `wendyri` — псевдоним электронной почты пользователя.

```powershell
New-ManagementRoleAssignment -Role "My Custom Apps" -User "wendyri"
```

При необходимости администратор может выполнить следующий командлет, чтобы назначить похожие разрешения нескольким пользователям.

```powershell
$users = Get-Mailbox *$users | ForEach-Object { New-ManagementRoleAssignment -Role "My Custom Apps" -User $_.Alias}
```

Дополнительные сведения об упомянутой роли см. в статье [Роль My Custom Apps](/exchange/my-custom-apps-role-exchange-2013-help).

Если для разработки надстроек вы используете Microsoft 365 или Visual Studio, вам назначается роль администратора организации, позволяющая устанавливать надстройки с помощью файла или URL-адреса в Центре администрирования Exchange, а также с помощью командлетов PowerShell.

### <a name="install-an-add-in-by-using-remote-powershell"></a>Установка надстройки с помощью удаленного сеанса PowerShell

После создания удаленного сеанса Windows PowerShell на сервере Exchange Server вы можете установить надстройку Outlook, используя командлет `New-App` и следующую команду PowerShell.

```powershell
New-App -URL:"http://<fully-qualified URL">
```

Полный URL-адрес — это расположение подготовленного файла манифеста надстройки.

Используйте следующие дополнительные командлеты PowerShell для управления надстройками для почтового ящика.

- `Get-App`: отображает надстройки, включенные для почтового ящика.
- `Set-App`: включает или отключает надстройку для почтового ящика.
- `Remove-App`: удаляет ранее установленную надстройку с сервера Exchange Server.

## <a name="client-versions"></a>Версии клиента

Выбор версии клиента Outlook для тестирования зависит от ваших требований к разработке.

- Если вы разрабатываете надстройку для частного использования или только для членов организации, важно протестировать версии Outlook, используемые в компании. Обратите внимание на то, что некоторые пользователи могут использовать Outlook в Интернете, поэтому также важно протестировать версии стандартного браузера компании.

- Если вы разрабатываете надстройку для размещения в [AppSource](https://appsource.microsoft.com), необходимо протестировать версии, указанные в [политиках сертификации коммерческой платформы 1120.3](/legal/marketplace/certification-policies#11203-functionality). К ним относятся:
  - Последнюю и предпоследнюю версии Outlook для Windows.
  - Последнюю версию Outlook для Mac.
  - Последнюю версию Outlook для iOS и Android (если надстройка [поддерживает мобильный формат](add-mobile-support.md)).
  - Версии браузеров, указанные в политике проверки коммерческой платформы Marketplace 1120.3.

> [!NOTE]
> Если ваша надстройка не поддерживает один из указанных выше клиентов, так как [запрашивает набор обязательных элементов API](apis.md), не поддерживаемый клиентом, его тестировать не нужно.

## <a name="outlook-on-the-web-and-exchange-server-versions"></a>Outlook в Интернете и версии Exchange Server

Потребители и пользователи учетной записи Microsoft 365 видят современную версию интерфейса при обращении к Outlook в Интернете и больше не видят классическую версию, поддержка которой прекращена. Однако локальные серверы Exchange Server продолжают поддерживать классическую версию Outlook в Интернете. Поэтому во время проверки ваша отправка может получить предупреждение о том, что надстройка несовместима с классической версией Outlook в Интернете. В этом случае рекомендуется проверить надстройку в локальной среде Exchange. При этом предупреждение не блокирует отправку в AppSource, но для ваших пользователей могут быть ограничены возможности, если они используют Outlook в Интернете в локальной среде Exchange.

Чтобы устранить эту проблему, рекомендуем проверить надстройку в Outlook в Интернете, подключенном к собственной приватной локальной среде Exchange. Дополнительные сведения см. в руководстве о том, как [создать тестовую среду Exchange 2016 или Exchange 2019](/Exchange/plan-and-deploy/plan-and-deploy?view=exchserver-2019&preserve-view=true#establish-an-exchange-2016-or-exchange-2019-test-environment), и о том, как управлять [Outlook в Интернете в Exchange Server](/exchange/clients/outlook-on-the-web/outlook-on-the-web?view=exchserver-2019&preserve-view=true).

Вы также можете выбрать вариант с оплатой и использовать службу, размещающую локальные серверы Exchange Server и управляющую ими. Некоторые варианты:

- [Rackspace](https://www.rackspace.com/email-hosting/exchange-server)
- [Hostway](https://hostway.com/microsoft-exchange/)

Кроме того, если вы не хотите, чтобы ваши надстройки были доступны для пользователей, подключенных к локальной среде Exchange, вы можете настроить для [набора обязательных элементов](../reference/requirement-sets/outlook-api-requirement-sets.md#exchange-server-support) в манифесте надстройки версию 1.6 или более позднюю. Такие надстройки не будут проверяться в классическом интерфейсе Outlook в Интернете.

## <a name="see-also"></a>См. также

- [Устранение ошибок, с которыми сталкиваются пользователи при работе с надстройками Office](../testing/testing-and-troubleshooting.md)
