---
title: Развертывание и установка надстроек Outlook для тестирования
description: Создайте файл манифеста, разверните файл пользовательского интерфейса надстройки на веб-сервере, установите надстройку в своем почтовом ящике, а затем протестируйте ее.
ms.date: 05/20/2020
localization_priority: Priority
ms.openlocfilehash: 97841f7c8112b42cee2927f238b31fe985b2e101
ms.sourcegitcommit: 7ef14753dce598a5804dad8802df7aaafe046da7
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/10/2020
ms.locfileid: "45093863"
---
# <a name="deploy-and-install-outlook-add-ins-for-testing"></a><span data-ttu-id="ea68f-103">Развертывание и установка надстроек Outlook для тестирования</span><span class="sxs-lookup"><span data-stu-id="ea68f-103">Deploy and install Outlook add-ins for testing</span></span>

<span data-ttu-id="ea68f-104">В рамках разработки надстройки Outlook вам, скорее всего, понадобится несколько раз развертывать и устанавливать надстройку для тестирования, что подразумевает выполнение следующих действий.</span><span class="sxs-lookup"><span data-stu-id="ea68f-104">As part of the process of developing an Outlook add-in, you will probably find yourself iteratively deploying and installing the add-in for testing, which involves the following steps:</span></span>

1. <span data-ttu-id="ea68f-105">Создание файла манифеста, в котором описывается надстройка.</span><span class="sxs-lookup"><span data-stu-id="ea68f-105">Creating a manifest file that describes the add-in.</span></span>
1. <span data-ttu-id="ea68f-106">Развертывание файлов пользовательского интерфейса надстройки на веб-сервере.</span><span class="sxs-lookup"><span data-stu-id="ea68f-106">Deploying the add-in UI file(s) to a web server.</span></span>
1. <span data-ttu-id="ea68f-107">Установка надстройки в почтовом ящике пользователя.</span><span class="sxs-lookup"><span data-stu-id="ea68f-107">Installing the add-in in your mailbox.</span></span>
1. <span data-ttu-id="ea68f-108">Тестирование надстройки с внесением соответствующих изменений в пользовательский интерфейс или файлы манифеста и повторение этапов 2 и 3 для тестирования изменений.</span><span class="sxs-lookup"><span data-stu-id="ea68f-108">Testing the add-in, making appropriate changes to the UI or manifest files, and repeating steps 2 and 3 to test the changes.</span></span>

> [!NOTE]
> <span data-ttu-id="ea68f-109">Поскольку [настраиваемые области устарели](https://developer.microsoft.com/outlook/blogs/make-your-add-ins-available-in-the-office-ribbon/), следует убедиться, что вы используете [поддерживаемую точку расширения надстройки](outlook-add-ins-overview.md#extension-points).</span><span class="sxs-lookup"><span data-stu-id="ea68f-109">[Custom panes have been deprecated](https://developer.microsoft.com/outlook/blogs/make-your-add-ins-available-in-the-office-ribbon/) so please ensure that you're using [a supported add-in extension point](outlook-add-ins-overview.md#extension-points).</span></span>

## <a name="create-a-manifest-file-for-the-add-in"></a><span data-ttu-id="ea68f-110">Создание файла манифеста для надстройки</span><span class="sxs-lookup"><span data-stu-id="ea68f-110">Create a manifest file for the add-in</span></span>

<span data-ttu-id="ea68f-p101">Каждая надстройка описывается XML-манифестом, то есть документом, который предоставляет серверу сведения о почтовой надстройке, сообщает пользователям подробные сведения о надстройке и определяет местоположение HTML-файла пользовательского интерфейса надстройки. Вы можете сохранить манифест в локальной папке или на сервере, если у сервера Exchange, где размещен почтовый ящик, используемый в тестировании, есть доступ к этому месту. Сведения о создании файла манифеста см. в разделе [Манифесты надстроек Outlook](manifests.md).</span><span class="sxs-lookup"><span data-stu-id="ea68f-p101">Each add-in is described by an XML manifest, a document that gives the server information about the add-in, provides descriptive information about the add-in for the user, and identifies the location of the add-in UI HTML file. You can store the manifest in a local folder or server, as long as the location is accessible by the Exchange server of the mailbox that you are testing with. We'll assume that you store your manifest in a local folder. For information about how to create a manifest file, see [Outlook add-in manifests](manifests.md).</span></span>

## <a name="deploy-an-add-in-to-a-web-server"></a><span data-ttu-id="ea68f-115">Развертывание надстройки на веб-сервере</span><span class="sxs-lookup"><span data-stu-id="ea68f-115">Deploy an add-in to a web server</span></span>

<span data-ttu-id="ea68f-p102">Для создания надстройки можно использовать HTML и JavaScript. Конечные исходные файлы хранятся на веб-сервере, к которому может обращаться сервер Exchange Server, на котором размещена надстройка. После развертывания исходных файлов надстройки вы можете обновить ее пользовательский интерфейс и поведение, обновив файлы HTML или JavaScript на веб-сервере.</span><span class="sxs-lookup"><span data-stu-id="ea68f-p102">You can use HTML and JavaScript to create the add-in. The resulting source files are stored on a web server that can be accessed by the Exchange server that hosts the add-in. After initially deploying the source files for the add-in, you can update the add-in UI and behavior by replacing the HTML files or JavaScript files stored on the web server with a new version of the HTML file.</span></span>

## <a name="install-the-add-in"></a><span data-ttu-id="ea68f-119">Установка надстройки</span><span class="sxs-lookup"><span data-stu-id="ea68f-119">Install the add-in</span></span>

<span data-ttu-id="ea68f-120">После подготовки файла манифеста и развертывания пользовательского интерфейса надстройки на доступном веб-сервере, вы можете загрузить неопубликованную надстройку для почтового ящика на сервере Exchange Server, используя клиент Outlook, или установить ее с помощью командлетов Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="ea68f-120">After preparing the add-in manifest file and deploying the add-in UI to a web server that can be accessed, you can sideload the add-in for a mailbox on an Exchange server by using an Outlook client, or install the add-in by running remote Windows PowerShell cmdlets.</span></span>

### <a name="sideload-the-add-in"></a><span data-ttu-id="ea68f-121">Загрузка неопубликованной надстройки</span><span class="sxs-lookup"><span data-stu-id="ea68f-121">Sideload the add-in</span></span>

<span data-ttu-id="ea68f-p103">Вы можете установить надстройку, если ваш почтовый ящик находится в Exchange Online, Exchange 2013 или более поздней версии. Для загрузки неопубликованных надстроек требуется по крайней мере роль **My Custom Apps** для сервера Exchange Server. Чтобы проверить надстройку или иметь возможность устанавливать надстройки, указывая URL-адрес или имя файла манифеста, попросите своего администратора Exchange предоставить вам необходимые разрешения.</span><span class="sxs-lookup"><span data-stu-id="ea68f-p103">You can install an add-in if your mailbox is on Exchange Online, Exchange 2013 or a later release. Sideloading add-ins requires at minimum the **My Custom Apps** role for your Exchange Server. In order to test your add-in, or install add-ins in general by specifying a URL or file name for the add-in manifest, you should request your Exchange administrator to provide the necessary permissions.</span></span>

<span data-ttu-id="ea68f-p104">Администратор Exchange может выполнить следующий командлет PowerShell, чтобы назначить необходимые разрешения одному пользователю. В этом примере `wendyri` — псевдоним электронной почты пользователя.</span><span class="sxs-lookup"><span data-stu-id="ea68f-p104">The Exchange administrator can run the following PowerShell cmdlet to assign a single user the necessary permissions. In this example, `wendyri` is the user's email alias.</span></span>

```powershell
New-ManagementRoleAssignment -Role "My Custom Apps" -User "wendyri"
```

<span data-ttu-id="ea68f-127">При необходимости администратор может выполнить следующий командлет, чтобы назначить похожие разрешения нескольким пользователям:</span><span class="sxs-lookup"><span data-stu-id="ea68f-127">If necessary, the administrator can run the following cmdlet to assign multiple users the similar necessary permissions:</span></span>

```powershell
$users = Get-Mailbox *$users | ForEach-Object { New-ManagementRoleAssignment -Role "My Custom Apps" -User $_.Alias}
```

<span data-ttu-id="ea68f-128">Дополнительные сведения об упомянутой роли см. в статье [Роль My Custom Apps](/exchange/my-custom-apps-role-exchange-2013-help).</span><span class="sxs-lookup"><span data-stu-id="ea68f-128">For more information about the My Custom Apps role, see [My Custom Apps role](/exchange/my-custom-apps-role-exchange-2013-help).</span></span>

<span data-ttu-id="ea68f-129">Если для разработки надстроек вы используете Microsoft 365 или Visual Studio, вам назначается роль администратора организации, позволяющая устанавливать надстройки с помощью файла или URL-адреса в Центре администрирования Exchange, а также с помощью командлетов PowerShell.</span><span class="sxs-lookup"><span data-stu-id="ea68f-129">Using Microsoft 365 or Visual Studio to develop add-ins assigns you the organization administrator role which allows you to install add-ins by file or URL in the EAC, or by Powershell cmdlets.</span></span>

### <a name="install-an-add-in-by-using-remote-powershell"></a><span data-ttu-id="ea68f-130">Установка надстройки с помощью удаленного сеанса PowerShell</span><span class="sxs-lookup"><span data-stu-id="ea68f-130">Install an add-in by using remote PowerShell</span></span>

<span data-ttu-id="ea68f-131">После создания удаленного сеанса Windows PowerShell на сервере Exchange Server вы можете установить надстройку Outlook, используя командлет `New-App` и следующую команду PowerShell.</span><span class="sxs-lookup"><span data-stu-id="ea68f-131">After you create a remote Windows PowerShell session on your Exchange server, you can install an Outlook add-in by using the `New-App` cmdlet with the following PowerShell command.</span></span>

```powershell
New-App -URL:"http://<fully-qualified URL">
```

<span data-ttu-id="ea68f-132">Полный URL-адрес — это расположение подготовленного файла манифеста надстройки.</span><span class="sxs-lookup"><span data-stu-id="ea68f-132">The fully qualified URL is the location of the add-in manifest file that you prepared for your add-in.</span></span>

<span data-ttu-id="ea68f-133">Вы можете использовать следующие командлеты PowerShell для управления надстройками для почтового ящика:</span><span class="sxs-lookup"><span data-stu-id="ea68f-133">You can use the following additional PowerShell cmdlets to manage the add-ins for a mailbox:</span></span>

- <span data-ttu-id="ea68f-134">`Get-App`: отображает надстройки, включенные для почтового ящика.</span><span class="sxs-lookup"><span data-stu-id="ea68f-134">`Get-App` - Lists the add-ins that are enabled for a mailbox.</span></span>
- <span data-ttu-id="ea68f-135">`Set-App`: включает или отключает надстройку для почтового ящика.</span><span class="sxs-lookup"><span data-stu-id="ea68f-135">`Set-App` - Enables or disables a add-in on a mailbox.</span></span>
- <span data-ttu-id="ea68f-136">`Remove-App`: удаляет ранее установленную надстройку с сервера Exchange Server.</span><span class="sxs-lookup"><span data-stu-id="ea68f-136">`Remove-App` - Removes a previously installed add-in from an Exchange server.</span></span>

## <a name="client-versions"></a><span data-ttu-id="ea68f-137">Версии клиента</span><span class="sxs-lookup"><span data-stu-id="ea68f-137">Client versions</span></span>

<span data-ttu-id="ea68f-138">Выбор версии клиента Outlook для тестирования зависит от ваших требований к разработке.</span><span class="sxs-lookup"><span data-stu-id="ea68f-138">Deciding what versions of the Outlook client to test depends on your development requirements.</span></span>

- <span data-ttu-id="ea68f-p105">Если вы разрабатываете надстройку для частного использования или только для членов организации, важно протестировать версии Outlook, используемые в компании. Обратите внимание, что некоторые пользователи могут использовать Outlook в Интернете, поэтому также важно протестировать версии стандартного браузера компании.</span><span class="sxs-lookup"><span data-stu-id="ea68f-p105">If you are developing an add-in for private use, or only for members of your organization, then it is important to test the versions of Outlook that your company uses. Keep in mind that some users may use Outlook on the web, so testing your company's standard browser versions is also important.</span></span>

- <span data-ttu-id="ea68f-p106">Если вы разрабатываете надстройку для размещения в [AppSource](https://appsource.microsoft.com), необходимо протестировать версии, указанные в [политиках сертификации коммерческой платформы Marketplace 1120.3](/legal/marketplace/certification-policies#11203-functionality), в том числе:</span><span class="sxs-lookup"><span data-stu-id="ea68f-p106">If you are developing an add-in to list in [AppSource](https://appsource.microsoft.com), you must test the required versions as specified in the [Commercial marketplace certification policies 1120.3](/legal/marketplace/certification-policies#11203-functionality). This includes:</span></span>
  - <span data-ttu-id="ea68f-143">Последнюю и предпоследнюю версии Outlook для Windows.</span><span class="sxs-lookup"><span data-stu-id="ea68f-143">The latest version of Outlook on Windows and the version prior to the latest.</span></span>
  - <span data-ttu-id="ea68f-144">Последнюю версию Outlook для Mac.</span><span class="sxs-lookup"><span data-stu-id="ea68f-144">The latest version of Outlook on Mac.</span></span>
  - <span data-ttu-id="ea68f-145">Последнюю версию Outlook для iOS и Android (если надстройка [поддерживает мобильный формат](add-mobile-support.md)).</span><span class="sxs-lookup"><span data-stu-id="ea68f-145">The latest version of Outlook on iOS and Android (if your add-in [supports mobile form factor](add-mobile-support.md)).</span></span>
  - <span data-ttu-id="ea68f-146">Версии браузеров, указанные в политике проверки коммерческой платформы Marketplace 1120.3.</span><span class="sxs-lookup"><span data-stu-id="ea68f-146">The browser versions specified in the Commercial marketplace validation policy 1120.3.</span></span>

> [!NOTE]
> <span data-ttu-id="ea68f-147">Если ваша надстройка не поддерживает один из указанных выше клиентов, так как [запрашивает набор обязательных элементов API](apis.md), не поддерживаемый клиентом, его тестировать не нужно.</span><span class="sxs-lookup"><span data-stu-id="ea68f-147">If your add-in does not support one of the above clients due to [requesting an API requirement set](apis.md) that the client does not support, that client would be removed from the list of required clients.</span></span>

## <a name="outlook-on-the-web-and-exchange-server-versions"></a><span data-ttu-id="ea68f-148">Outlook в Интернете и версии Exchange Server</span><span class="sxs-lookup"><span data-stu-id="ea68f-148">Outlook on the web and Exchange server versions</span></span>

<span data-ttu-id="ea68f-149">Потребители и пользователи учетной записи Microsoft 365 видят современную версию интерфейса при обращении к Outlook в Интернете и больше не видят классическую версию, поддержка которой прекращена.</span><span class="sxs-lookup"><span data-stu-id="ea68f-149">Consumer and Microsoft 365 account users see the modern UI version when they access Outlook on the web and no longer see the classic version which has been deprecated.</span></span> <span data-ttu-id="ea68f-150">Однако локальные серверы Exchange Server продолжают поддерживать классическую версию Outlook в Интернете.</span><span class="sxs-lookup"><span data-stu-id="ea68f-150">However, on-premises Exchange servers continue to support classic Outlook on the web.</span></span> <span data-ttu-id="ea68f-151">Поэтому во время проверки ваша отправка может получить предупреждение о том, что надстройка несовместима с классической версией Outlook в Интернете.</span><span class="sxs-lookup"><span data-stu-id="ea68f-151">Therefore, during the validation process, your submission may receive a warning that the add-in is not compatible with classic Outlook on the web.</span></span> <span data-ttu-id="ea68f-152">В этом случае рекомендуется проверить надстройку в локальной среде Exchange.</span><span class="sxs-lookup"><span data-stu-id="ea68f-152">In that case, you should consider testing your add-in in an on-premises Exchange environment.</span></span> <span data-ttu-id="ea68f-153">При этом предупреждение не блокирует отправку в AppSource, но для ваших пользователей могут быть ограничены возможности, если они используют Outlook в Интернете в локальной среде Exchange.</span><span class="sxs-lookup"><span data-stu-id="ea68f-153">This warning won't block your submission to AppSource but your customers may experience a sub-optimal experience if they use Outlook on the web in an on-premises Exchange environment.</span></span>

<span data-ttu-id="ea68f-154">Чтобы устранить эту проблему, рекомендуем проверить надстройку в Outlook в Интернете, подключенном к собственной приватной локальной среде Exchange.</span><span class="sxs-lookup"><span data-stu-id="ea68f-154">To mitigate this, we recommend you test your add-in in Outlook on the web connected to your own private on-premises Exchange environment.</span></span> <span data-ttu-id="ea68f-155">Дополнительные сведения см. в руководстве о том, как [создать тестовую среду Exchange 2016 или Exchange 2019](/Exchange/plan-and-deploy/plan-and-deploy?view=exchserver-2019#establish-an-exchange-2016-or-exchange-2019-test-environment), и о том, как управлять [Outlook в Интернете в Exchange Server](/exchange/clients/outlook-on-the-web/outlook-on-the-web?view=exchserver-2019).</span><span class="sxs-lookup"><span data-stu-id="ea68f-155">For more information, see guidance on how to [Establish an Exchange 2016 or Exchange 2019 test environment](/Exchange/plan-and-deploy/plan-and-deploy?view=exchserver-2019#establish-an-exchange-2016-or-exchange-2019-test-environment) and how to manage [Outlook on the web in Exchange Server](/exchange/clients/outlook-on-the-web/outlook-on-the-web?view=exchserver-2019).</span></span>

<span data-ttu-id="ea68f-156">Вы также можете выбрать вариант с оплатой и использовать службу, размещающую локальные серверы Exchange Server и управляющую ими.</span><span class="sxs-lookup"><span data-stu-id="ea68f-156">Alternatively, you can opt to pay for and use a service that hosts and manages on-premises Exchange servers.</span></span> <span data-ttu-id="ea68f-157">Несколько вариантов:</span><span class="sxs-lookup"><span data-stu-id="ea68f-157">A couple of options are:</span></span>

- [<span data-ttu-id="ea68f-158">Rackspace</span><span class="sxs-lookup"><span data-stu-id="ea68f-158">Rackspace</span></span>](https://www.rackspace.com/email-hosting/exchange-server)
- [<span data-ttu-id="ea68f-159">Hostway</span><span class="sxs-lookup"><span data-stu-id="ea68f-159">Hostway</span></span>](https://hostway.com/products-services-2/hosted-microsoft-exchange/)

<span data-ttu-id="ea68f-160">Кроме того, если вы не хотите, чтобы ваши надстройки были доступны для пользователей, подключенных к локальной среде Exchange, вы можете настроить для [набора обязательных элементов](../reference/requirement-sets/outlook-api-requirement-sets.md#exchange-server-support) в манифесте надстройки версию 1.6 или более позднюю.</span><span class="sxs-lookup"><span data-stu-id="ea68f-160">Furthermore, if you don't want your add-ins to be available for users who are connected to on-premises Exchange, you can set the [requirement set](../reference/requirement-sets/outlook-api-requirement-sets.md#exchange-server-support) in the add-in manifest to be 1.6 or higher.</span></span> <span data-ttu-id="ea68f-161">Такие надстройки не будут проверяться в классическом интерфейсе Outlook в Интернете.</span><span class="sxs-lookup"><span data-stu-id="ea68f-161">Such add-ins will not be tested or validated on the classic Outlook on the web UI.</span></span>

## <a name="see-also"></a><span data-ttu-id="ea68f-162">См. также</span><span class="sxs-lookup"><span data-stu-id="ea68f-162">See also</span></span>

- [<span data-ttu-id="ea68f-163">Устранение ошибок, с которыми сталкиваются пользователи при работе с надстройками Office</span><span class="sxs-lookup"><span data-stu-id="ea68f-163">Troubleshoot user errors with Office Add-ins</span></span>](../testing/testing-and-troubleshooting.md)
