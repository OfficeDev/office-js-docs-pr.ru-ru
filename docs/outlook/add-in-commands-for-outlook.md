---
title: Команды надстроек Outlook
description: Команды надстроек Outlook предоставляют доступ к определенным действиям надстройки с ленты, добавляя на нее кнопки или раскрывающиеся меню.
ms.date: 07/11/2022
ms.localizationpriority: high
ms.openlocfilehash: d58f8cd76f965007fdc9621c53fe52ed18dd6dd9
ms.sourcegitcommit: 9bb790f6264f7206396b32a677a9133ab4854d4e
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/15/2022
ms.locfileid: "66797689"
---
# <a name="add-in-commands-for-outlook"></a>Команды надстроек Outlook

Команды надстроек Outlook позволяют вызывать определенные действия надстроек с ленты путем добавления кнопок или раскрывающихся меню. Благодаря этому пользователи могут легко получать доступ к надстройкам простым и интуитивно понятным способом. Так как команды надстроек предлагают удобные расширенные функции, с их помощью вы можете создавать более интересные решения.

> [!NOTE]
> Команды надстроек доступны только в Outlook 2013 или более поздней версии для Windows, Outlook 2016 или более поздней версии для Mac, Outlook для iOS, Outlook для Android, Outlook в Интернете для Exchange 2016 или более поздней версии, Outlook в Интернете для Microsoft 365 и Outlook.com.
>
> Для поддержки команд надстроек в Outlook 2013 необходимы три обновления:
> - [Обновление для системы безопасности для Outlook от 8 марта 2016 г.](https://support.microsoft.com/kb/3114829)
> - [Обновление для системы безопасности для Office (KB3114816) от 8 марта 2016 г.](https://support.microsoft.com/topic/3d3eb171-78c2-0e61-62a2-85723bc4bcc0)
> - [Обновление для системы безопасности для Office (KB3114828) от 8 марта 2016 г.](https://support.microsoft.com/topic/54437016-d1e0-7aac-dbb7-4ecfbd57f5f0)
>
> Для поддержки команд надстроек в Exchange 2016 требуется [накопительный пакет обновления 5](https://support.microsoft.com/topic/d67d7693-96a4-fb6e-b60b-e64984e267bd).

Команды надстроек доступны в тех надстройках, где не используются [правила ItemHasAttachment, ItemHasKnownEntity и ItemHasRegularExpressionMatch](activation-rules.md), для ограничения типов элементов, активирующих надстройки. В [контекстных надстройках](contextual-outlook-add-ins.md) могут отображаться разные команды в зависимости от того, какой элемент выбран (сообщение или встреча), и они могут работать в режимах просмотра и создания. [Рекомендуем](../concepts/add-in-development-best-practices.md) использовать команды надстроек по мере возможности.

## <a name="create-the-add-in-command"></a>Создание команды надстройки

Команды надстроек объявляются в манифесте в элементе [VersionOverrides](/javascript/api/manifest/versionoverrides). Этот элемент является дополнением к схеме манифестов версии 1.1, которая обеспечивает обратную совместимость. В клиенте, который не поддерживает узел **\<VersionOverrides\>**, имеющиеся надстройки продолжат работать так же, как и без команд надстроек.

В записях манифеста **\<VersionOverrides\>** указывается множество свойств надстройки, например приложение, типы элементов управления, добавляемых на ленту, текст, значки и соответствующие функции.

Если надстройка должна показывать индикаторы хода выполнения или сообщения об ошибках, она должна делать это через [API уведомления](/javascript/api/outlook/office.notificationmessages). Обработка уведомлений также должна быть определена в отдельном HTML-файле, указанном в узле `FunctionFile` манифеста.

Разработчикам следует определить значки всех требуемых размеров, чтобы команды надстройки плавно изменялись при изменении размера ленты. Количество пикселей, составляющее требуемый размер значков: 80 x 80, 32 x 32 и 16 x 16 для компьютера, а также 48 x 48, 32 x 32 и 25 x 25 для мобильного устройства.

## <a name="how-do-add-in-commands-appear"></a>Отображение команд надстройки

Команда надстройки отображается на ленте в виде кнопки или элемента в раскрывающемся меню. Когда пользователь устанавливает надстройку, ее команды отображаются в пользовательском интерфейсе как группа кнопок. Она может располагаться на вкладке по умолчанию или пользовательской вкладке ленты. Для сообщений вкладкой по умолчанию является вкладка **Главная** или **Сообщение**. Для календаря вкладкой по умолчанию является вкладка **Собрание**, **Экземпляр собрания**, **Ряд собраний** или **Встреча**. Для расширений модуля вкладкой по умолчанию является пользовательская вкладка. На вкладке по умолчанию у каждой надстройки может быть одна группа ленты, содержащая до 6 команд. Пользовательские вкладки могут включать до 10 групп, по 6 команд в каждой. У надстройки может быть только одна пользовательская вкладка.

Команды надстройки отображаются в меню переполнения по мере заполнения ленты элементами. Команды надстройки обычно группируются вместе.

![Кнопки команд надстройки на ленте.](../images/commands-normal.png)

![Кнопки команд надстройки на ленте и в меню переполнения.](../images/commands-collapsed.png)

При добавлении команды в надстройку имя надстройки удаляется с панели приложения. На ленте остается только кнопка надстройки.

### <a name="modern-outlook-on-the-web"></a>Современная версия Outlook в Интернете

В Outlook в Интернете имя надстройки отображается в меню переполнения. Если у надстройки есть несколько команд, вы можете развернуть меню надстройки, чтобы просмотреть группу кнопок с именем надстройки.

![Меню переполнения, в котором находятся кнопки команд надстройки.](../images/commands-overflow-menu-web.png)

![Меню переполнения, отображающее кнопки команд надстройки.](../images/commands-overflow-menu-expand-web.png)

## <a name="what-are-the-types-of-add-in-commands"></a>Какие существуют типы команд надстройки?

Пользовательский интерфейс для команды надстройки состоит из кнопки ленты или элемента в раскрывающемся меню. Существует два типа команд надстроек, основанных на типе действия, активируемого командой.

- **Команды области задач**: кнопка или элемент меню открывает панель задач надстроек. Этот тип команды надстройки добавляется с разметкой в манифесте. "Код программной части" команды предоставляется Office.
- **Команды функций**: кнопка или элемент меню запускает любой произвольный JavaScript. Код почти всегда вызывает API в библиотеке JavaScript для Office, но это не обязательно. Этот тип надстройки обычно не отображает пользовательский интерфейс, кроме самой кнопки или элемента меню. Обратите внимание на следующие сведения о командах функций:

   - Запущенная функция может вызвать метод [displayDialogAsync](/javascript/api/office/office.ui#office-office-ui-displaydialogasync-member(1)) для отображения диалогового окна, что является хорошим способом отобразить ошибку, показать прогресс или запросить ввод от пользователя.
   - Среда выполнения JavaScript, в которой выполняется команда функции, является полноценной средой выполнения на основе браузера. Она может отображать HTML и обращаться к Интернету для отправки или получения данных.

### <a name="run-a-function-command"></a>Выполнение команды функции

Командные кнопки, выполняющие функцию JavaScript, используются для тех случаев, когда пользователю не требуется выбирать дополнительные параметры действия. Это могут быть такие действия, как отслеживание, напоминание или печать. Их также можно использовать для получения более подробных сведений от службы.

В расширениях модуля кнопка команды надстройки может выполнять функции JavaScript, взаимодействующие с содержимым в основном пользовательском интерфейсе.

![Кнопка, которая выполняет функцию, на ленте Outlook.](../images/commands-uiless-button-1.png)

### <a name="launch-a-task-pane"></a>Запуск области задач

Командные кнопки надстроек, запускающие область задач, используются в тех случаях, когда пользователю нужно работать с надстройкой длительное время. Например, надстройке может потребоваться изменить параметры или заполнить множество полей.

По умолчанию ширина вертикальной области задач составляет 320 точек. Размер области задач можно изменить как в проводнике Outlook, так и в инспекторе. Изменить размеры области можно будет точно так же, как и размеры панели списка дел и представления списка.

![Кнопка, открывающая область задач, на ленте Outlook.](../images/commands-task-pane-button-1.png)

<br/>

На этом снимке экрана показан пример вертикальной области задач. В левом верхнем углу области указано имя команды надстройки. Пользователи могут нажать кнопку **X** в правом верхнем углу области, чтобы закрыть надстройку после завершения работы с ней. По умолчанию эта область не сохраняется в сообщениях. Надстройки могут [поддерживать закрепление](pinnable-taskpane.md) в области задач и получать события при выборе нового сообщения. Все элементы пользовательского интерфейса в области задач, кроме имени надстройки и кнопки "Закрыть", предоставляются надстройкой.

Если пользователь выбирает другую команду надстройки, которая открывает область задач, то область задач заменяется выбранной командой. Когда пользователь нажимает командную кнопку, которая выполняет функцию, или раскрывающееся меню при открытой области задач, действие будет выполнено, а область задач останется открытой.

### <a name="drop-down-menu"></a>Раскрывающееся меню

Команда надстройки с раскрывающимся меню определяет статический список элементов. Меню может содержать любой набор элементов, которые выполняют функцию или открывают область задач. Подменю не поддерживаются.

![Кнопка раскрывающегося меню на ленте Outlook.](../images/commands-menu-button-1.png)

## <a name="where-do-add-in-commands-appear-in-the-ui"></a>Отображение команд надстройки в пользовательском интерфейсе

Команды надстроек поддерживаются для четырех сценариев:

### <a name="reading-a-message"></a>Просмотр сообщения

Когда пользователь просматривает сообщение в области чтения или на вкладке **Сообщение** для всплывающей формы чтения, команды надстройки, добавленные на вкладку по умолчанию, отображаются на вкладке **Главная**.

### <a name="composing-a-message"></a>Создание сообщения

Когда пользователь создает сообщение, команды надстройки, добавленные на вкладку по умолчанию, отображаются на вкладке **Сообщение**.

### <a name="creating-or-viewing-an-appointment-or-meeting-as-the-organizer"></a>Создание или просмотр встречи или собрания организатором

Когда организатор создает или просматривает встречу или собрание, команды надстройки, добавленные на вкладку по умолчанию, отображаются на вкладках **Собрание**, **Экземпляр собрания**, **Ряд собраний** или **Встреча** во всплывающих формах. Тем не менее, если пользователь выберет элемент календаря, но не откроет всплывающее окно, группа надстройки не будет отображаться на ленте.

### <a name="viewing-a-meeting-as-an-attendee"></a>Просмотр собрания участником

Когда участник просматривает собрание, команды надстройки, добавленные на вкладку по умолчанию, отображаются на вкладках **Собрание**, **Экземпляр собрания** или **Ряд собраний** всплывающих форм. Тем не менее, если пользователь выберет элемент календаря, не открывая всплывающее окно, группа надстройки не будет отображаться на ленте.

### <a name="using-a-module-extension"></a>Использование расширения модуля

Если используется расширение модуля, команды надстройки отображаются на пользовательской вкладке расширения.

## <a name="see-also"></a>См. также

- [Надстройка Outlook "Демонстрация команд надстройки"](https://github.com/officedev/outlook-add-in-command-demo)
- [Создание команд надстроек в манифесте для Excel, PowerPoint и Word](../develop/create-addin-commands.md)
- [Отладка команд функций в надстройках Outlook](debug-ui-less.md)
- [Руководство. Сборка надстройки Outlook для создания сообщения](../tutorials/outlook-tutorial.md)
