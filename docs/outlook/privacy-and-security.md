---
title: Конфиденциальность, разрешения и безопасность для надстроек Outlook
description: Узнайте, как управлять конфиденциальностью, разрешениями и безопасностью в надстройке Outlook.
ms.date: 07/27/2021
localization_priority: Priority
ms.openlocfilehash: e88dc6395eafc665a6e0635823a0419feb8f27de1acc7ec28bb94becc43b5536
ms.sourcegitcommit: 4f2c76b48d15e7d03c5c5f1f809493758fcd88ec
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/07/2021
ms.locfileid: "57093507"
---
# <a name="privacy-permissions-and-security-for-outlook-add-ins"></a>Конфиденциальность, разрешения и безопасность для надстроек Outlook

Пользователи, разработчики и администраторы могут использовать уровни разрешений модели безопасности для надстроек Outlook, чтобы управлять конфиденциальностью и производительностью.

В этой статье описаны разрешения, которые могут запрашивать надстройки Outlook, и рассматривается модель безопасности с различных точек зрения.

- **AppSource**: Целостность надстройки

- **Пользователи**: Вопросы, связанные с конфиденциальностью и производительностью

- **Разработчики**: Варианты разрешений и ограничения на использование ресурсов

- **Администраторы**: Разрешения на определение пороговых значений производительности

## <a name="permissions-model"></a>Модель разрешений

От того, насколько клиенты доверяют безопасности надстройки, зависит ее принятие. Безопасность надстройки Outlook опирается на уровневую модель разрешений. Надстройка Outlook открывает необходимый уровень разрешений, определяя возможный доступ и действия, которые она может выполнять с данными почтового ящика пользователя.

Схема манифеста версии 1.1 включает четыре уровня разрешений.

**Таблица 1. Уровни разрешений для надстройки**

|**Уровень разрешений**|**Значение в манифесте надстройки Outlook**|
|:-----|:-----|
|Ограниченный доступ|Restricted|
|Чтение элемента|ReadItem|
|Чтение и запись элемента|ReadWriteItem|
|Чтение и запись почтового ящика|ReadWriteMailbox|

Четыре уровня разрешений являются накопительными: разрешение **на чтение и запись в почтовом ящике** включает в себя разрешения **на чтение и запись элемента**, **на чтение элемента** и **на ограниченный доступ**; разрешение **на чтение и запись элемента** включает в себя разрешения **на чтение элемента** и **на ограниченный доступ**; разрешение **на чтение элемента** включает в себя разрешение **на ограниченный доступ**.

На рисунке ниже показано четыре уровня разрешений и описаны возможности, обеспечиваемые каждым уровнем для пользователей, разработчиков и администраторов. Дополнительные сведения об этих разрешениях см. в статьях [Пользователи: вопросы, связанные с конфиденциальностью и производительностью](#end-users-privacy-and-performance-concerns), [Разработчики: варианты разрешений и ограничения на использование ресурсов](#developers-permission-choices-and-resource-usage-limits) и [Общие сведения о разрешениях для надстроек Outlook](understanding-outlook-add-in-permissions.md).

**Сопоставление четырехуровневой модели разрешений с пользователями, разработчиками и администраторами**

![Четырехуровневая модель разрешений для схемы почтовых приложений версии 1.1.](../images/add-in-permission-tiers.png)

## <a name="appsource-add-in-integrity"></a>AppSource: Целостность надстройки

[AppSource](https://appsource.microsoft.com) содержит надстройки, которые могут установить пользователи и администраторы. AppSource применяет указанные ниже меры для поддержки целостности надстроек Outlook.

- Требуется постоянное использование сервером, на котором размещена надстройка, протокола SSL для связи.

- Разработчику требуется предоставить доказательство подлинности, контрактное соглашение и соответствующую требованиям политику конфиденциальности для отправки надстроек.

- Архивация надстроек осуществляется только в режиме для чтения.

- Поддерживается система рецензий пользователей для доступных надстроек, чтобы стимулировать формирование саморегулирующегося сообщества.

## <a name="optional-connected-experiences"></a>Необязательные сетевые функции.

Конечные пользователи и ИТ-администраторы могут отключать [дополнительные возможности подключения в Office](/deployoffice/privacy/optional-connected-experiences) для клиентов рабочего стола и мобильных клиентов. В надстройках для Outlook влияние отключения параметра **Необязательные сетевые функции** зависит от клиента, но обычно подразумевает, что установленные пользователем надстройки и доступ к Магазину Office запрещены. Надстройки, развернутые ИТ-администратором организации с помощью [централизованного развертывания](/microsoft-365/admin/manage/centralized-deployment-of-add-ins), по-прежнему будут доступны.

- Windows\*, Mac: кнопка **Получить надстройки** не отображается, поэтому пользователи больше не могут управлять своими надстройками и получать доступ к Магазину Office.
- Android, iOS: в диалоговом окне **Получить надстройки** отображаются только надстройки, развернутые администратором.
- Браузер: доступность надстроек и доступ к магазину остаются без изменения, поэтому пользователи могут продолжать [управлять своими надстройками](https://support.microsoft.com/office/8f2ce816-5df4-44a5-958c-f7f9d6dabdce), в том числе развернутыми администратором.

  > [!NOTE]
  > \* В Windows такое взаимодействие или поведение поддерживается с версии 2008 (сборка 13127.20296). Дополнительные сведения относительно вашей версии см. на странице журнала обновлений для [Microsoft 365](/officeupdates/update-history-office365-proplus-by-date) и в статье [Поиск версии клиента Office и канала обновления](https://support.microsoft.com/office/932788b8-a3ce-44bf-bb09-e334518b8b19).

Общие сведения о надстройках см. в разделе [Конфиденциальность и безопасность надстроек для Office](../concepts/privacy-and-security.md#optional-connected-experiences).

## <a name="end-users-privacy-and-performance-concerns"></a>Конечные пользователи: Вопросы, связанные с конфиденциальностью и производительностью

Модель безопасности адресует вопросы пользователей, связанные с безопасностью, конфиденциальностью и производительностью, следующим образом.

- Пользовательские сообщения, защищенные с помощью IRM в Outlook, не взаимодействуют с надстройками Outlook.

  > [!IMPORTANT]
  > - Надстройки активируют сообщения с цифровой подписью в Outlook, связанном с подпиской на Microsoft 365. В Windows эта поддержка представлена в сборке 8711.1000.
  >
  > - Начиная с Outlook сборки 13229.10000 в Windows, надстройки могут активировать элементы, защищенные с помощью IRM. Дополнительные сведения об этой функции в предварительной версии см. в статье [Активация надстроек для элементов, защищенных службами управления правами на доступ к данным (IRM)](../reference/objectmodel/preview-requirement-set/outlook-requirement-set-preview.md#add-in-activation-on-items-protected-by-information-rights-management-irm).

- Перед установкой надстройки, добавленной в AppSource, пользователям видны сведения о доступе и действиях, которые надстройка может выполнять с их данными, и для продолжения установки необходимо явно подтвердить свое согласие. Ни одна надстройка Outlook не устанавливается на клиентский компьютер без получения непосредственного согласия от пользователя или администратора.

- Разрешение **ограниченное** позволяет ограничить доступ надстройки Outlook только к текущему элементу. Разрешение **чтение элемента** позволяет надстройке получить доступ к личным сведениям, например именам и электронным адресам отправителя и получателя, но только для текущего элемента.

- Пользователь может установить надстройку Outlook только для себя. Установку надстроек Outlook на уровне всей организации выполняют администраторы.

- Пользователи могут устанавливать надстройки Outlook, которые задействуют сценарии, зависимые от контекста, что очень привлекательно для самих пользователей, но при этом также снижает риски, связанные с безопасностью.

- Защита файлов манифестов установленных надстроек Outlook обеспечивается в учетной записи электронной почты пользователя.

- Данные, которыми приложения обмениваются с серверами, на которых установлены Надстройки Office, всегда шифруются в соответствии с протоколом SSL.

- Применимо только к полнофункциональным клиентам Outlook, которые отслеживают производительность установленных надстроек Outlook, контролируют их и отключают те приложения, которые превышают ограничения по ряду следующих факторов.

  - Время отзыва для активации

  - Количество сбоев при активации или повторной активации

  - Использование памяти

  - Использование процессора  

  Такой контроль предотвращает атаки по принципу отказа в обслуживании и поддерживает производительность надстройки на допустимом уровне. В бизнес-строке пользователи получают уведомления о тех надстройках Outlook, которые полнофункциональный клиент Outlook отключил, руководствуясь изложенными выше принципами.

- В любой момент пользователи могут проверить разрешения, запрашиваемые установленными надстройками Outlook, отключить, а затем включить любую надстройку Outlook в Центре администрирования Exchange.

## <a name="developers-permission-choices-and-resource-usage-limits"></a>Разработчики: Варианты разрешений и ограничения на использование ресурсов

Модель безопасности предоставляет пользователям возможность детальной настройки разрешений, а также строгие правила производительности, которых следует придерживаться.

### <a name="tiered-permissions-increases-transparency"></a>Уровневая модель разрешений повышает прозрачность

Разработчикам рекомендуется следовать многоуровневой модели разрешений, чтобы обеспечить прозрачность и развеять сомнения пользователей по поводу доступа надстроек к их данным и почтовым ящикам, что косвенно повысит популярность надстройки.

- Разработчики запрашивают подходящий уровень разрешений для надстройки Outlook с учетом способа ее активации, а также необходимости чтения или записи определенных свойств элемента или создания и отправки элемента.

- Разработчики запрашивают разрешение с помощью элемента [Permissions](../reference/manifest/permissions.md) в манифесте надстройки Outlook, назначая значение **Restricted**, **ReadItem**, **ReadWriteItem** или **ReadWriteMailbox**.

  > [!NOTE]
  > Помните, что разрешение **ReadWriteItem** доступно начиная со схемы манифеста версии 1.1.

  В приведенном ниже примере запрашивается разрешение на **чтение элемента**.

  ```XML
    <Permissions>ReadItem</Permissions>
  ```

- Разработчики могут запрашивать **ограниченное** разрешение, если надстройка Outlook задействуется только для определенного типа элементов Outlook (встреча или сообщение) или для определенных извлеченных сущностей (телефонный номер, адрес, URL-адрес) в теме или основном тексте элемента. Например, следующее правило активирует надстройку Outlook, если хотя бы одна из трех сущностей (телефонный номер, почтовый адрес или URL-адрес) найдена в теме или основном тексте текущего сообщения.

  ```XML
    <Permissions>Restricted</Permissions>
        <Rule xsi:type="RuleCollection" Mode="And">
        <Rule xsi:type="ItemIs" FormType="Read" ItemType="Message" />
        <Rule xsi:type="RuleCollection" Mode="Or">
            <Rule xsi:type="ItemHasKnownEntity" EntityType="PhoneNumber" />
            <Rule xsi:type="ItemHasKnownEntity" EntityType="Address" />
            <Rule xsi:type="ItemHasKnownEntity" EntityType="Url" />
        </Rule>
    </Rule>
  ```

- Разработчикам рекомендуется запрашивать разрешение на **чтение элемента**, если надстройка Outlook должна считывать свойства текущего элемента, который не входит в извлеченные сущности по умолчанию, или записывать пользовательские свойства, определяемые надстройкой для текущего элемента, но не требует чтения или записи других элементов либо создания и отправки сообщения в пользовательском почтовом ящике. Например, разработчик должен запросить разрешение на **чтение элемента**, если надстройка должна искать такие сущности, как приглашение на собрание, предложение задачи, электронный адрес или имя контакта в теме или основном тексте элемента, или если для активации надстройки требуется регулярное выражение.

- Разработчикам следует запрашивать разрешение на **чтение и запись элемента**, если надстройка Outlook должна записывать свойства созданного элемента, например имена, электронные адреса, основной текст и тему или добавлять и удалять вложения.

- Разработчики запрашивают разрешение **чтение и запись в почтовом ящике**, только если надстройка Outlook должна выполнять одно или несколько из приведенных ниже действий с помощью метода [mailbox.makeEWSRequestAsync](../reference/objectmodel/preview-requirement-set/office.context.mailbox.md#methods).

  - Чтение и запись свойств элементов в почтовом ящике.
  - Создание, чтение, запись и отправка элементов в почтовом ящике.
  - Создание, чтение папок почтового ящика и запись в них.

### <a name="resource-usage-tuning"></a>Регулирование использования ресурсов

Разработчики должны знать пределы использования ресурсов для активации и учитывать необходимость оптимальной настройки производительности в рабочем процессе разработки, чтобы снизить вероятность отказа в обслуживании из-за низкой производительности надстройки. Рекомендуем следовать инструкциям по разработке правил активации, представленным в статье [Ограничения для активации и API JavaScript для надстроек Outlook](limits-for-activation-and-javascript-api-for-outlook-add-ins.md). Если надстройка Outlook должна работать в полнофункциональном клиенте Outlook, разработчикам стоит убедиться, что она правильно работает при ограниченном использовании ресурсов.

### <a name="other-measures-to-promote-user-security"></a>Другие меры повышения безопасности пользователей

Разработчики также должны знать и учитывать следующее.

- Разработчики не могут использовать элементы ActiveX в своих надстройках, так как эти элементы не поддерживаются.

- При отправке надстройки Outlook в AppSource разработчикам следует.

  - Создать SSL-сертификат высокой надежности для подтверждения своей личности.

  - Разместить предоставляемую надстройку на веб-сервере, поддерживающем SSL.

  - Создать соответствующую нормам политику конфиденциальности.

  - Быть готовыми подписать договорное соглашение при предоставлении надстройки.

## <a name="administrators-privileges"></a>Администраторы: Привилегии

Модель разработки предоставляет администраторам следующие права и обязанности.

- Возможность запретить пользователям устанавливать какие-либо надстройки Outlook, в том числе надстройки из AppSource.

- Возможность отключать или включать любую надстройку Outlook в Центре администрирования Exchange.

- Применимо только к Outlook для Windows: можно переопределить параметры пороговых значений производительности с помощью параметров реестра в объекте глобальной политики.

## <a name="see-also"></a>Дополнительные ресурсы

- [Конфиденциальность и безопасность надстроек для Office](../concepts/privacy-and-security.md)
- [Элементы управления конфиденциальностью для приложений Microsoft 365](/deployoffice/privacy/overview-privacy-controls)
- [API надстроек Outlook](apis.md)
- [Ограничения для активации и API JavaScript для надстроек Outlook](limits-for-activation-and-javascript-api-for-outlook-add-ins.md)
