---
title: Конфиденциальность, разрешения и безопасность для надстроек Outlook
description: Узнайте, как управлять конфиденциальностью, разрешениями и безопасностью в надстройке Outlook.
ms.date: 10/07/2022
ms.localizationpriority: high
ms.openlocfilehash: 560c9bbdfcde849b66d86e9c000d78f094b3e561
ms.sourcegitcommit: a2df9538b3deb32ae3060ecb09da15f5a3d6cb8d
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/12/2022
ms.locfileid: "68541256"
---
# <a name="privacy-permissions-and-security-for-outlook-add-ins"></a>Конфиденциальность, разрешения и безопасность для надстроек Outlook

Пользователи, разработчики и администраторы могут использовать уровни разрешений модели безопасности для надстроек Outlook, чтобы управлять конфиденциальностью и производительностью.

В этой статье описаны разрешения, которые могут запрашивать надстройки Outlook, и рассматривается модель безопасности с различных точек зрения.

- **AppSource**: Целостность надстройки

- **Пользователи**: Вопросы, связанные с конфиденциальностью и производительностью

- **Разработчики**: Варианты разрешений и ограничения на использование ресурсов

- **Администраторы**: Разрешения на определение пороговых значений производительности

## <a name="permissions-model"></a>Модель разрешений

Because customers' perception of add-in security can affect add-in adoption, Outlook add-in security relies on a tiered permissions model. An Outlook add-in would disclose the level of permissions it needs, identifying the possible access and actions that the add-in can make on the customer's mailbox data.

Существует четыре уровня разрешений.

[!include[Table of Outlook permissions](../includes/outlook-permission-levels-table.md)]

Четыре уровня разрешений являются накопительными: разрешение **на чтение и запись в почтовом ящике** включает в себя разрешения **на чтение и запись элемента**, **на чтение элемента** и **на ограниченный доступ**; разрешение **на чтение и запись элемента** включает в себя разрешения **на чтение элемента** и **на ограниченный доступ**; разрешение **на чтение элемента** включает в себя разрешение **на ограниченный доступ**.

На рисунке ниже показано четыре уровня разрешений и описаны возможности, обеспечиваемые каждым уровнем для пользователей, разработчиков и администраторов. Дополнительные сведения об этих разрешениях см. в статьях [Пользователи: вопросы, связанные с конфиденциальностью и производительностью](#end-users-privacy-and-performance-concerns), [Разработчики: варианты разрешений и ограничения на использование ресурсов](#developers-permission-choices-and-resource-usage-limits) и [Общие сведения о разрешениях для надстроек Outlook](understanding-outlook-add-in-permissions.md).

**Сопоставление четырехуровневой модели разрешений с пользователями, разработчиками и администраторами**

![Схема четырехуровневой модели разрешений для схемы почтовых приложений версии 1.1.](../images/add-in-permission-tiers.png)

## <a name="appsource-add-in-integrity"></a>AppSource: Целостность надстройки

[AppSource](https://appsource.microsoft.com) содержит надстройки, которые могут установить пользователи и администраторы. AppSource применяет указанные ниже меры для поддержки целостности надстроек Outlook.

- Требуется постоянное использование сервером, на котором размещена надстройка, протокола SSL для связи.

- Разработчику требуется предоставить доказательство подлинности, контрактное соглашение и соответствующую требованиям политику конфиденциальности для отправки надстроек.

- Архивация надстроек осуществляется только в режиме для чтения.

- Поддерживается система рецензий пользователей для доступных надстроек, чтобы стимулировать формирование саморегулирующегося сообщества.

## <a name="optional-connected-experiences"></a>Необязательные сетевые функции.

Конечные пользователи и ИТ-администраторы могут отключать [дополнительные возможности подключения в Office](/deployoffice/privacy/optional-connected-experiences) для клиентов рабочего стола и мобильных клиентов. Для надстроек Outlook влияние отключения параметра "Необязательные сетевые функции" зависит от клиента, но обычно это означает, что установленные пользователем надстройки и доступ к Магазину Office запрещены. Надстройки, развернутые ИТ-администратором организации с помощью [централизованного развертывания](/microsoft-365/admin/manage/centralized-deployment-of-add-ins), по-прежнему будут доступны.

- Windows\*, Mac: кнопка **"** Получить надстройки" не отображается, поэтому пользователи больше не могут управлять надстройки и получать доступ к Магазину Office.
- Android, iOS: в диалоговом окне **Получить надстройки** отображаются только надстройки, развернутые администратором.
- Браузер: доступность надстроек и доступ к магазину остаются без изменения, поэтому пользователи могут продолжать [управлять своими надстройками](https://support.microsoft.com/office/8f2ce816-5df4-44a5-958c-f7f9d6dabdce), в том числе развернутыми администратором.

  > [!NOTE]
  > \* Для Windows поддержка этого интерфейса и поведения доступна в версии 2008 (сборка 13127.20296). Дополнительные сведения относительно вашей версии см. на странице журнала обновлений для [Microsoft 365](/officeupdates/update-history-office365-proplus-by-date) и в статье [Поиск версии клиента Office и канала обновления](https://support.microsoft.com/office/932788b8-a3ce-44bf-bb09-e334518b8b19).

Общие сведения о надстройках см. в разделе [Конфиденциальность и безопасность надстроек для Office](../concepts/privacy-and-security.md#optional-connected-experiences).

## <a name="end-users-privacy-and-performance-concerns"></a>Конечные пользователи: Вопросы, связанные с конфиденциальностью и производительностью

Модель безопасности адресует вопросы пользователей, связанные с безопасностью, конфиденциальностью и производительностью, следующим образом.

- Сообщения конечных пользователей, защищенные службой Управления правами на доступ к данным (IRM) Outlook, не взаимодействуют с надстройки Outlook на клиентах, отличных от Windows.

[!INCLUDE [outlook-irm-add-in-activation](../includes/outlook-irm-add-in-activation.md)]

- Before installing an add-in from AppSource, end users can see the access and actions that the add-in can make on their data and must explicitly confirm to proceed. No Outlook add-in is automatically pushed onto a client computer without manual validation by the user or administrator.

- Разрешение **на ограниченный доступ** позволяет ограничить доступ надстройки Outlook только к текущему элементу. Предоставление разрешения на  чтение элемента позволяет надстройке Outlook получать доступ к личным сведениям, таким как имена отправителей и получателей и адреса электронной почты, только к текущему элементу.

- An end user can install an Outlook add-in for only himself or herself. Outlook add-ins that affect an organization are installed by an administrator.

- Пользователи могут устанавливать надстройки Outlook, которые задействуют сценарии, зависимые от контекста, что очень привлекательно для самих пользователей, но при этом также снижает риски, связанные с безопасностью.

- Защита файлов манифестов установленных надстроек Outlook обеспечивается в учетной записи электронной почты пользователя.

- Данные, которыми приложения обмениваются с серверами, на которых установлены Надстройки Office, всегда шифруются в соответствии с протоколом SSL.

- Применимо только к полнофункциональным клиентам Outlook, которые отслеживают производительность установленных надстроек Outlook, контролируют их и отключают те приложения, которые превышают ограничения по ряду следующих факторов.

  - Время отзыва для активации

  - Количество сбоев при активации или повторной активации

  - Использование памяти

  - Использование процессора  

  Governance deters denial-of-service attacks and maintains add-in performance at a reasonable level. The Business Bar alerts end users about Outlook add-ins that the Outlook rich client has disabled based on such governance control.

- В любой момент пользователи могут проверить разрешения, запрашиваемые установленными надстройками Outlook, отключить, а затем включить любую надстройку Outlook в Центре администрирования Exchange.

## <a name="developers-permission-choices-and-resource-usage-limits"></a>Разработчики: Варианты разрешений и ограничения на использование ресурсов

Модель безопасности предоставляет пользователям возможность детальной настройки разрешений, а также строгие правила производительности, которых следует придерживаться.

### <a name="tiered-permissions-increases-transparency"></a>Уровневая модель разрешений повышает прозрачность

Разработчикам рекомендуется следовать многоуровневой модели разрешений, чтобы обеспечить прозрачность и развеять сомнения пользователей по поводу доступа надстроек к их данным и почтовым ящикам, что косвенно повысит популярность надстройки.

- Разработчики запрашивают подходящий уровень разрешений для надстройки Outlook с учетом способа ее активации, а также необходимости чтения или записи определенных свойств элемента или создания и отправки элемента.

- Как отмечалось выше, разработчики запрашивают разрешение в манифесте.

  В следующем примере запрашивает разрешение **на чтение элемента** в XML-манифесте.

  ```XML
  <Permissions>ReadItem</Permissions>
  ```

  В следующем примере запрашивается разрешение **на чтение элемента** в манифесте Teams (предварительная версия).

```json
"authorization": {
  "permissions": {
    "resourceSpecific": [
      ...
      {
        "name": "MailboxItem.Read.User",
        "type": "Delegated"
      },
    ]
  }
},
```

- Разработчики могут запросить  ограниченное разрешение, если надстройка Outlook активируется для определенного типа элемента Outlook (встречи или сообщения) или для определенных извлеченных сущностей (номер телефона, адрес, URL-адрес), присутствующих в теме или тексте элемента. Например, указанное ниже правило активирует надстройку Outlook, если хотя бы одна из трех сущностей (телефонный номер, почтовый адрес или URL-адрес) найдена в теме или основном тексте текущего сообщения.

> [!NOTE]
> Правила активации, как показано в этом примере, не поддерживаются в надстройки, использующие манифест [Teams для надстроек Office (предварительная версия)](../develop/json-manifest-overview.md).

  ```XML
    <Permissions>Restricted</Permissions>
        <Rule xsi:type="RuleCollection" Mode="And">
        <Rule xsi:type="ItemIs" FormType="Read" ItemType="Message" />
        <Rule xsi:type="RuleCollection" Mode="Or">
            <Rule xsi:type="ItemHasKnownEntity" EntityType="PhoneNumber" />
            <Rule xsi:type="ItemHasKnownEntity" EntityType="Address" />
            <Rule xsi:type="ItemHasKnownEntity" EntityType="Url" />
        </Rule>
    </Rule>
  ```

- Разработчикам следует запросить разрешение  на чтение элемента, если надстройке Outlook требуется чтение свойств текущего элемента, отличного от извлеченных сущностей по умолчанию, или запись настраиваемых свойств, задаемых надстройки для текущего элемента, но не требует чтения или записи в другие элементы, а также создания или отправки сообщения в почтовом ящике пользователя. Например, разработчик должен запросить разрешение на **чтение элемента**, если надстройка должна искать такие сущности, как приглашение на собрание, предложение задачи, электронный адрес или имя контакта в теме или основном тексте элемента, или если для активации надстройки требуется регулярное выражение.

- Разработчикам следует запрашивать разрешение на **чтение и запись элемента**, если надстройка Outlook должна записывать свойства созданного элемента, например имена, электронные адреса, основной текст и тему или добавлять и удалять вложения.

- Разработчики запрашивают разрешение **чтение и запись в почтовом ящике**, только если надстройка Outlook должна выполнять одно или несколько из приведенных ниже действий с помощью метода [mailbox.makeEWSRequestAsync](/javascript/api/requirement-sets/outlook/preview-requirement-set/office.context.mailbox#methods).

  - Чтение и запись свойств элементов в почтовом ящике.
  - Создание, чтение, запись и отправка элементов в почтовом ящике.
  - Создание, чтение папок почтового ящика и запись в них.

### <a name="resource-usage-tuning"></a>Регулирование использования ресурсов

Developers should be aware of resource usage limits for activation, incorporate performance tuning in their development workflow, so as to reduce the chance of a poorly performing add-in denying service of the host. Developers should follow the guidelines in designing activation rules as described in [Limits for activation and JavaScript API for Outlook add-ins](limits-for-activation-and-javascript-api-for-outlook-add-ins.md). If an Outlook add-in is intended to run on an Outlook rich client, then developers should verify that the add-in performs within the resource usage limits.

### <a name="other-measures-to-promote-user-security"></a>Другие меры повышения безопасности пользователей

Разработчики также должны знать и учитывать следующее.

- Разработчики не могут использовать элементы ActiveX в надстройке, так как они не поддерживаются.

- При отправке надстройки Outlook в AppSource разработчикам следует.

  - Создать SSL-сертификат высокой надежности для подтверждения своей личности.

  - Разместить предоставляемую надстройку на веб-сервере, поддерживающем SSL.

  - Создать соответствующую нормам политику конфиденциальности.

  - Быть готовыми подписать договорное соглашение при предоставлении надстройки.

## <a name="administrators-privileges"></a>Администраторы: Привилегии

Модель разработки предоставляет администраторам следующие права и обязанности.

- Возможность запретить пользователям устанавливать какие-либо надстройки Outlook, в том числе надстройки из AppSource.

- Возможность отключать или включать любую надстройку Outlook в Центре администрирования Exchange.

- Применимо только к Outlook для Windows: можно переопределить параметры пороговых значений производительности с помощью параметров реестра в объекте глобальной политики.

## <a name="see-also"></a>Дополнительные ресурсы

- [Конфиденциальность и безопасность надстроек для Office](../concepts/privacy-and-security.md)
- [Элементы управления конфиденциальностью для приложений Microsoft 365](/deployoffice/privacy/overview-privacy-controls)
- [API надстроек Outlook](apis.md)
- [Ограничения для активации и API JavaScript для надстроек Outlook](limits-for-activation-and-javascript-api-for-outlook-add-ins.md)
