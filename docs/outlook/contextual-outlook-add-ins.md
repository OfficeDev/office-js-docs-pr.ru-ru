---
title: Контекстные надстройки Outlook
description: Инициируют задачи, связанные с сообщением, не выходя из самого сообщения, что обеспечивает большее удобство и богатый пользовательский опыт
ms.date: 04/09/2020
localization_priority: Normal
ms.openlocfilehash: 7898f836e431ad4446952a0f34a24d3771e51d01
ms.sourcegitcommit: 42c55a8d8e0447258393979a09f1ddb44c6be884
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/08/2021
ms.locfileid: "58937011"
---
# <a name="contextual-outlook-add-ins"></a>Контекстные надстройки Outlook

Контекстные надстройки — это надстройки Outlook, которые активируются при наличии определенного текста в сообщении или сведениях о встрече. С помощью контекстных надстроек пользователь может выполнять связанные с сообщением действия, не закрывая окно сообщения, что упрощает работу и расширяет возможности пользователя.

Ниже приводится пример контекстных надстроек.

- Чтобы открыть карту расположения, нужно выбрать адрес.
- Чтобы открыть надстройку с предложенными собраниями, нужно щелкнуть соответствующую строку.
- Чтобы добавить номер телефона в контакты, нужно его выбрать.


> [!NOTE]
> Контекстные надстройки в настоящее время недоступны в Outlook для Android и iOS, но в будущем мы добавим эту функцию.
>
> Поддержка этой функции была реализована в наборе обязательных элементов 1.6 См [клиенты и платформы](../reference/requirement-sets/outlook-api-requirement-sets.md#requirement-sets-supported-by-exchange-servers-and-outlook-clients), поддерживающие этот набор обязательных требований.

## <a name="how-to-make-a-contextual-add-in"></a>Создание контекстной надстройки

Манифест контекстной надстройки должен содержать элемент [ExtensionPoint](../reference/manifest/extensionpoint.md#detectedentity), для атрибута `xsi:type` которого задано значение `DetectedEntity`. В элементе **ExtensionPoint** надстройка задает сущности или регулярное выражение, которые могут активировать ее. Если указывается сущность, это может быть любое из свойств объекта [Entities](/javascript/api/outlook/office.entities).

Следовательно, манифест надстройки должен содержать правило типа **ItemHasKnownEntity** или **ItemHasRegularExpressionMatch**. В следующем примере показано, как указать, что надстройка должна активировать сообщения с обнаруженной сущностью, которая является номером телефона.

```XML
<ExtensionPoint xsi:type="DetectedEntity">
  <Label resid="contextLabel" />
  <!--If you opt to include RequestedHeight, it must be between 140px to 450px, inclusive.-->
  <!--<RequestedHeight>360</RequestedHeight>-->
  <SourceLocation resid="detectedEntityURL" />
  <Rule xsi:type="RuleCollection" Mode="And">
    <Rule xsi:type="ItemIs" ItemType="Message" />
    <Rule xsi:type="ItemHasKnownEntity" EntityType="PhoneNumber" Highlight="all" />
  </Rule>
</ExtensionPoint>
```

После того как контекстная надстройка будет связана с учетной записью, она будет автоматически запускаться, когда пользователь щелкает выделенный объект или регулярное выражение. Дополнительные сведения о регулярных выражениях для надстроек Outlook см. в статье [Использование правил активации на основе регулярных выражений для отображения надстройки Outlook](use-regular-expressions-to-show-an-outlook-add-in.md).

Контекстные надстройки имеют несколько ограничений:

- Контекстная надстройка может существовать только в надстройках чтения (не надстройках создания).
- Указывать цвет выделенной сущности невозможно.
- Невыделенная сущность не запускает контекстную надстройку на карточке.

Так как невыделенные сущности и регулярные выражения не запускают контекстную надстройку, такие надстройки должны включать по крайней мере один элемент `Rule`, для атрибута `Highlight` которого задано значение `all`.

> [!NOTE]
> Сущности `EmailAddress` и `Url` не поддерживают выделение, поэтому их нельзя использовать для запуска контекстной надстройки. Однако их можно объединить в правило `RuleCollection` и использовать в качестве дополнительного условия активации.

## <a name="how-to-launch-a-contextual-add-in"></a>Запуск контекстной надстройки

Пользователь запускает контекстную надстройку через текст — известную сущность или регулярное выражение разработчика. Как правило, пользователь определяет контекстную надстройку по выделенной сущности. В приведенном ниже примере показано, как выделение отображается в сообщении. Здесь сущность (адрес) окрашена в синий цвет и подчеркнута синим пунктиром. Пользователь запускает контекстную надстройку, щелкнув выделенную сущность. 

**Пример текста с выделенной сущностью (адресом)**

![Отображает выделенную сущность в электронной почте.](../images/outlook-detected-entity-highlight.png)
    
Если сообщение содержит несколько сущностей или контекстных надстроек, действует несколько правил взаимодействия:

- Если имеется несколько сущностей, нужно щелкнуть другую сущность, чтобы запустить связанную с ней надстройку.
- Если сущность активирует несколько надстроек, каждая из них открывается в новой вкладке. Пользователь может переключаться между надстройками, переходя между вкладками. Например, имя и адрес могут запускать надстройку для звонков и карту.
- Если строка содержит несколько сущностей, которые активируют несколько надстроек, выделяется вся строка. Щелкнув строку, пользователь увидит все соответствующие надстройки на отдельных вкладках. Например, строка с описанием встречи в ресторане может активировать надстройку с предложениями, касающимися собраний, и надстройку с оценкой ресторана.

## <a name="how-a-contextual-add-in-displays"></a>Отображение контекстной надстройки

Активированная контекстная надстройка отображается на карточке — отдельном окне рядом с сущностью. Как правило, карточка отображается под сущностью и, насколько это возможно, выравнивается по центру относительно нее. Если под сущностью недостаточно места, карточка отображается над ней. На приведенном ниже снимке экрана показана выделенная сущность, а под ней — активированная надстройка (Карты Bing) на карточке.

**Пример надстройки, отображаемой на карточке**

![Показывает контекстное приложение на карте.](../images/outlook-detected-entity-card.png)

Чтобы закрыть карточку и завершить работу надстройки, щелкните в любом месте за пределами карточки.

## <a name="current-contextual-add-ins"></a>Текущие контекстные надстройки

Следующие контекстные надстройки устанавливаются по умолчанию для пользователей с Outlook надстроек.

- Карты Bing
- Рекомендуемые собрания

## <a name="see-also"></a>См. также

- [Надстройка Outlook: номер заказа Contoso](https://github.com/OfficeDev/Outlook-Add-In-Contextual-Regex) (пример контекстной надстройки, которая активируется на основе соответствия регулярному выражению)
- [Написание вашей первой надстройки Outlook](../quickstarts/outlook-quickstart.md)
- [Использование правил активации на основе регулярных выражений для отображения надстройки Outlook](use-regular-expressions-to-show-an-outlook-add-in.md)
- [Объект Entities](/javascript/api/outlook/office.entities)
