---
title: Сопоставление строк как известных сущностей в надстройке Outlook
description: С помощью API JavaScript для Office можно получить строки, которые совпадают с определенными известными сущностями для дальнейшей обработки.
ms.date: 04/15/2019
localization_priority: Normal
ms.openlocfilehash: c3e9e9812118e06285b76970dae49381a73206c2
ms.sourcegitcommit: be23b68eb661015508797333915b44381dd29bdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/08/2020
ms.locfileid: "44609050"
---
# <a name="match-strings-in-an-outlook-item-as-well-known-entities"></a><span data-ttu-id="b560f-103">Сопоставление строк в элементе Outlook как известных сущностей</span><span class="sxs-lookup"><span data-stu-id="b560f-103">Match strings in an Outlook item as well-known entities</span></span>

<span data-ttu-id="b560f-p101">Прежде чем отправить сообщение или приглашение на собрание, Exchange Server анализирует содержимое элемента, определяет в теме и тексте строки, похожие на известные Exchange сущности, например адреса электронной почты, номера телефонов и URL-адреса, и добавляет соответствующие метки. Exchange Server отправляет сообщения и приглашения на собрания с помеченными известными сущностями в папку "Входящие" приложения Outlook.</span><span class="sxs-lookup"><span data-stu-id="b560f-p101">Before sending a message or meeting request item, Exchange Server parses the contents of the item, identifies and stamps certain strings in the subject and body that resemble entities well-known to Exchange, for example, email addresses, phone numbers, and URLs. Messages and meeting requests are delivered by Exchange Server in an Outlook Inbox with well-known entities stamped.</span></span> 

<span data-ttu-id="b560f-106">С помощью API JavaScript для Office можно получить эти строки, соответствующие определенным известным сущностям для дальнейшей обработки.</span><span class="sxs-lookup"><span data-stu-id="b560f-106">Using the Office JavaScript API, you can get these strings that match specific well-known entities for further processing.</span></span> <span data-ttu-id="b560f-107">Известную сущность также можно указать в правиле в манифесте надстройки, чтобы программа Outlook смогла активировать надстройку, когда пользователь просматривает элемент, который содержит совпадения с этой сущностью.</span><span class="sxs-lookup"><span data-stu-id="b560f-107">You can also specify a well-known entity in a rule in the add-in manifest so that Outlook can activate your add-in when the user is viewing an item that contains matches for that entity.</span></span> <span data-ttu-id="b560f-108">Затем вы можете извлечь и обработать совпадения с этой сущностью.</span><span class="sxs-lookup"><span data-stu-id="b560f-108">You can then extract and take action on matches for the entity.</span></span> 

<span data-ttu-id="b560f-109">Возможность найти или извлечь такие экземпляры из выбранного сообщения или встречи очень полезна.</span><span class="sxs-lookup"><span data-stu-id="b560f-109">Being able to identify or extract such instances from a selected message or appointment is convenient.</span></span> <span data-ttu-id="b560f-110">Например, вы можете создавать сервис обратного просмотра телефона как надстройку Outlook.</span><span class="sxs-lookup"><span data-stu-id="b560f-110">For example, you can build a reverse phone look-up service as an Outlook add-in.</span></span> <span data-ttu-id="b560f-111">Надстройка может извлекать строки в теме или основном тексте элемента, которые напоминают номер телефона, выполнять обратный поиск, а также отображать зарегистрированного владельца каждого номера телефона.</span><span class="sxs-lookup"><span data-stu-id="b560f-111">The add-in can extract strings in the item subject or body that resemble a phone number, do a reverse lookup, and display the registered owner of each phone number.</span></span>

<span data-ttu-id="b560f-112">В этой статье приводятся общие сведения об этих известных сущностях, приводятся примеры основанных на них правил активации, а также описывается, как извлекать совпадения с сущностями независимо от того, используются ли они в правилах активации.</span><span class="sxs-lookup"><span data-stu-id="b560f-112">This topic introduces these well-known entities, shows examples of activation rules based on well-known entities, and how to extract entity matches independently of having used entities in activation rules.</span></span>


## <a name="support-for-well-known-entities"></a><span data-ttu-id="b560f-113">Поддержка известных сущностей</span><span class="sxs-lookup"><span data-stu-id="b560f-113">Support for well-known entities</span></span>

<span data-ttu-id="b560f-p104">После отправки элемента и до его доставки получателю Exchange Server добавляет метки к известным сущностям в сообщении или приглашении на собрание. Поэтому метки добавляются только к тем элементам, которые транспортировались через Exchange, и приложение Outlook может активировать надстройки на основе этих меток, когда пользователь просматривает такие элементы. С другой стороны, когда пользователь создает или просматривает в папке "Отправленные" элемент, который не прошел процесс транспортировки, Outlook не может активировать надстройки на основе известных сущностей.</span><span class="sxs-lookup"><span data-stu-id="b560f-p104">Exchange Server stamps well-known entities in a message or meeting request item after the sender sends the item and before Exchange delivers the item to the recipient. Therefore, only items that have gone through transport in Exchange are stamped, and Outlook can activate add-ins based on these stamps when the user is viewing such items. On the contrary, when the user is composing an item or viewing an item that is in the Sent Items folder, because the item has not gone through transport, Outlook cannot activate add-ins based on well-known entities.</span></span> 

<span data-ttu-id="b560f-p105">По этой же причине невозможно извлечь известные сущности из элементов, которые создаются или находятся в папке "Отправленные", так как эти элементы не прошли процесс транспортировки и не содержат метки. Дополнительные сведения о типах элементов, которые поддерживают активацию, см. в статье [Правила активации надстроек Outlook](activation-rules.md).</span><span class="sxs-lookup"><span data-stu-id="b560f-p105">Similarly, you cannot extract well-known entities in items that are being composed or in the Sent Items folder, as these items have not gone through transport and are not stamped. For additional information about the kinds of items that support activation, see [Activation rules for Outlook add-ins](activation-rules.md).</span></span>

<span data-ttu-id="b560f-p106">В следующей таблице перечислены сущности, которые поддерживаются и распознаются приложениями Exchange Server и Outlook (отсюда и название "известные сущности"), а также типы экземпляров каждой сущности. Распознавание строки в качестве одной из этих сущностей основано на модели обучения восприятию естественного языка, выработанной путем анализа большого объема данных. Поэтому распознавание является недетерминированным. Дополнительные сведения об условиях распознавания см. в статье [Советы по использованию известных сущностей](#tips-for-using-well-known-entities).</span><span class="sxs-lookup"><span data-stu-id="b560f-p106">The following table lists the entities that Exchange Server and Outlook support and recognize (hence the name "well-known entities"), and the object type of an instance of each entity. The natural language recognition of a string as one of these entities is based on a learning model that has been trained on a large amount of data. Therefore, the recognition is non-deterministic. See [Tips for using well-known entities](#tips-for-using-well-known-entities) for more information about conditions for recognition.</span></span>

<span data-ttu-id="b560f-123">**Таблица 1. Поддерживаемые сущности и их типы**</span><span class="sxs-lookup"><span data-stu-id="b560f-123">**Table 1. Supported entities and their types**</span></span>

|<span data-ttu-id="b560f-124">Тип сущности</span><span class="sxs-lookup"><span data-stu-id="b560f-124">Entity type</span></span>|<span data-ttu-id="b560f-125">Условия для распознавания</span><span class="sxs-lookup"><span data-stu-id="b560f-125">Conditions for recognition</span></span>|<span data-ttu-id="b560f-126">Тип объекта</span><span class="sxs-lookup"><span data-stu-id="b560f-126">Object type</span></span>|
|:-----|:-----|:-----|
|<span data-ttu-id="b560f-127">**Адрес**</span><span class="sxs-lookup"><span data-stu-id="b560f-127">**Address**</span></span>|<span data-ttu-id="b560f-p107">Адреса в Соединенных Штатах, например: 1234 Main Street, Redmond, WA 07722. В целом, чтобы адрес был распознан, он должен соответствовать структуре почтовых адресов в Соединенных Штатах с присутствием большинства элементов, таких как номер дома, название улицы, города, штата и почтовый индекс. Адрес можно указать в одной или нескольких строках.</span><span class="sxs-lookup"><span data-stu-id="b560f-p107">United States street addresses; for example: 1234 Main Street, Redmond, WA 07722. Generally, for an address to be recognized, it should follow the structure of a United States postal address, with most of the elements of a street number, street name, city, state, and zip code present. The address can be specified in one or multiple lines.</span></span>|<span data-ttu-id="b560f-131">Объект JavaScript **String**</span><span class="sxs-lookup"><span data-stu-id="b560f-131">JavaScript **String** object</span></span>|
|<span data-ttu-id="b560f-132">**Контакт**</span><span class="sxs-lookup"><span data-stu-id="b560f-132">**Contact**</span></span>|<span data-ttu-id="b560f-133">Ссылки на сведения о человеке распознаются на естественном языке.</span><span class="sxs-lookup"><span data-stu-id="b560f-133">A reference to a person's information as recognized in natural language.</span></span> <span data-ttu-id="b560f-134">Распознавание контакта зависит от контекста.</span><span class="sxs-lookup"><span data-stu-id="b560f-134">The recognition of a contact depends on the context.</span></span> <span data-ttu-id="b560f-135">Например, подпись в конце сообщения или имя человека появляются в непосредственной близости от таких сведений, как номер телефона, адрес, адрес эл. почты и URL-адрес.</span><span class="sxs-lookup"><span data-stu-id="b560f-135">For example, a signature at the end of a message, or a person's name appearing in the vicinity of some of the following information: a phone number, address, email address, and URL.</span></span>|<span data-ttu-id="b560f-136">[Объект ](/javascript/api/outlook/office.contact)Contact</span><span class="sxs-lookup"><span data-stu-id="b560f-136">[Contact](/javascript/api/outlook/office.contact) object</span></span>|
|<span data-ttu-id="b560f-137">**EmailAddress**</span><span class="sxs-lookup"><span data-stu-id="b560f-137">**EmailAddress**</span></span>|<span data-ttu-id="b560f-138">SMTP-адреса электронной почты.</span><span class="sxs-lookup"><span data-stu-id="b560f-138">SMTP email addresses.</span></span>|<span data-ttu-id="b560f-139">`String`Объект JavaScript</span><span class="sxs-lookup"><span data-stu-id="b560f-139">JavaScript `String` object</span></span>|
|<span data-ttu-id="b560f-140">**MeetingSuggestion**</span><span class="sxs-lookup"><span data-stu-id="b560f-140">**MeetingSuggestion**</span></span>|<span data-ttu-id="b560f-p109">Ссылка на событие или собрание. Например, Exchange 2013 распознает следующий текст как приглашение на собрание: _Let's meet tomorrow for lunch (Встретимся завтра за обедом)._</span><span class="sxs-lookup"><span data-stu-id="b560f-p109">A reference to an event or meeting. For example, Exchange 2013 would recognize the following text as a meeting suggestion:  _Let's meet tomorrow for lunch._</span></span>|<span data-ttu-id="b560f-143">[Объект ](/javascript/api/outlook/office.meetingsuggestion)MeetingSuggestion</span><span class="sxs-lookup"><span data-stu-id="b560f-143">[MeetingSuggestion](/javascript/api/outlook/office.meetingsuggestion) object</span></span>|
|<span data-ttu-id="b560f-144">**PhoneNumber**</span><span class="sxs-lookup"><span data-stu-id="b560f-144">**PhoneNumber**</span></span>|<span data-ttu-id="b560f-145">Телефонные номера в США, например: _(235) 555-0110._</span><span class="sxs-lookup"><span data-stu-id="b560f-145">United States telephone numbers; for example:  _(235) 555-0110_</span></span>|<span data-ttu-id="b560f-146">[Объект](/javascript/api/outlook/office.phonenumber)PhoneNumber</span><span class="sxs-lookup"><span data-stu-id="b560f-146">[PhoneNumber](/javascript/api/outlook/office.phonenumber) object</span></span>|
|<span data-ttu-id="b560f-147">**TaskSuggestion**</span><span class="sxs-lookup"><span data-stu-id="b560f-147">**TaskSuggestion**</span></span>|<span data-ttu-id="b560f-p110">Предложения в сообщении эл. почты, являющиеся призывами к действию. Например: _Please update the spreadsheet (Просьба обновить таблицу)._</span><span class="sxs-lookup"><span data-stu-id="b560f-p110">Actionable sentences in an email. For example:  _Please update the spreadsheet._</span></span>|<span data-ttu-id="b560f-150">[Объект ](/javascript/api/outlook/office.tasksuggestion)TaskSuggestion</span><span class="sxs-lookup"><span data-stu-id="b560f-150">[TaskSuggestion](/javascript/api/outlook/office.tasksuggestion) object</span></span>|
|<span data-ttu-id="b560f-151">**Url**</span><span class="sxs-lookup"><span data-stu-id="b560f-151">**Url**</span></span>|<span data-ttu-id="b560f-152">Веб-адрес, который в явной форме указывает сетевое расположение и идентификатор веб-ресурса.</span><span class="sxs-lookup"><span data-stu-id="b560f-152">A web address that explicitly specifies the network location and identifier for a web resource.</span></span> <span data-ttu-id="b560f-153">Exchange Server не требует протокола доступа в веб-адресе и не распознает URL-адреса, внедренные в текст ссылки в качестве экземпляров `Url` сущности.</span><span class="sxs-lookup"><span data-stu-id="b560f-153">Exchange Server does not require the access protocol in the web address, and does not recognize URLs that are embedded in link text as instances of the `Url` entity.</span></span> <span data-ttu-id="b560f-154">Exchange Server может быть сопоставлен следующим примерам: `www.youtube.com/user/officevideos``https://www.youtube.com/user/officevideos`</span><span class="sxs-lookup"><span data-stu-id="b560f-154">Exchange Server can match the following examples: `www.youtube.com/user/officevideos` `https://www.youtube.com/user/officevideos`</span></span> |<span data-ttu-id="b560f-155">`String`Объект JavaScript</span><span class="sxs-lookup"><span data-stu-id="b560f-155">JavaScript `String` object</span></span>|

<br/>

<span data-ttu-id="b560f-p112">На рисунке ниже показано, как Exchange Server и Outlook поддерживают известные сущности для надстроек, а также действия, которые надстройки могут совершать с ними. Дополнительные сведения см. в разделах [Получение сущностей в надстройке](#retrieving-entities-in-your-add-in) и [Активация надстройки в зависимости от наличия сущности](#activating-an-add-in-based-on-the-existence-of-an-entity).</span><span class="sxs-lookup"><span data-stu-id="b560f-p112">The following figure describes how Exchange Server and Outlook support well-known entities for add-ins, and what add-ins can do with well-known entities. See [Retrieving entities in your add-in](#retrieving-entities-in-your-add-in) and [Activating an add-in based on the existence of an entity](#activating-an-add-in-based-on-the-existence-of-an-entity) for more details on how to use these entities.</span></span>

<span data-ttu-id="b560f-158">**Поддержка известных сущностей в Exchange Server, Outlook и надстройках**</span><span class="sxs-lookup"><span data-stu-id="b560f-158">**How Exchange Server, Outlook, and add-ins support well-known entities**</span></span>

![Поддержка и использование известных сущностей в почтовом приложении](../images/well-known-entities-info.png)


## <a name="permissions-to-extract-entities"></a><span data-ttu-id="b560f-160">Разрешения на извлечение сущностей</span><span class="sxs-lookup"><span data-stu-id="b560f-160">Permissions to extract entities</span></span>

<span data-ttu-id="b560f-161">Чтобы извлечь сущности в коде JavaScript или активировать надстройку в зависимости от наличия определенных известных сущностей, запросите нужные разрешения в манифесте приложения.</span><span class="sxs-lookup"><span data-stu-id="b560f-161">To extract entities in your JavaScript code or to have your add-in activated based on the existence of certain well-known entities, make sure you have requested the appropriate permissions in the add-in manifest.</span></span>

<span data-ttu-id="b560f-162">Задание ограниченного разрешения по умолчанию позволяет надстройке извлекать `Address` объект, `MeetingSuggestion` или `TaskSuggestion` сущность.</span><span class="sxs-lookup"><span data-stu-id="b560f-162">Specifying the default restricted permission allows your add-in to extract the `Address`, `MeetingSuggestion`, or `TaskSuggestion` entity.</span></span> <span data-ttu-id="b560f-163">Для извлечения любой другой сущности укажите чтение элемента, чтение и запись элемента или разрешение на чтение и запись для почтового ящика.</span><span class="sxs-lookup"><span data-stu-id="b560f-163">To extract any of the other entities, specify read item, read/write item, or read/write mailbox permission.</span></span> <span data-ttu-id="b560f-164">Чтобы сделать это в манифесте, используйте элемент [Permissions](../reference/manifest/permissions.md) и укажите соответствующее разрешение&mdash;**Restricted**, **ReadItem**, **ReadWriteItem** или **ReadWriteMailbox**&mdash;, как в следующем примере:</span><span class="sxs-lookup"><span data-stu-id="b560f-164">To do that in the manifest, use the [Permissions](../reference/manifest/permissions.md) element and specify the appropriate permission&mdash;**Restricted**, **ReadItem**, **ReadWriteItem**, or **ReadWriteMailbox**&mdash;as in the following example:</span></span>

```xml
<Permissions>ReadItem</Permissions>
```


## <a name="retrieving-entities-in-your-add-in"></a><span data-ttu-id="b560f-165">Получение сущностей в надстройке</span><span class="sxs-lookup"><span data-stu-id="b560f-165">Retrieving entities in your add-in</span></span>

<span data-ttu-id="b560f-166">Если тема или текст элемента, которые просматривает пользователь, содержат строки, которые Exchange и Outlook могут распознать как известные сущности, то эти экземпляры будут доступны надстройке, даже если она была активирована без использования известных сущностей.</span><span class="sxs-lookup"><span data-stu-id="b560f-166">As long as the subject or body of the item that is being viewed by the user contains strings that Exchange and Outlook can recognize as well-known entities, these instances are available to add-ins. They are available even if an add-in is not activated based on well-known entities.</span></span> <span data-ttu-id="b560f-167">С соответствующим разрешением можно использовать `getEntities` `getEntitiesByType` метод или для получения известных сущностей, присутствующих в текущем сообщении или встрече.</span><span class="sxs-lookup"><span data-stu-id="b560f-167">With the appropriate permission, you can use the `getEntities` or `getEntitiesByType` method to retrieve well-known entities that are present in the current message or appointment.</span></span>

<span data-ttu-id="b560f-168">`getEntities`Метод возвращает массив объектов [Entities](/javascript/api/outlook/office.entities) , который содержит все известные сущности элемента.</span><span class="sxs-lookup"><span data-stu-id="b560f-168">The `getEntities` method returns an array of [Entities](/javascript/api/outlook/office.entities) objects that contains all the well-known entities in the item.</span></span>

<span data-ttu-id="b560f-169">Если вы заинтересованы в определенном типе сущностей, используйте метод, `getEntitiesByType` возвращающий массив только нужных объектов.</span><span class="sxs-lookup"><span data-stu-id="b560f-169">If you're interested in a particular type of entities, use the `getEntitiesByType`method which returns an array of only the entities you want.</span></span> <span data-ttu-id="b560f-170">Перечисление [EntityType](/javascript/api/outlook/office.mailboxenums.entitytype) представляет все типы известных сущностей, которые можно извлечь.</span><span class="sxs-lookup"><span data-stu-id="b560f-170">The [EntityType](/javascript/api/outlook/office.mailboxenums.entitytype) enumeration represents all the types of well-known entities you can extract.</span></span>

<span data-ttu-id="b560f-171">После вызова `getEntities` можно использовать соответствующее свойство `Entities` объекта, чтобы получить массив экземпляров типа сущности.</span><span class="sxs-lookup"><span data-stu-id="b560f-171">After calling `getEntities`, you can then use the corresponding property of the `Entities` object to obtain an array of instances of a type of entity.</span></span> <span data-ttu-id="b560f-172">В зависимости от типа сущности экземпляры в массиве могут быть просто строками или могут сопоставляться с конкретными объектами.</span><span class="sxs-lookup"><span data-stu-id="b560f-172">Depending on the type of entity, the instances in the array can be just strings, or can map to specific objects.</span></span> 

<span data-ttu-id="b560f-173">Как показано в примере на рисунке выше, чтобы получить адреса в элементе, получите доступ к массиву, возвращенному с помощью `getEntities().addresses[]`.</span><span class="sxs-lookup"><span data-stu-id="b560f-173">As an example seen in the earlier figure, to get addresses in the item, access the array returned by `getEntities().addresses[]`.</span></span> <span data-ttu-id="b560f-174">`Entities.addresses`Свойство возвращает массив строк, которые Outlook распознает как почтовые адреса.</span><span class="sxs-lookup"><span data-stu-id="b560f-174">The `Entities.addresses` property returns an array of strings that Outlook recognizes as postal addresses.</span></span> <span data-ttu-id="b560f-175">Аналогично, `Entities.contacts` свойство возвращает массив `Contact` объектов, которые Outlook распознает как контактные данные.</span><span class="sxs-lookup"><span data-stu-id="b560f-175">Similarly, the `Entities.contacts` property returns an array of `Contact` objects that Outlook recognizes as contact information.</span></span> <span data-ttu-id="b560f-176">В таблице 1 приведен список типов объектов экземпляра каждой поддерживаемой сущности.</span><span class="sxs-lookup"><span data-stu-id="b560f-176">Tables 1 lists the object type of an instance of each supported entity.</span></span>

<span data-ttu-id="b560f-177">В следующем примере показано, как получить любые адреса, найденные в сообщении.</span><span class="sxs-lookup"><span data-stu-id="b560f-177">The following example shows how to retrieve any addresses found in a message.</span></span>

```js
// Get the address entities from the item.
var entities = Office.context.mailbox.item.getEntities();
// Check to make sure that address entities are present.
if (null != entities && null != entities.addresses && undefined != entities.addresses) {
   //Addresses are present, so use them here.
}

```


## <a name="activating-an-add-in-based-on-the-existence-of-an-entity"></a><span data-ttu-id="b560f-178">Активация надстройки в зависимости от наличия сущности</span><span class="sxs-lookup"><span data-stu-id="b560f-178">Activating an add-in based on the existence of an entity</span></span>

<span data-ttu-id="b560f-179">Другой способ использовать известные сущности — активировать надстройку Outlook в зависимости от наличия одного или нескольких типов сущностей в теме или тексте элемента, который вы просматриваете в данный момент.</span><span class="sxs-lookup"><span data-stu-id="b560f-179">Another way to use well-known entities is to have Outlook activate your add-in based on the existence of one or more types of entities in the subject or body of the currently viewed item.</span></span> <span data-ttu-id="b560f-180">Это можно сделать, указав `ItemHasKnownEntity` правило в манифесте надстройки.</span><span class="sxs-lookup"><span data-stu-id="b560f-180">You can do so by specifying an `ItemHasKnownEntity` rule in the add-in manifest.</span></span> <span data-ttu-id="b560f-181">Простой тип [EntityType](/javascript/api/outlook/office.mailboxenums.entitytype) представляет различные типы известных сущностей, которые поддерживаются `ItemHasKnownEntity` правилами.</span><span class="sxs-lookup"><span data-stu-id="b560f-181">The [EntityType](/javascript/api/outlook/office.mailboxenums.entitytype) simple type represents the different types of well-known entities supported by `ItemHasKnownEntity` rules.</span></span> <span data-ttu-id="b560f-182">После активации надстройки вы также сможете получить экземпляры таких сущностей для ваших целей, как описано в предыдущем разделе [Получение сущностей в надстройке](#retrieving-entities-in-your-add-in).</span><span class="sxs-lookup"><span data-stu-id="b560f-182">After your add-in is activated, you can also retrieve the instances of such entities for your purposes, as described in the previous section [Retrieving entities in your add-in](#retrieving-entities-in-your-add-in).</span></span>

<span data-ttu-id="b560f-183">При необходимости можно применить регулярное выражение в `ItemHasKnownEntity` правиле, чтобы при дальнейшем отфильтровать экземпляры сущности и позволить Outlook активировать надстройку только на подмножестве экземпляров сущности.</span><span class="sxs-lookup"><span data-stu-id="b560f-183">You can optionally apply a regular expression in an `ItemHasKnownEntity` rule, so as to further filter instances of an entity and have Outlook activate an add-in only on a subset of the instances of the entity.</span></span> <span data-ttu-id="b560f-184">Например, можно указать сущность адреса в сообщении, содержащем почтовый индекс штата Вашингтон, который начинается с "98".</span><span class="sxs-lookup"><span data-stu-id="b560f-184">For example, you can specify a filter for the street address entity in a message that contains a Washington state zip code beginning with "98".</span></span> <span data-ttu-id="b560f-185">Чтобы применить фильтр к экземплярам сущностей, используйте `RegExFilter` атрибуты и `FilterName` в `Rule` элементе типа [ItemHasKnownEntity](../reference/manifest/rule.md#itemhasknownentity-rule) .</span><span class="sxs-lookup"><span data-stu-id="b560f-185">To apply a filter on the entity instances, use the `RegExFilter` and `FilterName` attributes in the `Rule` element of the [ItemHasKnownEntity](../reference/manifest/rule.md#itemhasknownentity-rule) type.</span></span>

<span data-ttu-id="b560f-186">Как и для других правил активации, можно указать несколько правил, составляющих коллекцию для вашей надстройки.</span><span class="sxs-lookup"><span data-stu-id="b560f-186">Similar to other activation rules, you can specify multiple rules to form a rule collection for your add-in.</span></span> <span data-ttu-id="b560f-187">В следующем примере применяется операция "и" для 2 правил: `ItemIs` правило и `ItemHasKnownEntity` правило.</span><span class="sxs-lookup"><span data-stu-id="b560f-187">The following example applies an "AND" operation on 2 rules: an `ItemIs` rule and an `ItemHasKnownEntity` rule.</span></span> <span data-ttu-id="b560f-188">Эта коллекция правил активирует надстройку, если текущий элемент является сообщением и Outlook распознает адрес в теме или тексте элемента.</span><span class="sxs-lookup"><span data-stu-id="b560f-188">This rule collection activates the add-in whenever the current item is a message and Outlook recognizes an address in the subject or body of that item.</span></span>

```XML
<Rule xsi:type="RuleCollection" Mode="And">
   <Rule xsi:type="ItemIs" ItemType="Message" />
   <Rule xsi:type="ItemHasKnownEntity" EntityType="Address" />
</Rule>
```

<br/>

<span data-ttu-id="b560f-189">В следующем примере используется `getEntitiesByType` текущий элемент, чтобы задать `addresses` для переменной результаты предыдущего набора правил.</span><span class="sxs-lookup"><span data-stu-id="b560f-189">The following example uses `getEntitiesByType` of the current item to set a variable `addresses` to the results of the preceding rule collection.</span></span>

```js
var addresses = Office.context.mailbox.item.getEntitiesByType(Office.MailboxEnums.EntityType.Address);
```

<br/>

<span data-ttu-id="b560f-190">Следующий `ItemHasKnownEntity` Пример правила активирует надстройку, когда в теме или тексте текущего элемента есть URL-адрес, а URL-адрес содержит строку "YouTube" независимо от регистра строки.</span><span class="sxs-lookup"><span data-stu-id="b560f-190">The following `ItemHasKnownEntity` rule example activates the add-in whenever there is a URL in the subject or body of the current item, and the URL contains the string "youtube", regardless of the case of the string.</span></span>

```XML
<Rule xsi:type="ItemHasKnownEntity" 
    EntityType="Url" 
    RegExFilter="youtube"
    FilterName="youtube"
    IgnoreCase="true"/>
```

<br/>

<span data-ttu-id="b560f-191">В приведенном ниже примере показано использование `getFilteredEntitiesByName(name)` текущего элемента для задания переменной `videos` для получения массива результатов, которые совпадают с регулярным выражением предыдущего `ItemHasKnownEntity` правила.</span><span class="sxs-lookup"><span data-stu-id="b560f-191">The following example uses `getFilteredEntitiesByName(name)` of the current item to set a variable `videos` to get an array of results that match the regular expression in the preceding `ItemHasKnownEntity` rule.</span></span>

```js
var videos = Office.context.mailbox.item.getFilteredEntitiesByName(youtube);
```


## <a name="tips-for-using-well-known-entities"></a><span data-ttu-id="b560f-192">Советы по использованию известных сущностей</span><span class="sxs-lookup"><span data-stu-id="b560f-192">Tips for using well-known entities</span></span>

<span data-ttu-id="b560f-193">Необходимо помнить о некоторых аспектах и ограничениях при использовании известных сущностей в надстройке.</span><span class="sxs-lookup"><span data-stu-id="b560f-193">There are a few facts and limits you should be aware of if you use well-known entities in your add-in.</span></span> <span data-ttu-id="b560f-194">Следующие действия применяются, если надстройка активируется, когда пользователь просматривает элемент, который содержит совпадения известных сущностей, независимо от того, используется ли `ItemHasKnownEntity` правило:</span><span class="sxs-lookup"><span data-stu-id="b560f-194">The following applies as long as your add-in is activated when the user is reading an item which contains matches of well-known entities, regardless of whether you use an `ItemHasKnownEntity` rule:</span></span>


- <span data-ttu-id="b560f-195">Вы можете извлечь строки, представляющие известные сущности, только если они на английском языке.</span><span class="sxs-lookup"><span data-stu-id="b560f-195">You can extract strings that are well-known entities only if the strings are in English.</span></span>
    
- <span data-ttu-id="b560f-196">Вы можете извлечь известные сущности только из первых 2000 символов в тексте элемента.</span><span class="sxs-lookup"><span data-stu-id="b560f-196">You can extract well-known entities from the first 2,000 characters in the item body, but not beyond that limit.</span></span> <span data-ttu-id="b560f-197">Это помогает сбалансировать функциональность и производительность, чтобы Exchange Server и Outlook не тратили слишком много ресурсов на анализ и поиск экземпляров известных сущностей в крупных сообщениях и встречах.</span><span class="sxs-lookup"><span data-stu-id="b560f-197">This size limit helps balance the need for functionality and performance, so that Exchange Server and Outlook are not bogged down by parsing and identifying instances of well-known entities in large messages and appointments.</span></span> <span data-ttu-id="b560f-198">Обратите внимание, что это предельное значение не зависит от того, указывает ли надстройка `ItemHasKnownEntity` правило.</span><span class="sxs-lookup"><span data-stu-id="b560f-198">Note that this limit is independent of whether the add-in specifies an `ItemHasKnownEntity` rule.</span></span> <span data-ttu-id="b560f-199">Если она использует такое правило, обратите внимание на предел обработки правил в элементе 2 ниже для полнофункционального клиента Outlook.</span><span class="sxs-lookup"><span data-stu-id="b560f-199">If the add-in does use such a rule, note also the rule processing limit in item 2 below for the Outlook rich clients.</span></span>
    
- <span data-ttu-id="b560f-p123">Вы можете извлекать сущности из встреч — собраний, организованных не владельцем почтового ящика. Нельзя извлекать сущности из элементов календарей, которые не являются собраниями, или собраний, организованных владельцем почтового ящика.</span><span class="sxs-lookup"><span data-stu-id="b560f-p123">You can extract entities from appointments that are meetings organized by someone other than the mailbox owner. You cannot extract entities from calendar items that are not meetings, or meetings organized by the mailbox owner.</span></span>
    
- <span data-ttu-id="b560f-202">Вы можете извлекать сущности `MeetingSuggestion` типа только из сообщений, но не встреч.</span><span class="sxs-lookup"><span data-stu-id="b560f-202">You can extract entities of the `MeetingSuggestion` type from only messages but not appointments.</span></span>
    
- <span data-ttu-id="b560f-203">Вы можете извлекать URL-адреса, явно указанные в теле элемента, но не URL-адреса, встроенные в текст гиперссылок в HTML-элементе.</span><span class="sxs-lookup"><span data-stu-id="b560f-203">You can extract URLs that exist explicitly in the item body, but not URLs that are embedded in hyperlinked text in HTML item body.</span></span> <span data-ttu-id="b560f-204">Рассмотрите возможность использования `ItemHasRegularExpressionMatch` правила для получения явных и внедренных URL-адресов.</span><span class="sxs-lookup"><span data-stu-id="b560f-204">Consider using an `ItemHasRegularExpressionMatch` rule instead to get both explicit and embedded URLs.</span></span> <span data-ttu-id="b560f-205">Укажите в `BodyAsHTML` качестве _PropertyName_и регулярное выражение, которое соответствует URL-адресам в качестве _RegExValue_.</span><span class="sxs-lookup"><span data-stu-id="b560f-205">Specify `BodyAsHTML` as the _PropertyName_, and a regular expression that matches URLs as the  _RegExValue_.</span></span>
    
- <span data-ttu-id="b560f-206">Невозможно извлечь сущности из элементов в папке "Отправленные".</span><span class="sxs-lookup"><span data-stu-id="b560f-206">You cannot extract entities from items in the Sent Items folder.</span></span>
    
<span data-ttu-id="b560f-207">Кроме того, если вы используете правило [ItemHasKnownEntity](../reference/manifest/rule.md#itemhasknownentity-rule), применяются следующие условия, которые могут повлиять на ситуации, связанные с активацией надстройки:</span><span class="sxs-lookup"><span data-stu-id="b560f-207">In addition, the following applies if you use an [ItemHasKnownEntity](../reference/manifest/rule.md#itemhasknownentity-rule) rule, and may affect the scenarios where you'd otherwise expect your add-in to be activated:</span></span>

- <span data-ttu-id="b560f-208">При использовании этого `ItemHasKnownEntity` правила предполагается, что Outlook будет сопоставлять строки сущностей только на английском языке независимо от языкового стандарта по умолчанию, указанного в манифесте.</span><span class="sxs-lookup"><span data-stu-id="b560f-208">When using the `ItemHasKnownEntity` rule, expect Outlook to match entity strings in only English regardless of the default locale specified in the manifest.</span></span>
    
- <span data-ttu-id="b560f-209">Когда надстройка работает в полнофункциональном клиенте Outlook, приложение Outlook должно применить `ItemHasKnownEntity` правило к первому мегабайту тела элемента, а не к остальному тексту за это предельное значение.</span><span class="sxs-lookup"><span data-stu-id="b560f-209">When your add-in is running on an Outlook rich client, expect Outlook to apply the `ItemHasKnownEntity` rule to the first megabyte of the item body and not to the rest of the body over that limit.</span></span>
    
- <span data-ttu-id="b560f-210">Вы не можете использовать `ItemHasKnownEntity` правила для активации надстройки для элементов в папке "Отправленные".</span><span class="sxs-lookup"><span data-stu-id="b560f-210">You cannot use an `ItemHasKnownEntity` rule to activate an add-in for items in the Sent Items folder.</span></span>
    

## <a name="see-also"></a><span data-ttu-id="b560f-211">См. также</span><span class="sxs-lookup"><span data-stu-id="b560f-211">See also</span></span>

- [<span data-ttu-id="b560f-212">Создание надстроек Outlook для форм чтения</span><span class="sxs-lookup"><span data-stu-id="b560f-212">Create Outlook add-ins for read forms</span></span>](read-scenario.md)
- [<span data-ttu-id="b560f-213">Извлечение строк сущности из элемента Outlook</span><span class="sxs-lookup"><span data-stu-id="b560f-213">Extract entity strings from an Outlook item</span></span>](extract-entity-strings-from-an-item.md)
- [<span data-ttu-id="b560f-214">Правила активации для надстроек Outlook</span><span class="sxs-lookup"><span data-stu-id="b560f-214">Activation rules for Outlook add-ins</span></span>](activation-rules.md)
- [<span data-ttu-id="b560f-215">Использование правил активации на основе регулярных выражений для отображения надстройки Outlook</span><span class="sxs-lookup"><span data-stu-id="b560f-215">Use regular expression activation rules to show an Outlook add-in</span></span>](use-regular-expressions-to-show-an-outlook-add-in.md)
- [<span data-ttu-id="b560f-216">Общие сведения о разрешениях для надстройки Outlook</span><span class="sxs-lookup"><span data-stu-id="b560f-216">Understanding Outlook add-in permissions</span></span>](understanding-outlook-add-in-permissions.md)
