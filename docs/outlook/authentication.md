---
title: Варианты проверки подлинности в надстройках Outlook
description: Надстройки Outlook предоставляют несколько различных способов проверки подлинности для разных сценариев.
ms.date: 11/05/2019
localization_priority: Priority
ms.openlocfilehash: c7fc3f72dd04b2a64f6f5ce34732885a1a917001
ms.sourcegitcommit: fa4e81fcf41b1c39d5516edf078f3ffdbd4a3997
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/17/2020
ms.locfileid: "42720843"
---
# <a name="authentication-options-in-outlook-add-ins"></a>Варианты проверки подлинности в надстройках Outlook

Надстройка Outlook может получать доступ к данным из любого расположения в Интернете с сервера, на котором размещается надстройка, из внутренней сети или из другого места в облаке. Если эти сведения защищены, то надстройке нужен способ проверки подлинности пользователя. Надстройки Outlook предоставляют несколько различных способов проверки подлинности для разных сценариев.

## <a name="single-sign-on-access-token"></a>Маркер доступа для единого входа

Маркеры доступа для единого входа упрощают проверку подлинности надстройки и получение маркеров доступа для вызова [API Microsoft Graph](/graph/overview). Эта возможность повышает удобство работы, так как пользователю не требуется вводить свои учетные данные.

> [!NOTE]
> В настоящее время API единого входа поддерживается для Word, Excel, Outlook и PowerPoint в тестовом режиме. Дополнительные сведения о текущей поддержке API единого входа см. в статье [Наборы обязательных элементов API идентификации](../reference/requirement-sets/identity-api-requirement-sets.md).
> Чтобы использовать единый вход, вам необходимо загрузить бета-версию библиотеки JavaScript Office из https://appsforoffice.microsoft.com/lib/beta/hosted/office.js на страницу подготовки HTML для надстройки.
> Если вы работаете с надстройкой Outlook, обязательно включите современную проверку подлинности для клиента Office 365. Сведения о том, как это сделать, см. в статье [Exchange Online: как включить в клиенте современную проверку подлинности](https://social.technet.microsoft.com/wiki/contents/articles/32711.exchange-online-how-to-enable-your-tenant-for-modern-authentication.aspx).

Рекомендуем использовать маркеры единого входа в таких случаях:

- В основном надстройку применяют пользователи Office 365.
- Надстройке требуется доступ к следующему:
    - службам Майкрософт, предоставляемым в составе Microsoft Graph;
    - сторонней службе, которой управляете вы.

Метод проверки подлинности для единого входа использует [поток "от имени" OAuth2, предоставленный службой Azure Active Directory](/azure/active-directory/develop/active-directory-v2-protocols-oauth-on-behalf-of). Для этого необходимо, чтобы надстройка была зарегистрирована на [портале регистрации приложений](https://apps.dev.microsoft.com/), а в ее манифесте были указаны необходимые области Microsoft Graph.

Так надстройка может получить маркер доступа, действующий во внутреннем API сервера. Надстройка использует этот маркер в качестве токена носителя в заголовке `Authorization`, чтобы выполнять проверку подлинности обратного вызова API. После этого сервер сможет следующее:

- выполнить поток "от имени", чтобы получить маркер доступа, действующий в API Microsoft Graph;
- использовать сведения об удостоверении в маркере для определения удостоверения пользователя и проверки подлинности во внутренних службах.

Дополнительные сведения см. в [полном обзоре способа проверки подлинности с единым входом](../develop/sso-in-office-add-ins.md).

Дополнительные сведения об использовании маркера единого входа в надстройке Outlook см. в статье [Проверка подлинности пользователя с помощью маркера единого входа в надстройке Outlook](authenticate-a-user-with-an-sso-token.md).

Пример надстройки, использующей маркер единого входа: [AttachmentsDemo](https://github.com/OfficeDev/outlook-add-in-attachments-demo).

## <a name="exchange-user-identity-token"></a>Получение маркера удостоверения Exchange

Маркеры удостоверений пользователей Exchange позволяют надстройке определить удостоверение пользователя. После проверки удостоверения пользователя ваше решение сможет выполнить одноразовую проверку подлинности во внутренней системе, а затем — принять маркер удостоверения пользователя для авторизации при последующих запросах. Используйте маркер удостоверения пользователя Exchange:

- если надстройку в основном применяют локальные пользователи Exchange;
- если надстройке требуется доступ к управляемой вами сторонней службе;
- в качестве резервной проверки подлинности (и авторизации в Microsoft Graph) при запуске надстройки в версии Office, не поддерживающей единый вход.

Надстройка может вызывать метод [getUserIdentityTokenAsync](/javascript/api/outlook/office.mailbox#getuseridentitytokenasync-callback--usercontext-), чтобы получать маркеры удостоверений пользователей Exchange. Сведения об использовании этих маркеров см. в статье [Проверка подлинности пользователя с помощью маркера удостоверения для Exchange](authenticate-a-user-with-an-identity-token.md).

## <a name="access-tokens-obtained-via-oauth2-flows"></a>Маркеры доступа, полученные через потоки OAuth2

Надстройки также могут получать доступ к сторонним службам, поддерживающим протокол OAuth2 для авторизации. Рекомендуем использовать маркеры OAuth2 в таких случаях:

- надстройке требуется доступ к сторонней службе, которой вы не управляете.

Если вы применяете этот способ, надстройка предлагает пользователю войти в службу, используя метод [displayDialogAsync](/javascript/api/office/office.ui#displaydialogasync-startaddress--options--callback-) для инициализации потока OAuth2 или [библиотеку office-js-helpers](https://github.com/OfficeDev/office-js-helpers) для неявного потока OAuth2.

## <a name="callback-tokens"></a>Маркеры обратного вызова

Маркеры обратного вызова предоставляют доступ к почтовому ящику пользователя на внутреннем сервере при использовании [веб-служб Exchange (EWS)](/exchange/client-developer/exchange-web-services/explore-the-ews-managed-api-ews-and-web-services-in-exchange) или [REST API для Outlook](/previous-versions/office/office-365-api/api/version-2.0/use-outlook-rest-api). Рекомендуем использовать маркеры обратного вызова в таких случаях:

- надстройке требуется доступ к почтовому ящику пользователя на внутреннем сервере.

Надстройки получают маркеры обратного вызова с помощью одного из методов [getCallbackTokenAsync](../reference/objectmodel/preview-requirement-set/office.context.mailbox.md#methods). Уровень доступа контролируется при помощи разрешений, указываемых в манифесте надстройки.
