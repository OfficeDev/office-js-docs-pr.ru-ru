---
title: Варианты проверки подлинности в надстройках Outlook
description: Надстройки Outlook предоставляют несколько различных способов проверки подлинности для разных сценариев.
ms.date: 06/22/2021
localization_priority: Priority
ms.openlocfilehash: 108dc918fcea956b8349d4e2c53c0e8dd06cbeca
ms.sourcegitcommit: ee9e92a968e4ad23f1e371f00d4888e4203ab772
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/23/2021
ms.locfileid: "53077108"
---
# <a name="authentication-options-in-outlook-add-ins"></a><span data-ttu-id="4625e-103">Варианты проверки подлинности в надстройках Outlook</span><span class="sxs-lookup"><span data-stu-id="4625e-103">Authentication options in Outlook add-ins</span></span>

<span data-ttu-id="4625e-104">Надстройка Outlook может получать доступ к данным из любого расположения в Интернете с сервера, на котором размещается надстройка, из внутренней сети или из другого места в облаке.</span><span class="sxs-lookup"><span data-stu-id="4625e-104">Your Outlook add-in can access information from anywhere on the Internet, whether from the server that hosts the add-in, from your internal network, or from somewhere else in the cloud.</span></span> <span data-ttu-id="4625e-105">Если эти сведения защищены, то надстройке нужен способ проверки подлинности пользователя.</span><span class="sxs-lookup"><span data-stu-id="4625e-105">If that information is protected, your add-in needs a way to authenticate your user.</span></span> <span data-ttu-id="4625e-106">Надстройки Outlook предоставляют несколько различных способов проверки подлинности для разных сценариев.</span><span class="sxs-lookup"><span data-stu-id="4625e-106">Outlook add-ins provide a number of different methods to authenticate, depending on your specific scenario.</span></span>

## <a name="single-sign-on-access-token"></a><span data-ttu-id="4625e-107">Маркер доступа для единого входа</span><span class="sxs-lookup"><span data-stu-id="4625e-107">Single sign-on access token</span></span>

<span data-ttu-id="4625e-108">Маркеры доступа для единого входа упрощают проверку подлинности надстройки и получение маркеров доступа для вызова [API Microsoft Graph](/graph/overview).</span><span class="sxs-lookup"><span data-stu-id="4625e-108">Single sign-on access tokens provide a seamless way for your add-in to authenticate and obtain access tokens to call the [Microsoft Graph API](/graph/overview).</span></span> <span data-ttu-id="4625e-109">Эта возможность повышает удобство работы, так как пользователю не требуется вводить свои учетные данные.</span><span class="sxs-lookup"><span data-stu-id="4625e-109">This capability reduces friction since the user is not required to enter their credentials.</span></span>

> [!NOTE]
> <span data-ttu-id="4625e-110">API единого входа в настоящее время поддерживается для Word, Excel, Outlook и PowerPoint.</span><span class="sxs-lookup"><span data-stu-id="4625e-110">The Single Sign-on API is currently supported for Word, Excel, Outlook, and PowerPoint.</span></span> <span data-ttu-id="4625e-111">Дополнительные сведения о текущей поддержке API единого входа см. в статье [Наборы обязательных элементов API идентификации](../reference/requirement-sets/identity-api-requirement-sets.md).</span><span class="sxs-lookup"><span data-stu-id="4625e-111">For more information about where the Single Sign-on API is currently supported, see [IdentityAPI requirement sets](../reference/requirement-sets/identity-api-requirement-sets.md).</span></span>
> <span data-ttu-id="4625e-112">Если вы работаете с надстройкой Outlook, обязательно включите современную проверку подлинности для клиента Microsoft 365.</span><span class="sxs-lookup"><span data-stu-id="4625e-112">If you are working with an Outlook add-in, be sure to enable Modern Authentication for the Microsoft 365 tenancy.</span></span> <span data-ttu-id="4625e-113">Сведения о том, как это сделать, см. в статье [Exchange Online: как включить в клиенте современную проверку подлинности](https://social.technet.microsoft.com/wiki/contents/articles/32711.exchange-online-how-to-enable-your-tenant-for-modern-authentication.aspx).</span><span class="sxs-lookup"><span data-stu-id="4625e-113">For information about how to do this, see [Exchange Online: How to enable your tenant for modern authentication](https://social.technet.microsoft.com/wiki/contents/articles/32711.exchange-online-how-to-enable-your-tenant-for-modern-authentication.aspx).</span></span>

<span data-ttu-id="4625e-114">Рекомендуем использовать маркеры единого входа в таких случаях:</span><span class="sxs-lookup"><span data-stu-id="4625e-114">Consider using SSO access tokens if your add-in:</span></span>

- <span data-ttu-id="4625e-115">В основном надстройку применяют пользователи Microsoft 365.</span><span class="sxs-lookup"><span data-stu-id="4625e-115">Is used primarily by Microsoft 365 users</span></span>
- <span data-ttu-id="4625e-116">Надстройке требуется доступ к следующему:</span><span class="sxs-lookup"><span data-stu-id="4625e-116">Needs access to:</span></span>
  - <span data-ttu-id="4625e-117">службам Майкрософт, предоставляемым в составе Microsoft Graph;</span><span class="sxs-lookup"><span data-stu-id="4625e-117">Microsoft services that are exposed as part of Microsoft Graph</span></span>
  - <span data-ttu-id="4625e-118">сторонней службе, которой управляете вы.</span><span class="sxs-lookup"><span data-stu-id="4625e-118">A non-Microsoft service that you control</span></span>

<span data-ttu-id="4625e-119">Метод проверки подлинности для единого входа использует [поток "от имени" OAuth2, предоставленный службой Azure Active Directory](/azure/active-directory/develop/active-directory-v2-protocols-oauth-on-behalf-of).</span><span class="sxs-lookup"><span data-stu-id="4625e-119">The SSO authentication method uses the [OAuth2 On-Behalf-Of flow provided by Azure Active Directory](/azure/active-directory/develop/active-directory-v2-protocols-oauth-on-behalf-of).</span></span> <span data-ttu-id="4625e-120">Для этого необходимо, чтобы надстройка была зарегистрирована на [портале регистрации приложений](https://apps.dev.microsoft.com/), а в ее манифесте были указаны необходимые области Microsoft Graph.</span><span class="sxs-lookup"><span data-stu-id="4625e-120">It requires that the add-in register in the [Application Registration Portal](https://apps.dev.microsoft.com/) and specify any required Microsoft Graph scopes in its manifest.</span></span>

<span data-ttu-id="4625e-121">Так надстройка может получить маркер доступа, действующий во внутреннем API сервера.</span><span class="sxs-lookup"><span data-stu-id="4625e-121">Using this method, your add-in can obtain an access token scoped to your server back-end API.</span></span> <span data-ttu-id="4625e-122">Надстройка использует этот маркер в качестве токена носителя в заголовке `Authorization`, чтобы выполнять проверку подлинности обратного вызова API.</span><span class="sxs-lookup"><span data-stu-id="4625e-122">The add-in uses this as a bearer token in the `Authorization` header to authenticate a call back to your API.</span></span> <span data-ttu-id="4625e-123">После этого сервер сможет следующее:</span><span class="sxs-lookup"><span data-stu-id="4625e-123">At that point your server can:</span></span>

- <span data-ttu-id="4625e-124">выполнить поток "от имени", чтобы получить маркер доступа, действующий в API Microsoft Graph;</span><span class="sxs-lookup"><span data-stu-id="4625e-124">Complete the On-Behalf-Of flow to obtain an access token scoped to the Microsoft Graph API</span></span>
- <span data-ttu-id="4625e-125">использовать сведения об удостоверении в маркере для определения удостоверения пользователя и проверки подлинности во внутренних службах.</span><span class="sxs-lookup"><span data-stu-id="4625e-125">Use the identity information in the token to establish the user's identity and authenticate to your own back-end services</span></span>

<span data-ttu-id="4625e-126">Дополнительные сведения см. в [полном обзоре способа проверки подлинности с единым входом](../develop/sso-in-office-add-ins.md).</span><span class="sxs-lookup"><span data-stu-id="4625e-126">For a more detailed overview, see the [full overview of the SSO authentication method](../develop/sso-in-office-add-ins.md).</span></span>

<span data-ttu-id="4625e-127">Дополнительные сведения об использовании маркера единого входа в надстройке Outlook см. в статье [Проверка подлинности пользователя с помощью маркера единого входа в надстройке Outlook](authenticate-a-user-with-an-sso-token.md).</span><span class="sxs-lookup"><span data-stu-id="4625e-127">For details on using the SSO token in an Outlook add-in, see [Authenticate a user with an single-sign-on token in an Outlook add-in](authenticate-a-user-with-an-sso-token.md).</span></span>

<span data-ttu-id="4625e-128">Пример надстройки, использующей маркер единого входа, см. в статье [Единый вход надстройки Outlook](https://github.com/OfficeDev/Outlook-Add-in-SSO).</span><span class="sxs-lookup"><span data-stu-id="4625e-128">For a sample add-in that uses the SSO token, see [Outlook Add-in SSO](https://github.com/OfficeDev/Outlook-Add-in-SSO).</span></span>

## <a name="exchange-user-identity-token"></a><span data-ttu-id="4625e-129">Получение маркера удостоверения Exchange</span><span class="sxs-lookup"><span data-stu-id="4625e-129">Exchange user identity token</span></span>

<span data-ttu-id="4625e-130">Маркеры удостоверений пользователей Exchange позволяют надстройке определить удостоверение пользователя.</span><span class="sxs-lookup"><span data-stu-id="4625e-130">Exchange user identity tokens provide a way for your add-in to establish the identity of the user.</span></span> <span data-ttu-id="4625e-131">После проверки удостоверения пользователя ваше решение сможет выполнить одноразовую проверку подлинности во внутренней системе, а затем — принять маркер удостоверения пользователя для авторизации при последующих запросах.</span><span class="sxs-lookup"><span data-stu-id="4625e-131">By verifying the user's identity, you can then perform a one-time authentication into your back-end system, then accept the user identity token as an authorization for future requests.</span></span> <span data-ttu-id="4625e-132">Используйте маркер удостоверения пользователя Exchange:</span><span class="sxs-lookup"><span data-stu-id="4625e-132">Use the Exchange user identity token:</span></span>

- <span data-ttu-id="4625e-133">если надстройку в основном применяют локальные пользователи Exchange;</span><span class="sxs-lookup"><span data-stu-id="4625e-133">When the add-in is used primarily by Exchange on-premises users.</span></span>
- <span data-ttu-id="4625e-134">если надстройке требуется доступ к управляемой вами сторонней службе;</span><span class="sxs-lookup"><span data-stu-id="4625e-134">When the add-in needs access to a non-Microsoft service that you control.</span></span>
- <span data-ttu-id="4625e-135">в качестве резервной проверки подлинности при запуске надстройки в версии Office, не поддерживающей единый вход.</span><span class="sxs-lookup"><span data-stu-id="4625e-135">As a fallback authentication when the add-in is running on a version of Office that doesn't support SSO.</span></span>

<span data-ttu-id="4625e-136">Надстройка может вызывать метод [getUserIdentityTokenAsync](/javascript/api/outlook/office.mailbox#getuseridentitytokenasync-callback--usercontext-), чтобы получать маркеры удостоверений пользователей Exchange.</span><span class="sxs-lookup"><span data-stu-id="4625e-136">Your add-in can call [getUserIdentityTokenAsync](/javascript/api/outlook/office.mailbox#getuseridentitytokenasync-callback--usercontext-) to get Exchange user identity tokens.</span></span> <span data-ttu-id="4625e-137">Сведения об использовании этих маркеров см. в статье [Проверка подлинности пользователя с помощью маркера удостоверения для Exchange](authenticate-a-user-with-an-identity-token.md).</span><span class="sxs-lookup"><span data-stu-id="4625e-137">For details on using these tokens, see [Authenticate a user with an identity token for Exchange](authenticate-a-user-with-an-identity-token.md).</span></span>

## <a name="access-tokens-obtained-via-oauth2-flows"></a><span data-ttu-id="4625e-138">Маркеры доступа, полученные через потоки OAuth2</span><span class="sxs-lookup"><span data-stu-id="4625e-138">Access tokens obtained via OAuth2 flows</span></span>

<span data-ttu-id="4625e-139">Надстройки также могут получать доступ к сторонним службам, поддерживающим протокол OAuth2 для авторизации.</span><span class="sxs-lookup"><span data-stu-id="4625e-139">Add-ins can also access third-party services that support OAuth2 for authorization.</span></span> <span data-ttu-id="4625e-140">Рекомендуем использовать маркеры OAuth2 в таких случаях:</span><span class="sxs-lookup"><span data-stu-id="4625e-140">Consider using OAuth2 tokens if your add-in:</span></span>

- <span data-ttu-id="4625e-141">надстройке требуется доступ к сторонней службе, которой вы не управляете.</span><span class="sxs-lookup"><span data-stu-id="4625e-141">Needs access to a third-party service outside of your control</span></span>

<span data-ttu-id="4625e-142">Если вы применяете этот способ, надстройка предлагает пользователю войти в службу, используя метод [displayDialogAsync](/javascript/api/office/office.ui#displaydialogasync-startaddress--options--callback-) для инициализации потока OAuth2 или [библиотеку office-js-helpers](https://github.com/OfficeDev/office-js-helpers) для неявного потока OAuth2.</span><span class="sxs-lookup"><span data-stu-id="4625e-142">Using this method, your add-in prompts the user to sign-in to the service either by using the [displayDialogAsync](/javascript/api/office/office.ui#displaydialogasync-startaddress--options--callback-) method to initialize the OAuth2 flow, or by using the [office-js-helpers library](https://github.com/OfficeDev/office-js-helpers) to the OAuth2 Implicit flow.</span></span>

## <a name="callback-tokens"></a><span data-ttu-id="4625e-143">Маркеры обратного вызова</span><span class="sxs-lookup"><span data-stu-id="4625e-143">Callback tokens</span></span>

<span data-ttu-id="4625e-144">Маркеры обратного вызова предоставляют доступ к почтовому ящику пользователя на внутреннем сервере при использовании [веб-служб Exchange (EWS)](/exchange/client-developer/exchange-web-services/explore-the-ews-managed-api-ews-and-web-services-in-exchange) или [REST API для Outlook](/previous-versions/office/office-365-api/api/version-2.0/use-outlook-rest-api).</span><span class="sxs-lookup"><span data-stu-id="4625e-144">Callback tokens provide access to the user's mailbox from your server back-end, either using [Exchange Web Services (EWS)](/exchange/client-developer/exchange-web-services/explore-the-ews-managed-api-ews-and-web-services-in-exchange), or the [Outlook REST API](/previous-versions/office/office-365-api/api/version-2.0/use-outlook-rest-api).</span></span> <span data-ttu-id="4625e-145">Рекомендуем использовать маркеры обратного вызова в таких случаях:</span><span class="sxs-lookup"><span data-stu-id="4625e-145">Consider using callback tokens if your add-in:</span></span>

- <span data-ttu-id="4625e-146">надстройке требуется доступ к почтовому ящику пользователя на внутреннем сервере.</span><span class="sxs-lookup"><span data-stu-id="4625e-146">Needs access to the user's mailbox from your server back-end.</span></span>

<span data-ttu-id="4625e-147">Надстройки получают маркеры обратного вызова с помощью одного из методов [getCallbackTokenAsync](../reference/objectmodel/preview-requirement-set/office.context.mailbox.md#methods).</span><span class="sxs-lookup"><span data-stu-id="4625e-147">Add-ins obtain callback tokens using one of the [getCallbackTokenAsync](../reference/objectmodel/preview-requirement-set/office.context.mailbox.md#methods) methods.</span></span> <span data-ttu-id="4625e-148">Уровень доступа контролируется при помощи разрешений, указываемых в манифесте надстройки.</span><span class="sxs-lookup"><span data-stu-id="4625e-148">The level of access is controlled by the permissions specified in the add-in manifest.</span></span>
