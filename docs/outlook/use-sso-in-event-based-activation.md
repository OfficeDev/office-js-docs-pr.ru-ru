---
title: Включение единого входного пользования (SSO) в Outlook надстройки, которые используют активацию на основе событий
description: Узнайте, как включить SSO при работе надстройки активации на основе событий.
ms.date: 03/17/2022
ms.localizationpriority: medium
ms.openlocfilehash: 38c717e0d626f4c135f76350e30398db26cac24f
ms.sourcegitcommit: 968d637defe816449a797aefd930872229214898
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/23/2022
ms.locfileid: "63746537"
---
# <a name="enable-single-sign-on-sso-in-outlook-add-ins-that-use-event-based-activation"></a>Включение единого входного пользования (SSO) в Outlook надстройки, которые используют активацию на основе событий

Если надстройка Outlook на основе событий, события запускаются в отдельном времени запуска JavaScript. После выполнения действий по проверке подлинности пользователя с помощью маркера с одним [входом](authenticate-a-user-with-an-sso-token.md) в надстройку Outlook, выполните дополнительные действия, описанные в этой статье, чтобы включить SSO для кода обработки событий. После впуска SSO можно `getAccessToken()` вызвать API, чтобы получить маркер доступа с удостоверением пользователя.

> [!NOTE]
> Действия в этой статье применяются только при Outlook надстройки на Windows. Это происходит потому Outlook что Windows использует файл JavaScript, а Outlook в Интернете использует HTML-файл, который может ссылаться на один и тот же файл JavaScript.

Для Outlook Windows в манифесте для надстройки Outlook определяется один файл JavaScript для загрузки для активации на основе событий. Кроме того, необходимо указать Office, что этот файл может поддерживать SSO. Это необходимо, создав список всех надстройок и их файлов JavaScript, чтобы предоставить Office через хорошо известный URI.

## <a name="list-allowed-add-ins-with-a-well-known-uri"></a>Список разрешенных надстройок с известным URI

Чтобы перечислить, какие надстройки разрешены для работы с SSO, создайте JSON-файл, который идентифицирует каждый файл JavaScript для каждой надстройки. Затем разовьем файл JSON в известном URI. Хорошо известный URI позволяет спецификации всех хозяйных JS-файлов, которые уполномочены получать маркеры для текущего веб-происхождения. Это гарантирует, что владелец происхождения имеет полный контроль над тем, какие файлы JS предназначены для использования в надстройки, а какие нет, предотвращая, например, какие-либо уязвимости безопасности в области обезличения.

В следующем примере показано, как включить SSO для двух надстройок (основной версии и бета-версии). Вы можете перечислить как можно больше надстройок по мере необходимости в зависимости от того, сколько вы предоставляете с веб-сервера.

```json
{
    "allowed":
    [
        "https://addin.contoso.com:8000/main/js/autorun.js",
        "https://addin.contoso.com:8000/beta/js/autorun.js"
    ]
}
```

Размещение файла JSON под расположением `.well-known` , названным в URI в корневом корневом происхождении. Например, если происхождение , `https://addin.contoso.com:8000/`то хорошо известный URI `https://addin.contoso.com:8000/.well-known/microsoft-officeaddins-allowed.json`является .

Происхождение ссылается на шаблон схемы + subdomain + домен + порт. Имя расположения должно **быть** , `.well-known`и имя файла ресурса **должно** быть `microsoft-officeaddins-allowed.json`. Этот файл должен содержать объект JSON `allowed` с атрибутом с именем, значение которого — массив всех файлов JavaScript, авторизованных для SSO для соответствующих надстройок.

## <a name="see-also"></a>См. также

- [Проверка подлинности пользователя с помощью маркера с одним входом в Outlook надстройки](authenticate-a-user-with-an-sso-token.md)
- [Настройка надстройки Outlook для активации на основе событий](autolaunch.md)
