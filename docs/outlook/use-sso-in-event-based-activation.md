---
title: Включение единого входного пользования (SSO) в Outlook надстройки, которые используют активацию на основе событий
description: Узнайте, как включить SSO при работе надстройки активации на основе событий.
ms.date: 11/16/2021
ms.localizationpriority: medium
ms.openlocfilehash: 66d1edb8b7b0092ee107b73af24d5420caee8677
ms.sourcegitcommit: 6e6c4803fdc0a3cc2c1bcd275288485a987551ff
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/17/2021
ms.locfileid: "61064707"
---
# <a name="enable-single-sign-on-sso-in-outlook-add-ins-that-use-event-based-activation"></a>Включение единого входного пользования (SSO) в Outlook надстройки, которые используют активацию на основе событий

Если в Outlook надстройка использует активацию на основе событий, события запускаются в отдельное время запуска JavaScript. После выполнения действий [](authenticate-a-user-with-an-sso-token.md)по проверке подлинности пользователя с помощью маркера с одним входом в надстройку Outlook, выполните дополнительные действия, описанные в этой статье, чтобы включить SSO для кода обработки событий. После впуска SSO можно вызвать API, чтобы получить маркер доступа `getAccessToken()` с удостоверением пользователя.

> [!NOTE]
> Действия в этой статье применяются только при Outlook надстройки на Windows. Это происходит потому Outlook что Windows использует файл JavaScript, а Outlook в Интернете htmL-файл, который может ссылаться на один и тот же файл JavaScript.

Для Outlook Windows в манифесте для надстройки Outlook определяется один файл JavaScript для загрузки для активации на основе событий. Кроме того, необходимо указать Office, что этот файл разрешен для поддержки SSO. Для этого существует два подхода. Вы можете создать список всех надстройок и их файлов JavaScript, чтобы предоставить Office через хорошо известный URI. Или вы можете добавить настраиваемый заглавной ответ, чтобы включить SSO.

## <a name="list-allowed-add-ins-with-a-well-known-uri"></a>Список разрешенных надстройок с известным URI

Чтобы перечислить, какие надстройки разрешены для работы с SSO, создайте JSON-файл, который идентифицирует каждый файл JavaScript для каждой надстройки. Затем разовьем файл JSON в известном URI. Хорошо известный URI позволяет спецификации всех хозяйных JS-файлов, которые уполномочены получать маркеры для текущего веб-происхождения. Это гарантирует, что владелец происхождения имеет полный контроль над тем, какие файлы JS предназначены для использования в надстройки, а какие нет, предотвращая, например, какие-либо уязвимости безопасности в области обезличения.

В следующем примере показано, как включить SSO для двух надстройок (основной версии и бета-версии). Вы можете перечислить как можно больше надстройок по мере необходимости в зависимости от того, сколько вы предоставляете с веб-сервера.

```json
{
    "allowed":
    [
        "https://addin.contoso.com:8000/main/js/autorun.js",
        "https://addin.contoso.com:8000/beta/js/autorun.js"
    ]
}
```

Размещение файла JSON под расположением, названным `.well-known` в URI в корневом корневом происхождении. Например, если происхождение , `https://addin.contoso.com:8000/` то хорошо известный URI является `https://addin.contoso.com:8000/.well-known/microsoft-officeaddins-allowed.json` .

Происхождение ссылается на шаблон схемы + subdomain + домен + порт. Имя расположения должно **быть,** и имя файла `.well-known` ресурса **должно** быть `microsoft-officeaddins-allowed.json` . Этот файл должен содержать объект JSON с атрибутом с именем, значение которого — массив всех файлов JavaScript, авторизованных для SSO для соответствующих `allowed` надстройок.

## <a name="add-a-custom-response-header"></a>Добавление настраиваемой заготки ответа

Второй подход заключается в добавлении настраиваемой загона ответа с именем `MS-OfficeAddins-Allowed-Origin` . Значение загона должно быть происхождение файла JavaScript.

Например, если файл JavaScript расположен по адресу, добавьте `https://addin.contoso.com:8000/main/js/autorun.js` следующий заглавной ответ.

`MS-OfficeAddins-Allowed-Origin : https://addin.contoso.com:8000`

Для добавления настраиваемой загона ответа необходимо обратиться к конкретной документации на веб-сервере.

## <a name="see-also"></a>См. также

- [Проверка подлинности пользователя с помощью маркера с одним входом в Outlook надстройки](authenticate-a-user-with-an-sso-token.md)
- [Настройка надстройки Outlook для активации на основе событий](autolaunch.md)
