---
title: Включение единого входа (SSO) в Outlook надстройки, использующие активацию на основе событий
description: Узнайте, как включить единый вход при работе в надстройке активации на основе событий.
ms.date: 06/17/2022
ms.localizationpriority: medium
ms.openlocfilehash: 477ecb8c0ab84ab472763f83e342258998749861
ms.sourcegitcommit: d8fbe472b35c758753e5d2e4b905a5973e4f7b52
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/25/2022
ms.locfileid: "66229731"
---
# <a name="enable-single-sign-on-sso-in-outlook-add-ins-that-use-event-based-activation"></a>Включение единого входа (SSO) в Outlook надстройки, использующие активацию на основе событий

Если надстройка Outlook использует активацию на основе событий, события выполняются в отдельной среде выполнения JavaScript. После выполнения действий по проверке подлинности пользователя с помощью маркера единого входа в надстройке [Outlook](authenticate-a-user-with-an-sso-token.md) выполните дополнительные действия, описанные в этой статье, чтобы включить единый вход для кода обработки событий. После включения единого входа можно вызвать [API getAccessToken(),](/javascript/api/office-runtime/officeruntime.auth) чтобы получить маркер доступа с удостоверением пользователя.

> [!IMPORTANT]
> Хотя `OfficeRuntime.auth.getAccessToken` и `Office.auth.getAccessToken` выполните те же функции получения маркера доступа, `OfficeRuntime.auth.getAccessToken` мы рекомендуем вызывать надстройку на основе событий. Этот API поддерживается во всех Outlook клиентских версий, поддерживающих активацию на основе событий и единый вход. С другой стороны, `Office.auth.getAccessToken` поддерживается только в Outlook Windows начиная с версии 2111 (сборка 14701.20000).

Для Outlook Windows в манифесте надстройки Outlook вы определяете один файл JavaScript для загрузки для активации на основе событий. Также необходимо указать, Office, что этот файл может поддерживать единый вход. Для этого создайте список всех надстроек и их файлов JavaScript, чтобы предоставить Office через известный универсальный код ресурса (URI).

> [!NOTE]
> Действия, описанные в этой статье, применяются только при запуске Outlook надстройки на Windows. Это связано с тем Outlook что Windows использует файл JavaScript, а Outlook в Интернете HTML-файл, который может ссылаться на тот же файл JavaScript.

## <a name="list-allowed-add-ins-with-a-well-known-uri"></a>Список разрешенных надстроек с известным универсальным кодом ресурса (URI)

Чтобы указать, какие надстройки могут работать с единым входом, создайте JSON-файл, определяющий каждый файл JavaScript для каждой надстройки. Затем разведите этот JSON-файл по известному универсальному коду ресурса (URI). Известный универсальный код ресурса (URI) позволяет укажите все размещенные JS-файлы, которым разрешено получать маркеры для текущего веб-источника. Это гарантирует, что владелец источника имеет полный контроль над тем, какие размещенные JS-файлы предназначены для использования в надстройке, а какие нет, предотвращая, например, уязвимости системы безопасности, связанные с олицетворением.

В следующем примере показано, как включить единый вход для двух надстроек (основной и бета-версии). Вы можете перечислить любое количество надстроек в зависимости от того, сколько вы предоставляете с веб-сервера.

```json
{
    "allowed":
    [
        "https://addin.contoso.com:8000/main/js/autorun.js",
        "https://addin.contoso.com:8000/beta/js/autorun.js"
    ]
}
```

Разведите JSON-файл в расположении с `.well-known` именем в URI в корне источника. Например, если источником является `https://addin.contoso.com:8000/`источник, то хорошо известный URI — это `https://addin.contoso.com:8000/.well-known/microsoft-officeaddins-allowed.json`.

Источник ссылается на шаблон схемы + поддомен + домен + порт. Имя расположения должно **быть**, `.well-known`а имя файла ресурсов **должно быть**.`microsoft-officeaddins-allowed.json` Этот файл должен содержать объект JSON с атрибутом с `allowed` именем, значение которого является массивом всех файлов JavaScript, авторизованных для единого входа для соответствующих надстроек.

## <a name="see-also"></a>См. также

- [Проверка подлинности пользователя с помощью маркера единого входа в Outlook надстройке](authenticate-a-user-with-an-sso-token.md)
- [Настройка надстройки Outlook для активации на основе событий](autolaunch.md)
