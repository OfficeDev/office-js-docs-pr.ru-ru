---
title: Обработка значений дат в надстройках Outlook
description: API JavaScript для Office использует объект JavaScript Date для большей части хранения и извлечения даты и времени.
ms.date: 10/31/2019
localization_priority: Normal
ms.openlocfilehash: 2d92f32f488cba1c9220296936468ca93dd320e3
ms.sourcegitcommit: 5d29801180f6939ec10efb778d2311be67d8b9f1
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/27/2020
ms.locfileid: "42325335"
---
# <a name="tips-for-handling-date-values-in-outlook-add-ins"></a><span data-ttu-id="9c34d-103">Советы по использованию значений дат в надстройках Outlook</span><span class="sxs-lookup"><span data-stu-id="9c34d-103">Tips for handling date values in Outlook add-ins</span></span>

<span data-ttu-id="9c34d-104">API JavaScript для Office использует объект JavaScript [Date](https://www.w3schools.com/jsref/jsref_obj_date.asp) для большей части хранения и извлечения даты и времени.</span><span class="sxs-lookup"><span data-stu-id="9c34d-104">The Office JavaScript API uses the JavaScript [Date](https://www.w3schools.com/jsref/jsref_obj_date.asp) object for most of the storage and retrieval of dates and times.</span></span> 

<span data-ttu-id="9c34d-105">Этот `Date` объект предоставляет методы, такие как [жетуткдате](https://www.w3schools.com/jsref/jsref_getutcdate.asp), [жетутчаур](https://www.w3schools.com/jsref/jsref_getutchours.asp), [жетуткминутес](https://www.w3schools.com/jsref/jsref_getutcminutes.asp)и [вызовом toUTCString](https://www.w3schools.com/jsref/jsref_toutcstring.asp), которые возвращают запрошенное значение даты или времени в соответствии с всеобщим скоординированным временем (UTC).</span><span class="sxs-lookup"><span data-stu-id="9c34d-105">That `Date` object provides methods such as [getUTCDate](https://www.w3schools.com/jsref/jsref_getutcdate.asp), [getUTCHour](https://www.w3schools.com/jsref/jsref_getutchours.asp), [getUTCMinutes](https://www.w3schools.com/jsref/jsref_getutcminutes.asp), and [toUTCString](https://www.w3schools.com/jsref/jsref_toutcstring.asp), which return the requested date or time value according to Universal Coordinated Time (UTC) time.</span></span>

<span data-ttu-id="9c34d-106">`Date` Объект также предоставляет другие [методы, например](https://www.w3schools.com/jsref/jsref_getutchours.asp) [GETDATE, GETDATE](https://www.w3schools.com/jsref/jsref_getutcdate.asp) [, GETDATE и](https://www.w3schools.com/jsref/jsref_getminutes.asp) [ToString](https://www.w3schools.com/jsref/jsref_tostring_date.asp), которые возвращают запрошенную дату или время в соответствии с "местным временем".</span><span class="sxs-lookup"><span data-stu-id="9c34d-106">The `Date` object also provides other methods such as [getDate](https://www.w3schools.com/jsref/jsref_getutcdate.asp), [getHour](https://www.w3schools.com/jsref/jsref_getutchours.asp), [getMinutes](https://www.w3schools.com/jsref/jsref_getminutes.asp), and [toString](https://www.w3schools.com/jsref/jsref_tostring_date.asp), which return the requested date or time according to "local time".</span></span>

<span data-ttu-id="9c34d-107">Понятие "местного времени" в значительной мере определяется браузером и операционной системой на клиентском компьютере.</span><span class="sxs-lookup"><span data-stu-id="9c34d-107">The concept of "local time" is largely determined by the browser and operating system on the client computer.</span></span> <span data-ttu-id="9c34d-108">Например, в большинстве браузеров, запущенных на клиентском компьютере под управлением Windows, вызов JavaScript `getDate`возвращает дату в соответствии с часовым поясом, установленным в Windows на клиентском компьютере.</span><span class="sxs-lookup"><span data-stu-id="9c34d-108">For instance, on most browsers running on a Windows-based client computer, a JavaScript call to `getDate`, returns a date based on the time zone set in Windows on the client computer.</span></span>

<span data-ttu-id="9c34d-109">В следующем примере создается `Date` объект `myLocalDate` по местному времени, а затем `toUTCString` выполняется вызов для преобразования даты в строку даты в формате UTC.</span><span class="sxs-lookup"><span data-stu-id="9c34d-109">The following example creates a `Date` object `myLocalDate` in local time, and calls `toUTCString` to convert that date to a date string in UTC.</span></span>

```js
// Create and get the current date represented 
// in the client computer time zone.
var myLocalDate = new Date (); 

// Convert the Date value in the client computer time zone
// to a date string in UTC, and display the string.
document.write ("The current UTC time is " + 
    myLocalDate.toUTCString());
```

<span data-ttu-id="9c34d-110">Несмотря на то, что вы `Date` можете использовать объект JavaScript для получения значения даты или времени на основе UTC или часового пояса клиентского компьютера, объект **Date** ограничен в одном отношениях не предоставляет методы для возврата значения даты или времени для любого другого определенного часового пояса.</span><span class="sxs-lookup"><span data-stu-id="9c34d-110">While you can use the JavaScript `Date` object to get a date or time value based on UTC or the client computer time zone, the **Date** object is limited in one respect - it does not provide methods to return a date or time value for any other specific time zone.</span></span> <span data-ttu-id="9c34d-111">Например, если ваш клиентский компьютер настроен на зимнее стандартное время (EST), не существует `Date` метода, позволяющего получить значение часа, отличное от в средстве EST или UTC, например по тихоокеанскому времени (PST).</span><span class="sxs-lookup"><span data-stu-id="9c34d-111">For example, if your client computer is set to be on Eastern Standard Time (EST), there is no `Date` method that allows you to get the hour value other than in EST or UTC, such as Pacific Standard Time (PST).</span></span>


## <a name="date-related-features-for-outlook-add-ins"></a><span data-ttu-id="9c34d-112">Функции надстроек Outlook, связанные с датой</span><span class="sxs-lookup"><span data-stu-id="9c34d-112">Date-related features for Outlook add-ins</span></span>

<span data-ttu-id="9c34d-113">При использовании API JavaScript для Office для обработки значений даты и времени в надстройках Outlook, выполняемых в расширенном клиенте Outlook, а также в Outlook в Интернете или на мобильных устройствах, упомянутые выше ограничения JavaScript имеют недостаточное значение.</span><span class="sxs-lookup"><span data-stu-id="9c34d-113">The aforementioned JavaScript limitation has an implication for you, when you use the Office JavaScript API to handle date or time values in Outlook add-ins that run in an Outlook rich client, and in Outlook on the web or mobile devices.</span></span>


### <a name="time-zones-for-outlook-clients"></a><span data-ttu-id="9c34d-114">Часовые пояса для клиентов Outlook</span><span class="sxs-lookup"><span data-stu-id="9c34d-114">Time zones for Outlook clients</span></span>

<span data-ttu-id="9c34d-115">Во избежание недоразумений дадим определение часовым поясам.</span><span class="sxs-lookup"><span data-stu-id="9c34d-115">For clarity, let's define the time zones in question.</span></span>

|<span data-ttu-id="9c34d-116">**Часовой пояс**</span><span class="sxs-lookup"><span data-stu-id="9c34d-116">**Time zone**</span></span>|<span data-ttu-id="9c34d-117">**Описание**</span><span class="sxs-lookup"><span data-stu-id="9c34d-117">**Description**</span></span>|
|:-----|:-----|
|<span data-ttu-id="9c34d-118">Часовой пояс клиентского компьютера</span><span class="sxs-lookup"><span data-stu-id="9c34d-118">Client computer time zone</span></span>|<span data-ttu-id="9c34d-119">Устанавливается в операционной системе на клиентском компьютере.</span><span class="sxs-lookup"><span data-stu-id="9c34d-119">This is set on the operating system of the client computer.</span></span> <span data-ttu-id="9c34d-120">Большинство браузеров используют часовой пояс клиентского компьютера для отображения значений даты и времени объекта JavaScript `Date` .</span><span class="sxs-lookup"><span data-stu-id="9c34d-120">Most browsers use the client computer time zone to display date or time values of the JavaScript `Date` object.</span></span><br/><br/><span data-ttu-id="9c34d-121">В расширенном клиенте Outlook используется этот часовой пояс для отображения значений даты и времени в пользовательском интерфейсе.</span><span class="sxs-lookup"><span data-stu-id="9c34d-121">An Outlook rich client uses this time zone to display date or time values in the user interface.</span></span> <br/><br/><span data-ttu-id="9c34d-122">Например, на клиентском компьютере под управлением Windows в Outlook используется часовой пояс, установленный в операционной системе Windows в качестве местного часового пояса.</span><span class="sxs-lookup"><span data-stu-id="9c34d-122">For example, on a client computer running Windows, Outlook uses the time zone set on Windows as the local time zone.</span></span> <span data-ttu-id="9c34d-123">Если пользователь изменяет часовой пояс на клиентском компьютере в Mac, Outlook в MAC-адресе будет предлагать пользователю обновить часовой пояс в Outlook.</span><span class="sxs-lookup"><span data-stu-id="9c34d-123">On the Mac, if the user changes the time zone on the client computer, Outlook on Mac would prompt the user to update the time zone in Outlook as well.</span></span>|
|<span data-ttu-id="9c34d-124">Часовой пояс Центра администрирования Exchange (EAC)</span><span class="sxs-lookup"><span data-stu-id="9c34d-124">Exchange Admin Center (EAC) time zone</span></span>|<span data-ttu-id="9c34d-125">Пользователь задает это значение часового пояса (и предпочитаемый язык), когда он впервые выполняет вход в Outlook в Интернете или на мобильных устройствах.</span><span class="sxs-lookup"><span data-stu-id="9c34d-125">The user sets this time zone value (and the preferred language) when he or she logs on to Outlook on the web or mobile devices the first time.</span></span> <br/><br/><span data-ttu-id="9c34d-126">В Outlook в Интернете и на мобильных устройствах этот часовой пояс используется для отображения значений даты и времени в пользовательском интерфейсе.</span><span class="sxs-lookup"><span data-stu-id="9c34d-126">Outlook on the web and mobile devices use this time zone to display date or time values in the user interface.</span></span>|

<span data-ttu-id="9c34d-127">Так как расширенный клиент Outlook использует часовой пояс клиентского компьютера, а пользовательский интерфейс Outlook в Интернете и на мобильных устройствах использует часовой пояс центра администрирования Exchange, местное время для той же надстройки, установленной для того же почтового ящика, может отличаться при работе в расширенной клие Outlook NT и в Outlook в Интернете или на мобильных устройствах.</span><span class="sxs-lookup"><span data-stu-id="9c34d-127">Because an Outlook rich client uses the client computer time zone, and the user interface of Outlook on the web and mobile devices uses the EAC time zone, the local time for the same add-in installed for the same mailbox can be different when running in an Outlook rich client and in Outlook on the web or mobile devices.</span></span> <span data-ttu-id="9c34d-128">Разработчику надстройки Outlook следует продумать ввод и вывод значений даты, чтобы эти значения всегда согласовывались с часовым поясом, который пользователь ожидает увидеть в соответствующем клиенте.</span><span class="sxs-lookup"><span data-stu-id="9c34d-128">As an Outlook add-in developer, you should appropriately input and output date values so that those values are always consistent with the time zone that the user expects on the corresponding client.</span></span>


### <a name="date-related-api"></a><span data-ttu-id="9c34d-129">Интерфейс API, связанный с датой</span><span class="sxs-lookup"><span data-stu-id="9c34d-129">Date-related API</span></span>

<span data-ttu-id="9c34d-130">Ниже приведены свойства и методы API JavaScript для Office, которые поддерживают функции, связанные с датами.</span><span class="sxs-lookup"><span data-stu-id="9c34d-130">The following are the properties and methods in the Office JavaScript API that support date-related features.</span></span>

<span data-ttu-id="9c34d-131">**Элемент API**</span><span class="sxs-lookup"><span data-stu-id="9c34d-131">**API member**</span></span>|<span data-ttu-id="9c34d-132">**Представление часового пояса**</span><span class="sxs-lookup"><span data-stu-id="9c34d-132">**Time zone representation**</span></span>|<span data-ttu-id="9c34d-133">**Пример в расширенном клиенте Outlook**</span><span class="sxs-lookup"><span data-stu-id="9c34d-133">**Example in an Outlook rich client**</span></span>|<span data-ttu-id="9c34d-134">**Пример в Outlook в Интернете или на мобильных устройствах**</span><span class="sxs-lookup"><span data-stu-id="9c34d-134">**Example in Outlook on the web or mobile devices**</span></span>
--------------|----------------------------|-------------------------------------|-------------------
[<span data-ttu-id="9c34d-135">Office.context.mailbox.userProfile.timeZone</span><span class="sxs-lookup"><span data-stu-id="9c34d-135">Office.context.mailbox.userProfile.timeZone</span></span>](/javascript/api/outlook/office.userprofile?view=outlook-js-preview#timezone)|<span data-ttu-id="9c34d-136">В расширенном клиенте Outlook это свойство возвращает часовой пояс клиентского компьютера.</span><span class="sxs-lookup"><span data-stu-id="9c34d-136">In an Outlook rich client, this property returns the client computer time zone.</span></span> <span data-ttu-id="9c34d-137">В Outlook в Интернете и мобильных устройствах это свойство возвращает часовой пояс центра администрирования Exchange.</span><span class="sxs-lookup"><span data-stu-id="9c34d-137">In Outlook on the web and mobile devices, this property returns the EAC time zone.</span></span> |<span data-ttu-id="9c34d-138">EST</span><span class="sxs-lookup"><span data-stu-id="9c34d-138">EST</span></span>|<span data-ttu-id="9c34d-139">PST</span><span class="sxs-lookup"><span data-stu-id="9c34d-139">PST</span></span>
<span data-ttu-id="9c34d-140">[Office.context.mailbox.item.dateTimeCreated](../reference/objectmodel/preview-requirement-set/office.context.mailbox.item.md#properties) и [Office.context.mailbox.item.dateTimeModified](../reference/objectmodel/preview-requirement-set/office.context.mailbox.item.md#properties)</span><span class="sxs-lookup"><span data-stu-id="9c34d-140">[Office.context.mailbox.item.dateTimeCreated](../reference/objectmodel/preview-requirement-set/office.context.mailbox.item.md#properties) and [Office.context.mailbox.item.dateTimeModified](../reference/objectmodel/preview-requirement-set/office.context.mailbox.item.md#properties)</span></span>|<span data-ttu-id="9c34d-141">Каждое из этих свойств возвращает объект JavaScript `Date` .</span><span class="sxs-lookup"><span data-stu-id="9c34d-141">Each of these properties returns a JavaScript `Date` object.</span></span> <span data-ttu-id="9c34d-142">Это `Date` значение указано в формате UTC, как показано в следующем примере — `myUTCDate` имеет то же значение, что и в расширенном клиенте Outlook, Outlook в Интернете и на мобильных устройствах.</span><span class="sxs-lookup"><span data-stu-id="9c34d-142">This `Date` value is UTC-correct, as shown in the following example - `myUTCDate` has the same value in an Outlook rich client, Outlook on the web and mobile devices.</span></span><br/><br/>`var myDate = Office.mailbox.item.dateTimeCreated;`<br/>`var myUTCDate = myDate.getUTCDate;`<br/><br/><span data-ttu-id="9c34d-143">Однако вызов `myDate.getDate` возвращает значение даты в часовом поясе клиентского компьютера, которое согласуется с часовым поясом, используемым для отображения значений даты и времени в пользовательском интерфейсе Outlook с расширенными возможностями, но может отличаться от часовых поясов, которые Outlook в Интернете и мобильные устройства используют в своем пользовательском интерфейсе.</span><span class="sxs-lookup"><span data-stu-id="9c34d-143">However, calling  `myDate.getDate` returns a date value in the client computer time zone, which is consistent with the time zone used to display date times values in the Outlook rich client interface, but may be different from the EAC time zone that Outlook on the web and mobile devices use in its user interface.</span></span>|<span data-ttu-id="9c34d-144">Если элемент создан в 9 часов утра в формате времени UTC, для метода</span><span class="sxs-lookup"><span data-stu-id="9c34d-144">If the item is created at 9am UTC:</span></span><br/><br/>`Office.mailbox.item.`<br/><span data-ttu-id="9c34d-145">`dateTimeCreated.getHours` возвращается значение 4 часа утра в формате времени EST.</span><span class="sxs-lookup"><span data-stu-id="9c34d-145">`dateTimeCreated.getHours` returns 4am EST.</span></span><br/><br/><span data-ttu-id="9c34d-146">Если элемент изменен в 11 часов утра в формате времени UTC, для метода</span><span class="sxs-lookup"><span data-stu-id="9c34d-146">If the item is modified at 11am UTC:</span></span><br/><br/>`Office.mailbox.item.`<br/><span data-ttu-id="9c34d-147">`dateTimeModified.getHours` возвращается значение 6 часов утра в формате времени EST.</span><span class="sxs-lookup"><span data-stu-id="9c34d-147">`dateTimeModified.getHours` returns 6am EST.</span></span>|<span data-ttu-id="9c34d-148">Если элемент создан в 9 часов утра в формате времени UTC, для метода</span><span class="sxs-lookup"><span data-stu-id="9c34d-148">If the item creation time is 9am UTC:</span></span><br/><br/>`Office.mailbox.item.`</br><span data-ttu-id="9c34d-149">`dateTimeCreated.getHours` возвращается значение 4 часа утра в формате времени EST.</span><span class="sxs-lookup"><span data-stu-id="9c34d-149">`dateTimeCreated.getHours` returns 4am EST.</span></span><br/><br/><span data-ttu-id="9c34d-150">Если элемент изменен в 11 часов утра в формате времени UTC, для метода</span><span class="sxs-lookup"><span data-stu-id="9c34d-150">If the item is modified at 11am UTC:</span></span><br/><br/>`Office.mailbox.item.`</br><span data-ttu-id="9c34d-151">`dateTimeModified.getHours` возвращается значение 6 часов утра в формате времени EST.</span><span class="sxs-lookup"><span data-stu-id="9c34d-151">`dateTimeModified.getHours` returns 6am EST.</span></span><br/><br/><span data-ttu-id="9c34d-152">Обратите внимание, что если необходимо отобразить время создания или изменения в пользовательском интерфейсе, следует сначала преобразовать время в формат PST, чтобы оно соответствовало формату времени остального пользовательского интерфейса.</span><span class="sxs-lookup"><span data-stu-id="9c34d-152">Notice that if you want to display the creation or modification time in the user interface, you would want to first convert the time to PST to be consistent with the rest of the user interface.</span></span>
[<span data-ttu-id="9c34d-153">Office.context.mailbox.displayNewAppointmentForm</span><span class="sxs-lookup"><span data-stu-id="9c34d-153">Office.context.mailbox.displayNewAppointmentForm</span></span>](../reference/objectmodel/preview-requirement-set/office.context.mailbox.md#methods)|<span data-ttu-id="9c34d-154">Для каждого из параметров _Start_ и _End_ требуется объект JavaScript `Date` .</span><span class="sxs-lookup"><span data-stu-id="9c34d-154">Each of the  _Start_ and _End_ parameters requires a JavaScript `Date` object.</span></span> <span data-ttu-id="9c34d-155">Аргументы должны быть правильно заданы в формате UTC независимо от часового пояса, используемого в пользовательском интерфейсе в расширенном клиенте Outlook или в Интернете или на мобильных устройствах.</span><span class="sxs-lookup"><span data-stu-id="9c34d-155">The arguments should be UTC-correct regardless of the time zone used in the user interface of an Outlook rich client, or Outlook on the web or mobile devices.</span></span>|<span data-ttu-id="9c34d-156">Если значениями начального и конечного времени для формы встречи являются 9 и 11 часов утра в формате времени UTC, следует убедиться, что аргументы `start` и `end` правильны относительно формата времени UTC. Это означает, что для метода</span><span class="sxs-lookup"><span data-stu-id="9c34d-156">If the start and end times for the appointment form are 9am UTC and 11am UTC, then you should assure that the `start` and `end` arguments are UTC-correct, which means:</span></span><br/><br/><ul><li><span data-ttu-id="9c34d-157">`start.getUTCHours` возвращается значение 9 часов утра в формате времени UTC, а для метода</span><span class="sxs-lookup"><span data-stu-id="9c34d-157">`start.getUTCHours` returns 9am UTC</span></span></li><li><span data-ttu-id="9c34d-158">`end.getUTCHours` возвращается значение 11 часов утра в формате времени UTC</span><span class="sxs-lookup"><span data-stu-id="9c34d-158">`end.getUTCHours` returns 11am UTC</span></span></li></ul>|<span data-ttu-id="9c34d-159">Если значениями начального и конечного времени для формы встречи являются 9 и 11 часов утра в формате времени UTC, следует убедиться, что аргументы `start` и `end` правильны относительно формата времени UTC. Это означает, что для метода</span><span class="sxs-lookup"><span data-stu-id="9c34d-159">If the start and end times for the appointment form are 9am UTC and 11am UTC, then you should assure that the `start` and `end` arguments are UTC-correct, which means:</span></span><br/><br/><ul><li><span data-ttu-id="9c34d-160">`start.getUTCHours` возвращается значение 9 часов утра в формате времени UTC, а для метода</span><span class="sxs-lookup"><span data-stu-id="9c34d-160">`start.getUTCHours` returns 9am UTC</span></span></li><li><span data-ttu-id="9c34d-161">`end.getUTCHours` возвращается значение 11 часов утра в формате времени UTC</span><span class="sxs-lookup"><span data-stu-id="9c34d-161">`end.getUTCHours` returns 11am UTC</span></span></li></ul>

## <a name="helper-methods-for-date-related-scenarios"></a><span data-ttu-id="9c34d-162">Вспомогательные методы для сценариев, связанных с датами</span><span class="sxs-lookup"><span data-stu-id="9c34d-162">Helper methods for date-related scenarios</span></span>


<span data-ttu-id="9c34d-163">Как описано в предыдущих разделах, так как "Местное время" для пользователя в Outlook в Интернете или мобильных устройствах может различаться в расширенном клиенте Outlook, но объект JavaScript **Date** поддерживает преобразование только в часовой пояс клиентского компьютера или в формате UTC, API JavaScript для Office предоставляет два вспомогательных метода: [Office. Context. Mailbox. convertToLocalClientTime](../reference/objectmodel/preview-requirement-set/office.context.mailbox.md#methods) и [Office. Context. Mailbox. convertToUtcClientTime](../reference/objectmodel/preview-requirement-set/office.context.mailbox.md#methods).</span><span class="sxs-lookup"><span data-stu-id="9c34d-163">As described in the preceding sections, because the "local time" for a user in Outlook on the web or mobile devices can be different on an Outlook rich client, but the JavaScript **Date** object supports converting to only the client computer time zone or UTC, the Office JavaScript API provides two helper methods: [Office.context.mailbox.convertToLocalClientTime](../reference/objectmodel/preview-requirement-set/office.context.mailbox.md#methods) and [Office.context.mailbox.convertToUtcClientTime](../reference/objectmodel/preview-requirement-set/office.context.mailbox.md#methods).</span></span>

<span data-ttu-id="9c34d-164">Эти вспомогательные методы выполняют какие-либо действия по разным причинам для следующих двух сценариев, связанных с датами, в расширенном клиенте Outlook, Outlook в Интернете и на мобильных устройствах, что позволяет поднимать "однократная однократная" для разных клиентов вашей надстройки.</span><span class="sxs-lookup"><span data-stu-id="9c34d-164">These helper methods take care of any need to handle date or time differently for the following two date-related scenarios, in an Outlook rich client, Outlook on the web and mobile devices, thus reinforcing "write-once" for different clients of your add-in.</span></span>


### <a name="scenario-a-displaying-item-creation-or-modified-time"></a><span data-ttu-id="9c34d-165">Сценарий A. Отображение времени создания или изменения элементов</span><span class="sxs-lookup"><span data-stu-id="9c34d-165">Scenario A: Displaying item creation or modified time</span></span>

<span data-ttu-id="9c34d-166">`Item.dateTimeCreated`При отображении времени создания элемента () или времени изменения (`Item.dateTimeModified`в пользовательском интерфейсе сначала используется `convertToLocalClientTime` для преобразования `Date` объекта, предоставленного этими свойствами, для получения представления словаря в соответствующее местное время.</span><span class="sxs-lookup"><span data-stu-id="9c34d-166">If you are displaying the item creation time (`Item.dateTimeCreated`) or modification time (`Item.dateTimeModified`in the user interface, first use `convertToLocalClientTime` to convert the `Date` object provided by these properties to obtain a dictionary representation in the appropriate local time.</span></span> <span data-ttu-id="9c34d-167">Затем отображаются части даты словаря.</span><span class="sxs-lookup"><span data-stu-id="9c34d-167">Then display the parts of the dictionary date.</span></span> <span data-ttu-id="9c34d-168">Ниже приведен пример этого сценария.</span><span class="sxs-lookup"><span data-stu-id="9c34d-168">The following is an example of this scenario:</span></span>


```js
// This date is UTC-correct.
var myDate = Office.context.mailbox.item.dateTimeCreated;

// Call helper method to get date in dictionary format, 
// represented in the appropriate local time.
// In an Outlook rich client, this is dictionary format 
// in client computer time zone.
// In Outlook on the web or mobile devices, this dictionary 
// format is in EAC time zone.
var myLocalDictionaryDate = Office.context.mailbox.convertToLocalClientTime(myDate);

// Display different parts of the dictionary date.
document.write ("The item was created at " + myLocalDictionaryDate["hours"] + 
    ":" + myLocalDictionaryDate["minutes"]);)
```

<span data-ttu-id="9c34d-169">Обратите `convertToLocalClientTime` внимание, что в Outlook в Интернете или на мобильных устройствах применяется разница между расширенным клиентом Outlook и Outlook в Интернете.</span><span class="sxs-lookup"><span data-stu-id="9c34d-169">Note that `convertToLocalClientTime` takes care of the difference between an Outlook rich client, and Outlook on the web or mobile devices:</span></span>


- <span data-ttu-id="9c34d-170">Если `convertToLocalClientTime` обнаруживается, что текущий узел является полнофункциональным клиентом, метод преобразует `Date` представление в словарь в том же часовом поясе клиентского компьютера, который согласуется с остальным пользовательским интерфейсом расширенного клиента.</span><span class="sxs-lookup"><span data-stu-id="9c34d-170">If `convertToLocalClientTime` detects the current host is a rich client, the method converts the `Date` representation to a dictionary representation in the same client computer time zone, consistent with the rest of the rich client user interface.</span></span>
    
- <span data-ttu-id="9c34d-171">Если `convertToLocalClientTime` обнаруживается, что текущий узел находится в Outlook в Интернете или на мобильных устройствах, метод преобразует представление правильного `Date` формата времени в формате UTC в формат словаря в часовом поясе центра администрирования Exchange в соответствии с остальной частью Outlook в веб-интерфейсе или пользовательском интерфейсе мобильных устройств.</span><span class="sxs-lookup"><span data-stu-id="9c34d-171">If `convertToLocalClientTime` detects the current host is Outlook on the web or mobile devices, the method converts the UTC-correct `Date` representation to a dictionary format in the EAC time zone, consistent with the rest of the Outlook on the web or mobile devices user interface.</span></span>
    

### <a name="scenario-b-displaying-start-and-end-dates-in-a-new-appointment-form"></a><span data-ttu-id="9c34d-172">Сценарий Б. Отображение дат начала и окончания в форме создания встречи</span><span class="sxs-lookup"><span data-stu-id="9c34d-172">Scenario B: Displaying start and end dates in a new appointment form</span></span>

<span data-ttu-id="9c34d-173">Если вы используете в качестве входных данных различные части значения даты и времени, представленные в местном времени, и хотите предоставить это входное значение словаря в качестве времени начала или окончания в форме встречи, сначала используйте `convertToUtcClientTime` вспомогательный метод для преобразования значения словаря в соответствующий `Date` объект в формате UTC.</span><span class="sxs-lookup"><span data-stu-id="9c34d-173">If you are obtaining as input different parts of a date-time value represented in the local time, and would like to provide this dictionary input value as a start or end time in an appointment form, first use the `convertToUtcClientTime` helper method to convert the dictionary value to a UTC-correct `Date` object.</span></span>

<span data-ttu-id="9c34d-p110">В указанном ниже примере предположим, что `myLocalDictionaryStartDate` и `myLocalDictionaryEndDate` — значения даты и времени в формате словаря, полученные от пользователя. Эти значения берут за основу местное время, зависящее от ведущего приложения.</span><span class="sxs-lookup"><span data-stu-id="9c34d-p110">In the following example, assume  `myLocalDictionaryStartDate` and `myLocalDictionaryEndDate` are date-time values in dictionary format that you have obtained from the user. These values are based on the local time, dependent on the host application.</span></span>

```js
var myUTCCorrectStartDate = Office.context.mailbox.convertToUtcClientTime(myLocalDictionaryStartDate);
var myUTCCorrectEndDate = Office.context.mailbox.convertToUtcClientTime(myLocalDictionaryEndDate);

```

<span data-ttu-id="9c34d-176">В результате получаются значения `myUTCCorrectStartDate` и `myUTCCorrectEndDate`, соответствующие формату UTC.</span><span class="sxs-lookup"><span data-stu-id="9c34d-176">The resultant values,  `myUTCCorrectStartDate` and `myUTCCorrectEndDate`, are UTC-correct.</span></span> <span data-ttu-id="9c34d-177">Затем передайте `Date` эти объекты в качестве аргументов для параметров _Start_ и _End_ `Mailbox.displayNewAppointmentForm` метода, чтобы отобразить форму новой встречи.</span><span class="sxs-lookup"><span data-stu-id="9c34d-177">Then pass these `Date` objects as arguments for the _Start_ and _End_ parameters of the `Mailbox.displayNewAppointmentForm` method to display the new appointment form.</span></span>

<span data-ttu-id="9c34d-178">Обратите `convertToUtcClientTime` внимание, что в Outlook в Интернете или на мобильных устройствах применяется разница между расширенным клиентом Outlook и Outlook в Интернете.</span><span class="sxs-lookup"><span data-stu-id="9c34d-178">Note that `convertToUtcClientTime` takes care of the difference between an Outlook rich client, and Outlook on the web or mobile devices:</span></span>


- <span data-ttu-id="9c34d-179">Если `convertToUtcClientTime` обнаруживается, что текущий узел является расширенным клиентом Outlook, метод просто преобразует представление словаря в `Date` объект.</span><span class="sxs-lookup"><span data-stu-id="9c34d-179">If `convertToUtcClientTime` detects the current host is an Outlook rich client, the method simply converts the dictionary representation to a `Date` object.</span></span> <span data-ttu-id="9c34d-180">Этот `Date` объект является правильным временем в формате UTC, как `displayNewAppointmentForm`ожидалось.</span><span class="sxs-lookup"><span data-stu-id="9c34d-180">This `Date` object is UTC-correct, as expected by `displayNewAppointmentForm`.</span></span>
    
- <span data-ttu-id="9c34d-181">Если `convertToUtcClientTime` обнаруживается, что текущий узел находится в Outlook в Интернете или на мобильных устройствах, метод преобразует формат словаря значений даты и времени, выраженный в часовом поясе центра `Date` администрирования Exchange, в объект.</span><span class="sxs-lookup"><span data-stu-id="9c34d-181">If `convertToUtcClientTime` detects the current host is Outlook on the web or mobile devices, the method converts the dictionary format of the date and time values expressed in the EAC time zone to a `Date` object.</span></span> <span data-ttu-id="9c34d-182">Этот `Date` объект является правильным временем в формате UTC, как `displayNewAppointmentForm`ожидалось.</span><span class="sxs-lookup"><span data-stu-id="9c34d-182">This `Date` object is UTC-correct, as expected by `displayNewAppointmentForm`.</span></span>
    
## <a name="see-also"></a><span data-ttu-id="9c34d-183">См. также</span><span class="sxs-lookup"><span data-stu-id="9c34d-183">See also</span></span>

- [<span data-ttu-id="9c34d-184">Развертывание и установка надстроек Outlook для тестирования</span><span class="sxs-lookup"><span data-stu-id="9c34d-184">Deploy and install Outlook add-ins for testing</span></span>](testing-and-tips.md)