---
title: API надстроек Outlook
description: Узнайте, как ссылаться на API надстроек Outlook и объявлять разрешения в надстройке Outlook.
ms.date: 02/27/2020
localization_priority: Normal
ms.openlocfilehash: d09713da401c0298a6ebd756d6dfb3fd8dce5f0b
ms.sourcegitcommit: be23b68eb661015508797333915b44381dd29bdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/08/2020
ms.locfileid: "44607608"
---
# <a name="outlook-add-in-apis"></a><span data-ttu-id="bae6d-103">API надстроек Outlook</span><span class="sxs-lookup"><span data-stu-id="bae6d-103">Outlook add-in APIs</span></span>

<span data-ttu-id="bae6d-104">Чтобы использовать API-интерфейсы в надстройке Outlook, необходимо указать расположение библиотеки Office.js, набор требований, схему и разрешения.</span><span class="sxs-lookup"><span data-stu-id="bae6d-104">To use APIs in your Outlook add-in, you must specify the location of the Office.js library, the requirement set, the schema, and the permissions.</span></span> <span data-ttu-id="bae6d-105">В основном вы будете использовать API JavaScript для Office, предоставляемые через объект [Mailbox](#mailbox-object) .</span><span class="sxs-lookup"><span data-stu-id="bae6d-105">You'll primarily use the Office JavaScript APIs exposed through the [Mailbox](#mailbox-object) object.</span></span>

## <a name="officejs-library"></a><span data-ttu-id="bae6d-106">Библиотека Office.js</span><span class="sxs-lookup"><span data-stu-id="bae6d-106">Office.js library</span></span>

<span data-ttu-id="bae6d-107">Для взаимодействия с API надстроек Outlook необходимо использовать интерфейсы API JavaScript из библиотеки Office.js.</span><span class="sxs-lookup"><span data-stu-id="bae6d-107">To interact with the Outlook add-in API, you need to use the JavaScript APIs in Office.js.</span></span> <span data-ttu-id="bae6d-108">Сеть CDN для библиотеки: `https://appsforoffice.microsoft.com/lib/1/hosted/Office.js`.</span><span class="sxs-lookup"><span data-stu-id="bae6d-108">The CDN for the library is `https://appsforoffice.microsoft.com/lib/1/hosted/Office.js`.</span></span> <span data-ttu-id="bae6d-109">Надстройки, отправляемые в AppSource, должны ссылаться на библиотеку Office.js в этой сети CDN. Нельзя использовать локальную ссылку.</span><span class="sxs-lookup"><span data-stu-id="bae6d-109">Add-ins submitted to AppSource must reference Office.js by this CDN; they can't use a local reference.</span></span>

<span data-ttu-id="bae6d-110">Добавьте ссылку на сеть CDN в теге `<script>`, вложенном в тег `<head>`, на веб-странице (HTML-, ASPX- или PHP-файле), где определяется пользовательский интерфейс надстройки.</span><span class="sxs-lookup"><span data-stu-id="bae6d-110">Reference the CDN in a `<script>` tag in the `<head>` tag of the web page (.html, .aspx, or .php file) that implements the UI of your add-in.</span></span>

```HTML
<script src="https://appsforoffice.microsoft.com/lib/1/hosted/Office.js" type="text/javascript"></script>
```
<span data-ttu-id="bae6d-p103">При добавлении новых API-интерфейсов не будет меняться URL-адрес Office.js. Мы укажем другую версию в URL-адресе, только если изменится поведение API.</span><span class="sxs-lookup"><span data-stu-id="bae6d-p103">As we add new APIs, the URL to Office.js will stay the same. We will change the version in the URL only if we break an existing API behavior.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="bae6d-113">Создавая надстройку для любого ведущего приложения Office, ссылайтесь на API JavaScript для Office из `<head>` раздела страницы.</span><span class="sxs-lookup"><span data-stu-id="bae6d-113">When developing an add-in for any Office host application, reference the Office JavaScript API from inside the `<head>` section of the page.</span></span> <span data-ttu-id="bae6d-114">Это гарантирует, что API полностью инициализируется раньше всех элементов body.</span><span class="sxs-lookup"><span data-stu-id="bae6d-114">This ensures that the API is fully initialized prior to any body elements.</span></span> <span data-ttu-id="bae6d-115">Ведущим приложениям Office необходимо, чтобы надстройки инициализировались в течение 5 секунд после активации.</span><span class="sxs-lookup"><span data-stu-id="bae6d-115">Office hosts require that add-ins initialize within 5 seconds of activation.</span></span> <span data-ttu-id="bae6d-116">При превышении этого порога объявляется, что надстройка не отвечает, и отображается сообщение об ошибке.</span><span class="sxs-lookup"><span data-stu-id="bae6d-116">Crossing this threshold results in the add-in being declared unresponsive and an error message is displayed to the user.</span></span>

## <a name="requirement-sets"></a><span data-ttu-id="bae6d-117">Наборы требований</span><span class="sxs-lookup"><span data-stu-id="bae6d-117">Requirement sets</span></span>

<span data-ttu-id="bae6d-118">Все API Outlook относятся к набору требований `Mailbox`.</span><span class="sxs-lookup"><span data-stu-id="bae6d-118">All Outlook APIs belong to the `Mailbox` requirement set.</span></span> <span data-ttu-id="bae6d-119">Существуют разные версии набора обязательных элементов `Mailbox`. Каждый новый набор API, который мы выпускаем, относится к более высокой версии набора.</span><span class="sxs-lookup"><span data-stu-id="bae6d-119">The `Mailbox` requirement set has versions, and each new set of APIs that are released belongs to a higher version of the set.</span></span> <span data-ttu-id="bae6d-120">Не все клиенты Outlook поддерживают самый новый набор API при их выпуске, но если для клиента Outlook объявлена поддержка определенного набора обязательных элементов, то он поддерживает все API из этого набора.</span><span class="sxs-lookup"><span data-stu-id="bae6d-120">Not all Outlook clients will support the newest set of APIs when they are released, but if an Outlook client declares support for a requirement set, it will support all the APIs in that requirement set.</span></span>

<span data-ttu-id="bae6d-p106">Чтобы указать, в каких клиентах Outlook появляется надстройка, задайте минимальную версию набора требований в манифесте. Например, если указать набор требований версии 1.3, надстройка не будет отображаться в клиентах Outlook, не поддерживающих версию 1.3.</span><span class="sxs-lookup"><span data-stu-id="bae6d-p106">To control which Outlook clients the add-in appears in, specify a minimum requirement set version in the manifest. For example, if you specify requirement set version 1.3, the add-in will not show up in any Outlook client that doesn't support a minimum version of 1.3.</span></span>

<span data-ttu-id="bae6d-p107">Указание набора требований не означает, что надстройке будут доступны API-интерфейсы только из этой версии. Если в надстройке указан набор требований версии 1.1, но она выполняется в клиенте Outlook, поддерживающем версию 1.3, то надстройка может использовать API-интерфейсы версии 1.3. От набора требований зависит только то, в каких клиентах Outlook отображается надстройка.</span><span class="sxs-lookup"><span data-stu-id="bae6d-p107">Specifying a requirement set doesn't limit your add-in to the APIs in that version. If the add-in specifies requirement set v1.1 but is running in an Outlook client that supports v1.3, the add-in can still use v1.3 APIs. The requirement set only controls which Outlook clients the add-in appears in.</span></span>

<span data-ttu-id="bae6d-126">Чтобы проверить доступность API-интерфейсов из набора требований, версия которого выше указанной в манифесте, вы можете использовать стандартный код JavaScript:</span><span class="sxs-lookup"><span data-stu-id="bae6d-126">To check the availability of any APIs from a requirement set greater than the one specified in the manifest, you can use standard JavaScript:</span></span>

```js
if (item.somePropertyOrFunction) {
   item.somePropertyOrFunction...  
}
```

> [!NOTE]
> <span data-ttu-id="bae6d-127">Эти проверки необязательны для API, входящих в набор обязательных элементов версии, указанной в манифесте.</span><span class="sxs-lookup"><span data-stu-id="bae6d-127">These checks are not needed for any APIs that are in the requirement set version specified in the manifest.</span></span>

<span data-ttu-id="bae6d-128">Укажите минимальный набор обязательных элементов API для вашего сценария, без которого функции надстройки не будут работать.</span><span class="sxs-lookup"><span data-stu-id="bae6d-128">Specify the minimum requirement set that supports the critical set of APIs for your scenario, without which features of your add-in won't work.</span></span> <span data-ttu-id="bae6d-129">Набор обязательных элементов указывается в элементе `<Requirements>` манифеста.</span><span class="sxs-lookup"><span data-stu-id="bae6d-129">You specify the requirement set in the manifest in the `<Requirements>` element.</span></span> <span data-ttu-id="bae6d-130">Дополнительные сведения см. в статьях [Манифесты надстроек Outlook](manifests.md) и [Общие сведения о наборах обязательных элементов API Outlook](../reference/requirement-sets/outlook-api-requirement-sets.md).</span><span class="sxs-lookup"><span data-stu-id="bae6d-130">For more information, see [Outlook add-in manifests](manifests.md) and [Understanding Outlook API requirement sets](../reference/requirement-sets/outlook-api-requirement-sets.md).</span></span>

<span data-ttu-id="bae6d-131">Элемент `<Methods>` не применяется к надстройкам Outlook, поэтому невозможно объявить поддержку определенных методов.</span><span class="sxs-lookup"><span data-stu-id="bae6d-131">The `<Methods>` element doesn't apply to Outlook add-ins, so you can't declare support for specific methods.</span></span>

## <a name="permissions"></a><span data-ttu-id="bae6d-132">Разрешения</span><span class="sxs-lookup"><span data-stu-id="bae6d-132">Permissions</span></span>

<span data-ttu-id="bae6d-p109">Для использования необходимых API-интерфейсов надстройке нужны соответствующие разрешения. Разрешения делятся на четыре уровня. Дополнительные сведения см. в статье [Указание разрешений для доступа надстройки Outlook к почтовому ящику пользователя](understanding-outlook-add-in-permissions.md).</span><span class="sxs-lookup"><span data-stu-id="bae6d-p109">Your add-in requires the appropriate permissions to use the APIs that it needs. There are four levels of permissions. For more details, see [Understanding Outlook add-in permissions](understanding-outlook-add-in-permissions.md).</span></span>

<br/>

|<span data-ttu-id="bae6d-136">Уровень разрешений</span><span class="sxs-lookup"><span data-stu-id="bae6d-136">Permission level</span></span>|<span data-ttu-id="bae6d-137">Описание</span><span class="sxs-lookup"><span data-stu-id="bae6d-137">Description</span></span>|
|:-----|:-----|
| <span data-ttu-id="bae6d-138">**Ограниченный доступ**</span><span class="sxs-lookup"><span data-stu-id="bae6d-138">**Restricted**</span></span> | <span data-ttu-id="bae6d-139">Позволяет использовать сущности, но не регулярные выражения.</span><span class="sxs-lookup"><span data-stu-id="bae6d-139">Allows use of entities but not regular expressions.</span></span> |
| <span data-ttu-id="bae6d-140">**Чтение элемента**</span><span class="sxs-lookup"><span data-stu-id="bae6d-140">**Read item**</span></span> | <span data-ttu-id="bae6d-141">Помимо возможностей уровня **Ограниченный доступ**, поддерживаются:</span><span class="sxs-lookup"><span data-stu-id="bae6d-141">In addition to what is allowed in **Restricted**, it allows:</span></span><ul><li><span data-ttu-id="bae6d-142">регулярные выражения;</span><span class="sxs-lookup"><span data-stu-id="bae6d-142">regular expressions</span></span></li><li><span data-ttu-id="bae6d-143">доступ на чтение API надстроек Outlook;</span><span class="sxs-lookup"><span data-stu-id="bae6d-143">Outlook add-in API read access</span></span></li><li><span data-ttu-id="bae6d-144">получение свойств элемента и маркера обратного вызова.</span><span class="sxs-lookup"><span data-stu-id="bae6d-144">getting the item properties and the callback token</span></span></li></ul> |
| <span data-ttu-id="bae6d-145">**Чтение и запись**</span><span class="sxs-lookup"><span data-stu-id="bae6d-145">**Read/write**</span></span> | <span data-ttu-id="bae6d-146">Помимо возможностей уровня **Чтение элемента**, поддерживаются:</span><span class="sxs-lookup"><span data-stu-id="bae6d-146">In addition to what is allowed in **Read item**, it allows:</span></span><ul><li><span data-ttu-id="bae6d-147">полный доступ ко всем элементам API Outlook, кроме метода `makeEwsRequestAsync`;</span><span class="sxs-lookup"><span data-stu-id="bae6d-147">full Outlook add-in API access except `makeEwsRequestAsync`</span></span></li><li><span data-ttu-id="bae6d-148">задание свойств элемента.</span><span class="sxs-lookup"><span data-stu-id="bae6d-148">setting the item properties</span></span></li></ul> |
| <span data-ttu-id="bae6d-149">**Чтение и запись почтового ящика**</span><span class="sxs-lookup"><span data-stu-id="bae6d-149">**Read/write mailbox**</span></span> | <span data-ttu-id="bae6d-150">Помимо возможностей уровня **Чтение и запись**, поддерживаются:</span><span class="sxs-lookup"><span data-stu-id="bae6d-150">In addition to what is allowed in **Read/write**, it allows:</span></span><ul><li><span data-ttu-id="bae6d-151">создание, чтение и запись элементов и папок;</span><span class="sxs-lookup"><span data-stu-id="bae6d-151">creating, reading, writing items and folders</span></span></li><li><span data-ttu-id="bae6d-152">отправка папок;</span><span class="sxs-lookup"><span data-stu-id="bae6d-152">sending items</span></span></li><li><span data-ttu-id="bae6d-153">вызов метода [makeEwsRequestAsync](../reference/objectmodel/preview-requirement-set/office.context.mailbox.md#methods).</span><span class="sxs-lookup"><span data-stu-id="bae6d-153">calling [makeEwsRequestAsync](../reference/objectmodel/preview-requirement-set/office.context.mailbox.md#methods)</span></span></li></ul> |

<span data-ttu-id="bae6d-154">Как правило, следует указывать минимальные разрешения, необходимые надстройке.</span><span class="sxs-lookup"><span data-stu-id="bae6d-154">In general, you should specify the minimum permission needed for your add-in.</span></span> <span data-ttu-id="bae6d-155">Разрешения объявляются в элементе `<Permissions>` манифеста.</span><span class="sxs-lookup"><span data-stu-id="bae6d-155">Permissions are declared in the `<Permissions>` element in the manifest.</span></span> <span data-ttu-id="bae6d-156">Дополнительные сведения см. в статье [Манифесты надстроек Outlook](manifests.md).</span><span class="sxs-lookup"><span data-stu-id="bae6d-156">For more information, see [Outlook add-in manifests](manifests.md).</span></span> <span data-ttu-id="bae6d-157">Сведения о вопросах безопасности можно найти в статье [Конфиденциальность и безопасность для надстроек Office](../concepts/privacy-and-security.md).</span><span class="sxs-lookup"><span data-stu-id="bae6d-157">For information about security issues, see [Privacy and security for Office Add-ins](../concepts/privacy-and-security.md).</span></span>

## <a name="mailbox-object"></a><span data-ttu-id="bae6d-158">Объект Mailbox</span><span class="sxs-lookup"><span data-stu-id="bae6d-158">Mailbox object</span></span>

[!include[information about Mailbox object](../includes/mailbox-object-desc.md)]

## <a name="see-also"></a><span data-ttu-id="bae6d-159">См. также</span><span class="sxs-lookup"><span data-stu-id="bae6d-159">See also</span></span>

- [<span data-ttu-id="bae6d-160">Манифесты надстроек Outlook</span><span class="sxs-lookup"><span data-stu-id="bae6d-160">Outlook add-in manifests</span></span>](manifests.md)
- [<span data-ttu-id="bae6d-161">Общие сведения о наборах требований API Outlook</span><span class="sxs-lookup"><span data-stu-id="bae6d-161">Understanding Outlook API requirement sets</span></span>](../reference/requirement-sets/outlook-api-requirement-sets.md)
- [<span data-ttu-id="bae6d-162">Конфиденциальность и безопасность надстроек Office</span><span class="sxs-lookup"><span data-stu-id="bae6d-162">Privacy and security for Office Add-ins</span></span>](../concepts/privacy-and-security.md)
