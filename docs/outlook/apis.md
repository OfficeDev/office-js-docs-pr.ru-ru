---
title: API надстроек Outlook
description: Узнайте, как ссылаться на API надстроек Outlook и объявлять разрешения в надстройке Outlook.
ms.date: 02/27/2020
localization_priority: Normal
ms.openlocfilehash: d7458eebf16a3d9373e59aa0455234437f25289b
ms.sourcegitcommit: 9609bd5b4982cdaa2ea7637709a78a45835ffb19
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/28/2020
ms.locfileid: "47293998"
---
# <a name="outlook-add-in-apis"></a>API надстроек Outlook

Чтобы использовать API-интерфейсы в надстройке Outlook, необходимо указать расположение библиотеки Office.js, набор требований, схему и разрешения. В основном вы будете использовать API JavaScript для Office, предоставляемые через объект [Mailbox](#mailbox-object) .

## <a name="officejs-library"></a>Библиотека Office.js

Для взаимодействия с API надстроек Outlook необходимо использовать интерфейсы API JavaScript из библиотеки Office.js. Сеть CDN для библиотеки: `https://appsforoffice.microsoft.com/lib/1/hosted/Office.js`. Надстройки, отправляемые в AppSource, должны ссылаться на библиотеку Office.js в этой сети CDN. Нельзя использовать локальную ссылку.

Добавьте ссылку на сеть CDN в теге `<script>`, вложенном в тег `<head>`, на веб-странице (HTML-, ASPX- или PHP-файле), где определяется пользовательский интерфейс надстройки.

```HTML
<script src="https://appsforoffice.microsoft.com/lib/1/hosted/Office.js" type="text/javascript"></script>
```
При добавлении новых API-интерфейсов не будет меняться URL-адрес Office.js. Мы укажем другую версию в URL-адресе, только если изменится поведение API.

> [!IMPORTANT]
> Когда вы разрабатываете надстройку для любого клиентского приложения Office, ссылайтесь на API JavaScript для Office из `<head>` раздела страницы. Это гарантирует, что API полностью инициализируется раньше всех элементов body. Приложения Office требуют, чтобы надстройки инициализирулись в течение 5 секунд после активации. При превышении этого порога объявляется, что надстройка не отвечает, и отображается сообщение об ошибке.

## <a name="requirement-sets"></a>Наборы требований

Все API Outlook относятся к набору требований `Mailbox`. Существуют разные версии набора обязательных элементов `Mailbox`. Каждый новый набор API, который мы выпускаем, относится к более высокой версии набора. Не все клиенты Outlook поддерживают самый новый набор API при их выпуске, но если для клиента Outlook объявлена поддержка определенного набора обязательных элементов, то он поддерживает все API из этого набора.

Чтобы указать, в каких клиентах Outlook появляется надстройка, задайте минимальную версию набора требований в манифесте. Например, если указать набор требований версии 1.3, надстройка не будет отображаться в клиентах Outlook, не поддерживающих версию 1.3.

Указание набора требований не означает, что надстройке будут доступны API-интерфейсы только из этой версии. Если в надстройке указан набор требований версии 1.1, но она выполняется в клиенте Outlook, поддерживающем версию 1.3, то надстройка может использовать API-интерфейсы версии 1.3. От набора требований зависит только то, в каких клиентах Outlook отображается надстройка.

Чтобы проверить доступность API-интерфейсов из набора требований, версия которого выше указанной в манифесте, вы можете использовать стандартный код JavaScript:

```js
if (item.somePropertyOrFunction) {
   item.somePropertyOrFunction...  
}
```

> [!NOTE]
> Эти проверки необязательны для API, входящих в набор обязательных элементов версии, указанной в манифесте.

Укажите минимальный набор обязательных элементов API для вашего сценария, без которого функции надстройки не будут работать. Набор обязательных элементов указывается в элементе `<Requirements>` манифеста. Дополнительные сведения см. в статьях [Манифесты надстроек Outlook](manifests.md) и [Общие сведения о наборах обязательных элементов API Outlook](../reference/requirement-sets/outlook-api-requirement-sets.md).

Элемент `<Methods>` не применяется к надстройкам Outlook, поэтому невозможно объявить поддержку определенных методов.

## <a name="permissions"></a>Разрешения

Для использования необходимых API-интерфейсов надстройке нужны соответствующие разрешения. Разрешения делятся на четыре уровня. Дополнительные сведения см. в статье [Указание разрешений для доступа надстройки Outlook к почтовому ящику пользователя](understanding-outlook-add-in-permissions.md).

<br/>

|Уровень разрешений|Описание|
|:-----|:-----|
| **Ограниченный доступ** | Позволяет использовать сущности, но не регулярные выражения. |
| **Чтение элемента** | Помимо возможностей уровня **Ограниченный доступ**, поддерживаются:<ul><li>регулярные выражения;</li><li>доступ на чтение API надстроек Outlook;</li><li>получение свойств элемента и маркера обратного вызова.</li></ul> |
| **Чтение и запись** | Помимо возможностей уровня **Чтение элемента**, поддерживаются:<ul><li>полный доступ ко всем элементам API Outlook, кроме метода `makeEwsRequestAsync`;</li><li>задание свойств элемента.</li></ul> |
| **Чтение и запись почтового ящика** | Помимо возможностей уровня **Чтение и запись**, поддерживаются:<ul><li>создание, чтение и запись элементов и папок;</li><li>отправка папок;</li><li>вызов метода [makeEwsRequestAsync](../reference/objectmodel/preview-requirement-set/office.context.mailbox.md#methods).</li></ul> |

Как правило, следует указывать минимальные разрешения, необходимые надстройке. Разрешения объявляются в элементе `<Permissions>` манифеста. Дополнительные сведения см. в статье [Манифесты надстроек Outlook](manifests.md). Сведения о вопросах безопасности можно найти в статье [Конфиденциальность и безопасность для надстроек Office](../concepts/privacy-and-security.md).

## <a name="mailbox-object"></a>Объект Mailbox

[!include[information about Mailbox object](../includes/mailbox-object-desc.md)]

## <a name="see-also"></a>См. также

- [Манифесты надстроек Outlook](manifests.md)
- [Общие сведения о наборах требований API Outlook](../reference/requirement-sets/outlook-api-requirement-sets.md)
- [Конфиденциальность и безопасность надстроек Office](../concepts/privacy-and-security.md)
