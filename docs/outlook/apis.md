---
title: API надстроек Outlook
description: Узнайте, как ссылаться на API надстроек Outlook и объявлять разрешения в надстройке Outlook.
ms.date: 06/30/2022
ms.localizationpriority: medium
ms.openlocfilehash: 583d2b07a0590e7a04b052d5675320b8ea73a61f
ms.sourcegitcommit: 4ba5f750358c139c93eb2170ff2c97322dfb50df
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/06/2022
ms.locfileid: "66660258"
---
# <a name="outlook-add-in-apis"></a>API надстроек Outlook

Чтобы использовать API-интерфейсы в надстройке Outlook, необходимо указать расположение библиотеки Office.js, набор требований, схему и разрешения. В основном вы будете использовать API JavaScript для Office, предоставляемые через объект [Mailbox](#mailbox-object) .

## <a name="officejs-library"></a>Библиотека Office.js

Для взаимодействия с [API надстройки Outlook необходимо использовать API](/javascript/api/outlook) JavaScript в Office.js. Сеть доставки содержимого (CDN) для библиотеки имеет значение `https://appsforoffice.microsoft.com/lib/1/hosted/Office.js`. Надстройки, отправляемые в AppSource, должны ссылаться на библиотеку Office.js в этой сети CDN. Нельзя использовать локальную ссылку.

Добавьте ссылку на сеть CDN в теге `<script>`, вложенном в тег `<head>`, на веб-странице (HTML-, ASPX- или PHP-файле), где определяется пользовательский интерфейс надстройки.

```HTML
<script src="https://appsforoffice.microsoft.com/lib/1/hosted/Office.js" type="text/javascript"></script>
```

При добавлении новых API-интерфейсов не будет меняться URL-адрес Office.js. Мы укажем другую версию в URL-адресе, только если изменится поведение API.

> [!IMPORTANT]
> При разработке надстройки для любого клиентского приложения Office используйте ссылку на API `<head>` JavaScript для Office из раздела страницы. Это гарантирует, что API полностью инициализируется раньше всех элементов body.

## <a name="requirement-sets"></a>Наборы обязательных элементов

Все API Outlook относятся к [набору обязательных элементов почтового ящика](/javascript/api/requirement-sets/outlook/outlook-api-requirement-sets). Существуют разные версии набора обязательных элементов `Mailbox`. Каждый новый набор API, который мы выпускаем, относится к более высокой версии набора. Не все клиенты Outlook поддерживают самый новый набор API при их выпуске, но если для клиента Outlook объявлена поддержка определенного набора обязательных элементов, то он поддерживает все API из этого набора.

Чтобы указать, в каких клиентах Outlook появляется надстройка, задайте минимальную версию набора требований в манифесте. Например, если указать набор требований версии 1.3, надстройка не будет отображаться в клиентах Outlook, не поддерживающих версию 1.3.

Указание набора требований не означает, что надстройке будут доступны API-интерфейсы только из этой версии. Если в надстройке указан набор требований версии 1.1, но она выполняется в клиенте Outlook, поддерживающем версию 1.3, то надстройка может использовать API-интерфейсы версии 1.3. От набора требований зависит только то, в каких клиентах Outlook отображается надстройка.

Чтобы проверить доступность API-интерфейсов из набора требований, версия которого выше указанной в манифесте, вы можете использовать стандартный код JavaScript:

```js
if (item.somePropertyOrFunction) {
   item.somePropertyOrFunction...  
}
```

> [!NOTE]
> Эти проверки необязательны для API, входящих в набор обязательных элементов версии, указанной в манифесте.

Укажите минимальный набор обязательных элементов API для вашего сценария, без которого функции надстройки не будут работать. Набор обязательных элементов указывается в манифесте в элементе **\<Requirements\>** . Дополнительные сведения см. в статьях [Манифесты надстроек Outlook](manifests.md) и [Общие сведения о наборах обязательных элементов API Outlook](/javascript/api/requirement-sets/outlook/outlook-api-requirement-sets).

Этот **\<Methods\>** элемент не применяется к надстройке Outlook, поэтому невозможно объявить поддержку определенных методов.

## <a name="permissions"></a>Разрешения

Для использования необходимых API-интерфейсов надстройке нужны соответствующие разрешения. Разрешения делятся на четыре уровня. Дополнительные сведения см. в статье [Указание разрешений для доступа надстройки Outlook к почтовому ящику пользователя](understanding-outlook-add-in-permissions.md).

<br/>

|Уровень разрешений|Описание|
|:-----|:-----|
| **Ограниченный доступ** | Позволяет использовать сущности, но не регулярные выражения. |
| **Чтение элемента** | Помимо возможностей уровня **Ограниченный доступ**, поддерживаются:<ul><li>регулярные выражения;</li><li>доступ на чтение API надстроек Outlook;</li><li>получение свойств элемента и маркера обратного вызова.</li></ul> |
| **Чтение и запись** | Помимо возможностей уровня **Чтение элемента**, поддерживаются:<ul><li>полный доступ ко всем элементам API Outlook, кроме метода `makeEwsRequestAsync`;</li><li>задание свойств элемента.</li></ul> |
| **Чтение и запись почтового ящика** | Помимо возможностей уровня **Чтение и запись**, поддерживаются:<ul><li>создание, чтение и запись элементов и папок;</li><li>отправка папок;</li><li>вызов метода [makeEwsRequestAsync](/javascript/api/requirement-sets/outlook/preview-requirement-set/office.context.mailbox#methods).</li></ul> |

Как правило, следует указывать минимальные разрешения, необходимые надстройке. Разрешения объявляются в элементе **\<Permissions\>** манифеста. Дополнительные сведения см. в статье [Манифесты надстроек Outlook](manifests.md). Сведения о проблемах безопасности см. в [разделе "Конфиденциальность и безопасность для надстроек Office"](../concepts/privacy-and-security.md).

## <a name="mailbox-object"></a>Объект Mailbox

[!include[information about Mailbox object](../includes/mailbox-object-desc.md)]

## <a name="see-also"></a>См. также

- [Манифесты надстроек Outlook](manifests.md)
- [Общие сведения о наборах требований API Outlook](/javascript/api/requirement-sets/outlook/outlook-api-requirement-sets)
- [Конфиденциальность и безопасность надстроек Office](../concepts/privacy-and-security.md)
