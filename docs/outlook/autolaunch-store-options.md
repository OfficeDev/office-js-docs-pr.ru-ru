---
title: Параметры описания AppSource для надстройки Outlook на основе событий
description: Сведения о вариантах описания AppSource, доступных для надстройки Outlook, которая реализует активацию на основе событий.
ms.topic: article
ms.date: 07/11/2022
ms.localizationpriority: medium
ms.openlocfilehash: d8d2c2e9960d2aef2d32ede6e20eb5f1db125a6c
ms.sourcegitcommit: 9bb790f6264f7206396b32a677a9133ab4854d4e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/15/2022
ms.locfileid: "66797682"
---
# <a name="appsource-listing-options-for-your-event-based-outlook-add-in"></a>Параметры описания AppSource для надстройки Outlook на основе событий

В настоящее время надстройки должны быть развернуты администраторами организации, чтобы пользователи могли получить доступ к функциям функций на основе событий. Мы ограничим активацию на основе событий, если конечный пользователь приобрел надстройку непосредственно из AppSource. Например, если надстройка Contoso `LaunchEvent` `LaunchEvent Type` `LaunchEvents` включает точку расширения по крайней мере с одной определенной в узле, автоматический вызов надстройки происходит только в том случае, если надстройка была установлена для конечного пользователя администратором организации. В противном случае автоматический вызов надстройки блокируется. См. следующий фрагмент примера манифеста надстройки.

```xml
...
<ExtensionPoint xsi:type="LaunchEvent">
  <LaunchEvents>
    <LaunchEvent Type="OnNewMessageCompose" FunctionName="onMessageComposeHandler"/>
    ...
```

Конечный пользователь или администратор может приобрести надстройки через AppSource или Магазин Office в приложении. Если основной сценарий или рабочий процесс надстройки требует активации на основе событий, может потребоваться ограничить доступ к надстройки развертыванию администратора. Чтобы включить это ограничение, можно указать URL-адреса кода тестового приложения. Благодаря кодам рейсов только конечные пользователи с этими специальными URL-адресами могут получить доступ к списку. Ниже приведен пример URL-адреса.

`https://appsource.microsoft.com/product/office/WA200002862?flightCodes=EventBasedTest1`

Пользователи и администраторы не могут явно искать надстройку по ее имени в AppSource или в Магазине Office в приложении, если для нее включен тестовый код. Как создатель надстройки вы можете предоставлять администраторам организации частный доступ к этим кодам тестов для развертывания надстроек.

> [!NOTE]
> Хотя конечные пользователи могут установить надстройку с помощью тестового кода, она не будет включать активацию на основе событий.

## <a name="specify-a-flight-code"></a>Указание кода тестового пакета

Чтобы указать тестовый код для надстройки, поделитесь этой информацией в  примечаниях для сертификации при публикации надстройки. _**Важно!**_ Коды рейсов чувствительны к регистру.

![Снимок экрана: пример запроса тестового кода в примечаниях для экрана сертификации во время публикации.](../images/outlook-publish-notes-for-certification-1.png)

## <a name="deploy-add-in-with-flight-code"></a>Развертывание надстройки с помощью тестового кода

После установки кодов тестового пакета вы получите URL-адрес от группы сертификации приложений. Затем вы можете поделиться URL-адресом с администраторами в частном режиме.

Чтобы развернуть надстройку, администратор может выполнить следующие действия.

- Войдите в admin.microsoft.com или AppSource.com учетную запись администратора Microsoft 365. Если для надстройки включен единый вход, требуются учетные данные глобального администратора.
- Откройте URL-адрес тестового кода в веб-браузере.
- На странице описания надстройки нажмите кнопку **"Получить сейчас"**. Вы должны быть перенаправлены на портал интегрированного приложения.

## <a name="unrestricted-appsource-listing"></a>Неограниченный список AppSource

Если надстройка не использует активацию на основе событий для критически важных сценариев (то есть надстройка хорошо работает без автоматического вызова), рассмотрите возможность перечисления надстройки в AppSource без специальных кодов тестов. Если пользователь получает надстройку из AppSource, автоматическая активация для пользователя не выполняется. Однако они могут использовать другие компоненты надстройки, такие как область задач или команда функции.

> [!IMPORTANT]
> Это временное ограничение. В будущем мы планируем включить активацию надстройки на основе событий для конечных пользователей, которые получают надстройку напрямую.

## <a name="update-existing-add-ins-to-include-event-based-activation"></a>Обновление существующих надстроек для активации на основе событий

Вы можете обновить существующую надстройку, чтобы включить активацию на основе событий, а затем повторно отправить ее для проверки и решить, хотите ли вы использовать ограниченный или неограниченный список AppSource.

После утверждения обновленной надстройки администраторы организации, которые ранее развернули надстройку, получат сообщение об обновлении в разделе "Интегрированные приложения" Центра администрирования. Это сообщение рекомендует администратору об изменениях активации на основе событий. После того как администратор примет изменения, обновление будет развернуто для конечных пользователей.

![Снимок экрана: уведомление об обновлении приложения на экране "Интегрированные приложения".](../images/outlook-deploy-update-notification.png)

Для конечных пользователей, которые установили надстройку самостоятельно, функция активации на основе событий не будет работать даже после обновления надстройки.

## <a name="admin-consent-for-installing-event-based-add-ins"></a>Администратор согласия на установку надстроек на основе событий

Каждый раз, когда надстройка на основе событий развертывается с экрана "Интегрированные приложения", администратор получает сведения о возможностях активации на основе событий надстройки в мастере развертывания. Подробные сведения отображаются **в разделе "Разрешения и возможности приложения** ". Администратор должен просмотреть все события, в которых надстройка может автоматически активироваться.

![Снимок экрана: экран "Принять запросы разрешений" при развертывании нового приложения.](../images/outlook-deploy-accept-permissions-requests.png)

Аналогичным образом, когда существующая надстройка обновляется до функции на основе событий, администратор видит в надстройке состояние "Ожидание обновления". Обновленная надстройка развертывается только в том случае, если администратор дает согласие на изменения, указанные в разделе "Разрешения и возможности приложения", включая набор событий, в которых надстройка может автоматически активироваться.

Каждый раз, `LaunchEvent Type` когда вы добавляете новые возможности в надстройку, администраторы будут видеть поток обновления на портале администрирования и должны предоставить согласие на дополнительные события.

![Снимок экрана: поток Обновления при развертывании обновленного приложения.](../images/outlook-deploy-update-flow.png)

## <a name="see-also"></a>См. также

- [Настройка надстройки Outlook для активации на основе событий](autolaunch.md)
