---
title: Устранение неполадок при активации контекстных надстроек Outlook
description: Если ваша надстройка не активируется надлежащим образом, это может быть вызвано указанными ниже причинами.
ms.date: 05/27/2020
localization_priority: Normal
ms.openlocfilehash: 555ae2a45bf49d74d1fd439258fd87035644e86a
ms.sourcegitcommit: 77617f6ad06e07f5ff8078b26301748f73e2ee01
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/29/2020
ms.locfileid: "44413184"
---
# <a name="troubleshoot-outlook-add-in-activation"></a><span data-ttu-id="bdf2e-103">Устранение неполадок при активации надстроек Outlook</span><span class="sxs-lookup"><span data-stu-id="bdf2e-103">Troubleshoot Outlook add-in activation</span></span>

<span data-ttu-id="bdf2e-p101">Активация контекстных надстроек Outlook основана на правилах активации, указанных в манифесте надстройки. Если условия выбранного элемента соответствуют правилам активации надстройки, ведущее приложение активирует и отображает кнопку надстройки в пользовательском интерфейсе Outlook (в области выбора надстройки для формы создания или области надстроек для формы просмотра). Однако если ваша надстройка не активируется надлежащим образом, это может быть вызвано указанными ниже причинами.</span><span class="sxs-lookup"><span data-stu-id="bdf2e-p101">Outlook contextual add-in activation is based on the activation rules in the add-in manifest. When conditions for the currently selected item satisfy the activation rules for the add-in, the host application activates and displays the add-in button in the Outlook UI (add-in selection pane for compose add-ins, add-in bar for read add-ins). However, if your add-in doesn't activate as you expect, you should look into the following areas for possible reasons.</span></span>

## <a name="is-user-mailbox-on-a-version-of-exchange-server-that-is-at-least-exchange-2013"></a><span data-ttu-id="bdf2e-107">Размещен ли почтовый ящик пользователя в Exchange Server версии не ниже Exchange 2013?</span><span class="sxs-lookup"><span data-stu-id="bdf2e-107">Is user mailbox on a version of Exchange Server that is at least Exchange 2013?</span></span>

<span data-ttu-id="bdf2e-p102">В первую очередь убедитесь, что тестируемая учетная запись пользователя находится в Exchange Server версии не ниже Exchange 2013. Если вы используете какие-либо функции, выпущенные после Exchange 2013, убедитесь, что учетная запись пользователя размещена в соответствующей версии Exchange.</span><span class="sxs-lookup"><span data-stu-id="bdf2e-p102">First, ensure that the user's email account you're testing with is on a version of Exchange Server that is at least Exchange 2013. If you are using specific features that are released after Exchange 2013, make sure the user's account is on the appropriate version of Exchange.</span></span>

<span data-ttu-id="bdf2e-110">Версию Exchange 2013 можно проверить одним из указанных ниже способов.</span><span class="sxs-lookup"><span data-stu-id="bdf2e-110">You can verify the version of Exchange 2013 by using one of the following approaches:</span></span>

- <span data-ttu-id="bdf2e-111">Уточнить у администратора Exchange Server.</span><span class="sxs-lookup"><span data-stu-id="bdf2e-111">Check with your Exchange Server administrator.</span></span>

- <span data-ttu-id="bdf2e-p103">Если вы тестируете надстройку в Outlook в Интернете или на мобильных устройствах, в отладчике сценариев (например, в отладчике JScript Debugger, который поставляется с Internet Explorer) найдите атрибут **src** тега **script**, указывающий расположение, из которого выполняется загрузка сценариев. Этот путь должен содержать подстроку **owa/15.0.516.x/owa2/...**, где **15.0.516.x** — это версия Exchange Server, например **15.0.516.2**.</span><span class="sxs-lookup"><span data-stu-id="bdf2e-p103">If you are testing the add-in on Outlook on the web or mobile devices, in a script debugger (for example, the JScript Debugger that comes with Internet Explorer), look for the **src** attribute of the **script** tag that specifies the location from which scripts are loaded. The path should contain a substring **owa/15.0.516.x/owa2/...**, where **15.0.516.x** represents the version of the Exchange Server, such as **15.0.516.2**.</span></span>

- <span data-ttu-id="bdf2e-p104">Кроме того, вы можете проверить версию с помощью свойства [Office.context.mailbox.diagnostics.hostVersion](/javascript/api/outlook/office.diagnostics#hostversion). В Outlook в Интернете и на мобильных устройствах это свойство возвращает сведения о версии Exchange Server.</span><span class="sxs-lookup"><span data-stu-id="bdf2e-p104">Alternatively, you can use the [Office.context.mailbox.diagnostics.hostVersion](/javascript/api/outlook/office.diagnostics#hostversion) property to verify the version. On Outlook on the web and mobile devices, this property returns the version of the Exchange Server.</span></span>

- <span data-ttu-id="bdf2e-116">Если у вас есть возможность тестировать надстройку в Outlook, то вы можете применить указанный ниже простой способ отладки, в котором используются объектная модель Outlook и редактор Visual Basic.</span><span class="sxs-lookup"><span data-stu-id="bdf2e-116">If you can test the add-in on Outlook, you can use the following simple debugging technique that uses the Outlook object model and Visual Basic Editor:</span></span>

    1. <span data-ttu-id="bdf2e-p105">Во-первых, убедитесь, что включены макросы для Outlook. Выберите элементы **Файл** > **Параметры** > **Центр управления безопасностью** > **Параметры центра управления безопасностью** > **Параметры макросов**. Убедитесь, что в центре управления безопасностью выбрано значение **Уведомления для всех макросов**. Кроме того, при запуске Outlook необходимо выбрать элемент **Включить макросы**.</span><span class="sxs-lookup"><span data-stu-id="bdf2e-p105">First, verify that macros are enabled for Outlook. Choose **File**, **Options**, **Trust Center**, **Trust Center Settings**, **Macro Settings**. Ensure that **Notifications for all macros** is selected in the Trust Center. You should have also selected **Enable Macros** during Outlook startup.</span></span>

    1. <span data-ttu-id="bdf2e-121">На вкладке **Разработчик** ленты выберите **Visual Basic**.</span><span class="sxs-lookup"><span data-stu-id="bdf2e-121">On the **Developer** tab of the ribbon, choose **Visual Basic**.</span></span>

       > [!NOTE]
       > <span data-ttu-id="bdf2e-p106">Не отображается вкладка **Разработчик**? Сведения о том, как ее включить, см. в статье[ Отображение вкладки "Разработчик" на ленте](/visualstudio/vsto/how-to-show-the-developer-tab-on-the-ribbon).</span><span class="sxs-lookup"><span data-stu-id="bdf2e-p106">Not seeing the **Developer** tab? See [How to: Show the Developer Tab on the Ribbon](/visualstudio/vsto/how-to-show-the-developer-tab-on-the-ribbon) to turn it on.</span></span>

    1. <span data-ttu-id="bdf2e-124">В редакторе Visual Basic выберите **Вид** > **Окно интерпретации**.</span><span class="sxs-lookup"><span data-stu-id="bdf2e-124">In the Visual Basic Editor, choose **View**, **Immediate Window**.</span></span>

    1. <span data-ttu-id="bdf2e-p107">Для отображения версии Exchange Server ввести в окне интерпретации следующее (основной номер версии в возвращаемом значении должен быть не ниже 15).</span><span class="sxs-lookup"><span data-stu-id="bdf2e-p107">Type the following in the Immediate window to display the version of the Exchange Server. The major version of the returned value must be equal to or greater than 15.</span></span>

       - <span data-ttu-id="bdf2e-127">Если в профиле пользователя только одна учетная запись Exchange:</span><span class="sxs-lookup"><span data-stu-id="bdf2e-127">If there is only one Exchange account in the user's profile:</span></span>

       ```vb
        ?Session.ExchangeMailboxServerVersion
       ```

       - <span data-ttu-id="bdf2e-128">Если в профиле пользователя несколько учетных записей Exchange (`emailAddress` представляет строку, содержащую основной SMTP-адрес пользователя):</span><span class="sxs-lookup"><span data-stu-id="bdf2e-128">If there are multiple Exchange accounts in the same user profile (`emailAddress` represents a string that contains the user's primary SMTP address):</span></span>

       ```vb
        ?Session.Accounts.Item(emailAddress).ExchangeMailboxServerVersion
       ```

## <a name="is-the-add-in-disabled"></a><span data-ttu-id="bdf2e-129">Не отключена ли надстройка?</span><span class="sxs-lookup"><span data-stu-id="bdf2e-129">Is the add-in disabled?</span></span>

<span data-ttu-id="bdf2e-p108">Любой из полнофункциональных клиентов Outlook может отключать надстройку в целях повышения производительности, учитывая превышение порога использования ядра ЦП или памяти, устойчивость при сбоях и продолжительность обработки всех регулярных выражений для надстройки. Когда это происходит, полнофункциональный клиент Outlook выводит уведомление, что надстройка отключается.</span><span class="sxs-lookup"><span data-stu-id="bdf2e-p108">Any one of the Outlook rich clients can disable an add-in for performance reasons, including exceeding usage thresholds for CPU core or memory, tolerance for crashes, and length of time to process all the regular expressions for an add-in. When this happens, the Outlook rich client displays a notification that it is disabling the add-in.</span></span>

> [!NOTE]
> <span data-ttu-id="bdf2e-132">Только полнофункциональные клиенты Outlook отслеживают использование ресурсов. При отключении надстройки в полнофункциональном клиенте Outlook она также отключается в Outlook в Интернете и на мобильных устройствах.</span><span class="sxs-lookup"><span data-stu-id="bdf2e-132">Only Outlook rich clients monitor resource usage, but disabling an add-in in an Outlook rich client also disables the add-in in Outlook on the web and mobile devices.</span></span>

<span data-ttu-id="bdf2e-133">Чтобы проверить, не отключена ли надстройка, используйте один из следующих способов:</span><span class="sxs-lookup"><span data-stu-id="bdf2e-133">Use one of the following approaches to verify whether an add-in is disabled:</span></span>

- <span data-ttu-id="bdf2e-134">В Outlook в Интернете войдите непосредственно в учетную запись почты, щелкните значок "Параметры" и выберите элемент **Управление надстройками**, чтобы перейти в Центр администрирования Exchange и проверить, включена ли эта надстройка.</span><span class="sxs-lookup"><span data-stu-id="bdf2e-134">In Outlook on the web, sign in directly to the email account, choose the Settings icon, and then choose **Manage add-ins** to go to the Exchange Admin Center, where you can verify whether the add-in is enabled.</span></span>

- <span data-ttu-id="bdf2e-135">В Outlook для Windows перейдите в представление Backstage и выберите **Управление надстройками**. Войдите в Центр администрирования Exchange и проверьте, включена ли надстройка.</span><span class="sxs-lookup"><span data-stu-id="bdf2e-135">In Outlook on Windows, go to the Backstage view and choose **Manage add-ins**. Sign in to the Exchange Admin Center to verify whether the add-in is enabled.</span></span>

- <span data-ttu-id="bdf2e-p109">В Outlook для Mac выберите пункт **Управление надстройками** на панели надстройки. Войдите в Центр администрирования Exchange и проверьте, включена ли надстройка.</span><span class="sxs-lookup"><span data-stu-id="bdf2e-p109">In Outlook on Mac, choose **Manage add-ins** in the add-in bar. Sign in to the Exchange Admin Center to verify whether the add-in is enabled.</span></span>

## <a name="does-the-tested-item-support-outlook-add-ins-is-the-selected-item-delivered-by-a-version-of-exchange-server-that-is-at-least-exchange-2013"></a><span data-ttu-id="bdf2e-p110">Поддерживает ли тестируемый элемент надстройки Outlook? Предоставлен ли выбранный элемент Exchange Server версии не ниже Exchange 2013?</span><span class="sxs-lookup"><span data-stu-id="bdf2e-p110">Does the tested item support Outlook add-ins? Is the selected item delivered by a version of Exchange Server that is at least Exchange 2013?</span></span>

<span data-ttu-id="bdf2e-140">Если ваша надстройка Outlook является надстройкой чтения, которая должна активироваться, когда пользователь просматривает сообщение (включая письма, приглашения на собрания, а также ответы и отмены) или встречу, хотя в целом эти элементы поддерживают надстройки, существуют исключения.</span><span class="sxs-lookup"><span data-stu-id="bdf2e-140">If your Outlook add-in is a read add-in and is supposed to be activated when the user is viewing a message (including email messages, meeting requests, responses, and cancellations) or appointment, even though these items generally support add-ins, there are exceptions.</span></span> <span data-ttu-id="bdf2e-141">Проверьте, относится ли выбранный элемент к одному из [списка элементов, для которых надстройки Outlook не активируются](outlook-add-ins-overview.md#mailbox-items-available-to-add-ins).</span><span class="sxs-lookup"><span data-stu-id="bdf2e-141">Check if the selected item is one of those [listed where Outlook add-ins do not activate](outlook-add-ins-overview.md#mailbox-items-available-to-add-ins).</span></span>

<span data-ttu-id="bdf2e-142">Кроме того, поскольку встречи всегда сохраняются в формате RTF, правило [ItemHasRegularExpressionMatch](../reference/manifest/rule.md#itemhasregularexpressionmatch-rule), которое задает значение **PropertyName** для **BodyAsHTML**, не будет активировать надстройку для встреч или сообщений, сохраненных в виде обычного текста или в формате RTF.</span><span class="sxs-lookup"><span data-stu-id="bdf2e-142">Also, because appointments are always saved in Rich Text Format, an [ItemHasRegularExpressionMatch](../reference/manifest/rule.md#itemhasregularexpressionmatch-rule) rule that specifies a **PropertyName** value of **BodyAsHTML** would not activate an add-in on an appointment or message that is saved in plain text or Rich Text Format.</span></span>

<span data-ttu-id="bdf2e-p112">Даже если почтовый элемент не относится к одному из указанных выше типов, при недоставке этого элемента Exchange Server не ниже версии Exchange 2013 известные сущности и свойства, например SMTP-адрес отправителя, не будут идентифицированы в этом элементе. Все правила активации, которые зависят от этих сущностей или свойств, не будут удовлетворены, и надстройка не будет активирована.</span><span class="sxs-lookup"><span data-stu-id="bdf2e-p112">Even if a mail item is not one of the above types, if the item was not delivered by a version of Exchange Server that is at least Exchange 2013, known entities and properties such as sender's SMTP address would not be identified on the item. Any activation rules that rely on these entities or properties would not be satisfied, and the add-in would not be activated.</span></span>

<span data-ttu-id="bdf2e-145">Если ваша надстройка является надстройкой создания, которая должна активироваться, когда пользователь создает сообщение или приглашение на собрание, убедитесь, что элемент не защищен с помощью IRM.</span><span class="sxs-lookup"><span data-stu-id="bdf2e-145">If your add-in is a compose add-in and is supposed to be activated when the user is authoring a message or meeting request, make sure the item is not protected by IRM.</span></span>

## <a name="is-the-add-in-manifest-installed-properly-and-does-outlook-have-a-cached-copy"></a><span data-ttu-id="bdf2e-146">Установлен ли манифест надстройки должным образом, и есть ли Outlook кэшированная копия?</span><span class="sxs-lookup"><span data-stu-id="bdf2e-146">Is the add-in manifest installed properly, and does Outlook have a cached copy?</span></span>

<span data-ttu-id="bdf2e-p113">Этот сценарий применим только к Outlook для Windows. Обычно при установке надстройки Outlook для почтового ящика Exchange Server копирует манифест надстройки из указанного вами расположения в почтовый ящик в Exchange Server. При каждом запуске Outlook считывает все манифесты, установленные для этого почтового ящика, во временный кэш в следующей папке:</span><span class="sxs-lookup"><span data-stu-id="bdf2e-p113">This scenario applies to only Outlook on Windows. Normally, when you install an Outlook add-in for a mailbox, the Exchange Server copies the add-in manifest from the location you indicate to the mailbox on that Exchange Server. Every time Outlook starts, it reads all the manifests installed for that mailbox into a temporary cache at the following location:</span></span>

```text
%LocalAppData%\Microsoft\Office\16.0\WEF
```

<span data-ttu-id="bdf2e-150">Например, для пользователя John кэш может находиться на сайте C:\Users\john\AppData\Local\Microsoft\Office\16.0\WEF.</span><span class="sxs-lookup"><span data-stu-id="bdf2e-150">For example, for the user John, the cache might be at C:\Users\john\AppData\Local\Microsoft\Office\16.0\WEF.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="bdf2e-151">Для Outlook 2013 в Windows используйте 15,0 вместо 16,0, чтобы это расположение было бы следующим:</span><span class="sxs-lookup"><span data-stu-id="bdf2e-151">For Outlook 2013 on Windows, use 15.0 instead of 16.0 so the location would be:</span></span>
>
> ```text
> %LocalAppData%\Microsoft\Office\15.0\WEF
> ```

<span data-ttu-id="bdf2e-p114">Если надстройка не активируется для каких-либо элементов, возможно, манифест неправильно установлен в Exchange Server или Outlook не прочитал этот манифест должным образом при запуске. С помощью Центра администрирования Exchange убедитесь, что надстройка установлена и включена для этого почтового ящика, и при необходимости перезагрузите Exchange Server.</span><span class="sxs-lookup"><span data-stu-id="bdf2e-p114">If an add-in does not activate for any items, the manifest might not have been installed properly on the Exchange Server, or Outlook has not read the manifest properly on startup. Using the Exchange Admin Center, ensure that the add-in is installed and enabled for your mailbox, and reboot the Exchange Server, if necessary.</span></span>

<span data-ttu-id="bdf2e-154">На рисунке 1 показана сводка действий, которые необходимо выполнить, чтобы проверить правильность версии манифеста в Outlook.</span><span class="sxs-lookup"><span data-stu-id="bdf2e-154">Figure 1 shows a summary of the steps to verify whether Outlook has a valid version of the manifest.</span></span>

<span data-ttu-id="bdf2e-155">**Рис. 1. Блок-схема действий по проверке правильности кэширования манифеста в Outlook**</span><span class="sxs-lookup"><span data-stu-id="bdf2e-155">**Figure 1. Flow chart of the steps to verify whether Outlook properly cached the manifest**</span></span>

![Блок-схема для проверки манифеста](../images/troubleshoot-manifest-flow.png)

<span data-ttu-id="bdf2e-157">В следующей процедуре подробно описываются эти действия.</span><span class="sxs-lookup"><span data-stu-id="bdf2e-157">The following procedure describes the details.</span></span>

1. <span data-ttu-id="bdf2e-158">Если вы изменили манифест, не закрывая Outlook, и для разработки надстройки не используете Visual Studio 2012 или более поздней версии, то следует удалить надстройку и установить ее еще раз с помощью Центра администрирования Exchange.</span><span class="sxs-lookup"><span data-stu-id="bdf2e-158">If you have modified the manifest while Outlook is open, and you are not using Visual Studio 2012 or a later version of Visual Studio to develop the add-in, you should uninstall the add-in and reinstall it using the Exchange Admin Center.</span></span>

1. <span data-ttu-id="bdf2e-159">Перезапустите Outlook и проверьте, активирует ли Outlook надстройку теперь.</span><span class="sxs-lookup"><span data-stu-id="bdf2e-159">Restart Outlook and test whether Outlook now activates the add-in.</span></span>

1. <span data-ttu-id="bdf2e-p115">Если Outlook не активирует надстройку, проверьте, есть ли у Outlook кэшированная копия манифеста надстройки. Поищите ее по следующему пути:</span><span class="sxs-lookup"><span data-stu-id="bdf2e-p115">If Outlook doesn't activate the add-in, check whether Outlook has a properly cached copy of the manifest for the add-in. Look under the following path:</span></span>

    ```text
    %LocalAppData%\Microsoft\Office\16.0\WEF
    ```

    <span data-ttu-id="bdf2e-162">Манифест можно найти в следующей вложенной папке:</span><span class="sxs-lookup"><span data-stu-id="bdf2e-162">You can find the manifest in the following subfolder:</span></span>

    ```text
    \<insert your guid>\<insert base 64 hash>\Manifests\<ManifestID>_<ManifestVersion>
    ```

    > [!NOTE]
    > <span data-ttu-id="bdf2e-163">Пример пути к манифесту, установленному для почтового ящика пользователя John:</span><span class="sxs-lookup"><span data-stu-id="bdf2e-163">The following is an example of a path to a manifest installed for a mailbox for the user John:</span></span>
    >
    > ```text
    > C:\Users\john\appdata\Local\Microsoft\Office\16.0\WEF\{8D8445A4-80E4-4D6B-B7AC-D4E6AF594E73}\GoRshCWa7vW8+jhKmyiDhA==\Manifests\b3d7d9d5-6f57-437d-9830-94e2aaccef16_1.2
    > ```

    <span data-ttu-id="bdf2e-164">Проверьте, есть ли манифест тестируемой надстройки в кэше.</span><span class="sxs-lookup"><span data-stu-id="bdf2e-164">Verify whether the manifest of the add-in you're testing is among the cached manifests.</span></span>

1. <span data-ttu-id="bdf2e-165">Если манифест есть в кэше, пропустите остальную часть этого раздела и рассмотрите другие возможные причины ниже.</span><span class="sxs-lookup"><span data-stu-id="bdf2e-165">If the manifest is in the cache, skip the rest of this section and consider the other possible reasons following this section.</span></span>

1. <span data-ttu-id="bdf2e-p116">Если манифест в кэше отсутствует, проверьте, действительно ли Outlook успешно считал этот манифест в Exchange Server. Для этого воспользуйтесь средством просмотра событий Windows.</span><span class="sxs-lookup"><span data-stu-id="bdf2e-p116">If the manifest is not in the cache, check whether Outlook indeed successfully read the manifest from the Exchange Server. To do that, use the Windows Event Viewer:</span></span>

    1. <span data-ttu-id="bdf2e-168">В разделе **Журналы Windows** выберите **Приложение**.</span><span class="sxs-lookup"><span data-stu-id="bdf2e-168">Under **Windows Logs**, choose **Application**.</span></span>

    1. <span data-ttu-id="bdf2e-169">Найдите достаточно недавнее событие, идентификатор которого равен 63, что представляет загрузку Outlook манифеста из Exchange Server.</span><span class="sxs-lookup"><span data-stu-id="bdf2e-169">Look for a reasonably recent event for which the Event ID equals 63, which represents Outlook downloading a manifest from an Exchange Server.</span></span>

    1. <span data-ttu-id="bdf2e-170">Если Outlook успешно считал манифест, то событие в журнале должно иметь следующее описание:</span><span class="sxs-lookup"><span data-stu-id="bdf2e-170">If Outlook successfully read a manifest, the logged event should have the following description:</span></span>

        ```text
        The Exchange web service request GetAppManifests succeeded.
        ```

        <span data-ttu-id="bdf2e-171">В этом случае пропустите остальную часть этого раздела и рассмотрите другие возможные причины ниже.</span><span class="sxs-lookup"><span data-stu-id="bdf2e-171">Then skip the rest of this section and consider the other possible reasons following this section.</span></span>

1. <span data-ttu-id="bdf2e-172">Если манифест не был прочитан, закройте Outlook и удалите все манифесты в следующей папке:</span><span class="sxs-lookup"><span data-stu-id="bdf2e-172">If you don't see a successful event, close Outlook, and delete all the manifests in the following path:</span></span>

    ```text
    %LocalAppData%\Microsoft\Office\16.0\WEF\<insert your guid>\<insert base 64 hash>\Manifests\
    ```

    <span data-ttu-id="bdf2e-173">Запустите Outlook и проверьте, активирует ли Outlook надстройку.</span><span class="sxs-lookup"><span data-stu-id="bdf2e-173">Start Outlook and test whether Outlook now activates the add-in.</span></span>

1. <span data-ttu-id="bdf2e-174">Если Outlook по-прежнему не активирует надстройку, вернитесь к шагу 3 и еще раз проверьте, прочитал ли Outlook манифест.</span><span class="sxs-lookup"><span data-stu-id="bdf2e-174">If Outlook doesn't activate the add-in, go back to Step 3 to verify again whether Outlook has properly read the manifest.</span></span>

## <a name="is-the-add-in-manifest-valid"></a><span data-ttu-id="bdf2e-175">Действителен ли манифест надстройки?</span><span class="sxs-lookup"><span data-stu-id="bdf2e-175">Is the add-in manifest valid?</span></span>

<span data-ttu-id="bdf2e-176">Сведения об устранении проблем, связанных с манифестом надстройки, см. в статье [Проверка манифеста и устранение связанных с ним неполадок](../testing/troubleshoot-manifest.md).</span><span class="sxs-lookup"><span data-stu-id="bdf2e-176">See [Validate and troubleshoot issues with your manifest](../testing/troubleshoot-manifest.md) to debug add-in manifest issues.</span></span>

## <a name="are-you-using-the-appropriate-activation-rules"></a><span data-ttu-id="bdf2e-177">Используются ли необходимые правила активации?</span><span class="sxs-lookup"><span data-stu-id="bdf2e-177">Are you using the appropriate activation rules?</span></span>

<span data-ttu-id="bdf2e-p117">Начиная со схемы манифеста для надстроек Office версии 1.1, вы можете создавать надстройки, которые активируются, когда пользователь работает в форме создания (надстройке создания) или форме чтения (надстройке чтения). Обязательно укажите необходимые правила активации для каждого типа формы, в котором должна активироваться надстройка. Например, надстройки создания можно активировать только с помощью правил [ItemIs](../reference/manifest/rule.md#itemis-rule), в которых атрибут **FormType** которых имеет значение **Edit** или **ReadOrEdit**. При этом вам не удастся использовать другие типы правил, например [ItemHasKnownEntity](../reference/manifest/rule.md#itemhasknownentity-rule) и [ItemHasRegularExpressionMatch](../reference/manifest/rule.md#itemhasregularexpressionmatch-rule) для надстроек создания. Дополнительные сведения см. в статье [Правила активации для надстроек Outlook](activation-rules.md).</span><span class="sxs-lookup"><span data-stu-id="bdf2e-p117">Starting in version 1.1 of the Office Add-ins manifests schema, you can create add-ins that are activated when the user is in a compose form (compose add-ins) or in a read form (read add-ins). Make sure you specify the appropriate activation rules for each type of form that your add-in is supposed to activate in. For example, you can activate compose add-ins using only [ItemIs](../reference/manifest/rule.md#itemis-rule) rules with the **FormType** attribute set to **Edit** or **ReadOrEdit**, and you cannot use any of the other types of rules, such as [ItemHasKnownEntity](../reference/manifest/rule.md#itemhasknownentity-rule) and [ItemHasRegularExpressionMatch](../reference/manifest/rule.md#itemhasregularexpressionmatch-rule) rules for compose add-ins. For more information, see [Activation rules for Outlook add-ins](activation-rules.md).</span></span>

## <a name="if-you-use-a-regular-expression-is-it-properly-specified"></a><span data-ttu-id="bdf2e-181">Если используется регулярное выражение, указано ли оно должным образом?</span><span class="sxs-lookup"><span data-stu-id="bdf2e-181">If you use a regular expression, is it properly specified?</span></span>

<span data-ttu-id="bdf2e-p118">Поскольку регулярные выражения в правилах активации являются частью XML-файла манифеста надстройки чтения, при использовании в регулярных выражениях определенных символов убедитесь, что используется соответствующая escape-последовательность, которую поддерживают XML-процессоры. В таблице 1 приведены эти особые символы.</span><span class="sxs-lookup"><span data-stu-id="bdf2e-p118">Because regular expressions in activation rules are part of the XML manifest file for a read add-in, if a regular expression uses certain characters, be sure to follow the corresponding escape sequence that XML processors support. Table 1 lists these special characters.</span></span>

<span data-ttu-id="bdf2e-184">**Таблица 1. Escape-последовательности для регулярных выражений**</span><span class="sxs-lookup"><span data-stu-id="bdf2e-184">**Table 1. Escape sequences for regular expressions**</span></span>

|<span data-ttu-id="bdf2e-185">**Символ**</span><span class="sxs-lookup"><span data-stu-id="bdf2e-185">**Character**</span></span>|<span data-ttu-id="bdf2e-186">**Описание**</span><span class="sxs-lookup"><span data-stu-id="bdf2e-186">**Description**</span></span>|<span data-ttu-id="bdf2e-187">**Используемая escape-последовательность**</span><span class="sxs-lookup"><span data-stu-id="bdf2e-187">**Escape sequence to use**</span></span>|
|:-----|:-----|:-----|
|`"`|<span data-ttu-id="bdf2e-188">Двойная кавычка</span><span class="sxs-lookup"><span data-stu-id="bdf2e-188">Double quotation mark</span></span>|<span data-ttu-id="bdf2e-189">&amp;quot;</span><span class="sxs-lookup"><span data-stu-id="bdf2e-189">&amp;quot;</span></span>|
|`&`|<span data-ttu-id="bdf2e-190">Амперсанд</span><span class="sxs-lookup"><span data-stu-id="bdf2e-190">Ampersand</span></span>|<span data-ttu-id="bdf2e-191">&amp;amp;</span><span class="sxs-lookup"><span data-stu-id="bdf2e-191">&amp;amp;</span></span>|
|`'`|<span data-ttu-id="bdf2e-192">Апостроф</span><span class="sxs-lookup"><span data-stu-id="bdf2e-192">Apostrophe</span></span>|<span data-ttu-id="bdf2e-193">&amp;apos;</span><span class="sxs-lookup"><span data-stu-id="bdf2e-193">&amp;apos;</span></span>|
|`<`|<span data-ttu-id="bdf2e-194">Знак "меньше"</span><span class="sxs-lookup"><span data-stu-id="bdf2e-194">Less-than sign</span></span>|<span data-ttu-id="bdf2e-195">&amp;lt;</span><span class="sxs-lookup"><span data-stu-id="bdf2e-195">&amp;lt;</span></span>|
|`>`|<span data-ttu-id="bdf2e-196">Знак "больше"</span><span class="sxs-lookup"><span data-stu-id="bdf2e-196">Greater-than sign</span></span>|<span data-ttu-id="bdf2e-197">&amp;gt;</span><span class="sxs-lookup"><span data-stu-id="bdf2e-197">&amp;gt;</span></span>|

## <a name="if-you-use-a-regular-expression-is-the-read-add-in-activating-in-outlook-on-the-web-or-mobile-devices-but-not-in-any-of-the-outlook-rich-clients"></a><span data-ttu-id="bdf2e-198">Если вы используете регулярное выражение, надстройка чтения активируется в Outlook в Интернете или на мобильных устройствах, но не активируется ни в одном из полнофункциональных клиентов Outlook?</span><span class="sxs-lookup"><span data-stu-id="bdf2e-198">If you use a regular expression, is the read add-in activating in Outlook on the web or mobile devices, but not in any of the Outlook rich clients?</span></span>

<span data-ttu-id="bdf2e-p119">В полнофункциональных клиентах Outlook используется не такой обработчик регулярных выражений, как в Outlook в Интернете и на мобильных устройствах. В полнофункциональных клиентах Outlook используется обработчик регулярных выражений C++, который предоставляется в составе библиотеки стандартных шаблонов Visual Studio. Этот обработчик выполняет компиляцию в соответствии со стандартами ECMAScript 5. Outlook в Интернете и на мобильных устройствах использует компонент оценки регулярных выражений, который входит в состав JavaScript, предоставляется браузером и поддерживает расширенный набор стандартов ECMAScript 5.</span><span class="sxs-lookup"><span data-stu-id="bdf2e-p119">Outlook rich clients use a regular expression engine that's different from the one used by Outlook on the web and mobile devices. Outlook rich clients use the C++ regular expression engine provided as part of the Visual Studio standard template library. This engine complies with ECMAScript 5 standards. Outlook on the web and mobile devices use regular expression evaluation that is part of JavaScript, is provided by the browser, and supports a superset of ECMAScript 5.</span></span>

<span data-ttu-id="bdf2e-p120">В большинстве случаев эти ведущие приложения находят одни и те же соответствия одинаковым регулярным выражениям в правиле активации, но существуют исключения. Например, если регулярное выражение включает пользовательский класс символов, основанный на заранее определенных классах символов, то полнофункциональный клиент Outlook может возвращать не такие результаты, как Outlook в Интернете и на мобильных устройствах. Например, классы символов, которые содержат сокращенные классы символов `[\d\w]`, возвращают разные результаты. В этом случае во избежание различий в результатах для разных ведущих приложений, используйте `(\d|\w)`.</span><span class="sxs-lookup"><span data-stu-id="bdf2e-p120">While in most cases, these host applications find the same matches for the same regular expression in an activation rule, there are exceptions. For instance, if the regex includes a custom character class based on predefined character classes, an Outlook rich client may return results different from Outlook on the web and mobile devices. As an example, character classes that contain shorthand character classes  `[\d\w]` within them would return different results. In this case, to avoid different results on different hosts, use `(\d|\w)` instead.</span></span>

<span data-ttu-id="bdf2e-p121">Тщательно протестируйте регулярное выражение. Если оно возвращает разные результаты, перепишите выражение для совместимости с обоими обработчиками. Чтобы проверить результаты оценки в полнофункциональном клиенте Outlook, напишите небольшую программу на C++, применяющую регулярное выражение к образцу сопоставляемого текста. Эта тестовая программа на C++ работает в Visual Studio и использует стандартную библиотеку шаблонов, имитируя поведение полнофункционального клиента Outlook при выполнении такого же регулярного выражения. Чтобы проверить результаты проверки в Outlook в Интернете или на мобильных устройствах, используйте любое средство проверки регулярных выражений JavaScript.</span><span class="sxs-lookup"><span data-stu-id="bdf2e-p121">Test your regular expression thoroughly. If it returns different results, rewrite the regular expression for compatibility with both engines. To verify evaluation results on an Outlook rich client, write a small C++ program that applies the regular expression against a sample of the text you are trying to match. Running on Visual Studio, the C++ test program would use the standard template library, simulating the behavior of the Outlook rich client when running the same regular expression. To verify evaluation results on Outlook on the web or mobile devices, use your favorite JavaScript regular expression tester.</span></span>

## <a name="if-you-use-an-itemis-itemhasattachment-or-itemhasregularexpressionmatch-rule-have-you-verified-the-related-item-property"></a><span data-ttu-id="bdf2e-212">Если используется правило ItemIs, ItemHasAttachment или ItemHasRegularExpressionMatch, проверено ли соответствующее свойство элемента?</span><span class="sxs-lookup"><span data-stu-id="bdf2e-212">If you use an ItemIs, ItemHasAttachment, or ItemHasRegularExpressionMatch rule, have you verified the related item property?</span></span>

<span data-ttu-id="bdf2e-213">Если вы используете правило активации **ItemHasRegularExpressionMatch**, проверьте, соответствует ли значение атрибута **PropertyName** предполагаемому значению для выбранного элемента.</span><span class="sxs-lookup"><span data-stu-id="bdf2e-213">If you use an **ItemHasRegularExpressionMatch** activation rule, verify whether the value of the **PropertyName** attribute is what you expect for the selected item.</span></span> <span data-ttu-id="bdf2e-214">Ниже приведены несколько советов по отладке соответствующих свойств.</span><span class="sxs-lookup"><span data-stu-id="bdf2e-214">The following are some tips to debug the corresponding properties:</span></span>

- <span data-ttu-id="bdf2e-215">Если выбранный элемент представляет собой сообщение, и в атрибуте **PropertyName** вы указываете значение **BodyAsHTML**, откройте это сообщение и выберите **Просмотреть код**, чтобы проверить текст сообщения в HTML-представлении этого элемента.</span><span class="sxs-lookup"><span data-stu-id="bdf2e-215">If the selected item is a message and you specify **BodyAsHTML** in the **PropertyName** attribute, open the message, and then choose **View Source** to verify the message body in the HTML representation of that item.</span></span>

- <span data-ttu-id="bdf2e-216">Если выбранный элемент представляет собой встречу или если правило активации задает **BodyAsPlaintext** в атрибуте **PropertyName**, вы можете использовать объектную модель Outlook и редактор Visual Basic в Outlook для Windows.</span><span class="sxs-lookup"><span data-stu-id="bdf2e-216">If the selected item is an appointment, or if the activation rule specifies **BodyAsPlaintext** in the **PropertyName**, you can use the Outlook object model and the Visual Basic Editor in Outlook on Windows:</span></span>

    1. <span data-ttu-id="bdf2e-217">Убедитесь, что макросы включены и на ленте Outlook отображается вкладка **Разработчик**.</span><span class="sxs-lookup"><span data-stu-id="bdf2e-217">Ensure that macros are enabled and the **Developer** tab is displayed in the ribbon for Outlook.</span></span>

    1. <span data-ttu-id="bdf2e-218">В редакторе Visual Basic выберите **Вид** > **Окно интерпретации**.</span><span class="sxs-lookup"><span data-stu-id="bdf2e-218">In the Visual Basic Editor, choose **View**, **Immediate Window**.</span></span>

    1. <span data-ttu-id="bdf2e-219">Для отображения разных свойств в зависимости от сценария введите следующее.</span><span class="sxs-lookup"><span data-stu-id="bdf2e-219">Type the following to display various properties depending on the scenario.</span></span>

        - <span data-ttu-id="bdf2e-220">Для HTML-текста элемента сообщения или встречи, выбранного в обозревателе Outlook:</span><span class="sxs-lookup"><span data-stu-id="bdf2e-220">The HTML body of the message or appointment item selected in the Outlook explorer:</span></span>

        ```vb
        ?ActiveExplorer.Selection.Item(1).HTMLBody
        ```
        - <span data-ttu-id="bdf2e-221">Для простого текста элемента сообщения или встречи, выбранного в обозревателе Outlook:</span><span class="sxs-lookup"><span data-stu-id="bdf2e-221">The plain text body of the message or appointment item selected in the Outlook explorer:</span></span>

        ```vb
        ?ActiveExplorer.Selection.Item(1).Body
        ```
        - <span data-ttu-id="bdf2e-222">Для HTML-текста элемента сообщения или встречи, выбранного в инспекторе Outlook:</span><span class="sxs-lookup"><span data-stu-id="bdf2e-222">The HTML body of the message or appointment item opened in the current Outlook inspector:</span></span>

        ```vb
        ?ActiveInspector.CurrentItem.HTMLBody
        ```
        - <span data-ttu-id="bdf2e-223">Для простого текста элемента сообщения или встречи, выбранного в инспекторе Outlook:</span><span class="sxs-lookup"><span data-stu-id="bdf2e-223">The plain text body of the message or appointment item opened in the current Outlook inspector:</span></span>

        ```vb
        ?ActiveInspector.CurrentItem.Body
        ```

<span data-ttu-id="bdf2e-224">Если правило активации **ItemHasRegularExpressionMatch** указывает **Subject** либо **SenderSMTPAddress** или если вы используете правило **ItemIs** либо **ItemHasAttachment**, и вы умеете работать с MAPI или хотите его использовать, то для проверки значения в таблице 2, от которого зависит ваше правило, можно воспользоваться [MFCMAPI](https://github.com/stephenegriffin/mfcmapi).</span><span class="sxs-lookup"><span data-stu-id="bdf2e-224">If the **ItemHasRegularExpressionMatch** activation rule specifies **Subject** or **SenderSMTPAddress**, or if you use an **ItemIs** or **ItemHasAttachment** rule, and you are familiar with or would like to use MAPI, you can use [MFCMAPI](https://github.com/stephenegriffin/mfcmapi) to verify the value in Table 2 that your rule relies on.</span></span>

<span data-ttu-id="bdf2e-225">**Таблица 2. Правила активации и соответствующие свойства MAPI**</span><span class="sxs-lookup"><span data-stu-id="bdf2e-225">**Table 2. Activation rules and corresponding MAPI properties**</span></span>

|<span data-ttu-id="bdf2e-226">Тип правила</span><span class="sxs-lookup"><span data-stu-id="bdf2e-226">Type of rule</span></span>|<span data-ttu-id="bdf2e-227">Свойство MAPI для проверки</span><span class="sxs-lookup"><span data-stu-id="bdf2e-227">Verify this MAPI property</span></span>|
|:-----|:-----|
|<span data-ttu-id="bdf2e-228">Правило **ItemHasRegularExpressionMatch** с **Subject**</span><span class="sxs-lookup"><span data-stu-id="bdf2e-228">**ItemHasRegularExpressionMatch** rule with **Subject**</span></span>|[<span data-ttu-id="bdf2e-229">PidTagSubject</span><span class="sxs-lookup"><span data-stu-id="bdf2e-229">PidTagSubject</span></span>](/office/client-developer/outlook/mapi/pidtagsubject-canonical-property)|
|<span data-ttu-id="bdf2e-230">Правило **ItemHasRegularExpressionMatch** с **SenderSMTPAddress**</span><span class="sxs-lookup"><span data-stu-id="bdf2e-230">**ItemHasRegularExpressionMatch** rule with **SenderSMTPAddress**</span></span>|<span data-ttu-id="bdf2e-231">[PidTagSenderSmtpAddress](/office/client-developer/outlook/mapi/pidtagsendersmtpaddress-canonical-property) и [PidTagSentRepresentingSmtpAddress](/office/client-developer/outlook/mapi/pidtagsentrepresentingsmtpaddress-canonical-property)</span><span class="sxs-lookup"><span data-stu-id="bdf2e-231">[PidTagSenderSmtpAddress](/office/client-developer/outlook/mapi/pidtagsendersmtpaddress-canonical-property) and [PidTagSentRepresentingSmtpAddress](/office/client-developer/outlook/mapi/pidtagsentrepresentingsmtpaddress-canonical-property)</span></span>|
|<span data-ttu-id="bdf2e-232">**ItemIs**</span><span class="sxs-lookup"><span data-stu-id="bdf2e-232">**ItemIs**</span></span>|[<span data-ttu-id="bdf2e-233">PidTagMessageClass</span><span class="sxs-lookup"><span data-stu-id="bdf2e-233">PidTagMessageClass</span></span>](/office/client-developer/outlook/mapi/pidtagmessageclass-canonical-property)|
|<span data-ttu-id="bdf2e-234">**ItemHasAttachment**</span><span class="sxs-lookup"><span data-stu-id="bdf2e-234">**ItemHasAttachment**</span></span>|[<span data-ttu-id="bdf2e-235">PidTagHasAttachments</span><span class="sxs-lookup"><span data-stu-id="bdf2e-235">PidTagHasAttachments</span></span>](/office/client-developer/outlook/mapi/pidtaghasattachments-canonical-property)|

<span data-ttu-id="bdf2e-236">После проверки значения свойства можно с помощью средства оценки регулярных выражений проверить, находит ли регулярное выражение соответствие в этом значении.</span><span class="sxs-lookup"><span data-stu-id="bdf2e-236">After verifying the property value, you can then use a regular expression evaluation tool to test whether the regular expression finds a match in that value.</span></span>

## <a name="does-the-host-application-apply-all-the-regular-expressions-to-the-portion-of-the-item-body-as-you-expect"></a><span data-ttu-id="bdf2e-237">Применяет ли ведущее приложение все регулярные выражения к той части элемента, к которой следует?</span><span class="sxs-lookup"><span data-stu-id="bdf2e-237">Does the host application apply all the regular expressions to the portion of the item body as you expect?</span></span>

<span data-ttu-id="bdf2e-p123">Этот раздел относится ко всем правилам активации, использующим регулярные выражения, особенно к тем, которые применяются к основному тексту элемента. Их размер может быть большим, поэтому поиск соответствий может занимать длительное время. Помните, что даже если для свойства элемента, от которого зависит правило активации, задано ожидаемое значение, ведущее приложение может не иметь возможности сопоставить все регулярные выражения с полным значением этого свойства. Для обеспечения удовлетворительной производительности и контроля за чрезмерным использованием ресурсов надстройкой для чтения в Outlook, Outlook в Интернете и на мобильных устройствах соблюдаются приведенные ниже ограничения на обработку регулярных выражений в правилах активации во время выполнения.</span><span class="sxs-lookup"><span data-stu-id="bdf2e-p123">This section applies to all activation rules that use regular expressions -- particularly those that are applied to the item body, which may be large in size and take longer to evaluate for matches. You should be aware that even if the item property that an activation rule depends on has the value you expect, the host application may not be able to evaluate all the regular expressions on the entire value of the item property. To provide reasonable performance and to control excessive resource usage by a read add-in, Outlook, Outlook on the web and mobile devices observe the following limits on processing regular expressions in activation rules at run time:</span></span>

- <span data-ttu-id="bdf2e-p124">Размер основного текста элемента, в котором выполняется оценка. Существуют ограничения для части основного текста элемента, в которой ведущее приложение выполняет оценку регулярного выражения. Эти ограничения зависят от ведущего приложения, форм-фактора и формата основного текста элемента. Подробные сведения см. в таблице 2 статьи [Ограничения для активации и API JavaScript для надстроек Outlook](limits-for-activation-and-javascript-api-for-outlook-add-ins.md).</span><span class="sxs-lookup"><span data-stu-id="bdf2e-p124">The size of the item body evaluated -- There are limits to the portion of an item body on which the host application evaluates a regular expression. These limits depend on the host application, form factor, and format of the item body. See the details in Table 2 in [Limits for activation and JavaScript API for Outlook add-ins](limits-for-activation-and-javascript-api-for-outlook-add-ins.md).</span></span>

- <span data-ttu-id="bdf2e-p125">Количество соответствий регулярному выражению: полнофункциональные клиенты Outlook, Outlook в Интернете и на мобильных устройствах возвращают до 50 соответствий регулярным выражениям. Эти соответствия уникальны, и ограничение не распространяется на повторения. Не рассчитывайте, что соответствия будут возвращаться в определенном порядке и что порядок результатов в полнофункциональном клиенте Outlook будет таким же, как в Outlook в Интернете и на мобильных устройствах. Если ожидается, что найдется много соответствий регулярным выражениям из правил активации, и какого-то соответствия не хватает, это может быть связано с данным ограничением.</span><span class="sxs-lookup"><span data-stu-id="bdf2e-p125">Number of regular expression matches -- The Outlook rich clients, and Outlook on the web and mobile devices each returns a maximum of 50 regular expression matches. These matches are unique, and duplicate matches do not count against this limit. Do not assume any order to the returned matches, and do not assume the order in an Outlook rich client is the same as that in Outlook on the web and mobile devices. If you expect many matches to regular expressions in your activation rules, and you're missing a match, you may be exceeding this limit.</span></span>

- <span data-ttu-id="bdf2e-p126">Длина соответствия регулярному выражению. Существуют ограничения на длину соответствия регулярному выражению, возвращаемого ведущим приложением. Ведущее приложение не включает соответствия, превышающие это ограничение, и при этом не отображает никакого предупреждающего сообщения. Вы можете проверить регулярное выражение с помощью других средств оценки регулярных выражений или отдельной тестовой программы на языке C++, чтобы узнать, имеются ли соответствия, превышающие ограничения. В таблице 3 приведена сводка этих ограничений. Дополнительные сведения см. в таблице 3 статьи [Ограничения для активации и API JavaScript для надстроек Outlook](limits-for-activation-and-javascript-api-for-outlook-add-ins.md).</span><span class="sxs-lookup"><span data-stu-id="bdf2e-p126">Length of a regular expression match -- There are limits to the length of a regular expression match that the host application would return. The host application does not include any match above the limit and does not display any warning message. You can run your regular expression using other regex evaluation tools or a stand-alone C++ test program to verify whether you have a match that exceeds such limits. Table 3 summarizes the limits. For more information, see Table 3 in [Limits for activation and JavaScript API for Outlook add-ins](limits-for-activation-and-javascript-api-for-outlook-add-ins.md).</span></span>

    <span data-ttu-id="bdf2e-253">**Таблица 3. Ограничения длины для результатов, соответствующих регулярным выражениям**</span><span class="sxs-lookup"><span data-stu-id="bdf2e-253">**Table 3. Length limits for a regular expression match**</span></span>

    |<span data-ttu-id="bdf2e-254">Ограничение длины для результата, соответствующего регулярному выражению</span><span class="sxs-lookup"><span data-stu-id="bdf2e-254">Limit on length of a regex match</span></span>|<span data-ttu-id="bdf2e-255">Полнофункциональные клиенты Outlook</span><span class="sxs-lookup"><span data-stu-id="bdf2e-255">Outlook rich clients</span></span>|<span data-ttu-id="bdf2e-256">Outlook в Интернете или на мобильных устройствах</span><span class="sxs-lookup"><span data-stu-id="bdf2e-256">Outlook on the web or mobile devices</span></span>|
    |:-----|:-----|:-----|
    |<span data-ttu-id="bdf2e-257">Основной текст элемента в виде простого текста</span><span class="sxs-lookup"><span data-stu-id="bdf2e-257">Item body is plain text</span></span>|<span data-ttu-id="bdf2e-258">1,5 КБ</span><span class="sxs-lookup"><span data-stu-id="bdf2e-258">1.5 KB</span></span>|<span data-ttu-id="bdf2e-259">3 КБ</span><span class="sxs-lookup"><span data-stu-id="bdf2e-259">3 KB</span></span>|
    |<span data-ttu-id="bdf2e-260">Основной текст элемента в виде HTML-кода</span><span class="sxs-lookup"><span data-stu-id="bdf2e-260">Item body is HTML</span></span>|<span data-ttu-id="bdf2e-261">3 КБ</span><span class="sxs-lookup"><span data-stu-id="bdf2e-261">3 KB</span></span>|<span data-ttu-id="bdf2e-262">3 КБ</span><span class="sxs-lookup"><span data-stu-id="bdf2e-262">3 KB</span></span>|

- <span data-ttu-id="bdf2e-p127">Время, затрачиваемое на оценку всех регулярных выражений в надстройке чтения — для расширенного клиента Outlook. По умолчанию для каждой почтовой надстройки для Outlook должен завершить оценку всех регулярных выражений в правилах активации за 1 секунду. В противном случае Outlook повторяет попытку до трех раз и отключает приложение, если не может завершить оценку. Outlook отображает в панели уведомлений сообщение, что надстройка отключается. Количество времени на оценку регулярных выражений можно изменить в групповой политике или в разделе реестра.</span><span class="sxs-lookup"><span data-stu-id="bdf2e-p127">Time spent on evaluating all regular expressions of a read add-in for an Outlook rich client: By default, for each read add-in, Outlook must finish evaluating all the regular expressions in its activation rules within 1 second. Otherwise Outlook retries up to three times and disables the add-in if Outlook cannot complete the evaluation. Outlook displays a message in the notification bar that the add-in has been disabled. The amount of time available for your regular expression can be modified by setting a group policy or a registry key.</span></span> 

   > [!NOTE]
   > <span data-ttu-id="bdf2e-267">Если полнофункциональный клиент Outlook отключит надстройку для чтения, она станет недоступна для использования с данным почтовым ящиком в полнофункциональном клиенте Outlook, Outlook в Интернете и на мобильных устройствах.</span><span class="sxs-lookup"><span data-stu-id="bdf2e-267">If the Outlook rich client disables a read add-in, the read add-in is not available for use for the same mailbox on the Outlook rich client, and Outlook on the web and mobile devices.</span></span>

## <a name="see-also"></a><span data-ttu-id="bdf2e-268">См. также</span><span class="sxs-lookup"><span data-stu-id="bdf2e-268">See also</span></span>

- [<span data-ttu-id="bdf2e-269">Развертывание и установка надстроек Outlook для тестирования</span><span class="sxs-lookup"><span data-stu-id="bdf2e-269">Deploy and install Outlook add-ins for testing</span></span>](testing-and-tips.md)
- [<span data-ttu-id="bdf2e-270">Правила активации для надстроек Outlook</span><span class="sxs-lookup"><span data-stu-id="bdf2e-270">Activation rules for Outlook add-ins</span></span>](activation-rules.md)
- [<span data-ttu-id="bdf2e-271">Использование правил активации на основе регулярных выражений для отображения надстройки Outlook</span><span class="sxs-lookup"><span data-stu-id="bdf2e-271">Use regular expression activation rules to show an Outlook add-in</span></span>](use-regular-expressions-to-show-an-outlook-add-in.md)
- [<span data-ttu-id="bdf2e-272">Ограничения для активации и API JavaScript для надстроек Outlook</span><span class="sxs-lookup"><span data-stu-id="bdf2e-272">Limits for activation and JavaScript API for Outlook add-ins</span></span>](limits-for-activation-and-javascript-api-for-outlook-add-ins.md)
- [<span data-ttu-id="bdf2e-273">Проверка манифеста и устранение связанных с ним неполадок</span><span class="sxs-lookup"><span data-stu-id="bdf2e-273">Validate and troubleshoot issues with your manifest</span></span>](../testing/troubleshoot-manifest.md)
