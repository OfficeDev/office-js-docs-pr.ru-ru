---
title: Обеспечение совместимости надстройки Office с существующей надстройкой COM
description: Обеспечение совместимости с эквивалентной надстройкой COM, имеющей те же функциональные возможности, что и надстройка Office
ms.date: 04/22/2019
localization_priority: Normal
ms.openlocfilehash: 8f3780814163cc4dd21311b362d1d821a14b3e80
ms.sourcegitcommit: 7462409209264dc7f8f89f3808a7a6249fcd739e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/26/2019
ms.locfileid: "33356911"
---
# <a name="make-your-office-add-in-compatible-with-an-existing-com-add-in"></a>Обеспечение совместимости надстройки Office с существующей надстройкой COM

Если у вас есть надстройка COM, вы можете создать эквивалентную функцию в надстройке Office, чтобы расширить функциональные возможности решения на другие платформы, такие как Online или macOS. Однако у надстроек Office нет всех функциональных возможностей, доступных в надстройках COM. Надстройка COM может улучшить работу, чем надстройка Office в Windows в Excel, Word и PowerPoint.

Вы можете настроить надстройку Office таким образом, чтобы если на компьютере пользователя уже установлена эквивалентная надстройка COM, Office запускает надстройку COM, а не надстройку Office. Надстройка COM называется "эквивалентной", так как Office будет беспрепятственно переходить между надстройкой COM и надстройкой Office в зависимости от того, какая установлена в Windows.

[!include[Excel custom functions note](../includes/excel-custom-functions-note.md)]

## <a name="specify-an-equivalent-com-add-in-in-the-manifest"></a>Указание эквивалентной надстройки COM в манифесте

Чтобы обеспечить совместимость с существующей надстройкой COM, определите эквивалентную надстройку COM в манифесте надстройки Office. После этого Office будет использовать надстройку COM вместо надстройки Office при работе в Windows.

`ProgID` Укажите эквивалентную надстройку COM. Затем Office будет использовать пользовательский интерфейс надстройки COM, а не пользовательский интерфейс надстройки Office при установке надстройки COM.

В приведенном ниже примере показано, как указать как надстройку COM, так и XLL в качестве эквивалента. Как правило, для полноты указывается и то, и другое, в этом примере показана как в контексте. Они определяются по их `ProgID` и `FileName` соответственно. Для получения дополнительной информации о совместимости XLL, ознакомьтесь [со статьЕй создание пользовательских функций, совместимых с пользовательскими ФУНКЦИЯМИ XLL](../excel/make-custom-functions-compatible-with-xll-udf.md).

```xml
<VersionOverrides>
...
<EquivalentAddins>
  <EquivalentAddin>
    <ProgID>ContosoCOMAddin</ProgID>
    <Type>COM</Type>
  </EquivalentAddin>

  <EquivalentAddin>
    <FileName>contosofunctions.xll</FileName>
    <Type>XLL</Type>
  </EquivalentAddin>
<EquivalentAddins>
...
</VersionOverrides>
```

## <a name="equivalent-behavior-for-users"></a>Эквивалентное поведение для пользователей

Если в манифесте надстройки Office указана эквивалентная надстройка COM, Office подавляет пользовательский интерфейс надстройки Office в Windows при установке эквивалентной надстройки COM. Это не повлияет на пользовательский интерфейс надстройки Office на других платформах, таких как Online или macOS. Office скрывает только кнопки ленты и не запрещает установку. Поэтому надстройка Office будет по-прежнему отображаться в следующих расположениях ПОЛЬЗОВАТЕЛЬСКОГО интерфейса:

- В разделе **Мои** надстройки, так как она технически устанавливается.
- В качестве записи в диспетчере ленты.

В следующих сценариях описывается, что происходит в зависимости от того, как пользователь приобретает надстройку Office.

### <a name="appsource-acquisition-of-an-office-add-in"></a>AppSource приобретение надстройки Office

Если пользователь загружает надстройку Office из AppSource, а аналогичная надстройка COM уже установлена, Office выполнит следующие действия:

1. Установите надстройку Office.
2. Скрытие ПОЛЬЗОВАТЕЛЬСКОГО интерфейса надстройки Office на ленте.
3. Отображение вызываемого абонента для пользователя, который указывает на кнопку ленты надстройки COM.

### <a name="centralized-deployment-of-office-add-in"></a>Централизованное развертывание надстройки Office

Если Администратор развертывает надстройку Office в своем клиенте с помощью централизованного развертывания, а эквивалентная надстройка COM уже установлена, то пользователь должен перезапустить Office, прежде чем будут видны изменения. После перезапуска Office будет:

1. Установите надстройку Office.
2. Скрытие ПОЛЬЗОВАТЕЛЬСКОГО интерфейса надстройки Office на ленте.
3. Отображение вызываемого абонента для пользователя, который указывает на кнопку ленты надстройки COM.

### <a name="document-shared-with-embedded-office-add-in"></a>Общий доступ к документу с помощью встроенной надстройки Office

Если у пользователя установлена надстройка COM, а затем он получает общий документ с внедренной надстройкой Office, то при открытии документа Office будет:

1. ПредЛожит пользователю доверять надстройке Office.
2. Если вы доверяете, надстройка Office будет установлена.
3. Скрытие ПОЛЬЗОВАТЕЛЬСКОГО интерфейса надстройки Office на ленте.

## <a name="other-com-add-in-behavior"></a>Другое поведение надстройки COM

Если пользователь удаляет надстройку COM, Office восстанавливает пользовательский интерфейс надстройки Office в Windows для эквивалентной установленной надстройки Office.

Когда вы укажете эквивалентную надстройку COM для надстройки Office, Office прекратит обработку обновлений для надстройки Office. Пользователь должен удалить порядок надстроек COM для получения последних обновлений для надстройки Office.

## <a name="see-also"></a>См. также

- [Обеспечение совместимости пользовательских функций с пользовательскими функциями XLL](../excel/make-custom-functions-compatible-with-xll-udf.md)
