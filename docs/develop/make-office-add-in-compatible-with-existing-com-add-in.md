---
title: Убедитесь, что надстройка Office совместима с существующей надстройкой COM
description: Включение совместимости между надстройкой Office и эквивалентной надстройкой COM
ms.date: 07/31/2019
localization_priority: Normal
ms.openlocfilehash: 1ded60366c36edb876b8b2dd0a4ea9e6a39521b0
ms.sourcegitcommit: 7ef14753dce598a5804dad8802df7aaafe046da7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/10/2020
ms.locfileid: "45093597"
---
# <a name="make-your-office-add-in-compatible-with-an-existing-com-add-in"></a>Убедитесь, что надстройка Office совместима с существующей надстройкой COM

Если у вас есть надстройка COM, вы можете создавать эквивалентные функциональные возможности в надстройке Office, что позволяет выполнять решение на других платформах, таких как Office в Интернете или Office для Mac. В некоторых случаях надстройка Office может не поддерживать все функции, доступные в соответствующей надстройке COM. В таких ситуациях надстройка COM может улучшить взаимодействие с пользователем в Windows, а не с соответствующей надстройкой Office.

Вы можете настроить надстройку Office таким образом, чтобы когда эквивалентная надстройка COM уже установлена на компьютере пользователя, Office в Windows запускает надстройку COM, а не надстройку Office. Надстройка COM называется "эквивалентной", так как Office будет беспрепятственно переходить между надстройкой COM и надстройкой Office в зависимости от того, какой из них установил компьютер пользователя.

> [!NOTE]
> Эта функция поддерживается следующими платформами при подключении к подписке Microsoft 365:
> - Excel, Word и PowerPoint в Интернете
> - Excel, Word и PowerPoint для Windows (версия 1904 или более поздняя)
> - Excel, Word и PowerPoint на Mac (версия 13,329 или более поздняя)

## <a name="specify-an-equivalent-com-add-in-in-the-manifest"></a>Указание эквивалентной надстройки COM в манифесте

Чтобы обеспечить совместимость надстройки Office и надстройки COM, определите эквивалентную надстройку COM в [манифесте](add-in-manifests.md) надстройки Office. После этого Office в Windows будет использовать надстройку COM, а не надстройку Office, если они установлены.

В следующем примере показана часть манифеста, указывающая надстройку COM в качестве эквивалентной надстройки. Значение `ProgId` элемента определяет надстройку COM, и `EquivalentAddins` элемент должен быть расположен сразу перед закрывающим `VersionOverrides` тегом.

```xml
<VersionOverrides>
  ...
  <EquivalentAddins>
    <EquivalentAddin>
      <ProgId>ContosoCOMAddin</ProgId>
      <Type>COM</Type>
    </EquivalentAddin>
  </EquivalentAddins>
</VersionOverrides>
```

> [!TIP]
> Сведения о надстройках COM и совместимости с UDF UDF можно найти в статье [Создание пользовательских функций, совместимых с пользовательскими ФУНКЦИЯМИ XLL](../excel/make-custom-functions-compatible-with-xll-udf.md).

## <a name="equivalent-behavior-for-users"></a>Эквивалентное поведение для пользователей

Если в манифесте надстройки Office указана эквивалентная надстройка COM, Office в Windows не будет отображать пользовательский интерфейс надстройки Office, если установлена эквивалентная надстройка COM. Office скрывает кнопки ленты только в надстройке Office и не запрещает установку. Поэтому надстройка Office будет по-прежнему отображаться в следующих расположениях в пользовательском интерфейсе:

- В разделе **Мои надстройки**
- Как запись в диспетчере лент

> [!NOTE]
> Указание эквивалентной надстройки COM в манифесте не оказывает никакого действия на других платформах, таких как Office в Интернете или Mac.

В следующих сценариях описывается, что происходит в зависимости от того, как пользователь приобретает надстройку Office.

### <a name="appsource-acquisition-of-an-office-add-in"></a>AppSource приобретение надстройки Office

Если пользователь приобретает надстройку Office из AppSource, а эквивалентная надстройка COM уже установлена, Office выполнит следующие действия:

1. Установите надстройку Office.
2. Скрытие пользовательского интерфейса надстройки Office на ленте.
3. Отображение вызываемого абонента для пользователя, который указывает на кнопку ленты надстройки COM.

### <a name="centralized-deployment-of-office-add-in"></a>Централизованное развертывание надстройки Office

Если Администратор развертывает надстройку Office в своем клиенте с помощью централизованного развертывания, а эквивалентная надстройка COM уже установлена, пользователь должен перезапустить Office, чтобы увидеть изменения. После перезапуска Office будет:

1. Установите надстройку Office.
2. Скрытие пользовательского интерфейса надстройки Office на ленте.
3. Отображение вызываемого абонента для пользователя, который указывает на кнопку ленты надстройки COM.

### <a name="document-shared-with-embedded-office-add-in"></a>Общий доступ к документу с помощью встроенной надстройки Office

Если у пользователя установлена надстройка COM, а затем он получает общий документ с внедренной надстройкой Office, то при открытии документа Office будет:

1. Предложит пользователю доверять надстройке Office.
2. Если вы доверяете, надстройка Office будет установлена.
3. Скрытие пользовательского интерфейса надстройки Office на ленте.

## <a name="other-com-add-in-behavior"></a>Другое поведение надстройки COM

Если пользователь удаляет эквивалентную надстройку COM, Office в Windows восстанавливает пользовательский интерфейс надстройки Office.

После того как вы укажете эквивалентную надстройку COM для надстройки Office, Office прекратит обработку обновлений для надстройки Office. Чтобы получить последние обновления для надстройки Office, пользователь должен сначала удалить надстройку COM.

## <a name="see-also"></a>См. также

- [Обеспечение совместимости пользовательских функций с пользовательскими функциями XLL](../excel/make-custom-functions-compatible-with-xll-udf.md)
