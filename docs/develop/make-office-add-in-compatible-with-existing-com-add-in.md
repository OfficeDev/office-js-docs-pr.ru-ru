---
title: Обеспечение совместимости надстройки Excel с существующей надстройкой COM
description: Обеспечение совместимости с эквивалентной надстройкой COM, имеющей те же функциональные возможности, что и надстройка Excel
ms.date: 05/06/2019
localization_priority: Normal
ms.openlocfilehash: 0890e14466a2cd8f5aff2d1bcf307a43cff28127
ms.sourcegitcommit: ff73cc04e5718765fcbe74181505a974db69c3f5
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/06/2019
ms.locfileid: "33628174"
---
# <a name="make-your-office-add-in-compatible-with-an-existing-com-add-in-preview"></a>Обеспечение совместимости надстройки Office с существующей надстройкой COM (Предварительная версия)

Если у вас есть надстройка COM, вы можете создать эквивалентную функцию в надстройке Excel, чтобы расширить функциональные возможности решения на другие платформы, такие как Online или macOS. Тем не менее, надстройки Excel не имеют всех функциональных возможностей, доступных в надстройках COM. Надстройка COM может обеспечить лучшую работу, чем надстройка Excel в Windows.

Вы можете настроить надстройку Excel таким образом, чтобы если на компьютере пользователя уже установлена эквивалентная надстройка COM, Office запускает надстройку COM, а не надстройку Excel. Надстройка COM называется "эквивалентной", так как Office будет беспрепятственно переходить между надстройкой COM и надстройкой Excel в зависимости от того, какая установлена в Windows.

[!include[COM add-in and XLL UDF compatibility requirements note](../includes/xll-compatibility-note.md)]

## <a name="specify-an-equivalent-com-add-in-in-the-manifest"></a>Указание эквивалентной надстройки COM в манифесте

Чтобы обеспечить совместимость с существующей надстройкой COM, определите эквивалентную надстройку COM в манифесте надстройки Excel. После этого Office будет использовать надстройку COM вместо надстройки Excel при работе в Windows.

`ProgID` Укажите эквивалентную надстройку COM. Затем Office будет использовать пользовательский интерфейс надстройки COM, а не пользовательский интерфейс надстройки Excel при установке надстройки COM.

В приведенном ниже примере показано, как указать как надстройку COM, так и XLL в качестве эквивалента. Как правило, для полноты указывается и то, и другое, в этом примере показана как в контексте. Они определяются по их `ProgID` и `FileName` соответственно. Для получения дополнительной информации о совместимости XLL, ознакомьтесь [со статьей Создание пользовательских функций, совместимых с пользовательскими ФУНКЦИЯМИ XLL](../excel/make-custom-functions-compatible-with-xll-udf.md).

```xml
<VersionOverrides>
...
<EquivalentAddins>
  <EquivalentAddin>
    <ProgID>ContosoCOMAddin</ProgID>
    <Type>COM</Type>
  </EquivalentAddin>

  <EquivalentAddin>
    <FileName>contosofunctions.xll</FileName>
    <Type>XLL</Type>
  </EquivalentAddin>
<EquivalentAddins>
...
</VersionOverrides>
```

## <a name="equivalent-behavior-for-users"></a>Эквивалентное поведение для пользователей

Если в манифесте надстройки Excel указана эквивалентная надстройка COM, Office отключает пользовательский интерфейс надстройки Excel в Windows при установке эквивалентной надстройки COM. Это не влияет на пользовательский интерфейс надстройки Excel на других платформах, таких как Online или macOS. Office скрывает только кнопки ленты и не запрещает установку. Поэтому надстройка Excel по-прежнему будет отображаться в следующих расположениях ПОЛЬЗОВАТЕЛЬСКОГО интерфейса:

- В разделе **Мои** надстройки, так как она технически устанавливается.
- В качестве записи в диспетчере ленты.

В следующих сценариях описывается, что происходит в зависимости от того, как пользователь приобретает надстройку Excel.

### <a name="appsource-acquisition-of-an-excel-add-in"></a>AppSource получение надстройки Excel

Если пользователь загружает надстройку Excel из AppSource, а аналогичная надстройка COM уже установлена, Office выполнит следующие действия:

1. Установите надстройку Excel.
2. Скрыть пользовательский интерфейс надстройки Excel на ленте.
3. Отображение вызываемого абонента для пользователя, который указывает на кнопку ленты надстройки COM.

### <a name="centralized-deployment-of-excel-add-in"></a>Централизованное развертывание надстройки Excel

Если Администратор развертывает надстройку Excel в своем клиенте с помощью централизованного развертывания, а эквивалентная надстройка COM уже установлена, то пользователю необходимо перезапустить Office до того, как будут видны изменения. После перезапуска Office будет:

1. Установите надстройку Excel.
2. Скрыть пользовательский интерфейс надстройки Excel на ленте.
3. Отображение вызываемого абонента для пользователя, который указывает на кнопку ленты надстройки COM.

### <a name="document-shared-with-embedded-excel-add-in"></a>Общий доступ к документу с помощью встроенной надстройки Excel

Если у пользователя установлена надстройка COM, а затем он получает общий документ с внедренной надстройкой Excel, то при открытии документа Office будет:

1. Предложит пользователю доверять надстройке Excel.
2. Если вы доверяете, надстройка Excel будет установлена.
3. Скрыть пользовательский интерфейс надстройки Excel на ленте.

## <a name="other-com-add-in-behavior"></a>Другое поведение надстройки COM

Если пользователь удаляет надстройку COM, Office восстанавливает пользовательский интерфейс надстройки Excel в Windows для эквивалентной установленной надстройки Excel.

Когда вы укажете эквивалентную надстройку COM для надстройки Excel, Office прекратит обработку обновлений для надстройки Excel. Пользователь должен удалить порядок надстроек COM для получения последних обновлений для надстройки Excel.

## <a name="see-also"></a>См. также

- [Обеспечение совместимости пользовательских функций с пользовательскими функциями XLL](../excel/make-custom-functions-compatible-with-xll-udf.md)
