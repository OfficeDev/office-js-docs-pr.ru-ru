---
title: Загрузка модели DOM и среды выполнения
description: Загрузите среду выполнения DOM и надстроек Office.
ms.date: 07/08/2021
ms.localizationpriority: medium
ms.openlocfilehash: be93b261c8beacdb7b4e8cd08448abf06b14607e
ms.sourcegitcommit: b6a3815a1ad17f3522ca35247a3fd5d7105e174e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/22/2022
ms.locfileid: "66958687"
---
# <a name="loading-the-dom-and-runtime-environment"></a>Загрузка модели DOM и среды выполнения

Перед запуском собственной логики надстройка должна проверить, что загружены модель DOM и среда выполнения Надстройки Office.

## <a name="startup-of-a-content-or-task-pane-add-in"></a>Запуск контентной надстройки или надстройки области задач

На рисунке ниже приведен поток событий, происходящих при запуске контентной надстройки или надстройки области задач в Excel, PowerPoint, Project или Word.

![Поток событий при запуске контентной надстройки или надстройки области задач.](../images/office15-app-sdk-loading-dom-agave-runtime.png)

При запуске контентной надстройки или надстройки области задач происходят следующие события.

1. Пользователь открывает документ, который уже содержит надстройку, или вставляет надстройку в документ.

2. Клиентское приложение Office считывает XML-манифест надстройки из AppSource, каталога приложений в SharePoint или каталога общих папок, из которой она берется.

3. Клиентское приложение Office открывает HTML-страницу надстройки в элементе управления браузера.

    Следующие два действия, 4 и 5, выполняются одновременно и параллельно. Поэтому код надстройки перед обработкой должен убедиться, что и модель DOM, и среда выполнения надстройки полностью загрузились.

4. Элемент управления браузера загружает DOM и текст HTML и вызывает обработчик событий для `window.onload` события.

5. Клиентское приложение Office загружает среду выполнения, которая загружает и кэширует файлы библиотеки API JavaScript для Office с сервера сети распространения содержимого (CDN), а затем вызывает обработчик событий надстройки для события инициализации объекта [Office](/javascript/api/office), если он назначен обработчику.[](/javascript/api/office#Office_initialize_reason_) В это время он также проверяет, переданы ли обработчику какие-либо обратные вызовы ( `then()` `Office.onReady` или цепочки методов). Дополнительные сведения о различиях между `Office.initialize` и надстройки `Office.onReady`см. в разделе ["Инициализация надстройки"](initialize-add-in.md).

6. После завершения загрузки DOM и основного текста HTML и инициализации надстройки запускается основная функция надстройки.

## <a name="startup-of-an-outlook-add-in"></a>Запуск надстройки Outlook

На рисунке ниже приведен поток событий при запуске надстройки Outlook на настольном компьютере, планшетном ПК или смартфоне.

![Поток событий при запуске надстройки Outlook.](../images/outlook15-loading-dom-agave-runtime.png)

При запуске надстройки Outlook происходят следующие события.

1. При запуске Outlook считывает XML-манифесты надстроек Outlook, установленных для учетной записи пользователя.

2. Пользователь выбирает элемент в Outlook.

3. Если выбранный элемент удовлетворяет условиям активации надстройки Outlook, то Outlook активирует надстройку и делает соответствующую кнопку видимой в пользовательском интерфейсе.

4. Если пользователь нажимает кнопку для запуска надстройки Outlook, то ведущее приложение открывает HTML-страницу в элементе управления браузером. Следующие два шага, шаг 5 и шаг 6, выполняются одновременно.

5. Элемент управления браузера загружает DOM и текст HTML и вызывает обработчик событий для `onload` события.

6. Outlook загружает среду выполнения, которая загружает и кэширует API JavaScript для файлов библиотеки JavaScript с сервера сети доставки содержимого, а затем вызывает обработчик события [инициализации](/javascript/api/office#Office_initialize_reason_) объекта [Office](/javascript/api/office) надстройки, если ему назначен обработчик. В это время он также проверяет, переданы ли обработчику обратные вызовы ( `then()` `Office.onReady` или цепочки методов). Дополнительные сведения о различиях между `Office.initialize` и надстройки `Office.onReady`см. в разделе ["Инициализация надстройки"](initialize-add-in.md).

7. После завершения загрузки DOM и основного текста HTML и инициализации надстройки запускается основная функция надстройки.

## <a name="see-also"></a>Дополнительные ресурсы

- [Общие сведения об API JavaScript для Office](understanding-the-javascript-api-for-office.md)
- [Инициализация надстройки Office](initialize-add-in.md)
