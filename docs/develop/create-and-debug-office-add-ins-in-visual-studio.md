---
title: Создание и отладка надстроек Office в Visual Studio
description: ''
ms.date: 10/01/2018
ms.openlocfilehash: 0bbc1b167924ce4b7a1310f04b41751173312cd6
ms.sourcegitcommit: c53f05bbd4abdfe1ee2e42fdd4f82b318b363ad7
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/12/2018
ms.locfileid: "25506128"
---
# <a name="create-and-debug-office-add-ins-in-visual-studio"></a>Создание и отладка надстроек Office в Visual Studio

Из этой статьи можно узнать, как создать свою первую надстройку Office с помощью Visual Studio. Действия, описанные в этой статье, относятся к версии Visual Studio 2015. Если вы используете другую версию Visual Studio, действия могут немного отличаться.

> [!NOTE]
> Чтобы начать работу над надстройкой OneNote, см. статью [Создание первой надстройки OneNote](../onenote/onenote-add-ins-getting-started.md).

## <a name="create-an-office-add-in-project-in-visual-studio"></a>Создание проекта надстройки Office в Visual Studio


Для начала убедитесь, что у вас установлены инструменты [Office Developer Tools](https://www.visualstudio.com/features/office-tools-vs.aspx) и версия Microsoft Office. Вы можете присоединиться к [программе для разработчиков Office 365](https://developer.microsoft.com/office/dev-program) или получить [последнюю версию](../develop/install-latest-office-version.md), следуя приведенным ниже инструкциям.

1. В строке меню Visual Studio выберите **Файл** > **Создать** > **Проект**.
2. В списке типов проектов в **Visual C#** или **Visual Basic** разверните узел **Office/SharePoint**, выберите **Веб-надстройки**, а затем выберите один из проектов надстроек.
3. Введите имя проекта и нажмите кнопку **ОК**, чтобы создать его.

В Visual Studio 2017 после нажатия кнопки **ОК** следующие шаблоны проекта надстройки будут иметь дополнительные параметры:

**PowerPoint**
- Вы можете выбрать **Добавить новые функциональные возможности PowerPoint** для создания области задач надстройки.
- Или вы можете выбрать **Вставить содержимое в слайды PowerPoint** для создания надстройки содержимого.

**Excel** 
- Вы можете выбрать **Добавить новые функциональные возможности в Excel** для создания надстройки области задач.
- Или вы можете выбрать **Вставить содержимое в электронную таблицу Excel** для создания надстройки содержимого.
    - При создании надстройки содержимого вы также можете выбрать вариант **Базовая надстройка**, при котором создается проект надстройки с минимальным начальным кодом.
    - Или вы можете выбрать **надстройку визуализации документа**, которая включает начальный код для визуализации и привязки к данным.

После завершения работы мастера Visual Studio создаст решение, содержащее два проекта. Вы увидите открытую страницу Home.html по умолчанию.

|**Проект**|**Описание**|
|:-----|:-----|
|Проект надстройки|Содержит только XML-файл манифеста, который содержит все параметры, описывающие надстройку. Эти параметры помогают ведущему приложению Office определять, когда и где должна активироваться надстройка. Visual Studio создает содержимое этого файла за вас, чтобы вы могли сразу запустить проект и начать использовать надстройку. Вы можете менять эти параметры в любой момент с помощью редактора манифеста.|
|Проект веб-приложения|Содержит страницы содержимого надстройки, в том числе все файлы и ссылки на файлы, которые необходимы для разработки поддерживающих Office страниц HTML и JavaScript. Во время разработки надстройки веб-приложение размещается на локальном сервере IIS. Когда вы будете готовы к публикации, вам придется найти сервер для размещения этого проекта. Дополнительные сведения о проектах веб-приложений ASP.NET можно узнать в статье [Веб-проекты ASP.NET](http://msdn.microsoft.com/library/cdcd712f-96b0-4165-8b5d-9d0566650a28%28Office.15%29.aspx).|

## <a name="modify-your-add-in-settings"></a>Изменение параметров надстроек


Чтобы изменить параметры надстройки, отредактируйте XML-файл манифеста проекта. В **обозревателе решений** разверните узел проекта надстройки, откройте папку, содержащую XML-манифест, и выберите его. Вы можете навести указатель мыши на любой элемент в файле, чтобы увидеть подсказку с описанием назначения этого элемента. Дополнительные сведения о файле манифеста см. в статье [XML-манифест надстроек Office](../develop/add-in-manifests.md).


## <a name="develop-the-contents-of-your-add-in"></a>Разработка содержимого надстройки

Проект надстройки позволяет изменить ее параметры, а веб-приложение предоставляет содержимое, которое отображается в надстройке. 

Проект веб-приложения содержит HTML-страницу по умолчанию и файл JavaScript, которые можно использовать для начала работы. Эти файлы содержат ссылки на другие библиотеки JavaScript, включая API JavaScript для Office. Вы можете создавать надстройки путем обновления этих файлов и добавления дополнительных файлов HTML и JavaScript. В следующей таблице описываются файлы JavaScript и HTML-страницы по умолчанию.

> [!NOTE]
> Файлы в приведенной ниже таблице могут находиться в корневой папке веб-проекта или в папке **Home** в зависимости от типа использованного шаблона проекта.

|**Файл**|**Описание**|
|:-----|:-----|
|**Home.html**|HTML-страница надстройки по умолчанию. Эта страница отображается первой в надстройке при ее активации в документе, сообщении электронной почты или элементе встречи. Этот файл содержит все ссылки на файлы, необходимые для начала работы. Вы можете начать разработку надстройки, добавив HTML-код в этот файл.|
|**Home.js**|Файл JavaScript, связанный со страницей Home.html. Вы также можете поместить в файл Home.js любой код, который относится к поведению страницы Home.html. Файл Home.js содержит некоторые примеры кода для начала работы.|
|**Home.css**|Определение стилей по умолчанию для применения к надстройке. Рекомендуется использовать Office UI Fabric для разработки дизайна и стилей. Для получения дополнительных сведений см. статью [Office UI Fabric в надстройке Office](../design/office-ui-fabric.md).|

> [!NOTE]
> Вам не обязательно использовать эти файлы. Вы можете добавить другие файлы в проект и вместо этого использовать их. Если вы хотите, чтобы в качестве начальной страницы надстройки отображался другой HTML-файл, откройте редактор манифеста и задайте свойству **SourceLocation** имя файла.

## <a name="debug-your-add-in"></a>Отладка надстройки

Visual Studio предоставляет свойства построения и отладки для помощи с отладкой надстройки.

### <a name="review-the-build-and-debug-properties"></a>Просмотр свойств, связанных с построением и отладкой

Перед запуском решения убедитесь, что Visual Studio откроет нужное ведущее приложение. Эти сведения отображаются на страницах свойств проекта вместе с несколькими другими свойствами, относящимися к построению и отладке надстройки.

### <a name="to-open-the-property-pages-of-a-project"></a>Открытие страниц свойств проекта

1. В **обозревателе решений** выберите основной проект надстройки (не веб-проект).    
2. В строке меню выберите **Вид** >  **Окно свойств**.
    
В следующей таблице описываются свойства проекта.



|**Свойство**|**Описание**|
|:-----|:-----|
|**Действие при запуске**|Указывает, где производить отладку надстройки — в классическом приложении Office или в клиенте Office Online в заданном браузере.|
|**Документ при запуске** (только надстройки содержимого и надстройки области задач)|Указывает, какой документ следует открыть при запуске проекта.|
|**Веб-проект**|Указывает имя веб-проекта, связанного с надстройкой.|
|**Адрес электронной почты** (только надстройки Outlook)|Указывает адрес электронной почты учетной записи пользователя на сервере Exchange Server или Exchange Online, с которой вы хотите протестировать надстройку Outlook.|
|**URL-адрес EWS** (только надстройки Outlook)|URL веб-службы Exchange (например, https://www.contoso.com/ews/exchange.aspx). |
|**URL-адрес OWA** (только надстройки Outlook)|URL-адрес Outlook Web App (например, https://www.contoso.com/owa).|
|**Имя пользователя** (только надстройки Outlook)|Указывает имя вашей учетной записи пользователя в Exchange Server или Exchange Online.|
|**Файл проекта**|Задает имя файла, в котором указаны сборка, конфигурация и другие сведения о проекте.|
|**Папка проекта**|Расположение файла проекта.|

### <a name="use-an-existing-document-to-debug-the-add-in-content-and-task-pane-add-ins-only"></a>Использование существующего документа для отладки надстройки (только для контентных надстроек и надстроек области задач)

В проект надстройки можно добавить документы. Если ваш документ содержит тестовые данные, которые необходимо использовать в надстройке, Visual Studio откроет документ при запуске проекта.

### <a name="to-use-an-existing-document-to-debug-the-add-in"></a>Чтобы использовать существующий документ для отладки надстройки, выполните следующие действия:

1. В **обозревателе решений** выберите папку проекта надстройки.
    
    > [!NOTE]
    > Выберите проект надстройки, а не проект веб-приложения.

2. В меню **Проект** выберите пункт **Добавить существующий элемент**.
    
3. В диалоговом окне **Добавление существующего элемента** найдите и выберите документ, который необходимо добавить.
    
4. Нажмите кнопку **Добавить**, чтобы добавить документ в проект.
    
5. В **обозревателе решений** выберите папку проекта надстройки.
6. В строке меню выберите **Вид** > **Окно свойств**.
7. В Окне свойств выберите список **Документ при запуске**, а затем документ, который добавлен в проект. Теперь проект настроен на запуск надстройки в существующем документе.

### <a name="start-the-solution"></a>Запуск решения

Запустите решение в строке меню, выбрав **Отладка** > **Начать отладку**. Visual Studio автоматически построит решение и запустит Office для размещения надстройки.

После построения проекта Visual Studio выполняет следующие действия.

1. Создает копию XML-файла манифеста и добавляет его в каталог _ProjectName_\Output. Ведущее приложение использует эту копию при запуске Visual Studio и отладке надстройки.
    
2. Создает набор записей реестра на компьютере, которые служат для включения отображения надстройки в ведущем приложении.
    
3. Создает проект веб-приложения, а затем развертывает его на локальном веб-сервере IIS (http://localhost)). 
    
Затем Visual Studio делает следующее:

1. Изменяет элемент [SourceLocation](https://docs.microsoft.com/office/dev/add-ins/reference/manifest/sourcelocation?view=office-js) файла манифеста XML, заменяя маркер ~remoteAppUrl полным адресом начальной страницы (например, http://localhost/MyAgave.html)).
    
2. Запускает проект веб-приложения в IIS Express.
    
3. Открывает ведущее приложение. 
    
Visual Studio не отображает ошибки проверки в окне **OUTPUT (ВЫВОД)** при построении проекта. Visual Studio сообщает об ошибках и предупреждениях в окне **ERRORLIST (СПИСОК ОШИБОК)** по мере их возникновения. Кроме того, Visual Studio также выделяет ошибки волнистой линией разных цветов прямо в коде и текстовом редакторе. Эти пометки уведомляют о проблемах, обнаруженных Visual Studio в коде. Дополнительные сведения можно узнать в разделе [Код и текстовый редактор](https://msdn.microsoft.com/library/se2f663y(v=vs.140).aspx). Дополнительные сведения о включении или отключении проверки изложены в следующих статьях: 

- [Параметры, Текстовый редактор, JavaScript, IntelliSense](https://docs.microsoft.com/visualstudio/ide/reference/options-text-editor-javascript-intellisense?view=vs-2015)
    
- [Практическое руководство. Установка параметров проверки редактирования HTML в Visual Web Developer](https://msdn.microsoft.com/library/0byxkfet(v=vs.100).aspx)
    
- [CSS, см. Проверка, CSS, Текстовый редактор, Диалоговое окно "Параметры"](https://msdn.microsoft.com/library/se2f663y(v=vs.140).aspx)
    
Чтобы просмотреть правила проверки XML-файла манифеста проекта, ознакомьтесь с разделом [XML-манифест надстроек для Office](../develop/add-in-manifests.md).

### <a name="show-an-add-in-in-excel-or-word-and-step-through-your-code"></a>Отображение надстройки в Excel, Word или Project и пошаговое выполнение кода

Если задать свойству проекта надстройки **Документ при запуске** значение Excel или Word, Visual Studio создает новый документ и отображается надстройка. Если задать свойству проекта надстройки **Документ при запуске** использование существующего документа, Visual Studio открывает документ, но надстройку нужно вставить вручную.

1. В Excel или Word на вкладке **Вставка** выберите раскрывающийся список **Мои надстройки**. Выберите список, раскрывающийся на стрелке, но не саму кнопку, которая открывает диалоговое окно **Надстройки Office**.
2. В списке **Надстройки разработчика** выберите свою надстройку.

В Visual Studio можно создавать точки останова, взаимодействовать с надстройками и пошагово выполнять код в файлах HTML или JavaScript.

### <a name="show-the-outlook-add-in-in-outlook-and-step-through-your-code"></a>Отображение надстройки Outlook в Outlook и пошаговое выполнение кода

Чтобы просмотреть надстройку Outlook, откройте сообщение электронной почты или элемент встречи.

Outlook активирует надстройку для этого элемента, если соблюдаются критерии активации. В верхней части окна инспектора или области чтения появляется строка надстройки, и надстройка Outlook отображается в строке надстройки в виде кнопки. Если в вашей надстройке есть команда, на ленте появится кнопка (либо на вкладке по умолчанию, либо на указанной настраиваемой вкладке), а надстройка не будет отображаться в строке надстройки.

Чтобы просмотреть надстройку Outlook, нажмите кнопку своей надстройки Outlook.

В Visual Studio можно создавать точки останова, взаимодействовать с надстройками и пошагово выполнять код в файлах HTML или JavaScript.

Можно также изменить код и просмотреть результаты этих изменений в надстройке Outlook без необходимости закрывать надстройку Office и перезагрузить проект. В Outlook следует просто открыть контекстное меню для надстройки Outlook и нажать кнопку **Обновить**.


### <a name="modify-code-and-continue-to-debug-the-add-in-without-having-to-start-the-project-again"></a>Изменение кода и продолжение отладки надстройки без необходимости перезагрузки проекта

Вы можете изменить код и просмотреть эффект этих изменений в надстройке без необходимости закрывать ведущее приложение и перезагружать проект. После изменения и сохранения кода, откройте контекстное меню для надстройки и выберите пункт **Обновить**.
    

## <a name="next-steps"></a>Дальнейшие действия

- [Развертывание и публикация надстройки Office](../publish/publish.md)
    
