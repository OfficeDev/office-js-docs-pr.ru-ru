---
title: Создание и отладка надстроек Office в Visual Studio
description: ''
ms.date: 03/14/2018
ms.openlocfilehash: c903f3d475e46ee09a3c350f79c1e3d671ae5923
ms.sourcegitcommit: 28fc652bded31205e393df9dec3a9dedb4169d78
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/23/2018
ms.locfileid: "22927449"
---
# <a name="create-and-debug-office-add-ins-in-visual-studio"></a>Создание и отладка надстроек Office в Visual Studio

Из этой статьи можно узнать, как создать свою первую надстройку Office с помощью Visual Studio. Действия, описанные в этой статье, относятся к версии Visual Studio 2015. Если вы используете другую версию Visual Studio, действия могут немного отличаться.

> [!NOTE]
> Чтобы начать работу над надстройкой OneNote, см. статью [Создание первой надстройки OneNote](../onenote/onenote-add-ins-getting-started.md).

## <a name="create-an-office-add-in-project-in-visual-studio"></a>Создание проекта надстройки Office в Visual Studio


Для начала убедитесь, что у вас установлены инструменты [Office Developer Tools](https://www.visualstudio.com/features/office-tools-vs.aspx) и версия Microsoft Office. Вы можете присоединиться к [программе для разработчиков Office 365](https://developer.microsoft.com/office/dev-program) или получить [последнюю версию](../develop/install-latest-office-version.md), следуя приведенным ниже инструкциям.


1. В строке меню Visual Studio выберите **Файл** > **Создать** > **Проект**.
    
2. В списке типов проектов **Visual C#** или **Visual Basic** разверните узел **Office/SharePoint**, выберите **Веб-надстройки**, а затем выберите один из проектов надстроек.  
    
3. Введите имя проекта и нажмите кнопку **ОК**, чтобы создать его.
    
4. В Visual Studio создается решение, и соответствующие два проекта отображаются в **обозревателе решений**. В Visual Studio откроется страница Home.html по умолчанию.
    
В Visual Studio 2015 некоторые шаблоны проектов надстроек обновлены с добавлением новых функций.


- Контентные надстройки могут отображаться в основном тексте документов Access и PowerPoint, а не только в электронных таблицах Excel. Вы также можете выбрать параметр "Базовый проект", чтобы создать проект простой контентной надстройки с минимумом начального кода, или параметр "Проект визуализации документов" (только для Access и Excel), чтобы создать более функциональную контентную надстройку, которая включает начальный код для визуализации данных и привязки к ним.
    
- Надстройки Outlook позволяют не только встраивать надстройку в сообщения электронной почты или встречи, но и указывать, доступна ли она при создании и просмотре сообщения или встречи.
    

> [!NOTE]
> Назначение большинства параметров в Visual Studio очевидно из названия, кроме флажка **Сообщение электронной почты**. Установите этот флажок, если вам нужно создать надстройку Outlook, которая отображается не только с почтовыми элементами, но и с приглашениями на собрания, текстами ответов и отмен.

После завершения работы мастера Visual Studio создает решение, которое содержит два проекта.



|**Проект**|**Описание**|
|:-----|:-----|
|Проект надстройки|Содержит только XML-файл манифеста, который содержит все параметры, описывающие надстройку. Эти параметры помогают ведущему приложению Office определять, когда и где должна активироваться надстройка. Visual Studio создает содержимое этого файла за вас, чтобы вы могли сразу запустить проект и начать использовать надстройку. Вы можете менять эти параметры в любой момент с помощью редактора манифеста.|
|Проект веб-приложения|Содержит страницы контента надстройки, включающие все файлы и ссылки на файлы, необходимые для разработки страниц HTML и JavaScript с поддержкой Office. При разработке надстройки Visual Studio размещает веб-приложение на локальном сервере IIS. Когда вы будете готовы опубликовать надстройку, потребуется найти сервер для размещения проекта. Дополнительные сведения о проектах веб-приложений ASP.NET см. в статье [Веб-проекты ASP.NET](http://msdn.microsoft.com/library/cdcd712f-96b0-4165-8b5d-9d0566650a28%28Office.15%29.aspx).|

## <a name="modify-your-add-in-settings"></a>Изменение параметров надстроек


Чтобы изменить параметры надстройки, отредактируйте XML-файл манифеста проекта. В **обозревателе решений** разверните узел проекта надстройки, откройте папку, содержащую XML-манифест, и выберите его. Вы можете навести указатель мыши на любой элемент в файле, чтобы увидеть подсказку с описанием назначения этого элемента. Дополнительные сведения о файле манифеста см. в статье [XML-манифест надстроек Office](../develop/add-in-manifests.md).


## <a name="develop-the-contents-of-your-add-in"></a>Разработка содержимого надстройки


Проект надстройки позволяет изменить ее параметры, а веб-приложение предоставляет содержимое, которое отображается в надстройке. 

Проект веб-приложения содержит HTML-файл страницы по умолчанию и файл JavaScript, которые можно использовать для начала работы. Проект также содержит файл JavaScript, который используется для всех страниц, добавленных в проект. Эти файлы очень важны, так как в них содержатся ссылки на другие библиотеки JavaScript, в том числе API JavaScript для Office. 

По мере усложнения надстройки вы можете добавлять дополнительные HTML-файлы и файлы JavaScript. Содержимое файлов HTML и JavaScript по умолчанию можно использовать как примеры типов ссылок, которые можно добавить на другие страницы проекта, чтобы они работали с вашей надстройкой. В следующей таблице описываются файлы HTML и JavaScript по умолчанию.



|**Файл**|**Описание**|
|:-----|:-----|
|**Home.html**|Эта HTML-страница надстройки по умолчанию располагается в папке **Home** проекта. Она отображается первой в надстройки при ее активации в сообщении электронной почты или элементе встречи. Этот файл удобен тем, что содержит все ссылки на файлы, необходимые для начала работы. Когда вы будете готовы к созданию своей первой надстройки, просто добавьте HTML-код в этот файл.|
|**Home.js**|Файл JavaScript по умолчанию, расположенный в папке **Home** проекта и связанный со страницей Home.js. В файле Home.js можно разместить код, связанный с поведением страницы Home.html. Файл Home.js содержит пример кода, который поможет вам с созданием приложения.|
|**App.js**|Файл JavaScript по умолчанию, расположенный в папке **Add-in**. Вы можете поместить в файл App.js код, который относится к поведению нескольких страниц вашей надстройки. Файл App.js содержит некоторые примеры кода, которые помогут вам приступить к работе.|

> [!NOTE]
> Эти файлы необязательно использовать. Вы можете добавлять в проект другие файлы. Если в качестве начальной страницы надстройки должен отображаться другой HTML-файл, откройте редактор манифестов и задайте значение для свойства **SourceLocation**, указав имя нужного файла.


## <a name="debug-your-add-in"></a>Отладка надстройки


Если все готово к запуску надстройки, просмотрите свойства, связанные с построением и отладкой, затем запустите решение.


### <a name="review-the-build-and-debug-properties"></a>Просмотр свойств, связанных с построением и отладкой

Перед запуском решения убедитесь, что Visual Studio откроет нужное ведущее приложение. Эти сведения отображаются на страницах свойств проекта вместе с несколькими другими свойствами, относящимися к построению и отладке надстройки.


### <a name="to-open-the-property-pages-of-a-project"></a>Открытие страниц свойств проекта


1. В **Обозревателе решений** выберите основной проект надстройки (не веб-проект).
    
2. В панели меню выберите пункты **Вид** и **Окно свойств**.
    
В следующей таблице описываются свойства проекта.



|**Свойство**|**Описание**|
|:-----|:-----|
|**Действие при запуске**|Указывает, где производить отладку надстройки — в классическом приложении Office или в клиенте Office Online в заданном браузере.|
|**Документ при запуске** (только для контентных надстроек и надстроек области задач)|Указывает, какой документ следует открыть при запуске проекта.|
|**Веб-проект**|Определяет имя веб-проекта, связанного с надстройкой.|
|**Адрес электронной почты** (только надстройки Outlook)|Указывает адрес электронной почты учетной записи пользователя на сервере Exchange Server или Exchange Online, с которой нужно проверить надстройкой Outlook.|
|**URL-адрес EWS** (только надстройки Outlook)|URL веб-службы Exchange (пример: https://www.contoso.com/ews/exchange.aspx). |
|**URL-адрес OWA** (только надстройки Outlook)|URL-адрес Outlook Web App (пример: https://www.contoso.com/owa).|
|**Имя пользователя** (только надстройки Outlook)|Указывает имя учетной записи пользователя в Exchange Server или Exchange Online.|
|**Файл проекта**|Задает имя файла, в котором указаны сборка, конфигурация и другие сведения о проекте.|
|**Папка проекта**|Расположение файла проекта.|

### <a name="use-an-existing-document-to-debug-the-add-in-content-and-task-pane-add-ins-only"></a>Использование существующего документа для отладки надстройки (только для контентных надстроек и надстроек области задач)


В проект надстройки можно добавить документы. Если ваш документ содержит тестовые данные, которые необходимо использовать в надстройке, Visual Studio откроет документ при запуске проекта.


### <a name="to-use-an-existing-document-to-debug-the-add-in"></a>Чтобы использовать существующий документ для отладки надстройки, выполните следующие действия:


1. В **обозревателе решений** выберите папку проекта надстройки.
    
    > [!NOTE]
    > Выберите проект надстройки, а не проект веб-приложения.

2. В меню **Проект** выберите пункт **Добавить существующий элемент**.
    
3. В диалоговом окне **Добавление существующего элемента** найдите и выберите документ, который необходимо добавить.
    
4. Нажмите кнопку **Добавить**, чтобы добавить документ в проект.
    
5. В **обозревателе решений** откройте контекстное меню проекта и выберите **Свойства**.
    
    Появятся страницы свойств для проекта.
    
6. В списке **Документ при запуске** выберите добавляемый в проект документ и нажмите кнопку **ОК**, чтобы закрыть страницы свойств.
    

### <a name="start-the-solution"></a>Запуск решения


При запуске Visual Studio автоматически создает решение. Решение можно запустить в строке **Меню**, выбрав **Отладка**, **Пуск**. 


> [!NOTE]
> Если отладка скриптов не включена в Internet Explorer, запустить отладчик в Visual Studio не удастся. Чтобы включить отладку, откройте диалоговое окно **Свойства браузера**, перейдите на вкладку **Дополнительно** и снимите флажки **Отключить отладку сценариев (Internet Explorer)** и **Отключить отладку сценариев (другие)**.

Visual Studio создает проект и выполняет следующие действия:


1. Создает копию XML-файла манифеста и добавляет его в каталог _Имя_проекта_\Output. Ведущее приложение использует эту копию при запуске Visual Studio и отладке надстройки.
    
2. Создает набор записей реестра на компьютере, которые служат для включения отображения надстройки в ведущем приложении.
    
3. Создает проект веб-приложения, а затем развертывает его на локальном веб-сервере IIS (http://localhost)). 
    
Затем Visual Studio делает следующее:


1. Изменяет элемент [SourceLocation](https://dev.office.com/reference/add-ins/manifest/sourcelocation) файла манифеста XML, заменяя маркер ~remoteAppUrl полным адресом начальной страницы (например, http://localhost/MyAgave.html)).
    
2. Запускает проект веб-приложения в IIS Express.
    
3. Открывает ведущее приложение. 
    
Visual Studio не отображает ошибки проверки в окне **ВЫВОД** при построении проекта. Visual Studio сообщает об ошибках и предупреждениях в окне **ОШИБКИ** по мере их возникновения. Кроме того, Visual Studio также выделяет ошибки волнистой линией разных цветов прямо в коде и текстовом редакторе. Эти пометки уведомляют о проблемах, обнаруженных Visual Studio в коде. Дополнительные сведения можно узнать в разделе [Код и текстовый редактор](https://msdn.microsoft.com/library/se2f663y(v=vs.140).aspx). Дополнительные сведения о включении или отключении проверки изложены в следующих статьях: 

- ["Параметры", "Текстовый редактор", JavaScript, IntelliSense](https://msdn.microsoft.com/library/hh362485(v=vs.140).aspx)
    
- [Практическое руководство. Установка параметров проверки редактирования HTML в Visual Web Developer](https://msdn.microsoft.com/library/0byxkfet(v=vs.100).aspx)
    
- [Проверка, CSS, текстовый редактор, диалоговое окно "Параметры"](https://msdn.microsoft.com/library/se2f663y(v=vs.140).aspx)
    
Чтобы просмотреть правила проверки XML-файла манифеста проекта, ознакомьтесь с разделом [XML-манифест надстроек для Office](../develop/add-in-manifests.md).


### <a name="show-an-add-in-in-excel-word-or-project-and-step-through-your-code"></a>Показ надстройки в Excel, Word или Project и пошаговое выполнение кода


Если для свойства **Документ при запуске** проекта задать значение Excel или Word, Visual Studio создаст новый документ и отобразит надстройку. Если для свойства **Документ при запуске** проекта указать на использование существующего документа, Visual Studio откроет этот документ, но надстройку необходимо вставить вручную. Если для свойства **Документ при запуске** задано значение **Microsoft Project**, также необходимо вставить надстройку вручную.


### <a name="to-show-an-office-add-in-in-excel-or-word"></a>Отображение Надстройка Office в Excel или Word


1. В Excel или Word на вкладке **Вставка** выберите **Надстройки Office**.
    
2. Выберите надстройку в появившемся списке.
    

### <a name="to-show-an-office-add-in-in-project"></a>Отображение Надстройка Office в Project


1. В Project на вкладке **Проект** выберите **Надстройки Office**.
    
2. Выберите надстройку в появившемся списке.
    
В Visual Studio теперь можно создавать точки останова, а затем взаимодействовать с надстройкой и выполнять код в файлах HTML, JavaScript и C# или VB в пошаговом режиме.


### <a name="show-the-outlook-add-in-in-outlook-and-step-through-your-code"></a>Отображение надстройки Outlook в Outlook и пошаговый переход по коду


Чтобы просмотреть надстройку Outlook, откройте сообщение эл. почты или элемент встречи.

Outlook активирует надстройка для этого элемента, если соблюдаются критерии активации. В верхней части окна инспектора или области чтения появляется строка надстройка, и надстройка Outlook отображается в строке надстройка в виде кнопки. Если в вашей надстройке есть команда, на ленте появится кнопка (либо на вкладке по умолчанию, либо на пользовательской вкладке), а надстройка не будет отображаться в области надстройка.

Чтобы просмотреть надстройку Outlook, нажмите соответствующую кнопку.

В Visual Studio можно создавать точки останова, а затем взаимодействовать с надстройкой Outlook и выполнять код в файлах HTML, JavaScript и C# или VB в пошаговом режиме. 

Можно также изменить код и просмотреть результаты этих изменений в надстройке Outlook без необходимости закрывать Надстройка Office и повторного запуска проекта. В Outlook следует просто открыть контекстное меню для надстройки Outlook и нажать кнопку **Обновить**.


### <a name="modify-code-and-continue-to-debug-the-add-in-without-having-to-start-the-project-again"></a>Изменение кода и продолжение отладки надстройки без необходимости повторного запуска проекта


Код можно изменить и просмотреть результаты выполненных изменений в вашей надстройке, не закрывая ведущее приложение и не запуская проект снова. После изменения кода откройте контекстное меню надстройки и выберите команду **Перезагрузить**. Когда вы перезагружаете приложение, оно отключается от отладчика Visual Studio. Поэтому можно просмотреть эффект изменений, но невозможно пошагово выполнить код, пока ко всем доступным процессам Iexplore.exe не будет подключен отладчик Visual Studio.


### <a name="to-attach-the-visual-studio-debugger-to-all-of-the-available-iexploreexe-processes"></a>Подключение отладчика Visual Studio ко всем доступным процессам Iexplore.exe


1. В Visual Studio выберите команды **ОТЛАДКА**, **Присоединиться к процессу**.
    
2. В диалоговом окне **Присоединение к процессу** выберите все доступные процессы **Iexplore.exe**, а затем нажмите кнопку **Присоединиться**.
    

## <a name="next-steps"></a>Дальнейшие действия

- [Развертывание и публикация надстройки Office](../publish/publish.md)
    
