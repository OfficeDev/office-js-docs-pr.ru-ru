---
title: Создание и отладка надстроек Office в Visual Studio
description: ''
ms.date: 10/01/2018
ms.openlocfilehash: 0bbc1b167924ce4b7a1310f04b41751173312cd6
ms.sourcegitcommit: c53f05bbd4abdfe1ee2e42fdd4f82b318b363ad7
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/12/2018
ms.locfileid: "25506128"
---
# <a name="create-and-debug-office-add-ins-in-visual-studio"></a><span data-ttu-id="d9ab7-102">Создание и отладка надстроек Office в Visual Studio</span><span class="sxs-lookup"><span data-stu-id="d9ab7-102">Create and debug Office Add-ins in Visual Studio</span></span>

<span data-ttu-id="d9ab7-p101">Из этой статьи можно узнать, как создать свою первую надстройку Office с помощью Visual Studio. Действия, описанные в этой статье, относятся к версии Visual Studio 2015. Если вы используете другую версию Visual Studio, действия могут немного отличаться.</span><span class="sxs-lookup"><span data-stu-id="d9ab7-p101">This article describes how to use Visual Studio to create your first Office Add-in. The steps in this article based on Visual Studio 2015. If you're using another version of Visual Studio, the procedures might vary slightly.</span></span>

> [!NOTE]
> <span data-ttu-id="d9ab7-106">Чтобы начать работу над надстройкой OneNote, см. статью [Создание первой надстройки OneNote](../onenote/onenote-add-ins-getting-started.md).</span><span class="sxs-lookup"><span data-stu-id="d9ab7-106">To get started with an add-in for OneNote, see [Build your first OneNote add-in](../onenote/onenote-add-ins-getting-started.md).</span></span>

## <a name="create-an-office-add-in-project-in-visual-studio"></a><span data-ttu-id="d9ab7-107">Создание проекта надстройки Office в Visual Studio</span><span class="sxs-lookup"><span data-stu-id="d9ab7-107">Create an Office Add-in project in Visual Studio</span></span>


<span data-ttu-id="d9ab7-p102">Для начала убедитесь, что у вас установлены инструменты [Office Developer Tools](https://www.visualstudio.com/features/office-tools-vs.aspx) и версия Microsoft Office. Вы можете присоединиться к [программе для разработчиков Office 365](https://developer.microsoft.com/office/dev-program) или получить [последнюю версию](../develop/install-latest-office-version.md), следуя приведенным ниже инструкциям.</span><span class="sxs-lookup"><span data-stu-id="d9ab7-p102">To get started, make sure you have the [Office Developer Tools](https://www.visualstudio.com/features/office-tools-vs.aspx) installed, and a version of Microsoft Office. You can join the [Office 365 Developer Program](https://developer.microsoft.com/office/dev-program), or follow these instructions to get the [latest version](../develop/install-latest-office-version.md).</span></span>

1. <span data-ttu-id="d9ab7-110">В строке меню Visual Studio выберите **Файл** > **Создать** > **Проект**.</span><span class="sxs-lookup"><span data-stu-id="d9ab7-110">On the Visual Studio menu bar, choose  **File** > **New** > **Project**.</span></span>
2. <span data-ttu-id="d9ab7-111">В списке типов проектов в **Visual C#** или **Visual Basic** разверните узел **Office/SharePoint**, выберите **Веб-надстройки**, а затем выберите один из проектов надстроек.</span><span class="sxs-lookup"><span data-stu-id="d9ab7-111">In the list of project types under  **Visual C#** or **Visual Basic**, expand  **Office/SharePoint**, choose  **Web Add-ins**, and then select one of the Add-in projects.</span></span>
3. <span data-ttu-id="d9ab7-112">Введите имя проекта и нажмите кнопку **ОК**, чтобы создать его.</span><span class="sxs-lookup"><span data-stu-id="d9ab7-112">Name the project, and then choose  **OK** to create the project.</span></span>

<span data-ttu-id="d9ab7-113">В Visual Studio 2017 после нажатия кнопки **ОК** следующие шаблоны проекта надстройки будут иметь дополнительные параметры:</span><span class="sxs-lookup"><span data-stu-id="d9ab7-113">In Visual Studio 2017, the following add-in project templates have additional choices after you choose **OK**:</span></span>

<span data-ttu-id="d9ab7-114">**PowerPoint**</span><span class="sxs-lookup"><span data-stu-id="d9ab7-114">**PowerPoint**</span></span>
- <span data-ttu-id="d9ab7-115">Вы можете выбрать **Добавить новые функциональные возможности PowerPoint** для создания области задач надстройки.</span><span class="sxs-lookup"><span data-stu-id="d9ab7-115">You can choose to **Add new functionalities to PowerPoint** which creates a task pane add-in.</span></span>
- <span data-ttu-id="d9ab7-116">Или вы можете выбрать **Вставить содержимое в слайды PowerPoint** для создания надстройки содержимого.</span><span class="sxs-lookup"><span data-stu-id="d9ab7-116">Or you can choose to **Insert content into PowerPoint slides** which creates a content add-in.</span></span>

<span data-ttu-id="d9ab7-117">**Excel**</span><span class="sxs-lookup"><span data-stu-id="d9ab7-117">**Excel**</span></span> 
- <span data-ttu-id="d9ab7-118">Вы можете выбрать **Добавить новые функциональные возможности в Excel** для создания надстройки области задач.</span><span class="sxs-lookup"><span data-stu-id="d9ab7-118">You can choose to **Add new functionalities to Excel** which creates a task pane add-in.</span></span>
- <span data-ttu-id="d9ab7-119">Или вы можете выбрать **Вставить содержимое в электронную таблицу Excel** для создания надстройки содержимого.</span><span class="sxs-lookup"><span data-stu-id="d9ab7-119">Or you can choose to **Insert content into Excel spreadsheet** which creates a content add-in.</span></span>
    - <span data-ttu-id="d9ab7-120">При создании надстройки содержимого вы также можете выбрать вариант **Базовая надстройка**, при котором создается проект надстройки с минимальным начальным кодом.</span><span class="sxs-lookup"><span data-stu-id="d9ab7-120">If you create a content add-in, you have an additional choice of **Basic Add-in** which creates a content add-in project with minimal starter code.</span></span>
    - <span data-ttu-id="d9ab7-121">Или вы можете выбрать **надстройку визуализации документа**, которая включает начальный код для визуализации и привязки к данным.</span><span class="sxs-lookup"><span data-stu-id="d9ab7-121">Or you can choose a **Document Visualization Add-in** which includes starter code to visualize and bind to data.</span></span>

<span data-ttu-id="d9ab7-122">После завершения работы мастера Visual Studio создаст решение, содержащее два проекта.</span><span class="sxs-lookup"><span data-stu-id="d9ab7-122">When you've completed the wizard, Visual Studio creates a solution for you that contains two projects.</span></span> <span data-ttu-id="d9ab7-123">Вы увидите открытую страницу Home.html по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="d9ab7-123">You'll see the default Home.html page open.</span></span>

|<span data-ttu-id="d9ab7-124">**Проект**</span><span class="sxs-lookup"><span data-stu-id="d9ab7-124">**Project**</span></span>|<span data-ttu-id="d9ab7-125">**Описание**</span><span class="sxs-lookup"><span data-stu-id="d9ab7-125">**Description**</span></span>|
|:-----|:-----|
|<span data-ttu-id="d9ab7-126">Проект надстройки</span><span class="sxs-lookup"><span data-stu-id="d9ab7-126">Add-in project</span></span>|<span data-ttu-id="d9ab7-p104">Содержит только XML-файл манифеста, который содержит все параметры, описывающие надстройку. Эти параметры помогают ведущему приложению Office определять, когда и где должна активироваться надстройка. Visual Studio создает содержимое этого файла за вас, чтобы вы могли сразу запустить проект и начать использовать надстройку. Вы можете менять эти параметры в любой момент с помощью редактора манифеста.</span><span class="sxs-lookup"><span data-stu-id="d9ab7-p104">Contains only an XML manifest file, which contains all the settings that describe your add-in. These settings help the Office host determine when your add-in should be activated and where the add-in should appear. Visual Studio generates the contents of this file for you so that you can run the project and use your add-in immediately. You change these settings any time by using the Manifest editor.</span></span>|
|<span data-ttu-id="d9ab7-131">Проект веб-приложения</span><span class="sxs-lookup"><span data-stu-id="d9ab7-131">Web application project</span></span>|<span data-ttu-id="d9ab7-132">Содержит страницы содержимого надстройки, в том числе все файлы и ссылки на файлы, которые необходимы для разработки поддерживающих Office страниц HTML и JavaScript.</span><span class="sxs-lookup"><span data-stu-id="d9ab7-132">Contains the content pages of your add-in, including all the files and file references that you need to develop Office-aware HTML and JavaScript pages.</span></span> <span data-ttu-id="d9ab7-133">Во время разработки надстройки веб-приложение размещается на локальном сервере IIS.</span><span class="sxs-lookup"><span data-stu-id="d9ab7-133">While you develop your add-in, Visual Studio hosts the web application on your local IIS server.</span></span> <span data-ttu-id="d9ab7-134">Когда вы будете готовы к публикации, вам придется найти сервер для размещения этого проекта.</span><span class="sxs-lookup"><span data-stu-id="d9ab7-134">When you're ready to publish, you'll have to find a server to host this project.</span></span> <span data-ttu-id="d9ab7-135">Дополнительные сведения о проектах веб-приложений ASP.NET можно узнать в статье [Веб-проекты ASP.NET](http://msdn.microsoft.com/library/cdcd712f-96b0-4165-8b5d-9d0566650a28%28Office.15%29.aspx).</span><span class="sxs-lookup"><span data-stu-id="d9ab7-135">To learn more about ASP.NET web application projects, see [ASP.NET Web Projects](http://msdn.microsoft.com/library/cdcd712f-96b0-4165-8b5d-9d0566650a28%28Office.15%29.aspx).</span></span>|

## <a name="modify-your-add-in-settings"></a><span data-ttu-id="d9ab7-136">Изменение параметров надстроек</span><span class="sxs-lookup"><span data-stu-id="d9ab7-136">Modify your add-in settings</span></span>


<span data-ttu-id="d9ab7-137">Чтобы изменить параметры надстройки, отредактируйте XML-файл манифеста проекта.</span><span class="sxs-lookup"><span data-stu-id="d9ab7-137">To modify the settings of your add-in, edit the XML manifest file of the project.</span></span> <span data-ttu-id="d9ab7-138">В **обозревателе решений** разверните узел проекта надстройки, откройте папку, содержащую XML-манифест, и выберите его.</span><span class="sxs-lookup"><span data-stu-id="d9ab7-138">In  **Solution Explorer**, expand the add-in project node, expand the folder that contains the XML manifest, and choose the XML manifest.</span></span> <span data-ttu-id="d9ab7-139">Вы можете навести указатель мыши на любой элемент в файле, чтобы увидеть подсказку с описанием назначения этого элемента.</span><span class="sxs-lookup"><span data-stu-id="d9ab7-139">You can point to any element in the file to view a tooltip that describes the purpose of the element.</span></span> <span data-ttu-id="d9ab7-140">Дополнительные сведения о файле манифеста см. в статье [XML-манифест надстроек Office](../develop/add-in-manifests.md).</span><span class="sxs-lookup"><span data-stu-id="d9ab7-140">For more information about the manfiest file, see [Office Add-ins XML manifest](../develop/add-in-manifests.md).</span></span>


## <a name="develop-the-contents-of-your-add-in"></a><span data-ttu-id="d9ab7-141">Разработка содержимого надстройки</span><span class="sxs-lookup"><span data-stu-id="d9ab7-141">Develop the contents of your add-in</span></span>

<span data-ttu-id="d9ab7-142">Проект надстройки позволяет изменить ее параметры, а веб-приложение предоставляет содержимое, которое отображается в надстройке.</span><span class="sxs-lookup"><span data-stu-id="d9ab7-142">While the add-in project lets you modify the settings that describe your add-in, the web application provides the content that appears in the add-in.</span></span> 

<span data-ttu-id="d9ab7-143">Проект веб-приложения содержит HTML-страницу по умолчанию и файл JavaScript, которые можно использовать для начала работы.</span><span class="sxs-lookup"><span data-stu-id="d9ab7-143">The web application project contains a default HTML page and javascriptshort file that you can use to get started. These files are convenient because they contain all the file references that you need to get started quickly.</span></span> <span data-ttu-id="d9ab7-144">Эти файлы содержат ссылки на другие библиотеки JavaScript, включая API JavaScript для Office.</span><span class="sxs-lookup"><span data-stu-id="d9ab7-144">These files contain references to other JavaScript libraries including the JavaScript API for Office.</span></span> <span data-ttu-id="d9ab7-145">Вы можете создавать надстройки путем обновления этих файлов и добавления дополнительных файлов HTML и JavaScript.</span><span class="sxs-lookup"><span data-stu-id="d9ab7-145">You can develop your add-in by updating these files, and adding more HTML and JavaScript files.</span></span> <span data-ttu-id="d9ab7-146">В следующей таблице описываются файлы JavaScript и HTML-страницы по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="d9ab7-146">The following table describes the default HTML and JavaScript files.</span></span>

> [!NOTE]
> <span data-ttu-id="d9ab7-147">Файлы в приведенной ниже таблице могут находиться в корневой папке веб-проекта или в папке **Home** в зависимости от типа использованного шаблона проекта.</span><span class="sxs-lookup"><span data-stu-id="d9ab7-147">The files in the table below may be in the root folder of the web project, or the **Home** folder depending on the type of project template you used.</span></span>

|<span data-ttu-id="d9ab7-148">**Файл**</span><span class="sxs-lookup"><span data-stu-id="d9ab7-148">**File**</span></span>|<span data-ttu-id="d9ab7-149">**Описание**</span><span class="sxs-lookup"><span data-stu-id="d9ab7-149">**Description**</span></span>|
|:-----|:-----|
|<span data-ttu-id="d9ab7-150">**Home.html**</span><span class="sxs-lookup"><span data-stu-id="d9ab7-150">**Home.html**</span></span>|<span data-ttu-id="d9ab7-151">HTML-страница надстройки по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="d9ab7-151">The default HTML page of the add-in.</span></span> <span data-ttu-id="d9ab7-152">Эта страница отображается первой в надстройке при ее активации в документе, сообщении электронной почты или элементе встречи.</span><span class="sxs-lookup"><span data-stu-id="d9ab7-152">This page appears as the first page inside of the add-in when it is activated in a document, email message, or appointment item.</span></span> <span data-ttu-id="d9ab7-153">Этот файл содержит все ссылки на файлы, необходимые для начала работы.</span><span class="sxs-lookup"><span data-stu-id="d9ab7-153">This file contains all of the file references that you need to get started.</span></span> <span data-ttu-id="d9ab7-154">Вы можете начать разработку надстройки, добавив HTML-код в этот файл.</span><span class="sxs-lookup"><span data-stu-id="d9ab7-154">You can start developing your add-in by adding your HTML code to this file.</span></span>|
|<span data-ttu-id="d9ab7-155">**Home.js**</span><span class="sxs-lookup"><span data-stu-id="d9ab7-155">**Home.js**</span></span>|<span data-ttu-id="d9ab7-156">Файл JavaScript, связанный со страницей Home.html.</span><span class="sxs-lookup"><span data-stu-id="d9ab7-156">The JavaScript file associated with the Home.html page.</span></span> <span data-ttu-id="d9ab7-157">Вы также можете поместить в файл Home.js любой код, который относится к поведению страницы Home.html.</span><span class="sxs-lookup"><span data-stu-id="d9ab7-157">You can place any code that is specific to the behavior of the Home.html page in the Home.js file.</span></span> <span data-ttu-id="d9ab7-158">Файл Home.js содержит некоторые примеры кода для начала работы.</span><span class="sxs-lookup"><span data-stu-id="d9ab7-158">The Home.js file contains some example code to get you started.</span></span>|
|<span data-ttu-id="d9ab7-159">**Home.css**</span><span class="sxs-lookup"><span data-stu-id="d9ab7-159">**Home.css**</span></span>|<span data-ttu-id="d9ab7-160">Определение стилей по умолчанию для применения к надстройке.</span><span class="sxs-lookup"><span data-stu-id="d9ab7-160">Defines the default styles to apply to your add-in.</span></span> <span data-ttu-id="d9ab7-161">Рекомендуется использовать Office UI Fabric для разработки дизайна и стилей.</span><span class="sxs-lookup"><span data-stu-id="d9ab7-161">We recommend using the Office UI Fabric for design and styles.</span></span> <span data-ttu-id="d9ab7-162">Для получения дополнительных сведений см. статью [Office UI Fabric в надстройке Office](../design/office-ui-fabric.md).</span><span class="sxs-lookup"><span data-stu-id="d9ab7-162">For information about Office UI Fabric JS, see [Use Office UI Fabric in Office Add-ins](../design/office-ui-fabric.md).</span></span>|

> [!NOTE]
> <span data-ttu-id="d9ab7-163">Вам не обязательно использовать эти файлы.</span><span class="sxs-lookup"><span data-stu-id="d9ab7-163">You don't have to use these files.</span></span> <span data-ttu-id="d9ab7-164">Вы можете добавить другие файлы в проект и вместо этого использовать их.</span><span class="sxs-lookup"><span data-stu-id="d9ab7-164">Feel free to add other files to the project and use those instead.</span></span> <span data-ttu-id="d9ab7-165">Если вы хотите, чтобы в качестве начальной страницы надстройки отображался другой HTML-файл, откройте редактор манифеста и задайте свойству **SourceLocation** имя файла.</span><span class="sxs-lookup"><span data-stu-id="d9ab7-165">You don't have to use these files. Feel free to add other files to the project and use those instead. If you want another HTML file to appear as the initial page of the add-in, open the manifest editor, and then point the  **SourceLocation** property to the name of the file.</span></span>

## <a name="debug-your-add-in"></a><span data-ttu-id="d9ab7-166">Отладка надстройки</span><span class="sxs-lookup"><span data-stu-id="d9ab7-166">Debug your add-in</span></span>

<span data-ttu-id="d9ab7-167">Visual Studio предоставляет свойства построения и отладки для помощи с отладкой надстройки.</span><span class="sxs-lookup"><span data-stu-id="d9ab7-167">Visual Studio provides build and debug properties to assist with debugging your add-in.</span></span>

### <a name="review-the-build-and-debug-properties"></a><span data-ttu-id="d9ab7-168">Просмотр свойств, связанных с построением и отладкой</span><span class="sxs-lookup"><span data-stu-id="d9ab7-168">Review the build and debug properties</span></span>

<span data-ttu-id="d9ab7-p112">Перед запуском решения убедитесь, что Visual Studio откроет нужное ведущее приложение. Эти сведения отображаются на страницах свойств проекта вместе с несколькими другими свойствами, относящимися к построению и отладке надстройки.</span><span class="sxs-lookup"><span data-stu-id="d9ab7-p112">Before you start the solution, verify that Visual Studio will open the host application that you want. That information appears in the property pages of the project along with several other properties that relate to building and debugging the add-in.</span></span>

### <a name="to-open-the-property-pages-of-a-project"></a><span data-ttu-id="d9ab7-171">Открытие страниц свойств проекта</span><span class="sxs-lookup"><span data-stu-id="d9ab7-171">To open the property pages of a project</span></span>

1. <span data-ttu-id="d9ab7-172">В **обозревателе решений** выберите основной проект надстройки (не веб-проект).</span><span class="sxs-lookup"><span data-stu-id="d9ab7-172">In  **Solution Explorer**, choose the basic add-in project (not the Web project).</span></span>    
2. <span data-ttu-id="d9ab7-173">В строке меню выберите **Вид** >  **Окно свойств**.</span><span class="sxs-lookup"><span data-stu-id="d9ab7-173">On the menu bar, choose  View,  Properties Window.</span></span>
    
<span data-ttu-id="d9ab7-174">В следующей таблице описываются свойства проекта.</span><span class="sxs-lookup"><span data-stu-id="d9ab7-174">The following table describes the properties of the project.</span></span>



|<span data-ttu-id="d9ab7-175">**Свойство**</span><span class="sxs-lookup"><span data-stu-id="d9ab7-175">**Property**</span></span>|<span data-ttu-id="d9ab7-176">**Описание**</span><span class="sxs-lookup"><span data-stu-id="d9ab7-176">**Description**</span></span>|
|:-----|:-----|
|<span data-ttu-id="d9ab7-177">**Действие при запуске**</span><span class="sxs-lookup"><span data-stu-id="d9ab7-177">**Start Action**</span></span>|<span data-ttu-id="d9ab7-178">Указывает, где производить отладку надстройки — в классическом приложении Office или в клиенте Office Online в заданном браузере.</span><span class="sxs-lookup"><span data-stu-id="d9ab7-178">Specifies whether to debug your add-in in an Office desktop client or in an Office Online client in the specified browser.</span></span>|
|<span data-ttu-id="d9ab7-179">**Документ при запуске** (только надстройки содержимого и надстройки области задач)</span><span class="sxs-lookup"><span data-stu-id="d9ab7-179">**Start Document** (Content and task pane add-ins only)</span></span>|<span data-ttu-id="d9ab7-180">Указывает, какой документ следует открыть при запуске проекта.</span><span class="sxs-lookup"><span data-stu-id="d9ab7-180">Specifies what document to open when you start the project.</span></span>|
|<span data-ttu-id="d9ab7-181">**Веб-проект**</span><span class="sxs-lookup"><span data-stu-id="d9ab7-181">**Web Project**</span></span>|<span data-ttu-id="d9ab7-182">Указывает имя веб-проекта, связанного с надстройкой.</span><span class="sxs-lookup"><span data-stu-id="d9ab7-182">Specifies the name of the web project associated with the add-in.</span></span>|
|<span data-ttu-id="d9ab7-183">**Адрес электронной почты** (только надстройки Outlook)</span><span class="sxs-lookup"><span data-stu-id="d9ab7-183">**Email Address** (Outlook add-ins only)</span></span>|<span data-ttu-id="d9ab7-184">Указывает адрес электронной почты учетной записи пользователя на сервере Exchange Server или Exchange Online, с которой вы хотите протестировать надстройку Outlook.</span><span class="sxs-lookup"><span data-stu-id="d9ab7-184">Specifies the email address of the user account in Exchange Server or Exchange Online that you want to test your Outlook add-in with.</span></span>|
|<span data-ttu-id="d9ab7-185">**URL-адрес EWS** (только надстройки Outlook)</span><span class="sxs-lookup"><span data-stu-id="d9ab7-185">**EWS Url** (Outlook add-ins only)</span></span>|<span data-ttu-id="d9ab7-186">URL веб-службы Exchange (например, https://www.contoso.com/ews/exchange.aspx).</span><span class="sxs-lookup"><span data-stu-id="d9ab7-186">Exchange Web service URL (For example: https://www.contoso.com/ews/exchange.aspx).</span></span> |
|<span data-ttu-id="d9ab7-187">**URL-адрес OWA** (только надстройки Outlook)</span><span class="sxs-lookup"><span data-stu-id="d9ab7-187">**OWA Url** (Outlook add-ins only)</span></span>|<span data-ttu-id="d9ab7-188">URL-адрес Outlook Web App (например, https://www.contoso.com/owa).</span><span class="sxs-lookup"><span data-stu-id="d9ab7-188">Outlook Web App URL (For example: https://www.contoso.com/owa).</span></span>|
|<span data-ttu-id="d9ab7-189">**Имя пользователя** (только надстройки Outlook)</span><span class="sxs-lookup"><span data-stu-id="d9ab7-189">**User name** (Outlook add-ins only)</span></span>|<span data-ttu-id="d9ab7-190">Указывает имя вашей учетной записи пользователя в Exchange Server или Exchange Online.</span><span class="sxs-lookup"><span data-stu-id="d9ab7-190">Specifies the name of your user account in Exchange Server or Exchange Online.</span></span>|
|<span data-ttu-id="d9ab7-191">**Файл проекта**</span><span class="sxs-lookup"><span data-stu-id="d9ab7-191">**Project File**</span></span>|<span data-ttu-id="d9ab7-192">Задает имя файла, в котором указаны сборка, конфигурация и другие сведения о проекте.</span><span class="sxs-lookup"><span data-stu-id="d9ab7-192">Specifies the name of the file containing build, configuration, and other information about the project.</span></span>|
|<span data-ttu-id="d9ab7-193">**Папка проекта**</span><span class="sxs-lookup"><span data-stu-id="d9ab7-193">**Project Folder**</span></span>|<span data-ttu-id="d9ab7-194">Расположение файла проекта.</span><span class="sxs-lookup"><span data-stu-id="d9ab7-194">The location of the project file.</span></span>|

### <a name="use-an-existing-document-to-debug-the-add-in-content-and-task-pane-add-ins-only"></a><span data-ttu-id="d9ab7-195">Использование существующего документа для отладки надстройки (только для контентных надстроек и надстроек области задач)</span><span class="sxs-lookup"><span data-stu-id="d9ab7-195">Use an existing document to debug the add-in (content and task pane add-ins only)</span></span>

<span data-ttu-id="d9ab7-p113">В проект надстройки можно добавить документы. Если ваш документ содержит тестовые данные, которые необходимо использовать в надстройке, Visual Studio откроет документ при запуске проекта.</span><span class="sxs-lookup"><span data-stu-id="d9ab7-p113">You can add documents to the add-in project. If you have a document that contains test data that you want to use with your add-in, Visual Studio opens that document for you when you start the project.</span></span>

### <a name="to-use-an-existing-document-to-debug-the-add-in"></a><span data-ttu-id="d9ab7-198">Чтобы использовать существующий документ для отладки надстройки, выполните следующие действия:</span><span class="sxs-lookup"><span data-stu-id="d9ab7-198">To use an existing document to debug the add-in</span></span>

1. <span data-ttu-id="d9ab7-199">В **обозревателе решений** выберите папку проекта надстройки.</span><span class="sxs-lookup"><span data-stu-id="d9ab7-199">In  **Solution Explorer**, choose the add-in project folder.</span></span>
    
    > [!NOTE]
    > <span data-ttu-id="d9ab7-200">Выберите проект надстройки, а не проект веб-приложения.</span><span class="sxs-lookup"><span data-stu-id="d9ab7-200">Choose the add-in project and not the web application project.</span></span>

2. <span data-ttu-id="d9ab7-201">В меню **Проект** выберите пункт **Добавить существующий элемент**.</span><span class="sxs-lookup"><span data-stu-id="d9ab7-201">On the  **Project** menu, choose **Add Existing Item**.</span></span>
    
3. <span data-ttu-id="d9ab7-202">В диалоговом окне **Добавление существующего элемента** найдите и выберите документ, который необходимо добавить.</span><span class="sxs-lookup"><span data-stu-id="d9ab7-202">In the  **Add Existing Item** dialog box, locate and select the document that you want to add.</span></span>
    
4. <span data-ttu-id="d9ab7-203">Нажмите кнопку **Добавить**, чтобы добавить документ в проект.</span><span class="sxs-lookup"><span data-stu-id="d9ab7-203">Choose the  **Add** button to add the document to your project.</span></span>
    
5. <span data-ttu-id="d9ab7-204">В **обозревателе решений** выберите папку проекта надстройки.</span><span class="sxs-lookup"><span data-stu-id="d9ab7-204">In  **Solution Explorer**, choose the add-in project folder.</span></span>
6. <span data-ttu-id="d9ab7-205">В строке меню выберите **Вид** > **Окно свойств**.</span><span class="sxs-lookup"><span data-stu-id="d9ab7-205">On the menu bar, choose  View,  Properties Window.</span></span>
7. <span data-ttu-id="d9ab7-206">В Окне свойств выберите список **Документ при запуске**, а затем документ, который добавлен в проект.</span><span class="sxs-lookup"><span data-stu-id="d9ab7-206">In the  **Start Document** list, choose the document that you added to the project, and then choose the OK button to close the property pages.</span></span> <span data-ttu-id="d9ab7-207">Теперь проект настроен на запуск надстройки в существующем документе.</span><span class="sxs-lookup"><span data-stu-id="d9ab7-207">Now the project is configured to start your add-in in your existing document.</span></span>

### <a name="start-the-solution"></a><span data-ttu-id="d9ab7-208">Запуск решения</span><span class="sxs-lookup"><span data-stu-id="d9ab7-208">Start the solution</span></span>

<span data-ttu-id="d9ab7-209">Запустите решение в строке меню, выбрав **Отладка** > **Начать отладку**.</span><span class="sxs-lookup"><span data-stu-id="d9ab7-209">Start the solution from the menu bar by choosing **Debug** > **Start Debugging**.</span></span> <span data-ttu-id="d9ab7-210">Visual Studio автоматически построит решение и запустит Office для размещения надстройки.</span><span class="sxs-lookup"><span data-stu-id="d9ab7-210">Visual Studio will automatically build the solution and start Office to host your add-in.</span></span>

<span data-ttu-id="d9ab7-211">После построения проекта Visual Studio выполняет следующие действия.</span><span class="sxs-lookup"><span data-stu-id="d9ab7-211">Visual Studio builds the project and performs the following actions.</span></span>

1. <span data-ttu-id="d9ab7-p116">Создает копию XML-файла манифеста и добавляет его в каталог _ProjectName_\Output. Ведущее приложение использует эту копию при запуске Visual Studio и отладке надстройки.</span><span class="sxs-lookup"><span data-stu-id="d9ab7-p116">Creates a copy of the XML manifest file and adds it to  _ProjectName_\Output directory. The host application consumes this copy when you start Visual Studio and debug the add-in.</span></span>
    
2. <span data-ttu-id="d9ab7-214">Создает набор записей реестра на компьютере, которые служат для включения отображения надстройки в ведущем приложении.</span><span class="sxs-lookup"><span data-stu-id="d9ab7-214">Creates a set of registry entries on your computer that enable the add-in to appear in the host application.</span></span>
    
3. <span data-ttu-id="d9ab7-215">Создает проект веб-приложения, а затем развертывает его на локальном веб-сервере IIS (http://localhost)).</span><span class="sxs-lookup"><span data-stu-id="d9ab7-215">Builds the web application project, and then deploys it to the local IIS web server (http://localhost).</span></span> 
    
<span data-ttu-id="d9ab7-216">Затем Visual Studio делает следующее:</span><span class="sxs-lookup"><span data-stu-id="d9ab7-216">Next, Visual Studio does the following:</span></span>

1. <span data-ttu-id="d9ab7-217">Изменяет элемент [SourceLocation](https://docs.microsoft.com/office/dev/add-ins/reference/manifest/sourcelocation?view=office-js) файла манифеста XML, заменяя маркер ~remoteAppUrl полным адресом начальной страницы (например, http://localhost/MyAgave.html)).</span><span class="sxs-lookup"><span data-stu-id="d9ab7-217">Modifies the SourceLocation element of the XML manifest file by replacing the ~remoteAppUrl token with the fully qualified address of the start page (for example, http://localhost/MyAgave.html).</span></span>
    
2. <span data-ttu-id="d9ab7-218">Запускает проект веб-приложения в IIS Express.</span><span class="sxs-lookup"><span data-stu-id="d9ab7-218">Starts the web application project in IIS Express.</span></span>
    
3. <span data-ttu-id="d9ab7-219">Открывает ведущее приложение.</span><span class="sxs-lookup"><span data-stu-id="d9ab7-219">Opens the host application.</span></span> 
    
<span data-ttu-id="d9ab7-p117">Visual Studio не отображает ошибки проверки в окне **OUTPUT (ВЫВОД)** при построении проекта. Visual Studio сообщает об ошибках и предупреждениях в окне **ERRORLIST (СПИСОК ОШИБОК)** по мере их возникновения. Кроме того, Visual Studio также выделяет ошибки волнистой линией разных цветов прямо в коде и текстовом редакторе. Эти пометки уведомляют о проблемах, обнаруженных Visual Studio в коде. Дополнительные сведения можно узнать в разделе [Код и текстовый редактор](https://msdn.microsoft.com/library/se2f663y(v=vs.140).aspx). Дополнительные сведения о включении или отключении проверки изложены в следующих статьях:</span><span class="sxs-lookup"><span data-stu-id="d9ab7-p117">Visual Studio doesn't show validation errors in the  **OUTPUT** window when you build the project. Visual Studio reports errors and warnings in the **ERRORLIST** window as they occur. Visual Studio also reports validation errors by showing wavy underlines (known as squiggles) of different colors in the code and text editor. These marks notify you of problems that Visual Studio detected in your code. For more information, see [Code and Text Editor](https://msdn.microsoft.com/library/se2f663y(v=vs.140).aspx). For more information about how to enable or disable validation, see:</span></span> 

- [<span data-ttu-id="d9ab7-226">Параметры, Текстовый редактор, JavaScript, IntelliSense</span><span class="sxs-lookup"><span data-stu-id="d9ab7-226">Options, Text Editor, JavaScript, IntelliSense</span></span>](https://docs.microsoft.com/visualstudio/ide/reference/options-text-editor-javascript-intellisense?view=vs-2015)
    
- <span data-ttu-id="d9ab7-227">[Практическое руководство. Установка параметров проверки редактирования HTML в Visual Web Developer](https://msdn.microsoft.com/library/0byxkfet(v=vs.100).aspx)</span><span class="sxs-lookup"><span data-stu-id="d9ab7-227">[How to: Set Validation Options for HTML Editing in Visual Web Developer](https://msdn.microsoft.com/library/0byxkfet(v=vs.100).aspx)</span></span>
    
- <span data-ttu-id="d9ab7-228">[CSS, см. Проверка, CSS, Текстовый редактор, Диалоговое окно "Параметры"](https://msdn.microsoft.com/library/se2f663y(v=vs.140).aspx)</span><span class="sxs-lookup"><span data-stu-id="d9ab7-228">[CSS, see Validation, CSS, Text Editor, Options Dialog Box](https://msdn.microsoft.com/library/se2f663y(v=vs.140).aspx)</span></span>
    
<span data-ttu-id="d9ab7-229">Чтобы просмотреть правила проверки XML-файла манифеста проекта, ознакомьтесь с разделом [XML-манифест надстроек для Office](../develop/add-in-manifests.md).</span><span class="sxs-lookup"><span data-stu-id="d9ab7-229">To review the validation rules of the XML manifest file in your project, see [Office Add-ins XML manifest](../develop/add-in-manifests.md).</span></span>

### <a name="show-an-add-in-in-excel-or-word-and-step-through-your-code"></a><span data-ttu-id="d9ab7-230">Отображение надстройки в Excel, Word или Project и пошаговое выполнение кода</span><span class="sxs-lookup"><span data-stu-id="d9ab7-230">Show an add-in in Excel, Word, or Project and step through your code</span></span>

<span data-ttu-id="d9ab7-231">Если задать свойству проекта надстройки **Документ при запуске** значение Excel или Word, Visual Studio создает новый документ и отображается надстройка.</span><span class="sxs-lookup"><span data-stu-id="d9ab7-231">If you set the  **Start Document** property of the add-in project to Excel or Word, Visual Studio creates a new document and the add-in appears.</span></span> <span data-ttu-id="d9ab7-232">Если задать свойству проекта надстройки **Документ при запуске** использование существующего документа, Visual Studio открывает документ, но надстройку нужно вставить вручную.</span><span class="sxs-lookup"><span data-stu-id="d9ab7-232">If you set the **Start Document** property of the add-in project to use an existing document, Visual Studio opens the document, but you have to insert the add-in manually.</span></span>

1. <span data-ttu-id="d9ab7-233">В Excel или Word на вкладке **Вставка** выберите раскрывающийся список **Мои надстройки**.</span><span class="sxs-lookup"><span data-stu-id="d9ab7-233">In Excel or Word, on the  **Insert** tab, choose the **My Add-ins** drop down list.</span></span> <span data-ttu-id="d9ab7-234">Выберите список, раскрывающийся на стрелке, но не саму кнопку, которая открывает диалоговое окно **Надстройки Office**.</span><span class="sxs-lookup"><span data-stu-id="d9ab7-234">Choose the list from the drop-down arrow, not the button itself which opens the **Office Add-ins** dialog.</span></span>
2. <span data-ttu-id="d9ab7-235">В списке **Надстройки разработчика** выберите свою надстройку.</span><span class="sxs-lookup"><span data-stu-id="d9ab7-235">Under **Developer Add-ins**, choose your add-in.</span></span>

<span data-ttu-id="d9ab7-236">В Visual Studio можно создавать точки останова, взаимодействовать с надстройками и пошагово выполнять код в файлах HTML или JavaScript.</span><span class="sxs-lookup"><span data-stu-id="d9ab7-236">In Visual Studio, you can then set break-points. Then, as you interact with your add-in and step through the code in your HTML, JavaScript, and C# or VB code files.</span></span>

### <a name="show-the-outlook-add-in-in-outlook-and-step-through-your-code"></a><span data-ttu-id="d9ab7-237">Отображение надстройки Outlook в Outlook и пошаговое выполнение кода</span><span class="sxs-lookup"><span data-stu-id="d9ab7-237">Show the Outlook add-in in Outlook and step through your code</span></span>

<span data-ttu-id="d9ab7-238">Чтобы просмотреть надстройку Outlook, откройте сообщение электронной почты или элемент встречи.</span><span class="sxs-lookup"><span data-stu-id="d9ab7-238">To view the add-in in Outlook, open an email message or appointment item.</span></span>

<span data-ttu-id="d9ab7-p120">Outlook активирует надстройку для этого элемента, если соблюдаются критерии активации. В верхней части окна инспектора или области чтения появляется строка надстройки, и надстройка Outlook отображается в строке надстройки в виде кнопки. Если в вашей надстройке есть команда, на ленте появится кнопка (либо на вкладке по умолчанию, либо на указанной настраиваемой вкладке), а надстройка не будет отображаться в строке надстройки.</span><span class="sxs-lookup"><span data-stu-id="d9ab7-p120">Outlook activates the add-in for the item as long as the activation criteria are met. The add-in bar appears at the top of the Inspector window or Reading Pane, and your Outlook add-in appears as a button in the add-in bar. If your add-in has an add-in command, a button will appear in the ribbon, either in the default tab or a specified custom tab, and the add-in will not appear in the add-in bar.</span></span>

<span data-ttu-id="d9ab7-242">Чтобы просмотреть надстройку Outlook, нажмите кнопку своей надстройки Outlook.</span><span class="sxs-lookup"><span data-stu-id="d9ab7-242">To view your Outlook add-in, choose the button for your Outlook add-in.</span></span>

<span data-ttu-id="d9ab7-243">В Visual Studio можно создавать точки останова, взаимодействовать с надстройками и пошагово выполнять код в файлах HTML или JavaScript.</span><span class="sxs-lookup"><span data-stu-id="d9ab7-243">In Visual Studio, you can then set break-points. Then, as you interact with your add-in and step through the code in your HTML, JavaScript, and C# or VB code files.</span></span>

<span data-ttu-id="d9ab7-p121">Можно также изменить код и просмотреть результаты этих изменений в надстройке Outlook без необходимости закрывать надстройку Office и перезагрузить проект. В Outlook следует просто открыть контекстное меню для надстройки Outlook и нажать кнопку **Обновить**.</span><span class="sxs-lookup"><span data-stu-id="d9ab7-p121">You can also change your code and review the effects of those changes in your Outlook add-in without having to close the Office Add-in and start the project again. In Outlook, just open the shortcut menu for the Outlook add-in, and then choose  **Reload**.</span></span>


### <a name="modify-code-and-continue-to-debug-the-add-in-without-having-to-start-the-project-again"></a><span data-ttu-id="d9ab7-246">Изменение кода и продолжение отладки надстройки без необходимости перезагрузки проекта</span><span class="sxs-lookup"><span data-stu-id="d9ab7-246">Modify code and continue to debug the add-in without having to start the project again</span></span>

<span data-ttu-id="d9ab7-247">Вы можете изменить код и просмотреть эффект этих изменений в надстройке без необходимости закрывать ведущее приложение и перезагружать проект.</span><span class="sxs-lookup"><span data-stu-id="d9ab7-247">You can also change your code and review the effects of those changes in your Outlook add-in without having to close the Office Add-in and start the project again. In Outlook, just open the shortcut menu for the Outlook add-in, and then choose  Reload.</span></span> <span data-ttu-id="d9ab7-248">После изменения и сохранения кода, откройте контекстное меню для надстройки и выберите пункт **Обновить**.</span><span class="sxs-lookup"><span data-stu-id="d9ab7-248">After you change and save your code, open the shortcut menu for the add-in, and then choose **Reload**.</span></span>
    

## <a name="next-steps"></a><span data-ttu-id="d9ab7-249">Дальнейшие действия</span><span class="sxs-lookup"><span data-stu-id="d9ab7-249">Next steps</span></span>

- [<span data-ttu-id="d9ab7-250">Развертывание и публикация надстройки Office</span><span class="sxs-lookup"><span data-stu-id="d9ab7-250">Deploy and publish your Office Add-in</span></span>](../publish/publish.md)
    
