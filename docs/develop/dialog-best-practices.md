---
title: Рекомендации и правила Office dialog API
description: Предоставляет правила и лучшие практики для API Office диалогов, такие как лучшие практики для одно-страничного приложения (SPA)
ms.date: 02/09/2021
localization_priority: Normal
ms.openlocfilehash: 99129636cf722f98cef36c272f2e00e8a9321ccf
ms.sourcegitcommit: 883f71d395b19ccfc6874a0d5942a7016eb49e2c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/09/2021
ms.locfileid: "53349912"
---
# <a name="best-practices-and-rules-for-the-office-dialog-api"></a><span data-ttu-id="25dfd-103">Рекомендации и правила Office dialog API</span><span class="sxs-lookup"><span data-stu-id="25dfd-103">Best practices and rules for the Office dialog API</span></span>

<span data-ttu-id="25dfd-104">В этой статье данная статья содержит правила, приемы и лучшие практики для API диалогового Office, включая лучшие практики для разработки пользовательского интерфейса диалогов и использования API в одно-странице приложения (SPA)</span><span class="sxs-lookup"><span data-stu-id="25dfd-104">This article provides rules, gotchas, and best practices for the Office dialog API, including best practices for designing the UI of a dialog and using the API with in a single-page application (SPA)</span></span>

> [!NOTE]
> <span data-ttu-id="25dfd-105">В этой статье предполагается, что вы знакомы с основами использования API диалогового Office, как описано в Статье [Использование API](dialog-api-in-office-add-ins.md)диалогов Office в Office надстройки .</span><span class="sxs-lookup"><span data-stu-id="25dfd-105">This article presupposes that you are familiar with the basics of using the Office dialog API as described in [Use the Office dialog API in your Office Add-ins](dialog-api-in-office-add-ins.md).</span></span>
> 
> <span data-ttu-id="25dfd-106">См. также обработку ошибок и событий [Office диалоговом окне](dialog-handle-errors-events.md).</span><span class="sxs-lookup"><span data-stu-id="25dfd-106">See also [Handling errors and events with the Office dialog box](dialog-handle-errors-events.md).</span></span>

## <a name="rules-and-gotchas"></a><span data-ttu-id="25dfd-107">Правила и подсказки</span><span class="sxs-lookup"><span data-stu-id="25dfd-107">Rules and gotchas</span></span>

- <span data-ttu-id="25dfd-108">Диалоговое окно может перемещаться только по URL-адресам HTTPS, а не по HTTP.</span><span class="sxs-lookup"><span data-stu-id="25dfd-108">The dialog box can only navigate to HTTPS URLs, not HTTP.</span></span>
- <span data-ttu-id="25dfd-109">URL-адрес, переданный [методу displayDialogAsync,](/javascript/api/office/office.ui) должен быть в том же домене, что и сама надстройка.</span><span class="sxs-lookup"><span data-stu-id="25dfd-109">The URL passed to the [displayDialogAsync](/javascript/api/office/office.ui) method must be in the exact same domain as the add-in itself.</span></span> <span data-ttu-id="25dfd-110">Это не может быть поддомен.</span><span class="sxs-lookup"><span data-stu-id="25dfd-110">It cannot be a subdomain.</span></span> <span data-ttu-id="25dfd-111">Но страница, которая передается ему, может перенаправляться на страницу в другом домене.</span><span class="sxs-lookup"><span data-stu-id="25dfd-111">But the page that is passed to it can redirect to a page in another domain.</span></span>
- <span data-ttu-id="25dfd-112">В окне хост, которое может быть области [](../reference/manifest/functionfile.md) задач или файл функций без пользовательского интерфейса команды надстройки, может одновременно открываться только одно диалоговое окно.</span><span class="sxs-lookup"><span data-stu-id="25dfd-112">A host window, which can be a task pane or the UI-less [function file](../reference/manifest/functionfile.md) of an add-in command, can have only one dialog box open at a time.</span></span>
- <span data-ttu-id="25dfd-113">В диалоговом окне Office только два API:</span><span class="sxs-lookup"><span data-stu-id="25dfd-113">Only two Office APIs can be called in the dialog box:</span></span>
  - <span data-ttu-id="25dfd-114">Функция [messageParent.](/javascript/api/office/office.ui#messageparent-message-)</span><span class="sxs-lookup"><span data-stu-id="25dfd-114">The [messageParent](/javascript/api/office/office.ui#messageparent-message-) function.</span></span>
  - <span data-ttu-id="25dfd-115">`Office.context.requirements.isSetSupported`(Дополнительные сведения см. в [Office приложениях и требованиях API.)](specify-office-hosts-and-api-requirements.md)</span><span class="sxs-lookup"><span data-stu-id="25dfd-115">`Office.context.requirements.isSetSupported` (For more information, see [Specify Office applications and API requirements](specify-office-hosts-and-api-requirements.md).)</span></span>
- <span data-ttu-id="25dfd-116">Функция [messageParent](/javascript/api/office/office.ui#messageparent-message-) может быть вызвана только со страницы в том же домене, что и сама надстройка.</span><span class="sxs-lookup"><span data-stu-id="25dfd-116">The [messageParent](/javascript/api/office/office.ui#messageparent-message-) function can only be called from a page in the exact same domain as the add-in itself.</span></span>

## <a name="best-practices"></a><span data-ttu-id="25dfd-117">Рекомендации</span><span class="sxs-lookup"><span data-stu-id="25dfd-117">Best practices</span></span>

### <a name="avoid-overusing-dialog-boxes"></a><span data-ttu-id="25dfd-118">Избегайте чрезмерного окантовки диалогов</span><span class="sxs-lookup"><span data-stu-id="25dfd-118">Avoid overusing dialog boxes</span></span>

<span data-ttu-id="25dfd-119">Поскольку перекрывающиеся элементы пользовательского интерфейса не приветствуются, избегайте открытия диалогового окна на панели задач, если это не требуется в сценарий.</span><span class="sxs-lookup"><span data-stu-id="25dfd-119">Because overlapping UI elements are discouraged, avoid opening a dialog box from a task pane unless your scenario requires it.</span></span> <span data-ttu-id="25dfd-120">При планировании контактной зоны помните, что в области задач можно использовать вкладки.</span><span class="sxs-lookup"><span data-stu-id="25dfd-120">When you consider how to use the surface area of a task pane, note that task panes can be tabbed.</span></span> <span data-ttu-id="25dfd-121">Пример области задач на вкладке см. в примере Excel Надстройки [JavaScript SalesTracker.](https://github.com/OfficeDev/Excel-Add-in-JavaScript-SalesTracker)</span><span class="sxs-lookup"><span data-stu-id="25dfd-121">For an example of a tabbed task pane, see the [Excel Add-in JavaScript SalesTracker](https://github.com/OfficeDev/Excel-Add-in-JavaScript-SalesTracker) sample.</span></span>

### <a name="designing-a-dialog-box-ui"></a><span data-ttu-id="25dfd-122">Проектирование пользовательского интерфейса диалоговых полей</span><span class="sxs-lookup"><span data-stu-id="25dfd-122">Designing a dialog box UI</span></span>

<span data-ttu-id="25dfd-123">Лучшие практики в диалоговом окне см. в Office [надстройки.](../design/dialog-boxes.md)</span><span class="sxs-lookup"><span data-stu-id="25dfd-123">For best practices in dialog box design, see [Dialog boxes in Office Add-ins](../design/dialog-boxes.md).</span></span>

### <a name="handling-pop-up-blockers-with-office-on-the-web"></a><span data-ttu-id="25dfd-124">Обработка блокировщиков всплывающих окон с помощью Office в Интернете</span><span class="sxs-lookup"><span data-stu-id="25dfd-124">Handling pop-up blockers with Office on the web</span></span>

<span data-ttu-id="25dfd-125">Попытка отобразить диалоговое окно при Office в Интернете может привести к блокировке блокатора всплывающих окна браузера.</span><span class="sxs-lookup"><span data-stu-id="25dfd-125">Attempting to display a dialog box while using Office on the web may cause the browser's pop-up blocker to block the dialog box.</span></span> <span data-ttu-id="25dfd-126">Office в Интернете имеет функцию, которая позволяет диалоговике надстройки быть исключением из блокатора всплывающее окно браузера.</span><span class="sxs-lookup"><span data-stu-id="25dfd-126">Office on the web has a feature that enables your add-in's dialog boxes to be an exception to the browser's pop-up blocker.</span></span> <span data-ttu-id="25dfd-127">Когда код вызывает метод, Office в Интернете откроет запрос, аналогичный `displayDialogAsync` следующему:</span><span class="sxs-lookup"><span data-stu-id="25dfd-127">When your code calls the `displayDialogAsync` method, then Office on the web will open a prompt similar to the following:</span></span>

![Снимок экрана, показывающий подсказку с кратким описанием и кнопками Разрешить и игнорировать, которые надстройка может создать, чтобы избежать блокаторов всплывающее окна в браузере.](../images/dialog-prompt-before-open.png)

<span data-ttu-id="25dfd-129">Если пользователь выбирает **Разрешить,** откроется Office диалоговое окно.</span><span class="sxs-lookup"><span data-stu-id="25dfd-129">If the user chooses **Allow**, the Office dialog box opens.</span></span> <span data-ttu-id="25dfd-130">Если пользователь выбирает **Ignore,** запрос закрывается, а Office диалоговое окно не открывается.</span><span class="sxs-lookup"><span data-stu-id="25dfd-130">If the user chooses **Ignore**, the prompt closes and the Office dialog box does not open.</span></span> <span data-ttu-id="25dfd-131">Вместо этого `displayDialogAsync` метод возвращает ошибку 12009.</span><span class="sxs-lookup"><span data-stu-id="25dfd-131">Instead, the `displayDialogAsync` method returns error 12009.</span></span> <span data-ttu-id="25dfd-132">Код должен уловить эту ошибку и либо предоставить альтернативный интерфейс, не требующий диалога, либо отобразить сообщение пользователю, который сообщает, что надстройка требует от них разрешить диалоговое окно.</span><span class="sxs-lookup"><span data-stu-id="25dfd-132">Your code should catch this error and either provide an alternate experience that does not require a dialog, or display a message to the user advising that the add-in requires them to allow the dialog.</span></span> <span data-ttu-id="25dfd-133">(Подробнее о 12009 см. в руб. [Ошибки из displayDialogAsync](dialog-handle-errors-events.md#errors-from-displaydialogasync).)</span><span class="sxs-lookup"><span data-stu-id="25dfd-133">(For more about 12009, see [Errors from displayDialogAsync](dialog-handle-errors-events.md#errors-from-displaydialogasync).)</span></span>

<span data-ttu-id="25dfd-134">Если по какой-либо причине необходимо отключить эту функцию, код должен отказаться. Он делает этот запрос с [объектом DialogOptions,](/javascript/api/office/office.dialogoptions) который передается `displayDialogAsync` методу.</span><span class="sxs-lookup"><span data-stu-id="25dfd-134">If, for any reason, you want to turn off this feature, then your code must opt out. It makes this request with the [DialogOptions](/javascript/api/office/office.dialogoptions) object that is passed to the `displayDialogAsync` method.</span></span> <span data-ttu-id="25dfd-135">В частности, объект должен включать `promptBeforeOpen: false` .</span><span class="sxs-lookup"><span data-stu-id="25dfd-135">Specifically, the object should include `promptBeforeOpen: false`.</span></span> <span data-ttu-id="25dfd-136">Если этот параметр установлен ложным, Office в Интернете не будет побуждать пользователя разрешить надстройки открыть диалоговое окно, и Office диалоговое окно не откроется.</span><span class="sxs-lookup"><span data-stu-id="25dfd-136">When this option is set to false, Office on the web will not prompt the user to allow the add-in open a dialog, and the Office dialog will not open.</span></span>

### <a name="do-not-use-the-_host_info-value"></a><span data-ttu-id="25dfd-137">Не используйте значение \_ информации \_ о хост-сайте</span><span class="sxs-lookup"><span data-stu-id="25dfd-137">Do not use the \_host\_info value</span></span>

<span data-ttu-id="25dfd-138">Office автоматически добавляет параметр запроса `_host_info` в URL-адрес, который передается `displayDialogAsync`.</span><span class="sxs-lookup"><span data-stu-id="25dfd-138">Office automatically adds a query parameter called `_host_info` to the URL that is passed to `displayDialogAsync`.</span></span> <span data-ttu-id="25dfd-139">Он примыкает к параметрам настраиваемого запроса, если таковые есть.</span><span class="sxs-lookup"><span data-stu-id="25dfd-139">It is appended after your custom query parameters, if any.</span></span> <span data-ttu-id="25dfd-140">Он не примыкает к последующим URL-адресам, в которые перемещается диалоговое окно.</span><span class="sxs-lookup"><span data-stu-id="25dfd-140">It is not appended to any subsequent URLs that the dialog box navigates to.</span></span> <span data-ttu-id="25dfd-141">Корпорация Майкрософт может изменить содержимое этого значения или удалить его полностью, поэтому код не должен его читать.</span><span class="sxs-lookup"><span data-stu-id="25dfd-141">Microsoft may change the content of this value, or remove it entirely, so your code should not read it.</span></span> <span data-ttu-id="25dfd-142">Это же значение добавляется в хранилище сеансов диалоговое окно (то есть свойство [Window.sessionStorage).](https://developer.mozilla.org/docs/Web/API/Window/sessionStorage)</span><span class="sxs-lookup"><span data-stu-id="25dfd-142">The same value is added to the dialog box's session storage (that is, the [Window.sessionStorage](https://developer.mozilla.org/docs/Web/API/Window/sessionStorage) property).</span></span> <span data-ttu-id="25dfd-143">*Ваш код не должен ни считывать это значение, ни записывать в него данные*.</span><span class="sxs-lookup"><span data-stu-id="25dfd-143">Again, *your code should neither read nor write to this value*.</span></span>

### <a name="opening-another-dialog-immediately-after-closing-one"></a><span data-ttu-id="25dfd-144">Открытие другого диалоговое окно сразу после закрытия одного</span><span class="sxs-lookup"><span data-stu-id="25dfd-144">Opening another dialog immediately after closing one</span></span>

<span data-ttu-id="25dfd-145">Не может быть открыто несколько диалогов с данной хост-страницы, поэтому перед открытием другого диалоговое окно код должен вызвать [Диалог.закрыть](/javascript/api/office/office.dialog#close__) в открытом `displayDialogAsync` диалоговом ок.</span><span class="sxs-lookup"><span data-stu-id="25dfd-145">You can't have more than one dialog open from a given host page, so your code should call [Dialog.close](/javascript/api/office/office.dialog#close__) on an open dialog before it calls `displayDialogAsync` to open another dialog.</span></span> <span data-ttu-id="25dfd-146">Метод `close` асинхронный.</span><span class="sxs-lookup"><span data-stu-id="25dfd-146">The `close` method is asynchronous.</span></span> <span data-ttu-id="25dfd-147">По этой причине, если вы звоните сразу после звонка, первый диалог может не полностью закрыться, Office при попытке `displayDialogAsync` `close` открыть второй.</span><span class="sxs-lookup"><span data-stu-id="25dfd-147">For this reason, if you call `displayDialogAsync` immediately after a call of `close`, the first dialog may not have completely closed when Office attempts to open the second.</span></span> <span data-ttu-id="25dfd-148">Если это произойдет, Office возвращает ошибку [12007:](dialog-handle-errors-events.md#12007) "Операция не удалась, так как у этой надстройки уже есть активный диалог".</span><span class="sxs-lookup"><span data-stu-id="25dfd-148">If that happens, Office will return a [12007](dialog-handle-errors-events.md#12007) error: "The operation failed because this add-in already has an active dialog."</span></span>

<span data-ttu-id="25dfd-149">Метод не принимает параметр обратного вызова и не возвращает объект Promise, поэтому его нельзя ожидать ни с ключевым словом, ни `close` `await` с помощью `then` метода.</span><span class="sxs-lookup"><span data-stu-id="25dfd-149">The `close` method doesn't accept a callback parameter, and it doesn't return a Promise object so it cannot be awaited with either the `await` keyword or with a `then` method.</span></span> <span data-ttu-id="25dfd-150">По этой причине мы предлагаем следующий метод, когда необходимо открыть новый диалог сразу после закрытия диалогов: инкапсулировать код, чтобы открыть новый диалоговое окно в методе и разработать метод для повторного вызова себя, если вызов `displayDialogAsync` `12007` возвращается .</span><span class="sxs-lookup"><span data-stu-id="25dfd-150">For this reason, we suggest the following technique when you need to open a new dialog immediately after closing a dialog: encapsulate the code to open the new dialog in a method and design the method to recursively call itself if the call of `displayDialogAsync` returns `12007`.</span></span> <span data-ttu-id="25dfd-151">Ниже приведен пример.</span><span class="sxs-lookup"><span data-stu-id="25dfd-151">The following is an example.</span></span>

```javascript
function openFirstDialog() {
  Office.context.ui.displayDialogAsync("https://MyDomain/firstDialog.html", { width: 50, height: 50},
     (result) => {
      if(result.status === Office.AsyncResultStatus.Succeeded) {
        const dialog = result.value;
        dialog.close();
        openSecondDialog();
      }
      else {
         // Handle errors
      }
    }
  );
}
 
function openSecondDialog() {
  Office.context.ui.displayDialogAsync("https://MyDomain/secondDialog.html", { width: 50, height: 50},
    (result) => {
      if(result.status === Office.AsyncResultStatus.Failed) {
        if (result.error.code === 12007) {
          openSecondDialog(); // Recursive call
        }
        else {
         // Handle other errors
        }
      }
    }
  );
}
```

<span data-ttu-id="25dfd-152">Кроме того, можно заставить код приостановить работу, прежде чем он попытается открыть второй диалог с помощью [метода setTimeout.](https://www.w3schools.com/jsref/met_win_settimeout.asp)</span><span class="sxs-lookup"><span data-stu-id="25dfd-152">Alternatively, you could force the code to pause before it tries to open the second dialog by using the [setTimeout](https://www.w3schools.com/jsref/met_win_settimeout.asp) method.</span></span> <span data-ttu-id="25dfd-153">Ниже приведен пример.</span><span class="sxs-lookup"><span data-stu-id="25dfd-153">The following is an example.</span></span>

```javascript
function openFirstDialog() {
  Office.context.ui.displayDialogAsync("https://MyDomain/firstDialog.html", { width: 50, height: 50},
     (result) => {
      if(result.status === Office.AsyncResultStatus.Succeeded) {
        const dialog = result.value;
        dialog.close();
        setTimeout(() => { 
          Office.context.ui.displayDialogAsync("https://MyDomain/secondDialog.html", { width: 50, height: 50},
             (result) => { /* callback body */ }
          );
        }, 1000);
      }
      else {
         // Handle errors
      }
    }
  );
}
```

### <a name="best-practices-for-using-the-office-dialog-api-in-an-spa"></a><span data-ttu-id="25dfd-154">Наилучшие методы использования API Office диалогов в SPA</span><span class="sxs-lookup"><span data-stu-id="25dfd-154">Best practices for using the Office dialog API in an SPA</span></span>

<span data-ttu-id="25dfd-155">Если в вашей надстройке используется клиентская маршрутия, как это обычно делают одно-страницы приложений (SPAs), у вас есть возможность передать URL-адрес маршрута методу [displayDialogAsync](/javascript/api/office/office.ui) вместо URL-адреса отдельной страницы HTML.</span><span class="sxs-lookup"><span data-stu-id="25dfd-155">If your add-in uses client-side routing, as single-page applications (SPAs) typically do, you have the option to pass the URL of a route to the [displayDialogAsync](/javascript/api/office/office.ui) method instead of the URL of a separate HTML page.</span></span> <span data-ttu-id="25dfd-156">*Мы рекомендуем не делать этого по причинам, которые приведены ниже.*</span><span class="sxs-lookup"><span data-stu-id="25dfd-156">*We recommend against doing so for the reasons given below.*</span></span>

> [!NOTE]
> <span data-ttu-id="25dfd-157">Эта статья не относится к *маршрутике* на стороне сервера, например в веб-приложении на основе Express.</span><span class="sxs-lookup"><span data-stu-id="25dfd-157">This article is not relevant to *server-side* routing, such as in an Express-based web application.</span></span>

#### <a name="problems-with-spas-and-the-office-dialog-api"></a><span data-ttu-id="25dfd-158">Проблемы с spAs и API Office диалогов</span><span class="sxs-lookup"><span data-stu-id="25dfd-158">Problems with SPAs and the Office dialog API</span></span>

<span data-ttu-id="25dfd-159">Диалоговое Office находится в новом окне с собственным экземпляром двигателя JavaScript, а значит, это собственный контекст полного выполнения.</span><span class="sxs-lookup"><span data-stu-id="25dfd-159">The Office dialog box is in a new window with its own instance of the JavaScript engine, and hence it's own complete execution context.</span></span> <span data-ttu-id="25dfd-160">Если вы пройдете маршрут, ваша базовая страница и весь ее код инициализации и загрузки снова запустится в этом новом контексте, и любые переменные задают свои начальные значения в диалоговом окне.</span><span class="sxs-lookup"><span data-stu-id="25dfd-160">If you pass a route, your base page and all its initialization and bootstrapping code run again in this new context, and any variables are set to their initial values in the dialog box.</span></span> <span data-ttu-id="25dfd-161">Таким образом, этот метод загружает и запускает второй экземпляр приложения в окне окна, что частично побивает назначение SPA.</span><span class="sxs-lookup"><span data-stu-id="25dfd-161">So this technique downloads and launches a second instance of your application in the  box window, which partially defeats the purpose of an SPA.</span></span> <span data-ttu-id="25dfd-162">Кроме того, код, который изменяет переменные в окне диалоговое окно, не изменяет версию области задач тех же переменных.</span><span class="sxs-lookup"><span data-stu-id="25dfd-162">In addition, code that changes variables in the dialog box window does not change the task pane version of the same variables.</span></span> <span data-ttu-id="25dfd-163">Кроме того, в диалоговом окне имеется собственное хранилище сеансов (свойство [Window.sessionStorage),](https://developer.mozilla.org/docs/Web/API/Window/sessionStorage) которое не доступно из кода в области задач.</span><span class="sxs-lookup"><span data-stu-id="25dfd-163">Similarly, the dialog box window has its own session storage (the [Window.sessionStorage](https://developer.mozilla.org/docs/Web/API/Window/sessionStorage) property), which is not accessible from code in the task pane.</span></span> <span data-ttu-id="25dfd-164">Диалоговое окно и хост-страница, на которой был вызван, выглядят как `displayDialogAsync` два разных клиента на сервере.</span><span class="sxs-lookup"><span data-stu-id="25dfd-164">The dialog box and the host page on which `displayDialogAsync` was called look like two different clients to your server.</span></span> <span data-ttu-id="25dfd-165">(Чтобы напомнить о том, что такое хост-страница, см. в этой странице Откройте диалоговое [окно с хост-страницы.)](dialog-api-in-office-add-ins.md#open-a-dialog-box-from-a-host-page)</span><span class="sxs-lookup"><span data-stu-id="25dfd-165">(For a reminder of what a host page is, see [Open a dialog box from a host page](dialog-api-in-office-add-ins.md#open-a-dialog-box-from-a-host-page).)</span></span>

<span data-ttu-id="25dfd-166">Таким образом, если вы прошли путь к методу, у вас действительно не будет SPA; у вас будет два экземпляра одного и того же `displayDialogAsync` *SPA.*</span><span class="sxs-lookup"><span data-stu-id="25dfd-166">So, if you passed a route to the `displayDialogAsync` method, you wouldn't really have an SPA; you'd have *two instances of the same SPA*.</span></span> <span data-ttu-id="25dfd-167">Кроме того, большая часть кода в экземпляре области задач никогда не будет использоваться в этом экземпляре, а большая часть кода в экземпляре диалогового окна никогда не будет использоваться в этом экземпляре.</span><span class="sxs-lookup"><span data-stu-id="25dfd-167">Moreover, much of the code in the task pane instance would never be used in that instance and much of the code in the dialog box instance would never be used in that instance.</span></span> <span data-ttu-id="25dfd-168">Это соответствует применению двух одностраничных приложений в одном пакете.</span><span class="sxs-lookup"><span data-stu-id="25dfd-168">It would be like having two SPAs in the same bundle.</span></span>

#### <a name="microsoft-recommendations"></a><span data-ttu-id="25dfd-169">Рекомендации Корпорации Майкрософт</span><span class="sxs-lookup"><span data-stu-id="25dfd-169">Microsoft recommendations</span></span>

<span data-ttu-id="25dfd-170">Вместо передачи клиентского маршрута методу рекомендуется сделать один `displayDialogAsync` из следующих способов:</span><span class="sxs-lookup"><span data-stu-id="25dfd-170">Instead of passing a client-side route to the `displayDialogAsync` method, we recommend that you do one of the following:</span></span>

* <span data-ttu-id="25dfd-171">Если код, который необходимо выполнить в диалоговом окне, достаточно сложный, создайте два разных spAs явно; то есть иметь два spAs в разных папках одного домена.</span><span class="sxs-lookup"><span data-stu-id="25dfd-171">If the code that you want to run in the dialog box is sufficiently complex, create two different SPAs explicitly; that is, have two SPAs in different folders of the same domain.</span></span> <span data-ttu-id="25dfd-172">Один SPA выполняется в диалоговом окне, а другой на хост-странице диалогового окна, где `displayDialogAsync` был вызван.</span><span class="sxs-lookup"><span data-stu-id="25dfd-172">One SPA runs in the dialog box and the other in the dialog box's host page where `displayDialogAsync` was called.</span></span> 
* <span data-ttu-id="25dfd-173">В большинстве сценариев в диалоговом окне требуется только простая логика.</span><span class="sxs-lookup"><span data-stu-id="25dfd-173">In most scenarios, only simple logic is needed in the dialog box.</span></span> <span data-ttu-id="25dfd-174">В таких случаях ваш проект будет значительно упрощен путем размещения одной HTML-страницы со встроенным javaScript или ссылкой на нее в домене spa.</span><span class="sxs-lookup"><span data-stu-id="25dfd-174">In such cases, your project will be greatly simplified by hosting a single HTML page, with embedded or referenced JavaScript, in the domain of your SPA.</span></span> <span data-ttu-id="25dfd-175">Передайте URL-адрес страницы в метод `displayDialogAsync`.</span><span class="sxs-lookup"><span data-stu-id="25dfd-175">Pass the URL of the page to the `displayDialogAsync` method.</span></span> <span data-ttu-id="25dfd-176">Это означает, что вы отклонили от буквальной идеи одно-страницного приложения; При использовании API диалогового Office у вас нет ни одного экземпляра SPA.</span><span class="sxs-lookup"><span data-stu-id="25dfd-176">While this means that you are deviating from the literal idea of a single-page app; you don't really have a single instance of an SPA when you are using the Office dialog API.</span></span>
