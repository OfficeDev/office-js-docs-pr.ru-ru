---
title: Поддержка Internet Explorer 11
description: Узнайте, как поддерживать Internet Explorer 11 и Javascript ES5 в надстройки.
ms.date: 06/18/2021
localization_priority: Normal
ms.openlocfilehash: 3677b12d265cb70d2c048e91fc32ff5f9619908b
ms.sourcegitcommit: ee9e92a968e4ad23f1e371f00d4888e4203ab772
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/23/2021
ms.locfileid: "53075910"
---
# <a name="support-internet-explorer-11"></a><span data-ttu-id="601e3-103">Поддержка Internet Explorer 11</span><span class="sxs-lookup"><span data-stu-id="601e3-103">Support Internet Explorer 11</span></span>

> [!IMPORTANT]
> <span data-ttu-id="601e3-104">**Internet Explorer по-прежнему Office надстройки**</span><span class="sxs-lookup"><span data-stu-id="601e3-104">**Internet Explorer still used in Office Add-ins**</span></span>
>
> <span data-ttu-id="601e3-105">Корпорация Майкрософт заканчивает поддержку Internet Explorer, но это не влияет на Office надстройки. Некоторые сочетания платформ и Office версий, включая все версии с одновековой покупкой до Office 2019 г., будут по-прежнему использовать управление веб-просмотром, которое поставляется с Internet Explorer 11, для пользования надстройки, как поясняется в браузерах, используемых [Office надстройки](../concepts/browsers-used-by-office-web-add-ins.md). Кроме того, поддержка этих комбинаций и, следовательно, internet Explorer по-прежнему требуется для надстройок, представленных [в AppSource](/office/dev/store/submit-to-appsource-via-partner-center).</span><span class="sxs-lookup"><span data-stu-id="601e3-105">Microsoft is ending support for Internet Explorer, but this doesn't significantly affect Office Add-ins. Some combinations of platforms and Office versions, including all one-time-purchase versions through Office 2019, will continue to use the webview control that comes with Internet Explorer 11 to host add-ins, as explained in [Browsers used by Office Add-ins](../concepts/browsers-used-by-office-web-add-ins.md). Moreover, support for these combinations, and hence for Internet Explorer, is still required for add-ins submitted to [AppSource](/office/dev/store/submit-to-appsource-via-partner-center).</span></span> <span data-ttu-id="601e3-106">Меняются *две* вещи:</span><span class="sxs-lookup"><span data-stu-id="601e3-106">Two things *are* changing:</span></span>
>
> - <span data-ttu-id="601e3-107">AppSource больше не тестирует надстройки в Office в Интернете с помощью Internet Explorer в качестве браузера.</span><span class="sxs-lookup"><span data-stu-id="601e3-107">AppSource no longer tests add-ins in Office on the web using Internet Explorer as the browser.</span></span> <span data-ttu-id="601e3-108">Но AppSource по-прежнему тестирует комбинации  платформы и Office настольных версий, которые используют Internet Explorer.</span><span class="sxs-lookup"><span data-stu-id="601e3-108">But AppSource still tests for combinations of platform and Office *desktop* versions that use Internet Explorer.</span></span>
> - <span data-ttu-id="601e3-109">Средство [Script Lab прекратит](../overview/explore-with-script-lab.md) работу в Internet Explorer в 2021 году.</span><span class="sxs-lookup"><span data-stu-id="601e3-109">The [Script Lab tool](../overview/explore-with-script-lab.md) will stop working in Internet Explorer sometime in 2021.</span></span>

<span data-ttu-id="601e3-110">Office Надстройки — это веб-приложения, которые отображаются в IFrames при Office в Интернете.</span><span class="sxs-lookup"><span data-stu-id="601e3-110">Office Add-ins are web applications that are displayed inside IFrames when running on Office on the web.</span></span> <span data-ttu-id="601e3-111">Office Надстройки отображаются с помощью встроенных элементов управления браузером при Office на Windows или Office mac.</span><span class="sxs-lookup"><span data-stu-id="601e3-111">Office Add-ins are displayed using embedded browser controls when running in Office on Windows or Office on the Mac.</span></span> <span data-ttu-id="601e3-112">Встроенные элементы управления браузером поставляются операционной системой или браузером, установленным на компьютере пользователя.</span><span class="sxs-lookup"><span data-stu-id="601e3-112">The embedded browser controls are supplied by the operating system or by a browser installed on the user's computer.</span></span>

<span data-ttu-id="601e3-113">Если вы планируете выставлять надстройку на рынок через AppSource или планируете поддерживать более старые версии Windows и Office, надстройка должна работать в встраиваемом контроле браузера, основанном на Internet Explorer 11 (IE11).</span><span class="sxs-lookup"><span data-stu-id="601e3-113">If you plan to market your add-in through AppSource or you plan to support older versions of Windows and Office, your add-in must work in the embeddable browser control that is based on Internet Explorer 11 (IE11).</span></span> <span data-ttu-id="601e3-114">Сведения о том, какие сочетания Windows и Office используют управление браузером на основе IE11, см. в браузерах, используемых Office [надстройки.](../concepts/browsers-used-by-office-web-add-ins.md)</span><span class="sxs-lookup"><span data-stu-id="601e3-114">For information about which combinations of Windows and Office use the IE11-based browser control, see [Browsers used by Office Add-ins](../concepts/browsers-used-by-office-web-add-ins.md).</span></span>

> [!IMPORTANT]
> <span data-ttu-id="601e3-115">Internet Explorer 11 не поддерживает некоторые функции HTML5, такие как мультимедиа, запись и расположение.</span><span class="sxs-lookup"><span data-stu-id="601e3-115">Internet Explorer 11 doesn't support some HTML5 features such as media, recording, and location.</span></span> <span data-ttu-id="601e3-116">Если надстройка должна поддерживать Internet Explorer 11, вы не можете использовать эти функции.</span><span class="sxs-lookup"><span data-stu-id="601e3-116">If your add-in must support Internet Explorer 11, then you can't use these features.</span></span>

<span data-ttu-id="601e3-117">Internet Explorer 11 не поддерживает версии JavaScript позже ES5.</span><span class="sxs-lookup"><span data-stu-id="601e3-117">Internet Explorer 11 doesn't support JavaScript versions later than ES5.</span></span> <span data-ttu-id="601e3-118">Если вы хотите использовать синтаксис и функции ECMAScript 2015 или более поздней части или TypeScript, у вас есть два варианта, описанных в этой статье.</span><span class="sxs-lookup"><span data-stu-id="601e3-118">If you want to use the syntax and features of ECMAScript 2015 or later, or TypeScript, you have two options as described in this article.</span></span> <span data-ttu-id="601e3-119">Вы также можете объединить эти два метода.</span><span class="sxs-lookup"><span data-stu-id="601e3-119">You can also combine these two techniques.</span></span>

## <a name="use-a-transpiler"></a><span data-ttu-id="601e3-120">Использование транспилера</span><span class="sxs-lookup"><span data-stu-id="601e3-120">Use a transpiler</span></span>

<span data-ttu-id="601e3-121">Код можно написать как в TypeScript, так и в современном JavaScript, а затем перенастроить его во время сборки в JavaScript ES5.</span><span class="sxs-lookup"><span data-stu-id="601e3-121">You can write your code in either TypeScript or modern JavaScript and then transpile it at build-time into ES5 JavaScript.</span></span> <span data-ttu-id="601e3-122">В результате в веб-приложение надстройки загружаются файлы ES5.</span><span class="sxs-lookup"><span data-stu-id="601e3-122">The resulting ES5 files are what you upload to your add-in's web application.</span></span>

<span data-ttu-id="601e3-123">Существует два популярных транспилера.</span><span class="sxs-lookup"><span data-stu-id="601e3-123">There are two popular transpilers.</span></span> <span data-ttu-id="601e3-124">Оба из них могут работать с исходными файлами, которые typeScript или post-ES5 JavaScript.</span><span class="sxs-lookup"><span data-stu-id="601e3-124">Both of them can work with source files that are TypeScript or post-ES5 JavaScript.</span></span> <span data-ttu-id="601e3-125">Они также работают с React файлами (jsx и .tsx).</span><span class="sxs-lookup"><span data-stu-id="601e3-125">They also work with React files (.jsx and .tsx).</span></span>

- [<span data-ttu-id="601e3-126">babel</span><span class="sxs-lookup"><span data-stu-id="601e3-126">babel</span></span>](https://babeljs.io/)
- [<span data-ttu-id="601e3-127">tsc</span><span class="sxs-lookup"><span data-stu-id="601e3-127">tsc</span></span>](https://www.typescriptlang.org/index.html)

<span data-ttu-id="601e3-128">Сведения об установке и настройке транспилера в проекте надстройки см. в документации для любого из них.</span><span class="sxs-lookup"><span data-stu-id="601e3-128">See the documentation for either of them for information about installing and configuring the transpiler in your add-in project.</span></span> <span data-ttu-id="601e3-129">Для автоматизации переливания рекомендуется использовать бегун задач, например [Grunt](https://gruntjs.com/) или [WebPack.](https://webpack.js.org/)</span><span class="sxs-lookup"><span data-stu-id="601e3-129">We recommend that you use a task runner, such as [Grunt](https://gruntjs.com/) or [WebPack](https://webpack.js.org/) to automate the transpilation.</span></span> <span data-ttu-id="601e3-130">Пример надстройки, использующей tsc, см. в Office надстройки [Microsoft Graph React.](https://github.com/OfficeDev/PnP-OfficeAddins/tree/3ce0e1b74152dbbe8306a091696bc4455c04c0a1/Samples/auth/Office-Add-in-Microsoft-Graph-React)</span><span class="sxs-lookup"><span data-stu-id="601e3-130">For a sample add-in that uses tsc, see [Office Add-in Microsoft Graph React](https://github.com/OfficeDev/PnP-OfficeAddins/tree/3ce0e1b74152dbbe8306a091696bc4455c04c0a1/Samples/auth/Office-Add-in-Microsoft-Graph-React).</span></span> <span data-ttu-id="601e3-131">Пример, использующий babel, см. в служба хранилища [надстройки.](https://github.com/OfficeDev/PnP-OfficeAddins/tree/3ce0e1b74152dbbe8306a091696bc4455c04c0a1/Samples/Excel.OfflineStorageAddin)</span><span class="sxs-lookup"><span data-stu-id="601e3-131">For a sample that uses babel, see [Offline Storage Add-in](https://github.com/OfficeDev/PnP-OfficeAddins/tree/3ce0e1b74152dbbe8306a091696bc4455c04c0a1/Samples/Excel.OfflineStorageAddin).</span></span>

> [!NOTE]
> <span data-ttu-id="601e3-132">Если вы используете Visual Studio (не Visual Studio Code), tsc, вероятно, проще всего использовать.</span><span class="sxs-lookup"><span data-stu-id="601e3-132">If you are using Visual Studio (not Visual Studio Code), tsc is probably easiest to use.</span></span> <span data-ttu-id="601e3-133">Вы можете установить поддержку для него с помощью пакета nuget.</span><span class="sxs-lookup"><span data-stu-id="601e3-133">You can install support for it with a nuget package.</span></span> <span data-ttu-id="601e3-134">Дополнительные сведения см. в [javaScript и TypeScript в Visual Studio 2019 г.](/visualstudio/javascript/javascript-in-vs-2019)</span><span class="sxs-lookup"><span data-stu-id="601e3-134">For more information, see [JavaScript and TypeScript in Visual Studio 2019](/visualstudio/javascript/javascript-in-vs-2019).</span></span> <span data-ttu-id="601e3-135">Чтобы использовать babel с Visual Studio, создайте сценарий сборки или используйте обозреватель задач runner в Visual Studio с помощью таких средств, как бегун задач [WebPack](https://marketplace.visualstudio.com/items?itemName=MadsKristensen.WebPackTaskRunner) или [NPM Task Runner.](https://marketplace.visualstudio.com/items?itemName=MadsKristensen.NPMTaskRunner)</span><span class="sxs-lookup"><span data-stu-id="601e3-135">To use babel with Visual Studio, create a build script or use the Task Runner Explorer in Visual Studio with tools like the [WebPack Task Runner](https://marketplace.visualstudio.com/items?itemName=MadsKristensen.WebPackTaskRunner) or [NPM Task Runner](https://marketplace.visualstudio.com/items?itemName=MadsKristensen.NPMTaskRunner).</span></span>

## <a name="use-a-polyfill"></a><span data-ttu-id="601e3-136">Использование полифайла</span><span class="sxs-lookup"><span data-stu-id="601e3-136">Use a polyfill</span></span>

<span data-ttu-id="601e3-137">[Полифильм](https://en.wikipedia.org/wiki/Polyfill_(programming)) — это JavaScript более ранней версии, который дублирует функции из более последних версий JavaScript.</span><span class="sxs-lookup"><span data-stu-id="601e3-137">A [polyfill](https://en.wikipedia.org/wiki/Polyfill_(programming)) is earlier-version JavaScript that duplicates functionality from more recent versions of JavaScript.</span></span> <span data-ttu-id="601e3-138">Полифильм работает с браузерами, которые не поддерживают более поздние версии JavaScript.</span><span class="sxs-lookup"><span data-stu-id="601e3-138">The polyfill works with in browsers that don't support the later JavaScript versions.</span></span> <span data-ttu-id="601e3-139">Например, метод строки не был частью версии ES5 JavaScript, поэтому он не будет работать в `startsWith` Internet Explorer 11.</span><span class="sxs-lookup"><span data-stu-id="601e3-139">For example, the string method `startsWith` wasn't part of the ES5 version of JavaScript, and so it won't run in Internet Explorer 11.</span></span> <span data-ttu-id="601e3-140">Существуют библиотеки полифильмов, написанные в ES5, которые определяют и реализуют `startsWith` метод.</span><span class="sxs-lookup"><span data-stu-id="601e3-140">There are polyfill libraries, written in ES5, that define and implement a `startsWith` method.</span></span> <span data-ttu-id="601e3-141">Рекомендуется библиотека [полифильмов core-js.](https://github.com/zloirock/core-js)</span><span class="sxs-lookup"><span data-stu-id="601e3-141">We recommend the [core-js](https://github.com/zloirock/core-js) polyfill library.</span></span>

<span data-ttu-id="601e3-142">Чтобы использовать библиотеку полифильмов, загрузите ее, как и любой другой файл JavaScript или модуль.</span><span class="sxs-lookup"><span data-stu-id="601e3-142">To use a polyfill library, load it like any other JavaScript file or module.</span></span> <span data-ttu-id="601e3-143">Например, можно использовать тег в HTML-файле домашней страницы надстройки (например), или можно использовать заявление в `<script>` `<script src="/js/core-js.js"></script>` `import` файле JavaScript (например). `import 'core-js';`</span><span class="sxs-lookup"><span data-stu-id="601e3-143">For example, you can use a `<script>` tag in the add-in's home page HTML file (for example `<script src="/js/core-js.js"></script>`), or you can use an `import` statement in a JavaScript file (for example, `import 'core-js';`).</span></span> <span data-ttu-id="601e3-144">Когда двигатель JavaScript видит такой метод, он сначала будет искать, есть ли метод этого имени, встроенный `startsWith` в язык.</span><span class="sxs-lookup"><span data-stu-id="601e3-144">When the JavaScript engine sees a method like `startsWith`, it will first look to see if there is a method of that name built into the language.</span></span> <span data-ttu-id="601e3-145">Если есть, он будет вызывать родной метод.</span><span class="sxs-lookup"><span data-stu-id="601e3-145">If there is, it will call the native method.</span></span> <span data-ttu-id="601e3-146">Если метод не встроен и только в том случае, если он не встроен, двигатель будет искать для него все загруженные файлы.</span><span class="sxs-lookup"><span data-stu-id="601e3-146">If, and only if, the method isn't built-in, the engine will look in all loaded files for it.</span></span> <span data-ttu-id="601e3-147">Таким образом, полифулловая версия не используется в браузерах, поддерживаюх родную версию.</span><span class="sxs-lookup"><span data-stu-id="601e3-147">So, the polyfilled version isn't used in browsers that support the native version.</span></span>

<span data-ttu-id="601e3-148">Импорт всей библиотеки core-js импортирует все функции core-js.</span><span class="sxs-lookup"><span data-stu-id="601e3-148">Importing the entire core-js library will import all core-js features.</span></span> <span data-ttu-id="601e3-149">Вы также можете импортировать только полифильмы, Office надстройки.</span><span class="sxs-lookup"><span data-stu-id="601e3-149">You can also import only the polyfills that your Office Add-in requires.</span></span> <span data-ttu-id="601e3-150">Инструкции по этому поводу см. в [aPI CommonJS.](https://github.com/zloirock/core-js#commonjs-api)</span><span class="sxs-lookup"><span data-stu-id="601e3-150">For instructions about how to do this, see [CommonJS APIs](https://github.com/zloirock/core-js#commonjs-api).</span></span> <span data-ttu-id="601e3-151">Библиотека core-js имеет большинство необходимых полифильмов.</span><span class="sxs-lookup"><span data-stu-id="601e3-151">The core-js library has most of the polyfills that you need.</span></span> <span data-ttu-id="601e3-152">В разделе Missing [Polyfills](https://github.com/zloirock/core-js#missing-polyfills) документации core-js описано несколько исключений.</span><span class="sxs-lookup"><span data-stu-id="601e3-152">There are a few exceptions detailed in the [Missing Polyfills](https://github.com/zloirock/core-js#missing-polyfills) section of the core-js documentation.</span></span> <span data-ttu-id="601e3-153">Например, он не `fetch` поддерживается, но вы можете использовать [подбирать](https://github.com/github/fetch) полифильм.</span><span class="sxs-lookup"><span data-stu-id="601e3-153">For example, it doesn't support `fetch`, but you can use the [fetch](https://github.com/github/fetch) polyfill.</span></span>

<span data-ttu-id="601e3-154">Пример надстройки, использующей core.js, см. в примере [Word Add-in Angular2 StyleChecker.](https://github.com/OfficeDev/Word-Add-in-Angular2-StyleChecker)</span><span class="sxs-lookup"><span data-stu-id="601e3-154">For a sample add-in that uses core.js, see [Word Add-in Angular2 StyleChecker](https://github.com/OfficeDev/Word-Add-in-Angular2-StyleChecker).</span></span>

## <a name="testing-an-add-in-on-internet-explorer"></a><span data-ttu-id="601e3-155">Тестирование надстройки в Internet Explorer</span><span class="sxs-lookup"><span data-stu-id="601e3-155">Testing an add-in on Internet Explorer</span></span>

<span data-ttu-id="601e3-156">См. [тест Internet Explorer 11](../testing/ie-11-testing.md).</span><span class="sxs-lookup"><span data-stu-id="601e3-156">See [Internet Explorer 11 testing](../testing/ie-11-testing.md).</span></span>

## <a name="additional-resources"></a><span data-ttu-id="601e3-157">Дополнительные ресурсы</span><span class="sxs-lookup"><span data-stu-id="601e3-157">Additional resources</span></span>

- [<span data-ttu-id="601e3-158">Таблица совместимости ECMAScript 6</span><span class="sxs-lookup"><span data-stu-id="601e3-158">ECMAScript 6 compatibility table</span></span>](https://kangax.github.io/compat-table/es6/)
- [<span data-ttu-id="601e3-159">Могу ли я использовать... Таблицы поддержки для HTML5, CSS3 и т.д.</span><span class="sxs-lookup"><span data-stu-id="601e3-159">Can I use... Support tables for HTML5, CSS3, etc</span></span>](https://caniuse.com/)
