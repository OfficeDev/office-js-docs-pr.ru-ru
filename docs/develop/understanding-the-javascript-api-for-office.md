---
title: Общие сведения об интерфейсе API JavaScript для Office
description: ''
ms.date: 01/23/2018
ms.openlocfilehash: 12e7d9030ec37746f84e3fc725cddda2a5675761
ms.sourcegitcommit: 5bef9828f047da03ecf2f43c6eb5b8514eff28ce
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/31/2018
ms.locfileid: "23782796"
---
# <a name="understanding-the-javascript-api-for-office"></a><span data-ttu-id="7b31a-102">Общие сведения об интерфейсе API JavaScript для Office</span><span class="sxs-lookup"><span data-stu-id="7b31a-102">Understanding the JavaScript API for Office</span></span>

<span data-ttu-id="7b31a-p101">В этой статье можно узнать об интерфейсе API JavaScript для Office и о том, как его использовать. Справочные сведения см. в разделе [API JavaScript для Office](https://dev.office.com/reference/add-ins/javascript-api-for-office). О том, как обновить файлы проекта Visual Studio до последней версии API JavaScript для Office, см. в статье [Обновление версии API JavaScript для Office и файлов схемы манифеста](update-your-javascript-api-for-office-and-manifest-schema-version.md).</span><span class="sxs-lookup"><span data-stu-id="7b31a-p101">This article provides information about the JavaScript API for Office and how to use it. For reference information, see [JavaScript API for Office](https://dev.office.com/reference/add-ins/javascript-api-for-office). For information about updating Visual Studio project files to the most current version of the JavaScript API for Office, see [Update the version of your JavaScript API for Office and manifest schema files](update-your-javascript-api-for-office-and-manifest-schema-version.md).</span></span>

> [!NOTE]
> <span data-ttu-id="7b31a-p102">Если вы планируете [опубликовать](../publish/publish.md) надстройку в AppSource и сделать ее доступной в интерфейсе Office, убедитесь, что она соответствует [политикам проверки AppSource](https://docs.microsoft.com/office/dev/store/validation-policies). Например, чтобы пройти проверку, надстройка работать на всех платформах, поддерживающих определенные вами методы. Дополнительные сведения см. в [разделе 4.12](https://docs.microsoft.com/office/dev/store/validation-policies#4-apps-and-add-ins-behave-predictably) и на [странице со сведениями о доступности и ведущих приложениях для надстроек Office](../overview/office-add-in-availability.md).</span><span class="sxs-lookup"><span data-stu-id="7b31a-p102">If you plan to [publish](../publish/publish.md) your add-in to AppSource and make it available within the Office experience, make sure that you conform to the [AppSource validation policies](https://docs.microsoft.com/office/dev/store/validation-policies). For example, to pass validation, your add-in must work across all platforms that support the methods that you define (for more information, see [section 4.12](https://docs.microsoft.com/office/dev/store/validation-policies#4-apps-and-add-ins-behave-predictably) and the [Office Add-in host and availability page](../overview/office-add-in-availability.md)).</span></span> 

## <a name="referencing-the-javascript-api-for-office-library-in-your-add-in"></a><span data-ttu-id="7b31a-108">Ссылки на библиотеку API JavaScript для Office в надстройке</span><span class="sxs-lookup"><span data-stu-id="7b31a-108">Referencing the JavaScript API for Office library in your add-in</span></span>

<span data-ttu-id="7b31a-p103">Библиотека [API JavaScript для Office](https://dev.office.com/reference/add-ins/javascript-api-for-office) состоит из файла Office.js и связанных JS-файлов ведущего приложения, например Excel-15.js и Outlook-15.js. Простейший способ сослаться на API — использовать нашу сеть доставки содержимого (CDN), добавив следующий код `<script>` в тег `<head>` страницы:</span><span class="sxs-lookup"><span data-stu-id="7b31a-p103">The [JavaScript API for Office](https://dev.office.com/reference/add-ins/javascript-api-for-office) library consists of the Office.js file and associated host application-specific .js files, such as Excel-15.js and Outlook-15.js. The simplest method of referencing the API is using our CDN by adding the following `<script>` to your page's `<head>` tag:</span></span>  

```html
<script src="https://appsforoffice.microsoft.com/lib/1/hosted/Office.js" type="text/javascript"></script>
```

<span data-ttu-id="7b31a-111">Это приведет к скачиванию и кэшированию файлов JavaScript API для Office при первой загрузке надстройки, чтобы убедиться, что она использует актуальную реализацию Office.js и сопутствующих файлов для указанной версии.</span><span class="sxs-lookup"><span data-stu-id="7b31a-111">This will download and cache the JavaScript API for Office files the first time your add-in loads to make sure that it is using the most up-to-date implementation of Office.js and its associated files for the specified version.</span></span>

<span data-ttu-id="7b31a-112">Подробные сведения о CDN-версии файла Office.js, включая способы управления версиями и обратной совместимостью, приведены в разделе [Указание ссылок на библиотеку API JavaScript для Office из сети доставки содержимого (CDN)](referencing-the-javascript-api-for-office-library-from-its-cdn.md).</span><span class="sxs-lookup"><span data-stu-id="7b31a-112">For more details around the Office.js CDN, including how versioning and backward compatability is handled, see [Referencing the JavaScript API for Office library from its content delivery network (CDN)](referencing-the-javascript-api-for-office-library-from-its-cdn.md).</span></span>

## <a name="initializing-your-add-in"></a><span data-ttu-id="7b31a-113">Инициализация надстройки</span><span class="sxs-lookup"><span data-stu-id="7b31a-113">Initializing your add-in</span></span>

<span data-ttu-id="7b31a-114">**Область применения:** все типы надстроек</span><span class="sxs-lookup"><span data-stu-id="7b31a-114">**Applies to:** All add-in types</span></span>

<span data-ttu-id="7b31a-115">Надстройки Office часто имеют логику, выполняющую при запуске такие действия, как:</span><span class="sxs-lookup"><span data-stu-id="7b31a-115">Office add-ins often have start-up logic to do things such as:</span></span>

- <span data-ttu-id="7b31a-116">Проверка того, будет ли поддерживать пользовательская версия Office все функции API для Office, вызываемые вашим кодом.</span><span class="sxs-lookup"><span data-stu-id="7b31a-116">Check that the user's version of Office will support all the Office APIs that your code calls.</span></span>

- <span data-ttu-id="7b31a-117">Проверка наличия некоторых артефактов, таких как лист с конкретным именем.</span><span class="sxs-lookup"><span data-stu-id="7b31a-117">Ensure the existence of certain artifacts, such as worksheet with a specific name.</span></span>

- <span data-ttu-id="7b31a-118">Пользователю предлагается выбрать несколько ячеек в Excel, а затем вставить диаграмму, созданную с использованием этих выбранных значений.</span><span class="sxs-lookup"><span data-stu-id="7b31a-118">You can use the initialize event handler to implement common add-in initialization scenarios, such as prompting the user to select some cells in Excel, and then inserting a chart initialized with those selected values.</span></span>

- <span data-ttu-id="7b31a-119">Установление привязок.</span><span class="sxs-lookup"><span data-stu-id="7b31a-119">Establish bindings.</span></span>

- <span data-ttu-id="7b31a-120">Используйте диалоговое API для Office, предлагающее пользователю установить для параметров надстройки значения по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="7b31a-120">Use the Office dialog API to prompt the user for default add-in settings values.</span></span>

<span data-ttu-id="7b31a-121">При этом код запуска не должен вызывать функции API для Office.js до завершения загрузки библиотеки.</span><span class="sxs-lookup"><span data-stu-id="7b31a-121">But your start-up code must not call any Office.js APIs until the library is fully loaded.</span></span> <span data-ttu-id="7b31a-122">Существует два способа, с помощью которых код может определить, загружена ли библиотека.</span><span class="sxs-lookup"><span data-stu-id="7b31a-122">There are two ways that your code can ensure that the library is loaded.</span></span> <span data-ttu-id="7b31a-123">Они описаны в следующих разделах.</span><span class="sxs-lookup"><span data-stu-id="7b31a-123">They are described in the sections below.</span></span> <span data-ttu-id="7b31a-124">Мы рекомендуем использовать более новый и гибкий способ под названием `Office.onReady()`.</span><span class="sxs-lookup"><span data-stu-id="7b31a-124">We recommend that you use the newer, more flexible, technique, calling `Office.onReady()`.</span></span> <span data-ttu-id="7b31a-125">Более старый способ, назначающий обработчик для `Office.initialize`, по-прежнему поддерживается.</span><span class="sxs-lookup"><span data-stu-id="7b31a-125">The older technique, assigning a handler to `Office.initialize`, is still supported.</span></span> <span data-ttu-id="7b31a-126">См. также раздел [Основные различия между Office.initialize и Office.onReady()](#major-differences-between-office-initialize-and-office-onready).</span><span class="sxs-lookup"><span data-stu-id="7b31a-126">See also [Major differences between Office.initialize and Office.onReady()](#major-differences-between-office-initialize-and-office-onready).</span></span>

<span data-ttu-id="7b31a-127">Дополнительные сведения о последовательности событий при инициализации надстройки приведены в разделе [Загрузка модели DOM и среды выполнения](loading-the-dom-and-runtime-environment.md).</span><span class="sxs-lookup"><span data-stu-id="7b31a-127">For more detail about the sequence of events when an add-in is initialized, see [Loading the DOM and runtime environment](loading-the-dom-and-runtime-environment.md).</span></span>

### <a name="initialize-with-officeonready"></a><span data-ttu-id="7b31a-128">Инициализация с использованием функции Office.onReady()</span><span class="sxs-lookup"><span data-stu-id="7b31a-128">Initialize with Office.onReady()</span></span>

<span data-ttu-id="7b31a-129">`Office.onReady()` представляет собой асинхронный метод, который возвращает объект Promise, проверяя при этом, полностью ли загружена библиотека Office.js.</span><span class="sxs-lookup"><span data-stu-id="7b31a-129">`Office.onReady()` is an asynchronous method that returns a Promise object while it checks to see if the Office.js library is fully loaded.</span></span> <span data-ttu-id="7b31a-130">Только в том случае, если библиотека загружена, метод разрешает Promise как объект, определяющий ведущее приложение Office с помощью значения перечисления `Office.HostType` (`Excel`, `Word` и т. д.) и платформу с помощью значения перечисления `Office.PlatformType` (`PC`, `Mac`, `OfficeOnline` и т. д.).</span><span class="sxs-lookup"><span data-stu-id="7b31a-130">When, and only when, the library is loaded, it resolves the Promise as an object that specifies the Office host application with an `Office.HostType` enum value (`Excel`, `Word`, etc.) and the platform with an `Office.PlatformType` enum value (`PC`, `Mac`, `OfficeOnline`, etc.).</span></span> <span data-ttu-id="7b31a-131">Если библиотека уже загружена, выполняется вызов `Office.onReady()`, и разрешение объекта Promise производится немедленно.</span><span class="sxs-lookup"><span data-stu-id="7b31a-131">If the library is already loaded when `Office.onReady()` is called, then the Promise resolves immediately.</span></span>

<span data-ttu-id="7b31a-132">Для вызова `Office.onReady()` необходимо передать ему метод обратного вызова.</span><span class="sxs-lookup"><span data-stu-id="7b31a-132">One way to call `Office.onReady()` is to pass it a callback method.</span></span> <span data-ttu-id="7b31a-133">Пример:</span><span class="sxs-lookup"><span data-stu-id="7b31a-133">Here's an example:</span></span>

```js
Office.onReady(function(info) {
    if (info.host === Office.HostType.Excel) {
        // Do Excel-specific initialization (for example, make add-in task pane's
        // appearance compatible with Excel "green").
    }
    if (info.platform === Office.PlatformType.PC) {
        // Make minor layout changes in the task pane.
    }
    console.log(`Office.js is now ready in ${info.host} on ${info.platform}`);
});
```

<span data-ttu-id="7b31a-134">Кроме того, вместо передачи обратного вызова можно объединить метод `then()` с вызовом `Office.onReady()`.</span><span class="sxs-lookup"><span data-stu-id="7b31a-134">Alternatively, you can chain a `then()` method to the call of `Office.onReady()`, instead of passing a callback.</span></span> <span data-ttu-id="7b31a-135">Например, следующий код проверяет, поддерживает ли пользовательская версия Excel все функции API, которые могут быть вызваны надстройкой.</span><span class="sxs-lookup"><span data-stu-id="7b31a-135">For example, the following code checks to see that the user's version of Excel supports all the APIs that the add-in might call.</span></span>

```js
Office.onReady()
    .then(function() {
        if (!Office.context.requirements.isSetSupported('ExcelApi', '1.7')) {
            console.log("Sorry, this add-in only works with newer versions of Excel.");
        }
    });
```

<span data-ttu-id="7b31a-136">Ниже приведен тот же пример с использованием ключевых слов `async` и `await` в TypeScript:</span><span class="sxs-lookup"><span data-stu-id="7b31a-136">Here is the same example using the `async` and `await` keywords in TypeScript:</span></span>

```typescript
(async () => {
    await Office.onReady();
    if (!Office.context.requirements.isSetSupported('ExcelApi', '1.7')) {
        console.log("Sorry, this add-in only works with newer versions of Excel.");
    }
})();
```

<span data-ttu-id="7b31a-137">При использовании дополнительных платформ JavaScript, включающих собственный обработчик событий инициализации или тесты, их *обычно* размещают в ответе на `Office.onReady()`.</span><span class="sxs-lookup"><span data-stu-id="7b31a-137">If you are using additional JavaScript frameworks that include their own initialization handler or tests, these should be placed within the Office.initialize event.</span></span> <span data-ttu-id="7b31a-138">Например, ссылка на функцию [JQuery](https://jquery.com) `$(document).ready()` может выглядеть следующим образом:</span><span class="sxs-lookup"><span data-stu-id="7b31a-138">For example, [JQuery's](https://jquery.com) `$(document).ready()` function would be referenced as follows:</span></span>

```js
Office.onReady(function() {
    // Office is ready
    $(document).ready(function () {
        // The document is ready
    });
});
```

<span data-ttu-id="7b31a-139">Тем не менее существуют некоторые исключения из этого метода.</span><span class="sxs-lookup"><span data-stu-id="7b31a-139">However, there are exceptions to this practice.</span></span> <span data-ttu-id="7b31a-140">Например, предположим, что вы хотите открыть свою надстройку в браузере (вместо того, чтобы загружать ее в ведущее приложение Office) для отладки пользовательского интерфейса с помощью инструментов веб-обозревателя.</span><span class="sxs-lookup"><span data-stu-id="7b31a-140">For example, suppose you want to open your add-in in a browser (instead of sideload it in an Office host) in order to debug your UI with browser tools.</span></span> <span data-ttu-id="7b31a-141">Поскольку файл Office.js не будет загружаться в веб-обозревателе, `onReady` и `$(document).ready` не будут выполняться при вызове в `onReady` для Office.</span><span class="sxs-lookup"><span data-stu-id="7b31a-141">Since Office.js won't load in the browser, `onReady` won't run and the `$(document).ready` won't run if it's called inside the Office `onReady`.</span></span> <span data-ttu-id="7b31a-142">Еще одно исключение: вы хотите, чтобы при загрузке надстройки в области задач отображался индикатор выполнения.</span><span class="sxs-lookup"><span data-stu-id="7b31a-142">Another exception: you want a progress indicator to appear in the task pane while the add-in is loading.</span></span> <span data-ttu-id="7b31a-143">В этом случае код должен вызывать метод jQuery `ready` и использовать его обратный вызов для отображения индикатора выполнения.</span><span class="sxs-lookup"><span data-stu-id="7b31a-143">In this scenario, your code should call the jQuery `ready` and use it's callback to render the progress indicator.</span></span> <span data-ttu-id="7b31a-144">После этого обратный вызов `onReady` для Office может заменить индикатор выполнения в окончательном варианте пользовательского интерфейса.</span><span class="sxs-lookup"><span data-stu-id="7b31a-144">Then the Office `onReady`'s callback can replace the progress indicator with the final UI.</span></span> 

### <a name="initialize-with-officeinitialize"></a><span data-ttu-id="7b31a-145">Инициализация с использованием функции Office.initialize</span><span class="sxs-lookup"><span data-stu-id="7b31a-145">Initialize with Office.initialize</span></span>

<span data-ttu-id="7b31a-146">Для вызова события инициализации библиотека Office.js должна быть полностью загружена и готова к взаимодействию с пользователем.</span><span class="sxs-lookup"><span data-stu-id="7b31a-146">An initialize event fires when the Office.js library is fully loaded and ready for user interaction.</span></span> <span data-ttu-id="7b31a-147">Для `Office.initialize` можно назначить обработчик, реализующий логику инициализации.</span><span class="sxs-lookup"><span data-stu-id="7b31a-147">You can assign a handler to `Office.initialize` that implements your initialization logic.</span></span> <span data-ttu-id="7b31a-148">Ниже приведен пример, в котором проверяется, поддерживает ли пользовательская версия Excel все функции API, которые могут быть вызваны надстройкой.</span><span class="sxs-lookup"><span data-stu-id="7b31a-148">The following is an example that checks to see that the user's version of Excel supports all the APIs that the add-in might call.</span></span>

```js
Office.initialize = function () {
    if (!Office.context.requirements.isSetSupported('ExcelApi', '1.7')) {
        console.log("Sorry, this add-in only works with newer versions of Excel.");
    }
};
```

<span data-ttu-id="7b31a-149">При использовании дополнительных платформ JavaScript, включающих собственный обработчик событий инициализации или тесты, их *обычно* размещают в событии `Office.initialize`.</span><span class="sxs-lookup"><span data-stu-id="7b31a-149">If you are using additional JavaScript frameworks that include their own initialization handler or tests, these should be placed within the Office.initialize event.</span></span> <span data-ttu-id="7b31a-150">(В данном случае также применяются исключения, описанные ранее в разделе **Инициализация с использованием функции Office.onReady()**.) Например, ссылка на функцию [JQuery](https://jquery.com) `$(document).ready()` может выглядеть следующим образом:</span><span class="sxs-lookup"><span data-stu-id="7b31a-150">(But the exceptions described in the **Initialize with Office.onReady()** section earlier apply in this case also.) For example, [JQuery's](https://jquery.com) `$(document).ready()` function would be referenced as follows:</span></span>

```js
Office.initialize = function () {
    // Office is ready
    $(document).ready(function () {
        // The document is ready
    });
  };
```

<span data-ttu-id="7b31a-151">Для надстроек области задач и контентных надстроек `Office.initialize` обеспечивает дополнительный параметр _reason_.</span><span class="sxs-lookup"><span data-stu-id="7b31a-151">For task pane and content add-ins, `Office.initialize` provides an additional _reason_ parameter.</span></span> <span data-ttu-id="7b31a-152">Этот параметр можно использовать для определения того, каким образом надстройка была добавлена в текущий документ.</span><span class="sxs-lookup"><span data-stu-id="7b31a-152">This parameter specifies how an add-in was added to the current document.</span></span> <span data-ttu-id="7b31a-153">Это поможет обеспечить разную логику в тех случаях, когда надстройка вставляется впервые или когда она уже существует в документе.</span><span class="sxs-lookup"><span data-stu-id="7b31a-153">For task pane and content add-ins, Office.initialize provides an additional reason parameter. This parameter can be used to determine how an add-in was added to the current document. You can use this to provide different logic for when an add-in is first inserted versus when it already existed within the document.</span></span>

```js
Office.initialize = function (reason) {
    $(document).ready(function () {
        switch (reason) {
            case 'inserted': console.log('The add-in was just inserted.');
            case 'documentOpened': console.log('The add-in is already part of the document.');
        }
    });
 };
```

<span data-ttu-id="7b31a-154">Дополнительные сведения приведены в разделах [Событие Office.initialize](https://dev.office.com/reference/add-ins/shared/office.initialize) и [Перечисление InitializationReason](https://dev.office.com/reference/add-ins/shared/initializationreason-enumeration).</span><span class="sxs-lookup"><span data-stu-id="7b31a-154">For more information, see [Office.initialize Event](https://dev.office.com/reference/add-ins/shared/office.initialize) and [InitializationReason Enumeration](https://dev.office.com/reference/add-ins/shared/initializationreason-enumeration).</span></span>

### <a name="major-differences-between-officeinitialize-and-officeonready"></a><span data-ttu-id="7b31a-155">Основные различия между Office.initialize и Office.onReady</span><span class="sxs-lookup"><span data-stu-id="7b31a-155">Major differences between Office.initialize and Office.onReady</span></span>

- <span data-ttu-id="7b31a-156">Вы можете назначить только один обработчик для `Office.initialize` для однократного вызова в инфраструктуре Office; но также можете вызывать `Office.onReady()` в различных местах вашего кода и использовать различные обратные вызовы.</span><span class="sxs-lookup"><span data-stu-id="7b31a-156">You can assign only one handler to `Office.initialize` and it is called, only once, by the Office infrastructure; but you can call `Office.onReady()` in different places in your code and use different callbacks.</span></span> <span data-ttu-id="7b31a-157">Например, код может вызывать `Office.onReady()` сразу после загрузки пользовательского сценария с обратным вызовом, который запускает логику инициализации; и ваш код также может иметь в области задач кнопку, сценарий которой вызывает `Office.onReady()` с другим обратным вызовом.</span><span class="sxs-lookup"><span data-stu-id="7b31a-157">For example, your code could call `Office.onReady()` as soon as your custom script loads with a callback that runs initialization logic; and your code could also have a button in the task pane, whose script calls `Office.onReady()` with a different callback.</span></span> <span data-ttu-id="7b31a-158">В этом случае обратный вызов выполняется при нажатии кнопки.</span><span class="sxs-lookup"><span data-stu-id="7b31a-158">If so, the second callback runs when the button is clicked.</span></span>

- <span data-ttu-id="7b31a-159">Событие `Office.initialize` запускается по окончании внутреннего процесса, в ходе которого Office.js выполняет самоинициализацию.</span><span class="sxs-lookup"><span data-stu-id="7b31a-159">The `Office.initialize` event fires at the end of the internal process in which Office.js initializes itself.</span></span> <span data-ttu-id="7b31a-160">И вызов данного события производится *немедленно* после завершения внутреннего процесса.</span><span class="sxs-lookup"><span data-stu-id="7b31a-160">And it fires *immediately* after the internal process ends.</span></span> <span data-ttu-id="7b31a-161">Если код, в котором вы назначаете обработчик для события, выполняется слишком долго после возникновения события, ваш обработчик не запускается.</span><span class="sxs-lookup"><span data-stu-id="7b31a-161">If the code in which you assign a handler to the event executes too long after the event fires, then your handler doesn't run.</span></span> <span data-ttu-id="7b31a-162">Например, если вы используете диспетчер задач WebPack, он может настроить домашнюю страницу надстройки для загрузки файлов polyfill после загрузки Office.js, но до того, как он загрузит ваш собственный JavaScript.</span><span class="sxs-lookup"><span data-stu-id="7b31a-162">For example, if you are using the WebPack task manager, it might configure the add-in's home page to load polyfill files after it loads Office.js but before it loads your custom JavaScript.</span></span> <span data-ttu-id="7b31a-163">Когда ваш сценарий выполнит загрузку и назначение обработчика, событие инициализации уже произойдет.</span><span class="sxs-lookup"><span data-stu-id="7b31a-163">By the time your script loads and assigns the handler, the initialize event has already happened.</span></span> <span data-ttu-id="7b31a-164">Но вызвать `Office.onReady()` никогда не поздно.</span><span class="sxs-lookup"><span data-stu-id="7b31a-164">But it is never "too late" to call `Office.onReady()`.</span></span> <span data-ttu-id="7b31a-165">Если событие инициализации уже произошло, обратный вызов выполняется немедленно.</span><span class="sxs-lookup"><span data-stu-id="7b31a-165">If the initialize event has already happened, the callback runs immediately.</span></span>

> [!NOTE]
> <span data-ttu-id="7b31a-166">Даже если у вас нет логики запуска, рекомендуется либо вызвать `Office.onReady()`, либо назначить пустую функцию для `Office.initialize` при загрузке вашей надстройки JavaScript, поскольку некоторые комбинации ведущего приложения и платформы Office не будут загружать область задач до тех пор, пока не произойдет одно из этих событий.</span><span class="sxs-lookup"><span data-stu-id="7b31a-166">Even if you have no start-up logic, it is a good practice to either call `Office.onReady()` or assign an empty function to `Office.initialize` when your add-in JavaScript loads, because some Office host and platform combinations won't load the task pane until one of these happens.</span></span> <span data-ttu-id="7b31a-167">В следующих строках показаны два способа, с помощью которых это можно сделать:</span><span class="sxs-lookup"><span data-stu-id="7b31a-167">The following lines show the two ways this can be done:</span></span>
>
>```js
>Office.onReady();
>```
>
>```js
>Office.initialize = function () {};
>```

## <a name="office-javascript-api-object-model"></a><span data-ttu-id="7b31a-168">Объектная модель API JavaScript для Office</span><span class="sxs-lookup"><span data-stu-id="7b31a-168">Office JavaScript API object model</span></span>

<span data-ttu-id="7b31a-169">После инициализации надстройка может взаимодействовать с узлом (например, Excel, Outlook).</span><span class="sxs-lookup"><span data-stu-id="7b31a-169">Once initialized, the add-in can interact with the host (e.g. Excel, Outlook).</span></span> <span data-ttu-id="7b31a-170">Более подробную информацию о конкретных шаблонах использования см. на странице [Объектная модель API JavaScript для Office](office-javascript-api-object-model.md).</span><span class="sxs-lookup"><span data-stu-id="7b31a-170">The [Office JavaScript API object model](office-javascript-api-object-model.md)) page has more details on specific usage patterns.</span></span> <span data-ttu-id="7b31a-171">Существует также подробная справочная документация как для [общих API-интерфейсов](https://dev.office.com/reference/add-ins/javascript-api-for-office), так и для конкретных ведущих приложений.</span><span class="sxs-lookup"><span data-stu-id="7b31a-171">There is also detailed reference documentation for both [shared APIs](https://dev.office.com/reference/add-ins/javascript-api-for-office) and specific hosts.</span></span>

## <a name="api-support-matrix"></a><span data-ttu-id="7b31a-172">Матрица поддержки API</span><span class="sxs-lookup"><span data-stu-id="7b31a-172">API support matrix</span></span>

<span data-ttu-id="7b31a-173">В этой таблице представлены API и функции, поддерживаемые всеми типами надстроек (контентными, области задач и Outlook), и приложения Office, в которых они могут работать, когда вы указываете ведущие приложения Office, поддерживаемые вашей надстройкой с помощью [схемы манифестов надстроек версии 1.1 и функций, поддерживаемых API JavaScript для Office версии 1.1](update-your-javascript-api-for-office-and-manifest-schema-version.md).</span><span class="sxs-lookup"><span data-stu-id="7b31a-173">This table summarizes the API and features supported across add-in types (content, task pane, and Outlook) and the Office applications that can host them when you specify the Office host applications your add-in supports by using the [1.1 add-in manifest schema and features supported by v1.1 JavaScript API for Office](update-your-javascript-api-for-office-and-manifest-schema-version.md).</span></span>


|||||||||
|:-----|:-----|:-----:|:-----:|:-----:|:-----:|:-----:|:-----:|
||<span data-ttu-id="7b31a-174">**Имя узла**</span><span class="sxs-lookup"><span data-stu-id="7b31a-174">**Host name**</span></span>|<span data-ttu-id="7b31a-175">База данных</span><span class="sxs-lookup"><span data-stu-id="7b31a-175">Database</span></span>|<span data-ttu-id="7b31a-176">Книга</span><span class="sxs-lookup"><span data-stu-id="7b31a-176">Workbook</span></span>|<span data-ttu-id="7b31a-177">Почтовый ящик</span><span class="sxs-lookup"><span data-stu-id="7b31a-177">Mailbox</span></span>|<span data-ttu-id="7b31a-178">Презентация</span><span class="sxs-lookup"><span data-stu-id="7b31a-178">Presentation</span></span>|<span data-ttu-id="7b31a-179">Документ</span><span class="sxs-lookup"><span data-stu-id="7b31a-179">Document</span></span>|<span data-ttu-id="7b31a-180">Проект</span><span class="sxs-lookup"><span data-stu-id="7b31a-180">Project</span></span>|
||<span data-ttu-id="7b31a-181">**Поддерживаемые** **ведущие приложения**</span><span class="sxs-lookup"><span data-stu-id="7b31a-181">**Supported** **Host applications**</span></span>|<span data-ttu-id="7b31a-182">Веб-приложения Access</span><span class="sxs-lookup"><span data-stu-id="7b31a-182">Access web apps</span></span>|<span data-ttu-id="7b31a-183">Excel,</span><span class="sxs-lookup"><span data-stu-id="7b31a-183">Excel,</span></span><br/><span data-ttu-id="7b31a-184">Excel Online</span><span class="sxs-lookup"><span data-stu-id="7b31a-184">Excel Online</span></span>|<span data-ttu-id="7b31a-185">Outlook,</span><span class="sxs-lookup"><span data-stu-id="7b31a-185">Outlook,</span></span><br/><span data-ttu-id="7b31a-186">веб-приложение Outlook,</span><span class="sxs-lookup"><span data-stu-id="7b31a-186">Outlook Web App,</span></span><br/><span data-ttu-id="7b31a-187">Outlook Web App для устройств</span><span class="sxs-lookup"><span data-stu-id="7b31a-187">OWA for Devices</span></span>|<span data-ttu-id="7b31a-188">PowerPoint,</span><span class="sxs-lookup"><span data-stu-id="7b31a-188">PowerPoint</span></span><br/><span data-ttu-id="7b31a-189">PowerPoint Online</span><span class="sxs-lookup"><span data-stu-id="7b31a-189">PowerPoint Online</span></span>|<span data-ttu-id="7b31a-190">Word</span><span class="sxs-lookup"><span data-stu-id="7b31a-190">Word</span></span>|<span data-ttu-id="7b31a-191">Проект</span><span class="sxs-lookup"><span data-stu-id="7b31a-191">Project</span></span>|
|<span data-ttu-id="7b31a-192">**Поддерживаемые типы надстроек**</span><span class="sxs-lookup"><span data-stu-id="7b31a-192">**Supported add-in types**</span></span>|<span data-ttu-id="7b31a-193">Содержимое</span><span class="sxs-lookup"><span data-stu-id="7b31a-193">Content</span></span>|<span data-ttu-id="7b31a-194">Да</span><span class="sxs-lookup"><span data-stu-id="7b31a-194">Y</span></span>|<span data-ttu-id="7b31a-195">Да</span><span class="sxs-lookup"><span data-stu-id="7b31a-195">Y</span></span>||<span data-ttu-id="7b31a-196">Да</span><span class="sxs-lookup"><span data-stu-id="7b31a-196">Y</span></span>|||
||<span data-ttu-id="7b31a-197">Область задач</span><span class="sxs-lookup"><span data-stu-id="7b31a-197">Task pane</span></span>||<span data-ttu-id="7b31a-198">Да</span><span class="sxs-lookup"><span data-stu-id="7b31a-198">Y</span></span>||<span data-ttu-id="7b31a-199">Да</span><span class="sxs-lookup"><span data-stu-id="7b31a-199">Y</span></span>|<span data-ttu-id="7b31a-200">Да</span><span class="sxs-lookup"><span data-stu-id="7b31a-200">Y</span></span>|<span data-ttu-id="7b31a-201">Да</span><span class="sxs-lookup"><span data-stu-id="7b31a-201">Y</span></span>|
||<span data-ttu-id="7b31a-202">Outlook</span><span class="sxs-lookup"><span data-stu-id="7b31a-202">Outlook</span></span>|||<span data-ttu-id="7b31a-203">Да</span><span class="sxs-lookup"><span data-stu-id="7b31a-203">Y</span></span>||||
|<span data-ttu-id="7b31a-204">**Поддерживаемые функции API**</span><span class="sxs-lookup"><span data-stu-id="7b31a-204">**Supported API features**</span></span>|<span data-ttu-id="7b31a-205">Чтение и запись текста</span><span class="sxs-lookup"><span data-stu-id="7b31a-205">Read/Write Text</span></span>||<span data-ttu-id="7b31a-206">Да</span><span class="sxs-lookup"><span data-stu-id="7b31a-206">Y</span></span>||<span data-ttu-id="7b31a-207">Да</span><span class="sxs-lookup"><span data-stu-id="7b31a-207">Y</span></span>|<span data-ttu-id="7b31a-208">Да</span><span class="sxs-lookup"><span data-stu-id="7b31a-208">Y</span></span>|<span data-ttu-id="7b31a-209">Да</span><span class="sxs-lookup"><span data-stu-id="7b31a-209">Y</span></span><br/><span data-ttu-id="7b31a-210">(только для чтения)</span><span class="sxs-lookup"><span data-stu-id="7b31a-210">(Read only)</span></span>|
||<span data-ttu-id="7b31a-211">Матрица чтения и записи</span><span class="sxs-lookup"><span data-stu-id="7b31a-211">Read/Write Matrix</span></span>||<span data-ttu-id="7b31a-212">Да</span><span class="sxs-lookup"><span data-stu-id="7b31a-212">Y</span></span>|||<span data-ttu-id="7b31a-213">Да</span><span class="sxs-lookup"><span data-stu-id="7b31a-213">Y</span></span>||
||<span data-ttu-id="7b31a-214">Таблица чтения и записи</span><span class="sxs-lookup"><span data-stu-id="7b31a-214">Read/Write Table</span></span>||<span data-ttu-id="7b31a-215">Да</span><span class="sxs-lookup"><span data-stu-id="7b31a-215">Y</span></span>|||<span data-ttu-id="7b31a-216">Да</span><span class="sxs-lookup"><span data-stu-id="7b31a-216">Y</span></span>||
||<span data-ttu-id="7b31a-217">Чтение и запись HTML</span><span class="sxs-lookup"><span data-stu-id="7b31a-217">Read/Write HTML</span></span>|||||<span data-ttu-id="7b31a-218">Да</span><span class="sxs-lookup"><span data-stu-id="7b31a-218">Y</span></span>||
||<span data-ttu-id="7b31a-219">Чтение и запись</span><span class="sxs-lookup"><span data-stu-id="7b31a-219">Read/Write</span></span><br/><span data-ttu-id="7b31a-220">Office Open XML</span><span class="sxs-lookup"><span data-stu-id="7b31a-220">Office Open XML</span></span>|||||<span data-ttu-id="7b31a-221">Да</span><span class="sxs-lookup"><span data-stu-id="7b31a-221">Y</span></span>||
||<span data-ttu-id="7b31a-222">Чтение свойств задач, ресурсов, представлений и полей</span><span class="sxs-lookup"><span data-stu-id="7b31a-222">Read task, resource, view, and field properties</span></span>||||||<span data-ttu-id="7b31a-223">Да</span><span class="sxs-lookup"><span data-stu-id="7b31a-223">Y</span></span>|
||<span data-ttu-id="7b31a-224">События изменения выделенного фрагмента</span><span class="sxs-lookup"><span data-stu-id="7b31a-224">Selection changed events</span></span>||<span data-ttu-id="7b31a-225">Да</span><span class="sxs-lookup"><span data-stu-id="7b31a-225">Y</span></span>|||<span data-ttu-id="7b31a-226">Да</span><span class="sxs-lookup"><span data-stu-id="7b31a-226">Y</span></span>||
||<span data-ttu-id="7b31a-227">Загрузка всего документа</span><span class="sxs-lookup"><span data-stu-id="7b31a-227">Get whole document</span></span>||||<span data-ttu-id="7b31a-228">Да</span><span class="sxs-lookup"><span data-stu-id="7b31a-228">Y</span></span>|<span data-ttu-id="7b31a-229">Да</span><span class="sxs-lookup"><span data-stu-id="7b31a-229">Y</span></span>||
||<span data-ttu-id="7b31a-230">Привязки и их события</span><span class="sxs-lookup"><span data-stu-id="7b31a-230">Bindings and binding events</span></span>|<span data-ttu-id="7b31a-231">Да</span><span class="sxs-lookup"><span data-stu-id="7b31a-231">Y</span></span><br/><span data-ttu-id="7b31a-232">(только полный и частичные привязки таблиц)</span><span class="sxs-lookup"><span data-stu-id="7b31a-232">(Only full and partial table bindings)</span></span>|<span data-ttu-id="7b31a-233">Да</span><span class="sxs-lookup"><span data-stu-id="7b31a-233">Y</span></span>|||<span data-ttu-id="7b31a-234">Да</span><span class="sxs-lookup"><span data-stu-id="7b31a-234">Y</span></span>||
||<span data-ttu-id="7b31a-235">Чтение и запись настраиваемых частей XML</span><span class="sxs-lookup"><span data-stu-id="7b31a-235">Read/Write Custom XML Parts</span></span>|||||<span data-ttu-id="7b31a-236">Да</span><span class="sxs-lookup"><span data-stu-id="7b31a-236">Y</span></span>||
||<span data-ttu-id="7b31a-237">Сохранение данных состояния надстройки (параметры)</span><span class="sxs-lookup"><span data-stu-id="7b31a-237">Persist add-in state data (settings)</span></span>|<span data-ttu-id="7b31a-238">Да</span><span class="sxs-lookup"><span data-stu-id="7b31a-238">Y</span></span><br/><span data-ttu-id="7b31a-239">(на ведущую надстройку)</span><span class="sxs-lookup"><span data-stu-id="7b31a-239">(Per host add-in)</span></span>|<span data-ttu-id="7b31a-240">Да</span><span class="sxs-lookup"><span data-stu-id="7b31a-240">Y</span></span><br/><span data-ttu-id="7b31a-241">(на документ)</span><span class="sxs-lookup"><span data-stu-id="7b31a-241">(Per document)</span></span>|<span data-ttu-id="7b31a-242">Да</span><span class="sxs-lookup"><span data-stu-id="7b31a-242">Y</span></span><br/><span data-ttu-id="7b31a-243">(на почтовый ящик)</span><span class="sxs-lookup"><span data-stu-id="7b31a-243">(Per mailbox)</span></span>|<span data-ttu-id="7b31a-244">Да</span><span class="sxs-lookup"><span data-stu-id="7b31a-244">Y</span></span><br/><span data-ttu-id="7b31a-245">(на документ)</span><span class="sxs-lookup"><span data-stu-id="7b31a-245">(Per document)</span></span>|<span data-ttu-id="7b31a-246">Да</span><span class="sxs-lookup"><span data-stu-id="7b31a-246">Y</span></span><br/><span data-ttu-id="7b31a-247">(на документ)</span><span class="sxs-lookup"><span data-stu-id="7b31a-247">(Per document)</span></span>||
||<span data-ttu-id="7b31a-248">События изменения параметров</span><span class="sxs-lookup"><span data-stu-id="7b31a-248">Settings changed events</span></span>|<span data-ttu-id="7b31a-249">Да</span><span class="sxs-lookup"><span data-stu-id="7b31a-249">Y</span></span>|<span data-ttu-id="7b31a-250">Да</span><span class="sxs-lookup"><span data-stu-id="7b31a-250">Y</span></span>||<span data-ttu-id="7b31a-251">Да</span><span class="sxs-lookup"><span data-stu-id="7b31a-251">Y</span></span>|<span data-ttu-id="7b31a-252">Да</span><span class="sxs-lookup"><span data-stu-id="7b31a-252">Y</span></span>||
||<span data-ttu-id="7b31a-253">События получения активного режима просмотра</span><span class="sxs-lookup"><span data-stu-id="7b31a-253">Get active view mode</span></span><br/><span data-ttu-id="7b31a-254">и изменения представления</span><span class="sxs-lookup"><span data-stu-id="7b31a-254">and view changed events</span></span>||||<span data-ttu-id="7b31a-255">Да</span><span class="sxs-lookup"><span data-stu-id="7b31a-255">Y</span></span>|||
||<span data-ttu-id="7b31a-256">Переход к расположениям</span><span class="sxs-lookup"><span data-stu-id="7b31a-256">Navigate to locations</span></span><br/><span data-ttu-id="7b31a-257">в документе</span><span class="sxs-lookup"><span data-stu-id="7b31a-257">in the document</span></span>||<span data-ttu-id="7b31a-258">Да</span><span class="sxs-lookup"><span data-stu-id="7b31a-258">Y</span></span>||<span data-ttu-id="7b31a-259">Да</span><span class="sxs-lookup"><span data-stu-id="7b31a-259">Y</span></span>|<span data-ttu-id="7b31a-260">Да</span><span class="sxs-lookup"><span data-stu-id="7b31a-260">Y</span></span>||
||<span data-ttu-id="7b31a-261">Активация в зависимости от контекста</span><span class="sxs-lookup"><span data-stu-id="7b31a-261">Activate contextually</span></span><br/><span data-ttu-id="7b31a-262">с помощью правил и RegEx</span><span class="sxs-lookup"><span data-stu-id="7b31a-262">using rules and RegEx</span></span>|||<span data-ttu-id="7b31a-263">Да</span><span class="sxs-lookup"><span data-stu-id="7b31a-263">Y</span></span>||||
||<span data-ttu-id="7b31a-264">Чтение свойств элемента</span><span class="sxs-lookup"><span data-stu-id="7b31a-264">Read Item properties</span></span>|||<span data-ttu-id="7b31a-265">Да</span><span class="sxs-lookup"><span data-stu-id="7b31a-265">Y</span></span>||||
||<span data-ttu-id="7b31a-266">Чтение профиля пользователя</span><span class="sxs-lookup"><span data-stu-id="7b31a-266">Read User profile</span></span>|||<span data-ttu-id="7b31a-267">Да</span><span class="sxs-lookup"><span data-stu-id="7b31a-267">Y</span></span>||||
||<span data-ttu-id="7b31a-268">Получение вложений</span><span class="sxs-lookup"><span data-stu-id="7b31a-268">Get attachments</span></span>|||<span data-ttu-id="7b31a-269">Да</span><span class="sxs-lookup"><span data-stu-id="7b31a-269">Y</span></span>||||
||<span data-ttu-id="7b31a-270">Получение токена удостоверения пользователя</span><span class="sxs-lookup"><span data-stu-id="7b31a-270">Get User identity token</span></span>|||<span data-ttu-id="7b31a-271">Да</span><span class="sxs-lookup"><span data-stu-id="7b31a-271">Y</span></span>||||
||<span data-ttu-id="7b31a-272">Вызов веб-служб Exchange</span><span class="sxs-lookup"><span data-stu-id="7b31a-272">Call Exchange Web Services</span></span>|||<span data-ttu-id="7b31a-273">Да</span><span class="sxs-lookup"><span data-stu-id="7b31a-273">Y</span></span>||||
