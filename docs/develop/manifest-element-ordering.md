---
title: Как определить правильный порядок элементов манифеста
description: Узнайте, как определить правильный порядок расположения дочерних элементов в родительском элементе.
ms.date: 11/16/2018
ms.openlocfilehash: 6627a32b8a29bc8b0aa12550a61f43295713ecdb
ms.sourcegitcommit: 3e84d616e69f39eeeeea773f2431e7d674c4a9f5
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/22/2018
ms.locfileid: "26649877"
---
# <a name="how-to-find-the-proper-order-of-manifest-elements"></a>Как определить правильный порядок элементов манифеста

XML-элементы в манифесте надстройки Office должны располагаться под правильным родительском элементом *и* в определенном порядке относительно друг друга под родительским элементом.

Нужный порядок указывается в XSD-файлах в папке [Schemas](https://github.com/OfficeDev/office-js-docs-pr/tree/master/docs/overview/schemas). XSD-файлы упорядочены в подпапках для области задач, контента и почтовых надстроек.

Например, в элементе `<OfficeApp>` элементы `<Id>`, `<Version>`, `<ProviderName>` должны располагаться в указанном порядке. Если добавляется элемент `<AlternateId>`, он должен размещаться между элементами `<Id>` и `<Version>`. Ваш манифест будет недопустимым и надстройка не загрузится, если любой из элементов находится в неправильном порядке.

> [!NOTE]
> В [средстве проверки надстроек Office](/office/dev/add-ins/testing/troubleshoot-manifest?branch=manifest-element-ordering#validate-your-manifest-with-the-office-add-in-validator) используется одинаковое сообщение об ошибке, если элемент находится в неправильном порядке и если элемент находится под неправильным родительским элементом. В сообщении об ошибке указывается, что для родительского элемента этот дочерний элемент не является допустимым. Если появляется такая ошибка, но при этом в справочной документации указано, что дочерний элемент *является* допустимым для родительского, значит проблема вероятно связана с тем, что дочерний элемент помещен в неправильном порядке.

Чтобы определить правильный порядок дочерних элементов заданного родительского элемента, выполните указанные ниже действия. (Это упрощенный процесс, так как XSD-файлы являются весьма сложными. Полный разбор XSD файлов в этом документе не рассматривается).

1. Откройте вложенную папку в папке [Schemas](https://github.com/OfficeDev/office-js-docs-pr/tree/master/docs/overview/schemas) для типа создаваемой надстройки. 
2. Откройте XSD-файл, в котором тип родительского элемента определен как сложный. Если вы не знаете, какой файл содержит такое определение, может потребоваться выполнение действия 3 с несколькими файлами, пока вы его не найдете.
3. Выполните поиск `<xs:complexType name="PARENT_ELEMENT">`, где PARENT_ELEMENT — это имя родительского элемента.
4. Внутри определения для PARENT_ELEMENT обычно есть элемент с именем `<xs:sequence>`. Ниже приведено определение для `<SuperTip>` из файла [TaskPaneAppVersionOverridesV1_0.xsd](https://raw.githubusercontent.com/OfficeDev/office-js-docs-pr/master/docs/overview/schemas/taskpane/TaskPaneAppVersionOverridesV1_0.xsd).

```xml
  <xs:complexType name="Supertip">
    <xs:annotation>
      <xs:documentation>
        Specifies the super tip for this control.
      </xs:documentation>
    </xs:annotation>
    <xs:sequence>
      <xs:element name="Title" type="bt:ShortResourceReference" minOccurs="1" maxOccurs="1" />
      <xs:element name="Description" type="bt:LongResourceReference" minOccurs="1" maxOccurs="1" />
    </xs:sequence>
  </xs:complexType>
```

Элемент `<xs:sequence>` перечисляет возможные дочерние элементы *в том порядке, в котором они должны располагаться*. Это *не* означает, что все они являются обязательными. Если значение `minOccurs` для дочернего элемента равно **0**, дочерний элемент является необязательным. *Но при его наличии он должен располагаться в порядке, указываемом элементом `<xs:sequence>`*.

Если элемент `<xs:sequence>` отсутствует или он *имеется*, но в нем не указан нужный дочерний элемент (даже если в справочной документации указано, что дочерний элемент *является* допустимым для родительского), значит определение сложного типа родительского элемента расширено дополнительными дочерними элементами в другом месте XSD-файла. Например, в определении для сложного типа `OfficeApp` не указан элемент `Requirements` в качестве возможного дочернего элемента. Но ниже в файле (в определении для сложного типа `TaskPaneApp`) определение `OfficeApp` расширяется и добавляется `Requirements` в качестве дополнительного допустимого дочернего элемента.

Чтобы найти расширенные определения, выполните указанные ниже действия.

1. Начиная сверху файла, выполните поиск `<xs:extension base="PARENT_ELEMENT">`, где PARENT_ELEMENT — это имя родительского элемента. Может иметься несколько расширений.
2. Найдите расширение, соответствующее контексту, в котором вы работаете. Например, сложный тип `OfficeApp` расширяется в сложных типах `ContentApp` и `MailApp`, а также в сложном типе `TaskPaneApp`.

У каждого элемента `<xs:extension base="PARENT_ELEMENT">` в файле есть собственный элемент `<xs:sequence>`, в котором перечислены дополнительные допустимые дочерние элементы для родительского элемента. В определении сложного типа родительского элемента дочерние элементы из расширенного списка всегда должны располагаться *после* дочерних элементов исходного списка.

## <a name="see-also"></a>См. также

- [Справочник по схеме для манифестов надстроек Office (версия 1.1)](../develop/add-in-manifests.md)
