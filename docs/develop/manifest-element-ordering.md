---
title: Как определить правильный порядок элементов манифеста
description: Узнайте, как определить правильный порядок расположения дочерних элементов в родительском элементе.
ms.date: 11/16/2018
ms.openlocfilehash: 3efc95926b7562b0e68bbb6f4b13c47cc4ae6824
ms.sourcegitcommit: 3d8454055ba4d7aae12f335def97357dea5beb30
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/14/2018
ms.locfileid: "27270616"
---
# <a name="how-to-find-the-proper-order-of-manifest-elements"></a><span data-ttu-id="c36c0-103">Как определить правильный порядок элементов манифеста</span><span class="sxs-lookup"><span data-stu-id="c36c0-103">How to find the proper order of manifest elements</span></span>

<span data-ttu-id="c36c0-104">XML-элементы в манифесте надстройки Office должны располагаться под правильным родительском элементом *и* в определенном порядке относительно друг друга под родительским элементом.</span><span class="sxs-lookup"><span data-stu-id="c36c0-104">The XML elements in the manifest of an Office Add-in must be under the proper parent element *and* in a specific order, relative to each other, under the parent.</span></span>

<span data-ttu-id="c36c0-105">Нужный порядок указывается в XSD-файлах в папке [Schemas](https://github.com/OfficeDev/office-js-docs-pr/tree/master/docs/overview/schemas).</span><span class="sxs-lookup"><span data-stu-id="c36c0-105">The required ordering is specified in the XSD files in the [Schemas](https://github.com/OfficeDev/office-js-docs-pr/tree/master/docs/overview/schemas) folder.</span></span> <span data-ttu-id="c36c0-106">XSD-файлы упорядочены в подпапках для области задач, контента и почтовых надстроек.</span><span class="sxs-lookup"><span data-stu-id="c36c0-106">The XSD files are categorized into subfolders for taskpane, content, and mail add-ins.</span></span>

<span data-ttu-id="c36c0-107">Например, в элементе `<OfficeApp>` элементы `<Id>`, `<Version>`, `<ProviderName>` должны располагаться в указанном порядке.</span><span class="sxs-lookup"><span data-stu-id="c36c0-107">For example, In the `<OfficeApp>` element, the `<Id>`, `<Version>`, `<ProviderName>` must appear in that order.</span></span> <span data-ttu-id="c36c0-108">Если добавляется элемент `<AlternateId>`, он должен размещаться между элементами `<Id>` и `<Version>`.</span><span class="sxs-lookup"><span data-stu-id="c36c0-108">If an `<AlternateId>` element is added, it must be between the `<Id>` and `<Version>` element.</span></span> <span data-ttu-id="c36c0-109">Ваш манифест будет недопустимым и надстройка не загрузится, если любой из элементов находится в неправильном порядке.</span><span class="sxs-lookup"><span data-stu-id="c36c0-109">Your manifest will not be valid and your add-in will not load, if any element is in the wrong order.</span></span>

> [!NOTE]
> <span data-ttu-id="c36c0-110">В [средстве проверки надстроек Office](/office/dev/add-ins/testing/troubleshoot-manifest#validate-your-manifest-with-the-office-add-in-validator) используется одинаковое сообщение об ошибке, если элемент находится в неправильном порядке и если элемент находится под неправильным родительским элементом.</span><span class="sxs-lookup"><span data-stu-id="c36c0-110">The [Office Add-in Validator](/office/dev/add-ins/testing/troubleshoot-manifest#validate-your-manifest-with-the-office-add-in-validator) uses the same error message when an element is out-of-order as it does when an element is under the wrong parent.</span></span> <span data-ttu-id="c36c0-111">В сообщении об ошибке указывается, что для родительского элемента этот дочерний элемент не является допустимым.</span><span class="sxs-lookup"><span data-stu-id="c36c0-111">The error says the child element is is not a valid child of the parent element.</span></span> <span data-ttu-id="c36c0-112">Если появляется такая ошибка, но при этом в справочной документации указано, что дочерний элемент *является* допустимым для родительского, значит проблема вероятно связана с тем, что дочерний элемент помещен в неправильном порядке.</span><span class="sxs-lookup"><span data-stu-id="c36c0-112">If you get such an error but the reference documentation for the child element indicates that it *is* valid for the parent, then the problem is likely that the child has been placed in the wrong order.</span></span>

<span data-ttu-id="c36c0-113">Чтобы определить правильный порядок дочерних элементов заданного родительского элемента, выполните указанные ниже действия.</span><span class="sxs-lookup"><span data-stu-id="c36c0-113">To find the correct order for the child elements of a given parent element, take the following steps.</span></span> <span data-ttu-id="c36c0-114">(Это упрощенный процесс, так как XSD-файлы являются весьма сложными.</span><span class="sxs-lookup"><span data-stu-id="c36c0-114">(This is a simplified process, as XSD files are quite complex.</span></span> <span data-ttu-id="c36c0-115">Полный разбор XSD файлов в этом документе не рассматривается).</span><span class="sxs-lookup"><span data-stu-id="c36c0-115">Fully parsing XSD files is out of the scope of this document.)</span></span>

1. <span data-ttu-id="c36c0-116">Откройте вложенную папку в папке [Schemas](https://github.com/OfficeDev/office-js-docs-pr/tree/master/docs/overview/schemas) для типа создаваемой надстройки.</span><span class="sxs-lookup"><span data-stu-id="c36c0-116">Open the subfolder under [Schemas](https://github.com/OfficeDev/office-js-docs-pr/tree/master/docs/overview/schemas) for the type of add-in that you are creating.</span></span> 
2. <span data-ttu-id="c36c0-117">Откройте XSD-файл, в котором тип родительского элемента определен как сложный.</span><span class="sxs-lookup"><span data-stu-id="c36c0-117">Open the XSD file where the parent element is defined as a complex type.</span></span> <span data-ttu-id="c36c0-118">Если вы не знаете, какой файл содержит такое определение, может потребоваться выполнение действия 3 с несколькими файлами, пока вы его не найдете.</span><span class="sxs-lookup"><span data-stu-id="c36c0-118">If you don't know which file has the definition, you may have to do step 3 on multiple files until you find it.</span></span>
3. <span data-ttu-id="c36c0-119">Выполните поиск `<xs:complexType name="PARENT_ELEMENT">`, где PARENT_ELEMENT — это имя родительского элемента.</span><span class="sxs-lookup"><span data-stu-id="c36c0-119">Search for `<xs:complexType name="PARENT_ELEMENT">`, where PARENT_ELEMENT is the name of the parent element.</span></span>
4. <span data-ttu-id="c36c0-120">Внутри определения для PARENT_ELEMENT обычно есть элемент с именем `<xs:sequence>`.</span><span class="sxs-lookup"><span data-stu-id="c36c0-120">Inside the definition for the PARENT_ELEMENT, there is (usually) an element called `<xs:sequence>`.</span></span> <span data-ttu-id="c36c0-121">Ниже приведено определение для `<SuperTip>` из файла [TaskPaneAppVersionOverridesV1_0.xsd](https://raw.githubusercontent.com/OfficeDev/office-js-docs-pr/master/docs/overview/schemas/taskpane/TaskPaneAppVersionOverridesV1_0.xsd).</span><span class="sxs-lookup"><span data-stu-id="c36c0-121">The following is the definition for `<SuperTip>` from [TaskPaneAppVersionOverridesV1_0.xsd](https://raw.githubusercontent.com/OfficeDev/office-js-docs-pr/master/docs/overview/schemas/taskpane/TaskPaneAppVersionOverridesV1_0.xsd).</span></span>

```xml
  <xs:complexType name="Supertip">
    <xs:annotation>
      <xs:documentation>
        Specifies the super tip for this control.
      </xs:documentation>
    </xs:annotation>
    <xs:sequence>
      <xs:element name="Title" type="bt:ShortResourceReference" minOccurs="1" maxOccurs="1" />
      <xs:element name="Description" type="bt:LongResourceReference" minOccurs="1" maxOccurs="1" />
    </xs:sequence>
  </xs:complexType>
```

<span data-ttu-id="c36c0-122">Элемент `<xs:sequence>` перечисляет возможные дочерние элементы *в том порядке, в котором они должны располагаться*.</span><span class="sxs-lookup"><span data-stu-id="c36c0-122">The `<xs:sequence>` lists the possible child elements, *in the order in which they must appear*.</span></span> <span data-ttu-id="c36c0-123">Это *не* означает, что все они являются обязательными.</span><span class="sxs-lookup"><span data-stu-id="c36c0-123">This does *not* mean all of them are mandatory.</span></span> <span data-ttu-id="c36c0-124">Если значение `minOccurs` для дочернего элемента равно **0**, дочерний элемент является необязательным.</span><span class="sxs-lookup"><span data-stu-id="c36c0-124">If the `minOccurs` value for a child element is **0**, then the child element is optional.</span></span> <span data-ttu-id="c36c0-125">*Но при его наличии он должен располагаться в порядке, указываемом элементом `<xs:sequence>`*.</span><span class="sxs-lookup"><span data-stu-id="c36c0-125">*But if it is present, it must be in the order specified by the `<xs:sequence>` element*.</span></span>

<span data-ttu-id="c36c0-126">Если элемент `<xs:sequence>` отсутствует или он *имеется*, но в нем не указан нужный дочерний элемент (даже если в справочной документации указано, что дочерний элемент *является* допустимым для родительского), значит определение сложного типа родительского элемента расширено дополнительными дочерними элементами в другом месте XSD-файла.</span><span class="sxs-lookup"><span data-stu-id="c36c0-126">If there is no `<xs:sequence>` element, or there *is* but the child element is not listed (even though the reference documentation for the child element indicates that it *is* valid for the parent); then the parent element's complex type definition has been extended with additional child elements somewhere else in the XSD file.</span></span> <span data-ttu-id="c36c0-127">Например, в определении для сложного типа `OfficeApp` не указан элемент `Requirements` в качестве возможного дочернего элемента.</span><span class="sxs-lookup"><span data-stu-id="c36c0-127">For example, the definition for the `OfficeApp` complex type does not list `Requirements` as a possible child.</span></span> <span data-ttu-id="c36c0-128">Но ниже в файле (в определении для сложного типа `TaskPaneApp`) определение `OfficeApp` расширяется и добавляется `Requirements` в качестве дополнительного допустимого дочернего элемента.</span><span class="sxs-lookup"><span data-stu-id="c36c0-128">But later in the file (within the definition for the `TaskPaneApp` complex type), the definition of `OfficeApp` is extended and `Requirements` is added as an additional valid child.</span></span>

<span data-ttu-id="c36c0-129">Чтобы найти расширенные определения, выполните указанные ниже действия.</span><span class="sxs-lookup"><span data-stu-id="c36c0-129">To find the extended definitions follow these steps:</span></span>

1. <span data-ttu-id="c36c0-130">Начиная сверху файла, выполните поиск `<xs:extension base="PARENT_ELEMENT">`, где PARENT_ELEMENT — это имя родительского элемента.</span><span class="sxs-lookup"><span data-stu-id="c36c0-130">Starting at the top of the file, search for `<xs:extension base="PARENT_ELEMENT">`, where PARENT_ELEMENT is the name of the parent element.</span></span> <span data-ttu-id="c36c0-131">Может иметься несколько расширений.</span><span class="sxs-lookup"><span data-stu-id="c36c0-131">There may be more than one extension.</span></span>
2. <span data-ttu-id="c36c0-132">Найдите расширение, соответствующее контексту, в котором вы работаете.</span><span class="sxs-lookup"><span data-stu-id="c36c0-132">Find the extension that is relevant to the context in which you are working.</span></span> <span data-ttu-id="c36c0-133">Например, сложный тип `OfficeApp` расширяется в сложных типах `ContentApp` и `MailApp`, а также в сложном типе `TaskPaneApp`.</span><span class="sxs-lookup"><span data-stu-id="c36c0-133">For example, the `OfficeApp` complex type is extended within the `ContentApp` and `MailApp` complex types as well as within the `TaskPaneApp` complex type.</span></span>

<span data-ttu-id="c36c0-134">У каждого элемента `<xs:extension base="PARENT_ELEMENT">` в файле есть собственный элемент `<xs:sequence>`, в котором перечислены дополнительные допустимые дочерние элементы для родительского элемента.</span><span class="sxs-lookup"><span data-stu-id="c36c0-134">Each `<xs:extension base="PARENT_ELEMENT">` in the file has its own `<xs:sequence>` that lists additional valid child elements for the parent.</span></span> <span data-ttu-id="c36c0-135">В определении сложного типа родительского элемента дочерние элементы из расширенного списка всегда должны располагаться *после* дочерних элементов исходного списка.</span><span class="sxs-lookup"><span data-stu-id="c36c0-135">Child elements on an extended list must always be *after* the child elements in the original list in the parent's complex type definition.</span></span>

## <a name="see-also"></a><span data-ttu-id="c36c0-136">См. также</span><span class="sxs-lookup"><span data-stu-id="c36c0-136">See also</span></span>

- [<span data-ttu-id="c36c0-137">Справочник по схеме для манифестов надстроек Office (версия 1.1)</span><span class="sxs-lookup"><span data-stu-id="c36c0-137">Schema reference for Office Add-ins manifests (v1.1)</span></span>](../develop/add-in-manifests.md)
