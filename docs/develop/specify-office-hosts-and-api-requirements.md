---
title: Указание ведущих приложений Office и требований к API
description: Узнайте, как указать требования к приложениям Office и API для вашей надстройки, чтобы работать так, как ожидалось.
ms.date: 04/20/2021
localization_priority: Normal
ms.openlocfilehash: 0b0bd433a0b731437588b83cba0b37052babf2c1
ms.sourcegitcommit: 691fa338029c9cbd9a7194d163f390c3321a0cd8
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2021
ms.locfileid: "51959161"
---
# <a name="specify-office-applications-and-api-requirements"></a><span data-ttu-id="1e94e-103">Указание приложений Office и требований API</span><span class="sxs-lookup"><span data-stu-id="1e94e-103">Specify Office applications and API requirements</span></span>

<span data-ttu-id="1e94e-104">Ваша надстройка Office может зависеть от конкретного приложения Office, набора требований, члена API или версии API, чтобы работать так, как ожидалось.</span><span class="sxs-lookup"><span data-stu-id="1e94e-104">Your Office Add-in might depend on a specific Office application, a requirement set, an API member, or a version of the API in order to work as expected.</span></span> <span data-ttu-id="1e94e-105">Например, надстройка может:</span><span class="sxs-lookup"><span data-stu-id="1e94e-105">For example, your add-in might:</span></span>

- <span data-ttu-id="1e94e-106">работать в одном (например, Word или Excel) или нескольких приложениях Office;</span><span class="sxs-lookup"><span data-stu-id="1e94e-106">Run in a single Office application (e.g., Word or Excel), or several applications.</span></span>

- <span data-ttu-id="1e94e-p102">использовать API JavaScript, доступные только в некоторых версиях Office. Например, можно создать надстройку Excel 2016 на базе новых API JavaScript для Excel;</span><span class="sxs-lookup"><span data-stu-id="1e94e-p102">Make use of JavaScript APIs that are only available in some versions of Office. For example, you might use the Excel JavaScript APIs in an add-in that runs in Excel 2016.</span></span>

- <span data-ttu-id="1e94e-109">работать только в версиях Office, которые поддерживают элементы API, используемые вашей надстройкой.</span><span class="sxs-lookup"><span data-stu-id="1e94e-109">Run only in versions of Office that support API members that your add-in uses.</span></span>

<span data-ttu-id="1e94e-110">Эта статья поможет вам разобраться, какие параметры следует выбрать для правильной работы надстройки и максимального охвата аудитории.</span><span class="sxs-lookup"><span data-stu-id="1e94e-110">This article helps you understand which options you should choose to ensure that your add-in works as expected and reaches the broadest audience possible.</span></span>

> [!NOTE]
> <span data-ttu-id="1e94e-111">Чтобы просмотреть, где в настоящее время поддерживаются надстройки Office, см. в странице Клиентские приложения Office и доступность платформы для [надстройок Office.](../overview/office-add-in-availability.md)</span><span class="sxs-lookup"><span data-stu-id="1e94e-111">For a high-level view of where Office Add-ins are currently supported, see the [Office client application and platform availability for Office Add-ins](../overview/office-add-in-availability.md) page.</span></span>

<span data-ttu-id="1e94e-112">В таблице ниже перечислены основные понятия, рассматриваемые в этой статье.</span><span class="sxs-lookup"><span data-stu-id="1e94e-112">The following table lists core concepts discussed throughout this article.</span></span>

|<span data-ttu-id="1e94e-113">**Концепция**</span><span class="sxs-lookup"><span data-stu-id="1e94e-113">**Concept**</span></span>|<span data-ttu-id="1e94e-114">**Описание**</span><span class="sxs-lookup"><span data-stu-id="1e94e-114">**Description**</span></span>|
|:-----|:-----|
|<span data-ttu-id="1e94e-115">Приложение Office, клиентская заявка Office</span><span class="sxs-lookup"><span data-stu-id="1e94e-115">Office application, Office client application</span></span>|<span data-ttu-id="1e94e-p103">Приложение Office, используемое для запуска надстройки, например Word, Excel и т. д.</span><span class="sxs-lookup"><span data-stu-id="1e94e-p103">The Office application used to run your add-in. For example, Word, Excel, and so on.</span></span>|
|<span data-ttu-id="1e94e-118">Платформа</span><span class="sxs-lookup"><span data-stu-id="1e94e-118">Platform</span></span>|<span data-ttu-id="1e94e-119">Где работает приложение Office, например в браузере или на iPad.</span><span class="sxs-lookup"><span data-stu-id="1e94e-119">Where the Office application runs, such as in a browser or on an iPad.</span></span>|
|<span data-ttu-id="1e94e-120">Набор обязательных элементов</span><span class="sxs-lookup"><span data-stu-id="1e94e-120">Requirement set</span></span>|<span data-ttu-id="1e94e-121">Именованная группа связанных элементов API.</span><span class="sxs-lookup"><span data-stu-id="1e94e-121">A named group of related API members.</span></span> <span data-ttu-id="1e94e-122">Надстройки используют наборы требований, чтобы определить, поддерживает ли приложение Office членов API, используемых вашей надстройки.</span><span class="sxs-lookup"><span data-stu-id="1e94e-122">Add-ins use requirement sets to determine whether the Office application supports API members used by your add-in.</span></span> <span data-ttu-id="1e94e-123">Проще проверять поддержку набора требований, а не отдельных элементов API.</span><span class="sxs-lookup"><span data-stu-id="1e94e-123">It's easier to test for the support of a requirement set than for the support of individual API members.</span></span> <span data-ttu-id="1e94e-124">Поддержка набора требований зависит от приложения Office и версии приложения Office.</span><span class="sxs-lookup"><span data-stu-id="1e94e-124">Requirement set support varies by Office application and the version of the Office application.</span></span> <br ><span data-ttu-id="1e94e-125">Наборы обязательных элементов указываются в файле манифеста.</span><span class="sxs-lookup"><span data-stu-id="1e94e-125">Requirement sets are specified in the manifest file.</span></span> <span data-ttu-id="1e94e-126">При указании наборов требований в манифесте устанавливается минимальный уровень поддержки API, который должно предоставить приложение Office для запуска надстройки.</span><span class="sxs-lookup"><span data-stu-id="1e94e-126">When you specify requirement sets in the manifest, you set the minimum level of API support that the Office application must provide in order to run your add-in.</span></span> <span data-ttu-id="1e94e-127">Приложения Office, которые не поддерживают наборы требований, указанные в манифесте, не могут запустить надстройку, а ваша надстройка не будет отображаться в <span class="ui">моих надстройких.</span> Это ограничивает доступ к надстройки.</span><span class="sxs-lookup"><span data-stu-id="1e94e-127">Office applications that don't support requirement sets specified in the manifest can't run your add-in, and your add-in won't display in <span class="ui">My Add-ins</span>. This restricts where your add-in is available.</span></span> <span data-ttu-id="1e94e-128">в коде с помощью проверок в среде выполнения.</span><span class="sxs-lookup"><span data-stu-id="1e94e-128">In code using runtime checks.</span></span> <span data-ttu-id="1e94e-129">Полный список наборов требований см. в статье [Наборы обязательных элементов для надстроек Office](../reference/requirement-sets/office-add-in-requirement-sets.md).</span><span class="sxs-lookup"><span data-stu-id="1e94e-129">For the complete list of requirement sets, see [Office Add-in requirement sets](../reference/requirement-sets/office-add-in-requirement-sets.md).</span></span>|
|<span data-ttu-id="1e94e-130">Проверка в среде выполнения</span><span class="sxs-lookup"><span data-stu-id="1e94e-130">Runtime check</span></span>|<span data-ttu-id="1e94e-131">Тест, выполняемый во время выполнения, чтобы определить, поддерживает ли приложение Office, которое поддерживает наборы требований или методы, используемые вашей надстройки.</span><span class="sxs-lookup"><span data-stu-id="1e94e-131">A test that is performed at runtime to determine whether the Office application running your add-in supports requirement sets or methods used by your add-in.</span></span> <span data-ttu-id="1e94e-132">Для выполнения проверки времени выполнения используется утверждение **if** с методом, наборами требований или именами методов, которые не являются `isSetSupported` частью набора требований.</span><span class="sxs-lookup"><span data-stu-id="1e94e-132">To perform a runtime check, you use an **if** statement with the `isSetSupported` method, the requirement sets, or the method names that aren't part of a requirement set.</span></span> <span data-ttu-id="1e94e-133">Проверки в среде выполнения позволяют максимально расширить аудиторию надстройки.</span><span class="sxs-lookup"><span data-stu-id="1e94e-133">Use runtime checks to ensure that your add-in reaches the broadest number of customers.</span></span> <span data-ttu-id="1e94e-134">В отличие от наборов требований проверки времени запуска не указывают минимальный уровень поддержки API, который приложение Office должно предоставить для запуска надстройки.</span><span class="sxs-lookup"><span data-stu-id="1e94e-134">Unlike requirement sets, runtime checks don't specify the minimum level of API support that the Office application must provide for your add-in to run.</span></span> <span data-ttu-id="1e94e-135">Вместо этого вы используете **утверждение if,** чтобы определить, поддерживается ли член API.</span><span class="sxs-lookup"><span data-stu-id="1e94e-135">Instead, you use the **if** statement to determine whether an API member is supported.</span></span> <span data-ttu-id="1e94e-136">и если это так, добавляете в надстройку дополнительные функции.</span><span class="sxs-lookup"><span data-stu-id="1e94e-136">If it is, you can provide additional functionality in your add-in.</span></span> <span data-ttu-id="1e94e-137">Если вы используете проверки в среде выполнения, ваша надстройка всегда будет отображаться в разделе **Мои надстройки**.</span><span class="sxs-lookup"><span data-stu-id="1e94e-137">Your add-in will always display in **My Add-ins** when you use runtime checks.</span></span>|

## <a name="before-you-begin"></a><span data-ttu-id="1e94e-138">Подготовка</span><span class="sxs-lookup"><span data-stu-id="1e94e-138">Before you begin</span></span>

<span data-ttu-id="1e94e-139">Надстройка должна использовать последнюю версию схемы манифеста надстройки.</span><span class="sxs-lookup"><span data-stu-id="1e94e-139">Your add-in must use the most current version of the add-in manifest schema.</span></span> <span data-ttu-id="1e94e-140">При использовании проверок времени работы надстройки убедитесь, что вы используете последнюю библиотеку API JavaScript Office (office.js).</span><span class="sxs-lookup"><span data-stu-id="1e94e-140">If you use runtime checks in your add-in, ensure that you use the latest Office JavaScript API (office.js) library.</span></span>

### <a name="specify-the-latest-add-in-manifest-schema"></a><span data-ttu-id="1e94e-141">Выбор последней версии схема манифестов надстроек</span><span class="sxs-lookup"><span data-stu-id="1e94e-141">Specify the latest add-in manifest schema</span></span>

<span data-ttu-id="1e94e-142">Ваша надстройка должна использовать схему манифеста 1.1.</span><span class="sxs-lookup"><span data-stu-id="1e94e-142">Your add-in's manifest must use version 1.1 of the add-in manifest schema.</span></span> <span data-ttu-id="1e94e-143">Установите элемент [OfficeApp](../reference/manifest/officeapp.md) в манифесте надстройки следующим образом.</span><span class="sxs-lookup"><span data-stu-id="1e94e-143">Set the [OfficeApp](../reference/manifest/officeapp.md) element in your add-in manifest as follows.</span></span> <span data-ttu-id="1e94e-144">В этом примере показан `TaskPaneApp` тип.</span><span class="sxs-lookup"><span data-stu-id="1e94e-144">This example shows the `TaskPaneApp` type.</span></span>

```XML
<OfficeApp xmlns="http://schemas.microsoft.com/office/appforoffice/1.1" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="TaskPaneApp">
```

### <a name="specify-the-latest-office-javascript-api-library"></a><span data-ttu-id="1e94e-145">Укажите последнюю библиотеку API JavaScript Office</span><span class="sxs-lookup"><span data-stu-id="1e94e-145">Specify the latest Office JavaScript API library</span></span>

<span data-ttu-id="1e94e-146">Если вы используете проверки времени работы, ссылайся на наиболее текущую версию библиотеки API JavaScript Office из сети доставки контента (CDN).</span><span class="sxs-lookup"><span data-stu-id="1e94e-146">If you use runtime checks, reference the most current version of the Office JavaScript API library from the content delivery network (CDN).</span></span> <span data-ttu-id="1e94e-147">Для этого добавьте указанный ниже тег `script` в HTML-код.</span><span class="sxs-lookup"><span data-stu-id="1e94e-147">To do this, add the following  `script` tag to your HTML.</span></span> <span data-ttu-id="1e94e-148">Чтобы всегда ссылаться на последнюю версию файла Office.js, используйте `/1/` в URL-адресе сети доставки содержимого.</span><span class="sxs-lookup"><span data-stu-id="1e94e-148">Using `/1/` in the CDN URL ensures that you reference the most recent version of Office.js.</span></span>

```HTML
<script src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js" type="text/javascript"></script>
```

## <a name="options-to-specify-office-applications-or-api-requirements"></a><span data-ttu-id="1e94e-149">Параметры для указания требований к приложениям Office или API</span><span class="sxs-lookup"><span data-stu-id="1e94e-149">Options to specify Office applications or API requirements</span></span>

<span data-ttu-id="1e94e-150">При указании приложений Office или требований API необходимо учитывать несколько факторов.</span><span class="sxs-lookup"><span data-stu-id="1e94e-150">When you specify Office applications or API requirements, there are several factors to consider.</span></span> <span data-ttu-id="1e94e-151">На следующей схеме показано, как выбрать правильный метод для надстройки.</span><span class="sxs-lookup"><span data-stu-id="1e94e-151">The following diagram shows how to decide which technique to use in your add-in.</span></span>

![Выберите оптимальный вариант для надстройки при указании приложений Office или требований API](../images/options-for-office-hosts.png)

- <span data-ttu-id="1e94e-153">Если надстройка работает в одном приложении Office, установите `Hosts` элемент манифеста.</span><span class="sxs-lookup"><span data-stu-id="1e94e-153">If your add-in runs in one Office application, set the `Hosts` element in the manifest.</span></span> <span data-ttu-id="1e94e-154">Дополнительные сведения см. в разделе [Задание элемента Hosts](#set-the-hosts-element).</span><span class="sxs-lookup"><span data-stu-id="1e94e-154">For more information, see [Set the Hosts element](#set-the-hosts-element).</span></span>

- <span data-ttu-id="1e94e-155">Чтобы установить минимальный набор требований или членов API, которые приложение Office должно поддерживать для запуска надстройки, установите элемент `Requirements` манифеста.</span><span class="sxs-lookup"><span data-stu-id="1e94e-155">To set the minimum requirement set or API members that an Office application must support to run your add-in, set the `Requirements` element in the manifest.</span></span> <span data-ttu-id="1e94e-156">Дополнительные сведения см. [в элементе Set the Requirements in the manifest.](#set-the-requirements-element-in-the-manifest)</span><span class="sxs-lookup"><span data-stu-id="1e94e-156">For more information, see [Set the Requirements element in the manifest](#set-the-requirements-element-in-the-manifest).</span></span>

- <span data-ttu-id="1e94e-157">Если вы хотите предоставить дополнительные функции, если в приложении Office доступны определенные наборы требований или члены API, выполните проверку времени выполнения в коде JavaScript надстройки.</span><span class="sxs-lookup"><span data-stu-id="1e94e-157">If you would like to provide additional functionality if specific requirement sets or API members are available in the Office application, perform a runtime check in your add-in's JavaScript code.</span></span> <span data-ttu-id="1e94e-158">Например, если надстройка выполняется в Excel 2016, используйте элементы нового API JavaScript для Excel, чтобы предоставить дополнительные функции.</span><span class="sxs-lookup"><span data-stu-id="1e94e-158">For example, if your add-in runs in Excel 2016, use API members from the Excel JavaScript API to provide additional functionality.</span></span> <span data-ttu-id="1e94e-159">Дополнительные сведения см. в разделе [Использование проверок в среде выполнения в коде JavaScript](#use-runtime-checks-in-your-javascript-code).</span><span class="sxs-lookup"><span data-stu-id="1e94e-159">For more information, see [Use runtime checks in your JavaScript code](#use-runtime-checks-in-your-javascript-code).</span></span>

## <a name="set-the-hosts-element"></a><span data-ttu-id="1e94e-160">Задание элемента Hosts</span><span class="sxs-lookup"><span data-stu-id="1e94e-160">Set the Hosts element</span></span>

<span data-ttu-id="1e94e-161">Чтобы выполнить надстройку в одном клиентном приложении Office, используйте элементы `Hosts` `Host` и элементы манифеста.</span><span class="sxs-lookup"><span data-stu-id="1e94e-161">To make your add-in run in one Office client application, use the `Hosts` and `Host` elements in the manifest.</span></span> <span data-ttu-id="1e94e-162">Если элемент не указан, надстройка будет работать во всех приложениях Office, поддерживаемых указанным типом `Hosts` `OfficeApp` (например, Mail, Task pane или Content).</span><span class="sxs-lookup"><span data-stu-id="1e94e-162">If you don't specify the `Hosts` element, your add-in will run in all Office applications supported by the specified `OfficeApp` type (that is, Mail, Task pane, or Content).</span></span>

<span data-ttu-id="1e94e-163">Например, в следующем и объявлении указывается, что надстройка будет работать с любым выпуском Excel, который включает Excel в `Hosts` `Host` Интернете, Windows и iPad.</span><span class="sxs-lookup"><span data-stu-id="1e94e-163">For example, the following `Hosts` and `Host` declaration specifies that the add-in will work with any release of Excel, which includes Excel on the web, Windows, and iPad.</span></span>

```xml
<Hosts>
  <Host Name="Workbook" />
</Hosts>
```

<span data-ttu-id="1e94e-164">Элемент `Hosts` может содержать один или несколько `Host` элементов.</span><span class="sxs-lookup"><span data-stu-id="1e94e-164">The `Hosts` element can contain one or more `Host` elements.</span></span> <span data-ttu-id="1e94e-165">Элемент `Host` указывает приложение Office, которое требуется для надстройки.</span><span class="sxs-lookup"><span data-stu-id="1e94e-165">The `Host` element specifies the Office application your add-in requires.</span></span> <span data-ttu-id="1e94e-166">Атрибут `Name` необходим и может быть задат одним из следующих значений.</span><span class="sxs-lookup"><span data-stu-id="1e94e-166">The `Name` attribute is required and can be set to one of the following values.</span></span>

| <span data-ttu-id="1e94e-167">Name</span><span class="sxs-lookup"><span data-stu-id="1e94e-167">Name</span></span>          | <span data-ttu-id="1e94e-168">Клиентские приложения Office</span><span class="sxs-lookup"><span data-stu-id="1e94e-168">Office client applications</span></span>                     | <span data-ttu-id="1e94e-169">Доступные типы надстройки</span><span class="sxs-lookup"><span data-stu-id="1e94e-169">Available add-in types</span></span> |
|:--------------|:-----------------------------------------------|:-----------------------|
| <span data-ttu-id="1e94e-170">Database</span><span class="sxs-lookup"><span data-stu-id="1e94e-170">Database</span></span>      | <span data-ttu-id="1e94e-171">Веб-приложения Access</span><span class="sxs-lookup"><span data-stu-id="1e94e-171">Access web apps</span></span>                                | <span data-ttu-id="1e94e-172">Область задач</span><span class="sxs-lookup"><span data-stu-id="1e94e-172">Task pane</span></span>              |
| <span data-ttu-id="1e94e-173">Document</span><span class="sxs-lookup"><span data-stu-id="1e94e-173">Document</span></span>      | <span data-ttu-id="1e94e-174">Word в Интернете, Windows, Mac, iPad</span><span class="sxs-lookup"><span data-stu-id="1e94e-174">Word on the web, Windows, Mac, iPad</span></span>            | <span data-ttu-id="1e94e-175">Область задач</span><span class="sxs-lookup"><span data-stu-id="1e94e-175">Task pane</span></span>              |
| <span data-ttu-id="1e94e-176">MailHost</span><span class="sxs-lookup"><span data-stu-id="1e94e-176">MailHost</span></span>      | <span data-ttu-id="1e94e-177">Outlook в Интернете, Windows, Mac, Android, iOS</span><span class="sxs-lookup"><span data-stu-id="1e94e-177">Outlook on the web, Windows, Mac, Android, iOS</span></span> | <span data-ttu-id="1e94e-178">Почта</span><span class="sxs-lookup"><span data-stu-id="1e94e-178">Mail</span></span>                   |
| <span data-ttu-id="1e94e-179">Notebook</span><span class="sxs-lookup"><span data-stu-id="1e94e-179">Notebook</span></span>      | <span data-ttu-id="1e94e-180">OneNote в Интернете</span><span class="sxs-lookup"><span data-stu-id="1e94e-180">OneNote on the web</span></span>                             | <span data-ttu-id="1e94e-181">Области задач, контент</span><span class="sxs-lookup"><span data-stu-id="1e94e-181">Task pane, Content</span></span>     |
| <span data-ttu-id="1e94e-182">Presentation</span><span class="sxs-lookup"><span data-stu-id="1e94e-182">Presentation</span></span>  | <span data-ttu-id="1e94e-183">PowerPoint в Интернете, Windows, Mac, iPad</span><span class="sxs-lookup"><span data-stu-id="1e94e-183">PowerPoint on the web, Windows, Mac, iPad</span></span>      | <span data-ttu-id="1e94e-184">Области задач, контент</span><span class="sxs-lookup"><span data-stu-id="1e94e-184">Task pane, Content</span></span>     |
| <span data-ttu-id="1e94e-185">Проект</span><span class="sxs-lookup"><span data-stu-id="1e94e-185">Project</span></span>       | <span data-ttu-id="1e94e-186">Project для Windows</span><span class="sxs-lookup"><span data-stu-id="1e94e-186">Project on Windows</span></span>                             | <span data-ttu-id="1e94e-187">Область задач</span><span class="sxs-lookup"><span data-stu-id="1e94e-187">Task pane</span></span>              |
| <span data-ttu-id="1e94e-188">Workbook</span><span class="sxs-lookup"><span data-stu-id="1e94e-188">Workbook</span></span>      | <span data-ttu-id="1e94e-189">Excel в Интернете, Windows, Mac, iPad</span><span class="sxs-lookup"><span data-stu-id="1e94e-189">Excel on the web, Windows, Mac, iPad</span></span>           | <span data-ttu-id="1e94e-190">Области задач, контент</span><span class="sxs-lookup"><span data-stu-id="1e94e-190">Task pane, Content</span></span>     |

> [!NOTE]
> <span data-ttu-id="1e94e-191">Атрибут `Name` указывает клиентскую заявку Office, которая может запустить надстройку.</span><span class="sxs-lookup"><span data-stu-id="1e94e-191">The `Name` attribute specifies the Office client application that can run your add-in.</span></span> <span data-ttu-id="1e94e-192">Приложения Office поддерживаются на разных платформах и запускаются на настольных компьютерах, веб-браузерах, планшетах и мобильных устройствах.</span><span class="sxs-lookup"><span data-stu-id="1e94e-192">Office applications are supported on different platforms and run on desktops, web browsers, tablets, and mobile devices.</span></span> <span data-ttu-id="1e94e-193">Вам не удастся указать, какую платформу можно использовать для запуска надстройки.</span><span class="sxs-lookup"><span data-stu-id="1e94e-193">You can't specify which platform can be used to run your add-in.</span></span> <span data-ttu-id="1e94e-194">Например, если указать, для запуска надстройки можно использовать Outlook как в Интернете, так и в `MailHost` Windows.</span><span class="sxs-lookup"><span data-stu-id="1e94e-194">For example, if you specify `MailHost`, both Outlook on the web and on Windows can be used to run your add-in.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="1e94e-195">Больше не рекомендуется создавать и использовать веб-приложения и базы данных Access в SharePoint.</span><span class="sxs-lookup"><span data-stu-id="1e94e-195">We no longer recommend that you create and use Access web apps and databases in SharePoint.</span></span> <span data-ttu-id="1e94e-196">В качестве альтернативы рекомендуем использовать [Microsoft PowerApps](https://powerapps.microsoft.com/) для создания бизнес-решений для Интернета и мобильных устройств без написания кода.</span><span class="sxs-lookup"><span data-stu-id="1e94e-196">As an alternative, we recommend that you use [Microsoft PowerApps](https://powerapps.microsoft.com/) to build no-code business solutions for web and mobile devices.</span></span>

## <a name="set-the-requirements-element-in-the-manifest"></a><span data-ttu-id="1e94e-197">Указание элемента Requirements в манифесте</span><span class="sxs-lookup"><span data-stu-id="1e94e-197">Set the Requirements element in the manifest</span></span>

<span data-ttu-id="1e94e-198">Элемент указывает минимальные наборы требований или членов API, которые должны поддерживаться приложением Office для `Requirements` запуска надстройки.</span><span class="sxs-lookup"><span data-stu-id="1e94e-198">The `Requirements` element specifies the minimum requirement sets or API members that must be supported by the Office application to run your add-in.</span></span> <span data-ttu-id="1e94e-199">Элемент может указывать как наборы требований, так и `Requirements` отдельные методы, используемые в вашей надстройки.</span><span class="sxs-lookup"><span data-stu-id="1e94e-199">The `Requirements` element can specify both requirement sets and individual methods used in your add-in.</span></span> <span data-ttu-id="1e94e-200">В версии 1.1 схемы манифеста надстройки элемент необязателен для всех надстроек, за исключением `Requirements` надстроек Outlook.</span><span class="sxs-lookup"><span data-stu-id="1e94e-200">In version 1.1 of the add-in manifest schema, the `Requirements` element is optional for all add-ins, except for Outlook add-ins.</span></span>

> [!WARNING]
> <span data-ttu-id="1e94e-201">Только используйте элемент для указания критически важных наборов требований или `Requirements` членов API, которые должна использовать ваша надстройка.</span><span class="sxs-lookup"><span data-stu-id="1e94e-201">Only use the `Requirements` element to specify critical requirement sets or API members that your add-in must use.</span></span> <span data-ttu-id="1e94e-202">Если приложение Или платформа Office не поддерживают наборы требований или членов API, указанных в элементе, надстройка не будет работать в этом приложении или платформе и не будет отображаться в моих `Requirements` надстройких.  Вместо этого рекомендуется сделать надстройки доступными на всех платформах приложения Office, таких как Excel в Интернете, Windows и iPad.</span><span class="sxs-lookup"><span data-stu-id="1e94e-202">If the Office application or platform doesn't support the requirement sets or API members specified in the `Requirements` element, the add-in won't run in that application or platform, and won't display in **My Add-ins**. Instead, we recommend that you make your add-in available on all platforms of an Office application, such as Excel on the web, Windows, and iPad.</span></span> <span data-ttu-id="1e94e-203">Чтобы сделать надстройку доступной для  _всех_ приложений и платформ Office, используйте проверки времени работы вместо `Requirements` элемента.</span><span class="sxs-lookup"><span data-stu-id="1e94e-203">To make your add-in available on  _all_ Office applications and platforms, use runtime checks instead of the `Requirements` element.</span></span>

<span data-ttu-id="1e94e-204">В следующем примере кода показана надстройка, загружаемая во все клиентские приложения Office, поддерживают следующие:</span><span class="sxs-lookup"><span data-stu-id="1e94e-204">The following code example shows an add-in that loads in all Office client applications that support the following:</span></span>

-  <span data-ttu-id="1e94e-205">`TableBindings` набор требований, который имеет минимальную версию "1.1".</span><span class="sxs-lookup"><span data-stu-id="1e94e-205">`TableBindings` requirement set, which has a minimum version of "1.1".</span></span>

-  <span data-ttu-id="1e94e-206">`OOXML` набор требований, который имеет минимальную версию "1.1".</span><span class="sxs-lookup"><span data-stu-id="1e94e-206">`OOXML` requirement set, which has a minimum version of "1.1".</span></span>

-  <span data-ttu-id="1e94e-207">`Document.getSelectedDataAsync` метод.</span><span class="sxs-lookup"><span data-stu-id="1e94e-207">`Document.getSelectedDataAsync` method.</span></span>

```XML
<Requirements>
   <Sets DefaultMinVersion="1.1">
      <Set Name="TableBindings" MinVersion="1.1"/>
      <Set Name="OOXML" MinVersion="1.1"/>
   </Sets>
   <Methods>
      <Method Name="Document.getSelectedDataAsync"/>
   </Methods>
</Requirements>
```

- <span data-ttu-id="1e94e-208">Элемент `Requirements` содержит и `Sets` `Methods` детские элементы.</span><span class="sxs-lookup"><span data-stu-id="1e94e-208">The `Requirements` element contains the `Sets` and `Methods` child elements.</span></span>

- <span data-ttu-id="1e94e-209">Элемент `Sets` может содержать один или несколько `Set` элементов.</span><span class="sxs-lookup"><span data-stu-id="1e94e-209">The `Sets` element can contain one or more `Set` elements.</span></span> <span data-ttu-id="1e94e-210">`DefaultMinVersion` указывает значение `MinVersion` по умолчанию для всех `Set` детских элементов.</span><span class="sxs-lookup"><span data-stu-id="1e94e-210">`DefaultMinVersion` specifies the default `MinVersion` value of all child `Set` elements.</span></span>

- <span data-ttu-id="1e94e-211">Элемент указывает наборы требований, которые приложение Office должно поддерживать для `Set` запуска надстройки.</span><span class="sxs-lookup"><span data-stu-id="1e94e-211">The `Set` element specifies requirement sets that the Office application must support to run the add-in.</span></span> <span data-ttu-id="1e94e-212">Атрибут `Name` указывает имя набора требований.</span><span class="sxs-lookup"><span data-stu-id="1e94e-212">The `Name` attribute specifies the name of the requirement set.</span></span> <span data-ttu-id="1e94e-213">Указывает `MinVersion` минимальную версию набора требований.</span><span class="sxs-lookup"><span data-stu-id="1e94e-213">The `MinVersion` specifies the minimum version of the requirement set.</span></span> <span data-ttu-id="1e94e-214">`MinVersion`переопределяет значение Дополнительные сведения о наборах требований и версиях набора требований, к которые принадлежат члены API, см. в дополнительных наборах `DefaultMinVersion` [требований к надстройки Office.](../reference/requirement-sets/office-add-in-requirement-sets.md)</span><span class="sxs-lookup"><span data-stu-id="1e94e-214">`MinVersion` overrides the value of `DefaultMinVersion` For more information about requirement sets and requirement set versions that your API members belong to, see [Office Add-in requirement sets](../reference/requirement-sets/office-add-in-requirement-sets.md).</span></span>

- <span data-ttu-id="1e94e-215">Элемент `Methods` может содержать один или несколько `Method` элементов.</span><span class="sxs-lookup"><span data-stu-id="1e94e-215">The `Methods` element can contain one or more `Method` elements.</span></span> <span data-ttu-id="1e94e-216">Нельзя использовать элемент с надстройки `Methods` Outlook.</span><span class="sxs-lookup"><span data-stu-id="1e94e-216">You can't use the `Methods` element with Outlook add-ins.</span></span>

- <span data-ttu-id="1e94e-217">Элемент указывает отдельный метод, который должен поддерживаться в приложении Office, где `Method` выполняется надстройка.</span><span class="sxs-lookup"><span data-stu-id="1e94e-217">The `Method` element specifies an individual method that must be supported in the Office application where your add-in runs.</span></span> <span data-ttu-id="1e94e-218">Атрибут необходим и указывает имя метода, квалифицированного с `Name` родительским объектом.</span><span class="sxs-lookup"><span data-stu-id="1e94e-218">The `Name` attribute is required and specifies the name of the method qualified with its parent object.</span></span>

## <a name="use-runtime-checks-in-your-javascript-code"></a><span data-ttu-id="1e94e-219">Использование проверок в среде выполнения в коде JavaScript</span><span class="sxs-lookup"><span data-stu-id="1e94e-219">Use runtime checks in your JavaScript code</span></span>

<span data-ttu-id="1e94e-220">Может потребоваться предоставить дополнительные функции в надстройки, если определенные наборы требований поддерживаются приложением Office.</span><span class="sxs-lookup"><span data-stu-id="1e94e-220">You might want to provide additional functionality in your add-in if certain requirement sets are supported by the Office application.</span></span> <span data-ttu-id="1e94e-221">Например, если надстройка работает в Word 2016, вы можете использовать в ней API JavaScript для Word.</span><span class="sxs-lookup"><span data-stu-id="1e94e-221">For example, you might want to use the Word JavaScript APIs in your existing add-in if your add-in runs in Word 2016.</span></span> <span data-ttu-id="1e94e-222">Для этого используйте метод [isSetSupported](/javascript/api/office/office.requirementsetsupport#issetsupported-name--minversion-) с именем набора обязательных элементов.</span><span class="sxs-lookup"><span data-stu-id="1e94e-222">To do this, you use the [isSetSupported](/javascript/api/office/office.requirementsetsupport#issetsupported-name--minversion-) method with the name of the requirement set.</span></span> <span data-ttu-id="1e94e-223">`isSetSupported` определяет, поддерживает ли приложение Office, которое работает надстройку, набор требований.</span><span class="sxs-lookup"><span data-stu-id="1e94e-223">`isSetSupported` determines, at runtime, whether the Office application running the add-in supports the requirement set.</span></span> <span data-ttu-id="1e94e-224">Если набор требований поддерживается, возвращается true и запускается дополнительный код, `isSetSupported` использующий  членов API из этого набора требований.</span><span class="sxs-lookup"><span data-stu-id="1e94e-224">If the requirement set is supported, `isSetSupported` returns **true** and runs the additional code that uses the API members from that requirement set.</span></span> <span data-ttu-id="1e94e-225">Если приложение Office не поддерживает набор требований, возвращается ложный и дополнительный код `isSetSupported` не будет работать. </span><span class="sxs-lookup"><span data-stu-id="1e94e-225">If the Office application doesn't support the requirement set, `isSetSupported` returns **false** and the additional code won't run.</span></span> <span data-ttu-id="1e94e-226">В следующем коде показан синтаксис для использования с `isSetSupported`.</span><span class="sxs-lookup"><span data-stu-id="1e94e-226">The following code shows the syntax to use with `isSetSupported`.</span></span>

```js
if (Office.context.requirements.isSetSupported(RequirementSetName, MinimumVersion))
{
   // Code that uses API members from RequirementSetName.
}

```

- <span data-ttu-id="1e94e-227">_RequirementSetName_ (обязательный параметр) — это строка, представляющая имя набора обязательных элементов (например, "**ExcelApi**", "**Mailbox**" и т. д.).</span><span class="sxs-lookup"><span data-stu-id="1e94e-227">_RequirementSetName_ (required) is a string that represents the name of the requirement set (e.g., "**ExcelApi**", "**Mailbox**", etc.).</span></span> <span data-ttu-id="1e94e-228">Дополнительные сведения о доступных наборах обязательных элементов см. в статье [Наборы обязательных элементов для надстроек Office](../reference/requirement-sets/office-add-in-requirement-sets.md).</span><span class="sxs-lookup"><span data-stu-id="1e94e-228">For more information about available requirement sets, see [Office Add-in requirement sets](../reference/requirement-sets/office-add-in-requirement-sets.md).</span></span>
- <span data-ttu-id="1e94e-229">_MinimumVersion_ (необязательный) — это строка, которая указывает минимальную версию набора требований, которую приложение Office должно поддерживать для запуска кода в заявлении `if` (например,**"1.9").**</span><span class="sxs-lookup"><span data-stu-id="1e94e-229">_MinimumVersion_ (optional) is a string that specifies the minimum requirement set version that the Office application must support in order for the code within the `if` statement to run (e.g., "**1.9**").</span></span>

> [!WARNING]
> <span data-ttu-id="1e94e-230">При вызове метода значение параметра `isSetSupported` `MinimumVersion` (если указано) должно быть строкой.</span><span class="sxs-lookup"><span data-stu-id="1e94e-230">When calling the `isSetSupported` method, the value of the `MinimumVersion` parameter (if specified) should be a string.</span></span> <span data-ttu-id="1e94e-231">Это обусловлено тем, что средство синтаксического анализа JavaScript не может различить числовые значения, например 1.1 и 1.10, но может различать строковые значения, например "1.1" и "1.10".</span><span class="sxs-lookup"><span data-stu-id="1e94e-231">This is because the JavaScript parser cannot differentiate between numeric values such as 1.1 and 1.10, where as it can for string values such as "1.1" and "1.10".</span></span>
> <span data-ttu-id="1e94e-232">Перегрузка оператора `number` не рекомендуется.</span><span class="sxs-lookup"><span data-stu-id="1e94e-232">The `number` overload is deprecated.</span></span>

<span data-ttu-id="1e94e-233">Используйте `isSetSupported` с связанным с `RequirementSetName` приложением Office следующим образом.</span><span class="sxs-lookup"><span data-stu-id="1e94e-233">Use `isSetSupported` with the `RequirementSetName` associated with the Office application as follows.</span></span>

|<span data-ttu-id="1e94e-234">Приложение Office</span><span class="sxs-lookup"><span data-stu-id="1e94e-234">Office application</span></span>|<span data-ttu-id="1e94e-235">RequirementSetName</span><span class="sxs-lookup"><span data-stu-id="1e94e-235">RequirementSetName</span></span>|
|---|---|
|<span data-ttu-id="1e94e-236">Excel</span><span class="sxs-lookup"><span data-stu-id="1e94e-236">Excel</span></span>|<span data-ttu-id="1e94e-237">ExcelApi</span><span class="sxs-lookup"><span data-stu-id="1e94e-237">ExcelApi</span></span>|
|<span data-ttu-id="1e94e-238">OneNote</span><span class="sxs-lookup"><span data-stu-id="1e94e-238">OneNote</span></span>|<span data-ttu-id="1e94e-239">OneNoteApi</span><span class="sxs-lookup"><span data-stu-id="1e94e-239">OneNoteApi</span></span>|
|<span data-ttu-id="1e94e-240">Outlook</span><span class="sxs-lookup"><span data-stu-id="1e94e-240">Outlook</span></span>|<span data-ttu-id="1e94e-241">Mailbox</span><span class="sxs-lookup"><span data-stu-id="1e94e-241">Mailbox</span></span>|
|<span data-ttu-id="1e94e-242">Word</span><span class="sxs-lookup"><span data-stu-id="1e94e-242">Word</span></span>|<span data-ttu-id="1e94e-243">WordApi</span><span class="sxs-lookup"><span data-stu-id="1e94e-243">WordApi</span></span>|

<span data-ttu-id="1e94e-244">Метод и наборы требований для этих приложений доступны в последнем файле Office.js `isSetSupported` cdN.</span><span class="sxs-lookup"><span data-stu-id="1e94e-244">The `isSetSupported` method and the requirement sets for these applications are available in the latest Office.js file on the CDN.</span></span> <span data-ttu-id="1e94e-245">Если вы не используете Office.js cdN, ваша надстройка может создавать исключения, так как будет `isSetSupported` неопределенна.</span><span class="sxs-lookup"><span data-stu-id="1e94e-245">If you don't use Office.js from the CDN, your add-in might generate exceptions because `isSetSupported` will be undefined.</span></span> <span data-ttu-id="1e94e-246">Дополнительные сведения см. в [выпуске Укажите последнюю библиотеку API JavaScript](#specify-the-latest-office-javascript-api-library)Office.</span><span class="sxs-lookup"><span data-stu-id="1e94e-246">For more information, see [Specify the latest Office JavaScript API library](#specify-the-latest-office-javascript-api-library).</span></span>

<span data-ttu-id="1e94e-247">В следующем примере кода показано, как надстройка может предоставлять различные функциональные возможности для различных приложений Office, которые могут поддерживать различные наборы требований или членов API.</span><span class="sxs-lookup"><span data-stu-id="1e94e-247">The following code example shows how an add-in can provide different functionality for different Office applications that might support different requirement sets or API members.</span></span>

```js
if (Office.context.requirements.isSetSupported('WordApi', '1.1'))
{
    // Run code that provides additional functionality using the Word JavaScript API when the add-in runs in Word 2016 or later.
}
else if (Office.context.requirements.isSetSupported('CustomXmlParts'))
{
    // Run code that uses API members from the CustomXmlParts requirement set.
}
else
{
    // Run additional code when the Office application is not Word 2016 or later and does not support the CustomXmlParts requirement set.
}

```

## <a name="runtime-checks-using-methods-not-in-a-requirement-set"></a><span data-ttu-id="1e94e-248">Проверки в среде выполнения с использованием методов, не входящих в набор обязательных элементов</span><span class="sxs-lookup"><span data-stu-id="1e94e-248">Runtime checks using methods not in a requirement set</span></span>

<span data-ttu-id="1e94e-249">Некоторые элементы API не входят в наборы обязательных элементов.</span><span class="sxs-lookup"><span data-stu-id="1e94e-249">Some API members don't belong to requirement sets.</span></span> <span data-ttu-id="1e94e-250">Это относится только к членам API, которые входят в пространство имен [API](../reference/javascript-api-for-office.md) Office JavaScript (все, кроме API почтовых ящиков Outlook), но не члены API, которые относятся к `Office.` [API Word JavaScript](../reference/overview/word-add-ins-reference-overview.md) (что-либо [](/javascript/api/outlook) `Word.` в), [API JavaScript](../reference/overview/excel-add-ins-reference-overview.md) Excel (все `Excel.` в) или [API JavaScript OneNote](../reference/overview/onenote-add-ins-javascript-reference.md) (все в `OneNote.` ) пространствах имен.</span><span class="sxs-lookup"><span data-stu-id="1e94e-250">This only applies to API members that are part of the [Office JavaScript API](../reference/javascript-api-for-office.md) namespace (anything under `Office.` except [Outlook Mailbox APIs](/javascript/api/outlook)), but not API members that belong to the [Word JavaScript API](../reference/overview/word-add-ins-reference-overview.md) (anything in `Word.`), [Excel JavaScript API](../reference/overview/excel-add-ins-reference-overview.md) (anything in `Excel.`), or [OneNote JavaScript API](../reference/overview/onenote-add-ins-javascript-reference.md) (anything in `OneNote.`) namespaces.</span></span> <span data-ttu-id="1e94e-251">Если надстройка зависит от метода, который не входит в набор требований, вы можете использовать проверку времени работы, чтобы определить, поддерживается ли метод приложением Office, как показано в следующем примере кода.</span><span class="sxs-lookup"><span data-stu-id="1e94e-251">When your add-in depends on a method that is not part of a requirement set, you can use the runtime check to determine whether the method is supported by the Office application, as shown in the following code example.</span></span> <span data-ttu-id="1e94e-252">Список всех методов, не входящих в набор обязательных элементов, см. в статье [Наборы обязательных элементов для надстроек Office](../reference/requirement-sets/office-add-in-requirement-sets.md#methods-that-arent-part-of-a-requirement-set).</span><span class="sxs-lookup"><span data-stu-id="1e94e-252">For a complete list of methods that don't belong to a requirement set, see [Office Add-in requirement sets](../reference/requirement-sets/office-add-in-requirement-sets.md#methods-that-arent-part-of-a-requirement-set).</span></span>

> [!NOTE]
> <span data-ttu-id="1e94e-253">Рекомендуем ограничить использование этого типа проверки в среде выполнения в коде надстройки.</span><span class="sxs-lookup"><span data-stu-id="1e94e-253">We recommend that you limit the use of this type of runtime check in your add-in's code.</span></span>

<span data-ttu-id="1e94e-254">В следующем примере кода проверяется, поддерживает ли приложение `document.setSelectedDataAsync` Office.</span><span class="sxs-lookup"><span data-stu-id="1e94e-254">The following code example checks whether the Office application supports `document.setSelectedDataAsync`.</span></span>

```js
if (Office.context.document.setSelectedDataAsync)
{
    // Run code that uses `document.setSelectedDataAsync`.
}
```


## <a name="see-also"></a><span data-ttu-id="1e94e-255">См. также</span><span class="sxs-lookup"><span data-stu-id="1e94e-255">See also</span></span>

- [<span data-ttu-id="1e94e-256">XML-манифест надстройки Office</span><span class="sxs-lookup"><span data-stu-id="1e94e-256">Office Add-ins XML manifest</span></span>](add-in-manifests.md)
- [<span data-ttu-id="1e94e-257">Наборы обязательных элементов для надстроек Office</span><span class="sxs-lookup"><span data-stu-id="1e94e-257">Office Add-in requirement sets</span></span>](../reference/requirement-sets/office-add-in-requirement-sets.md)
- [<span data-ttu-id="1e94e-258">Word-Add-in-Get-Set-EditOpen-XML </span><span class="sxs-lookup"><span data-stu-id="1e94e-258">Word-Add-in-Get-Set-EditOpen-XML</span></span>](https://github.com/OfficeDev/Word-Add-in-Get-Set-EditOpen-XML)
