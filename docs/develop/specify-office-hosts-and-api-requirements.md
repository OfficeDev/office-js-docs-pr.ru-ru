---
title: Указание ведущих приложений Office и требований к API
description: Узнайте, как указать требования к приложениям Office и API для вашей надстройки, чтобы работать так, как ожидалось.
ms.date: 04/20/2021
localization_priority: Normal
ms.openlocfilehash: 0b0bd433a0b731437588b83cba0b37052babf2c1
ms.sourcegitcommit: 691fa338029c9cbd9a7194d163f390c3321a0cd8
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2021
ms.locfileid: "51959161"
---
# <a name="specify-office-applications-and-api-requirements"></a>Указание приложений Office и требований API

Ваша надстройка Office может зависеть от конкретного приложения Office, набора требований, члена API или версии API, чтобы работать так, как ожидалось. Например, надстройка может:

- работать в одном (например, Word или Excel) или нескольких приложениях Office;

- использовать API JavaScript, доступные только в некоторых версиях Office. Например, можно создать надстройку Excel 2016 на базе новых API JavaScript для Excel;

- работать только в версиях Office, которые поддерживают элементы API, используемые вашей надстройкой.

Эта статья поможет вам разобраться, какие параметры следует выбрать для правильной работы надстройки и максимального охвата аудитории.

> [!NOTE]
> Чтобы просмотреть, где в настоящее время поддерживаются надстройки Office, см. в странице Клиентские приложения Office и доступность платформы для [надстройок Office.](../overview/office-add-in-availability.md)

В таблице ниже перечислены основные понятия, рассматриваемые в этой статье.

|**Концепция**|**Описание**|
|:-----|:-----|
|Приложение Office, клиентская заявка Office|Приложение Office, используемое для запуска надстройки, например Word, Excel и т. д.|
|Платформа|Где работает приложение Office, например в браузере или на iPad.|
|Набор обязательных элементов|Именованная группа связанных элементов API. Надстройки используют наборы требований, чтобы определить, поддерживает ли приложение Office членов API, используемых вашей надстройки. Проще проверять поддержку набора требований, а не отдельных элементов API. Поддержка набора требований зависит от приложения Office и версии приложения Office. <br >Наборы обязательных элементов указываются в файле манифеста. При указании наборов требований в манифесте устанавливается минимальный уровень поддержки API, который должно предоставить приложение Office для запуска надстройки. Приложения Office, которые не поддерживают наборы требований, указанные в манифесте, не могут запустить надстройку, а ваша надстройка не будет отображаться в <span class="ui">моих надстройких.</span> Это ограничивает доступ к надстройки. в коде с помощью проверок в среде выполнения. Полный список наборов требований см. в статье [Наборы обязательных элементов для надстроек Office](../reference/requirement-sets/office-add-in-requirement-sets.md).|
|Проверка в среде выполнения|Тест, выполняемый во время выполнения, чтобы определить, поддерживает ли приложение Office, которое поддерживает наборы требований или методы, используемые вашей надстройки. Для выполнения проверки времени выполнения используется утверждение **if** с методом, наборами требований или именами методов, которые не являются `isSetSupported` частью набора требований. Проверки в среде выполнения позволяют максимально расширить аудиторию надстройки. В отличие от наборов требований проверки времени запуска не указывают минимальный уровень поддержки API, который приложение Office должно предоставить для запуска надстройки. Вместо этого вы используете **утверждение if,** чтобы определить, поддерживается ли член API. и если это так, добавляете в надстройку дополнительные функции. Если вы используете проверки в среде выполнения, ваша надстройка всегда будет отображаться в разделе **Мои надстройки**.|

## <a name="before-you-begin"></a>Подготовка

Надстройка должна использовать последнюю версию схемы манифеста надстройки. При использовании проверок времени работы надстройки убедитесь, что вы используете последнюю библиотеку API JavaScript Office (office.js).

### <a name="specify-the-latest-add-in-manifest-schema"></a>Выбор последней версии схема манифестов надстроек

Ваша надстройка должна использовать схему манифеста 1.1. Установите элемент [OfficeApp](../reference/manifest/officeapp.md) в манифесте надстройки следующим образом. В этом примере показан `TaskPaneApp` тип.

```XML
<OfficeApp xmlns="http://schemas.microsoft.com/office/appforoffice/1.1" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="TaskPaneApp">
```

### <a name="specify-the-latest-office-javascript-api-library"></a>Укажите последнюю библиотеку API JavaScript Office

Если вы используете проверки времени работы, ссылайся на наиболее текущую версию библиотеки API JavaScript Office из сети доставки контента (CDN). Для этого добавьте указанный ниже тег `script` в HTML-код. Чтобы всегда ссылаться на последнюю версию файла Office.js, используйте `/1/` в URL-адресе сети доставки содержимого.

```HTML
<script src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js" type="text/javascript"></script>
```

## <a name="options-to-specify-office-applications-or-api-requirements"></a>Параметры для указания требований к приложениям Office или API

При указании приложений Office или требований API необходимо учитывать несколько факторов. На следующей схеме показано, как выбрать правильный метод для надстройки.

![Выберите оптимальный вариант для надстройки при указании приложений Office или требований API](../images/options-for-office-hosts.png)

- Если надстройка работает в одном приложении Office, установите `Hosts` элемент манифеста. Дополнительные сведения см. в разделе [Задание элемента Hosts](#set-the-hosts-element).

- Чтобы установить минимальный набор требований или членов API, которые приложение Office должно поддерживать для запуска надстройки, установите элемент `Requirements` манифеста. Дополнительные сведения см. [в элементе Set the Requirements in the manifest.](#set-the-requirements-element-in-the-manifest)

- Если вы хотите предоставить дополнительные функции, если в приложении Office доступны определенные наборы требований или члены API, выполните проверку времени выполнения в коде JavaScript надстройки. Например, если надстройка выполняется в Excel 2016, используйте элементы нового API JavaScript для Excel, чтобы предоставить дополнительные функции. Дополнительные сведения см. в разделе [Использование проверок в среде выполнения в коде JavaScript](#use-runtime-checks-in-your-javascript-code).

## <a name="set-the-hosts-element"></a>Задание элемента Hosts

Чтобы выполнить надстройку в одном клиентном приложении Office, используйте элементы `Hosts` `Host` и элементы манифеста. Если элемент не указан, надстройка будет работать во всех приложениях Office, поддерживаемых указанным типом `Hosts` `OfficeApp` (например, Mail, Task pane или Content).

Например, в следующем и объявлении указывается, что надстройка будет работать с любым выпуском Excel, который включает Excel в `Hosts` `Host` Интернете, Windows и iPad.

```xml
<Hosts>
  <Host Name="Workbook" />
</Hosts>
```

Элемент `Hosts` может содержать один или несколько `Host` элементов. Элемент `Host` указывает приложение Office, которое требуется для надстройки. Атрибут `Name` необходим и может быть задат одним из следующих значений.

| Name          | Клиентские приложения Office                     | Доступные типы надстройки |
|:--------------|:-----------------------------------------------|:-----------------------|
| Database      | Веб-приложения Access                                | Область задач              |
| Document      | Word в Интернете, Windows, Mac, iPad            | Область задач              |
| MailHost      | Outlook в Интернете, Windows, Mac, Android, iOS | Почта                   |
| Notebook      | OneNote в Интернете                             | Области задач, контент     |
| Presentation  | PowerPoint в Интернете, Windows, Mac, iPad      | Области задач, контент     |
| Проект       | Project для Windows                             | Область задач              |
| Workbook      | Excel в Интернете, Windows, Mac, iPad           | Области задач, контент     |

> [!NOTE]
> Атрибут `Name` указывает клиентскую заявку Office, которая может запустить надстройку. Приложения Office поддерживаются на разных платформах и запускаются на настольных компьютерах, веб-браузерах, планшетах и мобильных устройствах. Вам не удастся указать, какую платформу можно использовать для запуска надстройки. Например, если указать, для запуска надстройки можно использовать Outlook как в Интернете, так и в `MailHost` Windows.

> [!IMPORTANT]
> Больше не рекомендуется создавать и использовать веб-приложения и базы данных Access в SharePoint. В качестве альтернативы рекомендуем использовать [Microsoft PowerApps](https://powerapps.microsoft.com/) для создания бизнес-решений для Интернета и мобильных устройств без написания кода.

## <a name="set-the-requirements-element-in-the-manifest"></a>Указание элемента Requirements в манифесте

Элемент указывает минимальные наборы требований или членов API, которые должны поддерживаться приложением Office для `Requirements` запуска надстройки. Элемент может указывать как наборы требований, так и `Requirements` отдельные методы, используемые в вашей надстройки. В версии 1.1 схемы манифеста надстройки элемент необязателен для всех надстроек, за исключением `Requirements` надстроек Outlook.

> [!WARNING]
> Только используйте элемент для указания критически важных наборов требований или `Requirements` членов API, которые должна использовать ваша надстройка. Если приложение Или платформа Office не поддерживают наборы требований или членов API, указанных в элементе, надстройка не будет работать в этом приложении или платформе и не будет отображаться в моих `Requirements` надстройких.  Вместо этого рекомендуется сделать надстройки доступными на всех платформах приложения Office, таких как Excel в Интернете, Windows и iPad. Чтобы сделать надстройку доступной для  _всех_ приложений и платформ Office, используйте проверки времени работы вместо `Requirements` элемента.

В следующем примере кода показана надстройка, загружаемая во все клиентские приложения Office, поддерживают следующие:

-  `TableBindings` набор требований, который имеет минимальную версию "1.1".

-  `OOXML` набор требований, который имеет минимальную версию "1.1".

-  `Document.getSelectedDataAsync` метод.

```XML
<Requirements>
   <Sets DefaultMinVersion="1.1">
      <Set Name="TableBindings" MinVersion="1.1"/>
      <Set Name="OOXML" MinVersion="1.1"/>
   </Sets>
   <Methods>
      <Method Name="Document.getSelectedDataAsync"/>
   </Methods>
</Requirements>
```

- Элемент `Requirements` содержит и `Sets` `Methods` детские элементы.

- Элемент `Sets` может содержать один или несколько `Set` элементов. `DefaultMinVersion` указывает значение `MinVersion` по умолчанию для всех `Set` детских элементов.

- Элемент указывает наборы требований, которые приложение Office должно поддерживать для `Set` запуска надстройки. Атрибут `Name` указывает имя набора требований. Указывает `MinVersion` минимальную версию набора требований. `MinVersion`переопределяет значение Дополнительные сведения о наборах требований и версиях набора требований, к которые принадлежат члены API, см. в дополнительных наборах `DefaultMinVersion` [требований к надстройки Office.](../reference/requirement-sets/office-add-in-requirement-sets.md)

- Элемент `Methods` может содержать один или несколько `Method` элементов. Нельзя использовать элемент с надстройки `Methods` Outlook.

- Элемент указывает отдельный метод, который должен поддерживаться в приложении Office, где `Method` выполняется надстройка. Атрибут необходим и указывает имя метода, квалифицированного с `Name` родительским объектом.

## <a name="use-runtime-checks-in-your-javascript-code"></a>Использование проверок в среде выполнения в коде JavaScript

Может потребоваться предоставить дополнительные функции в надстройки, если определенные наборы требований поддерживаются приложением Office. Например, если надстройка работает в Word 2016, вы можете использовать в ней API JavaScript для Word. Для этого используйте метод [isSetSupported](/javascript/api/office/office.requirementsetsupport#issetsupported-name--minversion-) с именем набора обязательных элементов. `isSetSupported` определяет, поддерживает ли приложение Office, которое работает надстройку, набор требований. Если набор требований поддерживается, возвращается true и запускается дополнительный код, `isSetSupported` использующий  членов API из этого набора требований. Если приложение Office не поддерживает набор требований, возвращается ложный и дополнительный код `isSetSupported` не будет работать.  В следующем коде показан синтаксис для использования с `isSetSupported`.

```js
if (Office.context.requirements.isSetSupported(RequirementSetName, MinimumVersion))
{
   // Code that uses API members from RequirementSetName.
}

```

- _RequirementSetName_ (обязательный параметр) — это строка, представляющая имя набора обязательных элементов (например, "**ExcelApi**", "**Mailbox**" и т. д.). Дополнительные сведения о доступных наборах обязательных элементов см. в статье [Наборы обязательных элементов для надстроек Office](../reference/requirement-sets/office-add-in-requirement-sets.md).
- _MinimumVersion_ (необязательный) — это строка, которая указывает минимальную версию набора требований, которую приложение Office должно поддерживать для запуска кода в заявлении `if` (например,**"1.9").**

> [!WARNING]
> При вызове метода значение параметра `isSetSupported` `MinimumVersion` (если указано) должно быть строкой. Это обусловлено тем, что средство синтаксического анализа JavaScript не может различить числовые значения, например 1.1 и 1.10, но может различать строковые значения, например "1.1" и "1.10".
> Перегрузка оператора `number` не рекомендуется.

Используйте `isSetSupported` с связанным с `RequirementSetName` приложением Office следующим образом.

|Приложение Office|RequirementSetName|
|---|---|
|Excel|ExcelApi|
|OneNote|OneNoteApi|
|Outlook|Mailbox|
|Word|WordApi|

Метод и наборы требований для этих приложений доступны в последнем файле Office.js `isSetSupported` cdN. Если вы не используете Office.js cdN, ваша надстройка может создавать исключения, так как будет `isSetSupported` неопределенна. Дополнительные сведения см. в [выпуске Укажите последнюю библиотеку API JavaScript](#specify-the-latest-office-javascript-api-library)Office.

В следующем примере кода показано, как надстройка может предоставлять различные функциональные возможности для различных приложений Office, которые могут поддерживать различные наборы требований или членов API.

```js
if (Office.context.requirements.isSetSupported('WordApi', '1.1'))
{
    // Run code that provides additional functionality using the Word JavaScript API when the add-in runs in Word 2016 or later.
}
else if (Office.context.requirements.isSetSupported('CustomXmlParts'))
{
    // Run code that uses API members from the CustomXmlParts requirement set.
}
else
{
    // Run additional code when the Office application is not Word 2016 or later and does not support the CustomXmlParts requirement set.
}

```

## <a name="runtime-checks-using-methods-not-in-a-requirement-set"></a>Проверки в среде выполнения с использованием методов, не входящих в набор обязательных элементов

Некоторые элементы API не входят в наборы обязательных элементов. Это относится только к членам API, которые входят в пространство имен [API](../reference/javascript-api-for-office.md) Office JavaScript (все, кроме API почтовых ящиков Outlook), но не члены API, которые относятся к `Office.` [API Word JavaScript](../reference/overview/word-add-ins-reference-overview.md) (что-либо [](/javascript/api/outlook) `Word.` в), [API JavaScript](../reference/overview/excel-add-ins-reference-overview.md) Excel (все `Excel.` в) или [API JavaScript OneNote](../reference/overview/onenote-add-ins-javascript-reference.md) (все в `OneNote.` ) пространствах имен. Если надстройка зависит от метода, который не входит в набор требований, вы можете использовать проверку времени работы, чтобы определить, поддерживается ли метод приложением Office, как показано в следующем примере кода. Список всех методов, не входящих в набор обязательных элементов, см. в статье [Наборы обязательных элементов для надстроек Office](../reference/requirement-sets/office-add-in-requirement-sets.md#methods-that-arent-part-of-a-requirement-set).

> [!NOTE]
> Рекомендуем ограничить использование этого типа проверки в среде выполнения в коде надстройки.

В следующем примере кода проверяется, поддерживает ли приложение `document.setSelectedDataAsync` Office.

```js
if (Office.context.document.setSelectedDataAsync)
{
    // Run code that uses `document.setSelectedDataAsync`.
}
```


## <a name="see-also"></a>См. также

- [XML-манифест надстройки Office](add-in-manifests.md)
- [Наборы обязательных элементов для надстроек Office](../reference/requirement-sets/office-add-in-requirement-sets.md)
- [Word-Add-in-Get-Set-EditOpen-XML ](https://github.com/OfficeDev/Word-Add-in-Get-Set-EditOpen-XML)
