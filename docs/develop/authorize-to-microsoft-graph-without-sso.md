---
title: Авторизация в Microsoft Graph без единого входа
description: ''
ms.date: 12/06/2019
localization_priority: Priority
ms.openlocfilehash: 2f65a76c31ba47f90860bc6a432cdcd32c992a17
ms.sourcegitcommit: 8c5c5a1bd3fe8b90f6253d9850e9352ed0b283ee
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/19/2019
ms.locfileid: "40814007"
---
# <a name="authorize-to-microsoft-graph-without-sso"></a><span data-ttu-id="48cf6-102">Авторизация в Microsoft Graph без единого входа</span><span class="sxs-lookup"><span data-stu-id="48cf6-102">Authorize to Microsoft Graph without SSO</span></span>

<span data-ttu-id="48cf6-103">Вы можете получить для надстройки разрешение на доступ к данным Microsoft Graph, получив маркер доступа к Graph из Azure Active Directory (AAD).</span><span class="sxs-lookup"><span data-stu-id="48cf6-103">You can get authorization to Microsoft Graph data for your add-in by obtaining an access token to Graph from Azure Active Directory (AAD).</span></span> <span data-ttu-id="48cf6-104">Это выполняется с помощью потока кода авторизации или неявного потока, как и в любом другом веб-приложении с одним исключением: служба AAD не разрешает открывать свою страницу входа в элементе iframe.</span><span class="sxs-lookup"><span data-stu-id="48cf6-104">You do this using either the Authorization Code flow or the Implicit Flow just as you would any in any other web application with one exception: AAD does not allow its login page to open in an iframe.</span></span> <span data-ttu-id="48cf6-105">При работе с надстройкой Office в *Office в Интернете* область задач является элементом iframe.</span><span class="sxs-lookup"><span data-stu-id="48cf6-105">When an Office Add-in is running on *Office on the web*, the task pane is an iframe.</span></span> <span data-ttu-id="48cf6-106">Это означает, что вам потребуется открыть экран входа в AAD в диалоговом окне, вызванном с помощью Dialog API для Office.</span><span class="sxs-lookup"><span data-stu-id="48cf6-106">This means that you will need to open the AAD login screen in a dialog opened with the Office Dialog API.</span></span> <span data-ttu-id="48cf6-107">Это повлияет на способ использования библиотек помощника проверки подлинности и авторизации.</span><span class="sxs-lookup"><span data-stu-id="48cf6-107">This will effect how you use authentication and authorization helper libraries.</span></span> <span data-ttu-id="48cf6-108">Дополнительные сведения см. в статье [Проверка подлинности с помощью Dialog API для Office](auth-with-office-dialog-api.md).</span><span class="sxs-lookup"><span data-stu-id="48cf6-108">For more information, see [Authentication with the Office Dialog API](auth-with-office-dialog-api.md).</span></span>

<span data-ttu-id="48cf6-109">Сведения о программной проверке подлинности с помощью AAD см. в статье [Общие сведения о платформе удостоверений Майкрософт (версии 2.0)](/azure/active-directory/develop/v2-overview).</span><span class="sxs-lookup"><span data-stu-id="48cf6-109">For information about programming authentication with AAD, begin with [Microsoft identity platform (v2.0) overview](/azure/active-directory/develop/v2-overview).</span></span> <span data-ttu-id="48cf6-110">В этом наборе документов содержится много руководств и инструкций, а также ссылки на соответствующие примеры.</span><span class="sxs-lookup"><span data-stu-id="48cf6-110">There are many tutorials and guides in that documentation set, as well as links to relevant samples.</span></span> <span data-ttu-id="48cf6-111">Дополнительное напоминание: вам может потребоваться изменить код из примеров, чтобы запустить его в диалоговом окне Office, учитывая, что диалоговое окно запускается в отдельном процессе из области задач.</span><span class="sxs-lookup"><span data-stu-id="48cf6-111">Once again a reminder: you may need to adjust the code in the samples to run in the Office Dialog to account for the fact that the Dialog runs in a separate process from the task pane.</span></span>

<span data-ttu-id="48cf6-112">После получения кодом маркера доступа к Microsoft Graph он передает маркер доступа из диалогового окна в область задач или сохраняет маркер в базе данных и уведомляет область задач о доступности маркера в базе данных.</span><span class="sxs-lookup"><span data-stu-id="48cf6-112">After your code has obtained the access token to Microsoft Graph, either it passes the access token from the dialog to the task pane, or it stores the token in a database and signals the task pane that the token is available there.</span></span> <span data-ttu-id="48cf6-113">(Дополнительные сведения см. в статье [Проверка подлинности с помощью Dialog API для Office](auth-with-office-dialog-api.md).) Код в области задач запрашивает данные из Microsoft Graph и включает маркер в эти запросы.</span><span class="sxs-lookup"><span data-stu-id="48cf6-113">(See [Authentication with the Office Dialog API](auth-with-office-dialog-api.md) for details.) Code in the task pane requests data from Microsoft Graph, and includes the token in those requests.</span></span> <span data-ttu-id="48cf6-114">Дополнительные сведения о вызовах Microsoft Graph и SDK для Microsoft Graph см. в статье [Документация Microsoft Graph](/graph/).</span><span class="sxs-lookup"><span data-stu-id="48cf6-114">For more information about calling Microsoft Graph and the SDKs for Microsoft Graph, see [Microsoft Graph documentation](/graph/).</span></span>

## <a name="recommended-libraries-and-samples"></a><span data-ttu-id="48cf6-115">Рекомендуемые библиотеки и примеры</span><span class="sxs-lookup"><span data-stu-id="48cf6-115">Recommended libraries and samples</span></span>

<span data-ttu-id="48cf6-116">При доступе к Microsoft Graph без использования единого входа рекомендуется применять следующие библиотеки:</span><span class="sxs-lookup"><span data-stu-id="48cf6-116">We recommend that you use the following libraries when accessing Microsoft Graph without using SSO:</span></span>

- <span data-ttu-id="48cf6-117">Для надстроек, использующих серверную часть с платформой на основе .NET, например .NET Core или ASP.NET, используйте [MSAL.NET](https://github.com/AzureAD/microsoft-authentication-library-for-dotnet/wiki#conceptual-documentation).</span><span class="sxs-lookup"><span data-stu-id="48cf6-117">For add-ins using a server-side with a .NET-based framework such as .NET Core or ASP.NET, use [MSAL.NET](https://github.com/AzureAD/microsoft-authentication-library-for-dotnet/wiki#conceptual-documentation).</span></span>
- <span data-ttu-id="48cf6-118">Для надстроек, использующих серверную часть на основе NodeJS, используйте [Azure AD Passport](https://github.com/AzureAD/passport-azure-ad).</span><span class="sxs-lookup"><span data-stu-id="48cf6-118">For add-ins using a NodeJS-based server-side, use [Passport Azure AD](https://github.com/AzureAD/passport-azure-ad).</span></span>
- <span data-ttu-id="48cf6-119">Для надстроек, использующих неявный поток, используйте [msal.js](https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki).</span><span class="sxs-lookup"><span data-stu-id="48cf6-119">For add-ins using the Implicit flow, use [msal.js](https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki).</span></span>

<span data-ttu-id="48cf6-120">Дополнительные сведения о рекомендуемых библиотеках для работы с платформой удостоверений Майкрософт (ранее — AAD версии 2.0) см. в статье [Библиотеки проверки подлинности платформы удостоверений Майкрософт](/azure/active-directory/develop/reference-v2-libraries).</span><span class="sxs-lookup"><span data-stu-id="48cf6-120">For more information about recommended libraries for working with Microsoft Identity Platform (formerly AAD v.2.0), see [Microsoft identity platform authentication libraries](/azure/active-directory/develop/reference-v2-libraries).</span></span>

<span data-ttu-id="48cf6-121">Следующие примеры получают данные Microsoft Graph из надстройки Office:</span><span class="sxs-lookup"><span data-stu-id="48cf6-121">The following samples get Microsoft Graph data from an Office Add-in:</span></span>

- [<span data-ttu-id="48cf6-122">Надстройка Office в Microsoft Graph ASP.NET</span><span class="sxs-lookup"><span data-stu-id="48cf6-122">Office Add-in Microsoft Graph ASP.NET</span></span>](https://github.com/OfficeDev/PnP-OfficeAddins/tree/master/Samples/auth/Office-Add-in-Microsoft-Graph-ASPNET)
- [<span data-ttu-id="48cf6-123">Надстройка Outlook в Microsoft Graph ASP.NET</span><span class="sxs-lookup"><span data-stu-id="48cf6-123">Outlook Add-in Microsoft Graph ASP.NET</span></span>](https://github.com/OfficeDev/PnP-OfficeAddins/tree/master/Samples/auth/Outlook-Add-in-Microsoft-Graph-ASPNET)
- [<span data-ttu-id="48cf6-124">Надстройка Office в Microsoft Graph React</span><span class="sxs-lookup"><span data-stu-id="48cf6-124">Office Add-in Microsoft Graph ASP.NET</span></span>](https://github.com/OfficeDev/PnP-OfficeAddins/tree/master/Samples/auth/Office-Add-in-Microsoft-Graph-React)

