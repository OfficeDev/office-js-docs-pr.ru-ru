---
title: Авторизация в Microsoft Graph без единого входа
description: Узнайте, как осуществлять авторизацию в Microsoft Graph без единого входа
ms.date: 01/29/2020
localization_priority: Normal
ms.openlocfilehash: 99d300d0155ba9a117efda5d31ef068a41eb86a9
ms.sourcegitcommit: 8546889a759590c3798ce56e311d9e46f0171413
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/04/2021
ms.locfileid: "50104835"
---
# <a name="authorize-to-microsoft-graph-without-sso"></a><span data-ttu-id="ab6ab-103">Авторизация в Microsoft Graph без единого входа</span><span class="sxs-lookup"><span data-stu-id="ab6ab-103">Authorize to Microsoft Graph without SSO</span></span>

<span data-ttu-id="ab6ab-104">Ваша надстройка может получить авторизацию данных Microsoft Graph, получив маркер доступа к Microsoft Graph из Azure Active Directory (Azure AD).</span><span class="sxs-lookup"><span data-stu-id="ab6ab-104">Your add-in can get authorization to Microsoft Graph data by obtaining an access token to Microsoft Graph from Azure Active Directory (Azure AD).</span></span> <span data-ttu-id="ab6ab-105">Используйте поток кода авторизации или неявный поток так же, как и в других веб-приложениях, но с одним исключением: Azure AD не разрешает открытие страницы входов в iframe.</span><span class="sxs-lookup"><span data-stu-id="ab6ab-105">Use either the Authorization Code flow or the Implicit flow just as you would in other web applications but with one exception: Azure AD does not allow its sign in page to open in an iframe.</span></span> <span data-ttu-id="ab6ab-106">При работе с надстройкой Office в *Office в Интернете* область задач является элементом iframe.</span><span class="sxs-lookup"><span data-stu-id="ab6ab-106">When an Office Add-in is running on *Office on the web*, the task pane is an iframe.</span></span> <span data-ttu-id="ab6ab-107">Это означает, что вам потребуется открыть экран входа в Azure AD в диалоговом окне, открываемом с помощью API диалоговых окне Office.</span><span class="sxs-lookup"><span data-stu-id="ab6ab-107">This means you'll need to open the Azure AD login screen in a dialog box opened with the Office dialog API.</span></span> <span data-ttu-id="ab6ab-108">Это повлияет на способ использования библиотек помощника проверки подлинности и авторизации.</span><span class="sxs-lookup"><span data-stu-id="ab6ab-108">This affects how you use authentication and authorization helper libraries.</span></span> <span data-ttu-id="ab6ab-109">Дополнительные сведения см. в статье [Проверка подлинности с помощью Dialog API для Office](auth-with-office-dialog-api.md).</span><span class="sxs-lookup"><span data-stu-id="ab6ab-109">For more information, see [Authentication with the Office dialog API](auth-with-office-dialog-api.md).</span></span>

<span data-ttu-id="ab6ab-110">Сведения о программировании проверки подлинности с помощью Azure AD см. в обзоре платформы удостоверений [Майкрософт (v2.0),](/azure/active-directory/develop/v2-overview)где вы найдете учебники и руководства в этом наборе документации, а также ссылки на соответствующие примеры.</span><span class="sxs-lookup"><span data-stu-id="ab6ab-110">For information about programming authentication with Azure AD, begin with [Microsoft identity platform (v2.0) overview](/azure/active-directory/develop/v2-overview), where you'll find tutorials and guides in that documentation set, as well as links to relevant samples.</span></span> <span data-ttu-id="ab6ab-111">Опять же, вам может потребоваться изменить код из примеров, чтобы запустить его в диалоговом окне Office, учитывая, что диалоговое окно Office запускается в отдельном процессе из области задач.</span><span class="sxs-lookup"><span data-stu-id="ab6ab-111">Once again, you may need to adjust the code in the samples to run in the Office dialog box to account for the fact that the Office dialog box runs in a separate process from the task pane.</span></span>

<span data-ttu-id="ab6ab-112">После того как код получит маркер доступа в Microsoft Graph, он либо передает маркер доступа из диалогового окна в области задач, либо сохраняет маркер в базе данных и сообщает области задач, что маркер доступен.</span><span class="sxs-lookup"><span data-stu-id="ab6ab-112">After your code obtains the access token to Microsoft Graph, either it passes the access token from the dialog box to the task pane, or it stores the token in a database and signals the task pane that the token is available.</span></span> <span data-ttu-id="ab6ab-113">(Подробные сведения см. в подразделе "Проверка подлинности с помощью [API диалогов](auth-with-office-dialog-api.md) Office".) Код в области задач запрашивает данные из Microsoft Graph и включает маркер в эти запросы.</span><span class="sxs-lookup"><span data-stu-id="ab6ab-113">(See [Authentication with the Office dialog API](auth-with-office-dialog-api.md) for details.) Code in the task pane requests data from Microsoft Graph, and includes the token in those requests.</span></span> <span data-ttu-id="ab6ab-114">Дополнительные сведения о вызове Microsoft Graph и SDKs Microsoft Graph см. в [документации по Microsoft Graph.](/graph/)</span><span class="sxs-lookup"><span data-stu-id="ab6ab-114">For more information about calling Microsoft Graph and the Microsoft Graph SDKs, see [Microsoft Graph documentation](/graph/).</span></span>

## <a name="recommended-libraries-and-samples"></a><span data-ttu-id="ab6ab-115">Рекомендуемые библиотеки и примеры</span><span class="sxs-lookup"><span data-stu-id="ab6ab-115">Recommended libraries and samples</span></span>

<span data-ttu-id="ab6ab-116">При доступе к Microsoft Graph без использования единого входа рекомендуется применять следующие библиотеки:</span><span class="sxs-lookup"><span data-stu-id="ab6ab-116">We recommend that you use the following libraries when accessing Microsoft Graph without using SSO:</span></span>

- <span data-ttu-id="ab6ab-117">Для надстроек, использующих серверную часть с платформой на основе .NET, например .NET Core или ASP.NET, используйте [MSAL.NET](https://github.com/AzureAD/microsoft-authentication-library-for-dotnet/wiki#conceptual-documentation).</span><span class="sxs-lookup"><span data-stu-id="ab6ab-117">For add-ins using a server-side with a .NET-based framework such as .NET Core or ASP.NET, use [MSAL.NET](https://github.com/AzureAD/microsoft-authentication-library-for-dotnet/wiki#conceptual-documentation).</span></span>
- <span data-ttu-id="ab6ab-118">Для надстроек, использующих серверную часть на основе NodeJS, используйте [Azure AD Passport](https://github.com/AzureAD/passport-azure-ad).</span><span class="sxs-lookup"><span data-stu-id="ab6ab-118">For add-ins using a NodeJS-based server-side, use [Passport Azure AD](https://github.com/AzureAD/passport-azure-ad).</span></span>
- <span data-ttu-id="ab6ab-119">Для надстроек, использующих неявный поток, используйте [msal.js](https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki).</span><span class="sxs-lookup"><span data-stu-id="ab6ab-119">For add-ins using the Implicit flow, use [msal.js](https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki).</span></span>

<span data-ttu-id="ab6ab-120">Дополнительные сведения о рекомендуемых библиотеках для работы с платформой удостоверений Майкрософт (ранее — AAD версии 2.0) см. в статье [Библиотеки проверки подлинности платформы удостоверений Майкрософт](/azure/active-directory/develop/reference-v2-libraries).</span><span class="sxs-lookup"><span data-stu-id="ab6ab-120">For more information about recommended libraries for working with Microsoft Identity Platform (formerly AAD v.2.0), see [Microsoft identity platform authentication libraries](/azure/active-directory/develop/reference-v2-libraries).</span></span>

<span data-ttu-id="ab6ab-121">Следующие примеры получают данные Microsoft Graph из надстройки Office:</span><span class="sxs-lookup"><span data-stu-id="ab6ab-121">The following samples get Microsoft Graph data from an Office Add-in:</span></span>

- [<span data-ttu-id="ab6ab-122">Надстройка Office в Microsoft Graph ASP.NET</span><span class="sxs-lookup"><span data-stu-id="ab6ab-122">Office Add-in Microsoft Graph ASP.NET</span></span>](https://github.com/OfficeDev/PnP-OfficeAddins/tree/master/Samples/auth/Office-Add-in-Microsoft-Graph-ASPNET)
- [<span data-ttu-id="ab6ab-123">Надстройка Outlook в Microsoft Graph ASP.NET</span><span class="sxs-lookup"><span data-stu-id="ab6ab-123">Outlook Add-in Microsoft Graph ASP.NET</span></span>](https://github.com/OfficeDev/PnP-OfficeAddins/tree/master/Samples/auth/Outlook-Add-in-Microsoft-Graph-ASPNET)
- [<span data-ttu-id="ab6ab-124">Надстройка Office в Microsoft Graph React</span><span class="sxs-lookup"><span data-stu-id="ab6ab-124">Office Add-in Microsoft Graph React</span></span>](https://github.com/OfficeDev/PnP-OfficeAddins/tree/master/Samples/auth/Office-Add-in-Microsoft-Graph-React)
