---
title: Запрос разрешений на использование API в надстройках
description: ''
ms.date: 03/19/2019
localization_priority: Normal
ms.openlocfilehash: d146322c6977e11eedcd7e0b9ffdc9d5eeaac7c2
ms.sourcegitcommit: 4079903c3cc45b7d8c041509a44e9fc38da399b1
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/11/2020
ms.locfileid: "42596664"
---
# <a name="requesting-permissions-for-api-use-in-add-ins"></a><span data-ttu-id="84377-102">Запрос разрешений на использование API в надстройках</span><span class="sxs-lookup"><span data-stu-id="84377-102">Requesting permissions for API use in add-ins</span></span>

<span data-ttu-id="84377-103">В этой статье описываются различные уровни разрешений, которые можно объявить в манифесте контентной надстройки или надстройки области задач, чтобы указать уровень доступа JavaScript API, необходимый вашей надстройке.</span><span class="sxs-lookup"><span data-stu-id="84377-103">This article describes the different permission levels that you can declare in your content or task pane add-in's manifest to specify the level of JavaScript API access your add-in requires for its features.</span></span> 

## <a name="permissions-model"></a><span data-ttu-id="84377-104">Модель разрешений</span><span class="sxs-lookup"><span data-stu-id="84377-104">Permissions model</span></span>

<span data-ttu-id="84377-105">5-уровневая модель разрешений JavaScript API — это основа безопасности и конфиденциальности для пользователей контентных надстроек и надстроек области задач. На рис. 1 показаны пять уровней разрешений API, которые можно объявить в манифесте надстройки.</span><span class="sxs-lookup"><span data-stu-id="84377-105">A five-level JavaScript API access-permissions model provides the basis for privacy and security for users of your content and task pane add-ins. Figure 1 shows the five levels of API permissions you can declare in your add-in's manifest.</span></span>

<span data-ttu-id="84377-106">*Рис. 1. Пятиуровневая модель разрешений для контентных надстроек и надстроек области задач*</span><span class="sxs-lookup"><span data-stu-id="84377-106">*Figure 1. The five-level permission model for content and task pane add-ins*</span></span>

![Уровни разрешений для приложений области задач](../images/office15-app-sdk-task-pane-app-permission.png)

<span data-ttu-id="84377-p101">Эти разрешения задают подмножество API, которые контентная надстройки или надстройка области задач сможет использовать во время выполнения, когда пользователь вставляет, а затем активирует ваше приложение (доверяет ему). Чтобы объявить уровень разрешений, необходимый вашей надстройке, укажите одно из текстовых значений разрешения в элементе [Permissions](../reference/manifest/permissions.md) манифеста надстройки. Следующий пример запрашивает разрешение **WriteDocument**, который разрешает использовать только методы записи в документ (но не методы чтения).</span><span class="sxs-lookup"><span data-stu-id="84377-p101">These permissions specify the subset of the API that the add-in runtime will allow your content or task pane add-in to use when a user inserts, and then activates (trusts) your add-in. To declare the permission level your content or task pane add-in requires, specify one of the permission text values in the [Permissions](../reference/manifest/permissions.md) element of your add-in's manifest. The following example requests the **WriteDocument** permission, which will allow only methods that can write to (but not read) the document.</span></span>

```XML
<Permissions>WriteDocument</Permissions>
```

<span data-ttu-id="84377-p102">Рекомендуется запрашивать разрешения по принципу  _минимальной привилегии_. Т. е. следует запрашивать разрешения для доступа только к минимальному подмножеству API, необходимому надстройке для правильной работы. Например, если надстройке требуется только читать данные документа пользователя, оно должно запрашивать максимум разрешение **ReadDocument**.</span><span class="sxs-lookup"><span data-stu-id="84377-p102">As a best practice, you should request permissions based on the principle of  _least privilege_. That is, you should request permission to access only the minimum subset of the API that your add-in requires to function correctly. For example, if your add-in needs only to read data in a user's document for its features, you should request no more than the **ReadDocument** permission.</span></span>

<span data-ttu-id="84377-114">В следующей таблице описывается подмножество API JavaScript, предоставляемое каждым уровнем разрешений.</span><span class="sxs-lookup"><span data-stu-id="84377-114">The following table describes the subset of the JavaScript API that is enabled by each permission level.</span></span>

|<span data-ttu-id="84377-115">**Разрешение**</span><span class="sxs-lookup"><span data-stu-id="84377-115">**Permission**</span></span>|<span data-ttu-id="84377-116">**Включенное подмножество API**</span><span class="sxs-lookup"><span data-stu-id="84377-116">**Enabled subset of the API**</span></span>|
|:-----|:-----|
|<span data-ttu-id="84377-117">**Restricted**</span><span class="sxs-lookup"><span data-stu-id="84377-117">**Restricted**</span></span>|<span data-ttu-id="84377-118">Методы объекта [Settings](/javascript/api/office/office.settings) и метод [Document.getActiveViewAsync](/javascript/api/office/office.document#getactiveviewasync-options--callback-).Это минимальный уровень разрешений, запрашиваемый контентной надстройкой или надстройкой области задач.</span><span class="sxs-lookup"><span data-stu-id="84377-118">The methods of the [Settings](/javascript/api/office/office.settings) object, and the [Document.getActiveViewAsync](/javascript/api/office/office.document#getactiveviewasync-options--callback-) method.This is the minimum permission level that can be requested by a content or task pane add-in.</span></span>|
|<span data-ttu-id="84377-119">**ReadDocument**</span><span class="sxs-lookup"><span data-stu-id="84377-119">**ReadDocument**</span></span>|<span data-ttu-id="84377-120">В дополнение к интерфейсам API, предоставляемым разрешением **Restricted** , добавляет доступ к элементам API, необходимым для чтения документа и управления привязками. Сюда входит использование следующих компонентов:</span><span class="sxs-lookup"><span data-stu-id="84377-120">In addition to the API allowed by the **Restricted** permission, adds access to the API members necessary to read the document and manage bindings.This includes the use of:</span></span><br/><ul><li><span data-ttu-id="84377-121">Метод <a href="/javascript/api/office/office.document#getselecteddataasync-coerciontype--options--callback-" target="_blank">Document.getSelectedDataAsync</a> для получения выбранного текста, HTML (только Word) или табличных данных, но не базовый код Open Office XML (OOXML), содержащий все данные в документе.</span><span class="sxs-lookup"><span data-stu-id="84377-121">The <a href="/javascript/api/office/office.document#getselecteddataasync-coerciontype--options--callback-" target="_blank">Document.getSelectedDataAsync</a> method to get the selected text, HTML (Word only), or tabular data, but not the underlying Open Office XML (OOXML) code that contains all of the data in the document.</span></span></p></li><li><p><span data-ttu-id="84377-122">Метод <a href="/javascript/api/office/office.document#getfileasync-filetype--options--callback-" target="_blank">Document.getFileAsync</a> для получения всего текста документа, но не двоичной копии OOXML документа.</span><span class="sxs-lookup"><span data-stu-id="84377-122">The <a href="/javascript/api/office/office.document#getfileasync-filetype--options--callback-" target="_blank">Document.getFileAsync</a> method to get all of the text in the document, but not the underlying OOXML binary copy of the document.</span></span></p></li><li><p><span data-ttu-id="84377-123">Метод <a href="/javascript/api/office/office.binding#getdataasync-options--callback-" target="_blank">Binding.getDataAsync</a> для чтения связанных данных в документе.</span><span class="sxs-lookup"><span data-stu-id="84377-123">The <a href="/javascript/api/office/office.binding#getdataasync-options--callback-" target="_blank">Binding.getDataAsync</a> method for reading bound data in the document.</span></span></p></li><li><p><span data-ttu-id="84377-124">Методы <a href="/javascript/api/office/office.bindings#addfromnameditemasync-itemname--bindingtype--options--callback-" target="_blank">addFromNamedItemAsync</a>, <a href="/javascript/api/office/office.bindings#addfrompromptasync-bindingtype--options--callback-" target="_blank">addFromPromptAsync</a>, <a href="/javascript/api/office/office.bindings#addfromselectionasync-bindingtype--options--callback-" target="_blank">addFromSelectionAsync</a> объекта <span class="keyword">Bindings</span> для создания привязок в документе.</span><span class="sxs-lookup"><span data-stu-id="84377-124">The <a href="/javascript/api/office/office.bindings#addfromnameditemasync-itemname--bindingtype--options--callback-" target="_blank">addFromNamedItemAsync</a>, <a href="/javascript/api/office/office.bindings#addfrompromptasync-bindingtype--options--callback-" target="_blank">addFromPromptAsync</a>, <a href="/javascript/api/office/office.bindings#addfromselectionasync-bindingtype--options--callback-" target="_blank">addFromSelectionAsync</a> methods of the <span class="keyword">Bindings</span> object for creating bindings in the document.</span></span></p></li><li><p><span data-ttu-id="84377-125">Методы <a href="/javascript/api/office/office.bindings#getallasync-options--callback-" target="_blank">getAllAsync</a>, <a href="/javascript/api/office/office.bindings#getbyidasync-id--options--callback-" target="_blank">getByIdAsync</a> и <a href="/javascript/api/office/office.bindings#releasebyidasync-id--options--callback-" target="_blank">releaseByIdAsync</a> объекта <span class="keyword">Bindings</span> для доступа к привязкам документа и их удаления.</span><span class="sxs-lookup"><span data-stu-id="84377-125">The <a href="/javascript/api/office/office.bindings#getallasync-options--callback-" target="_blank">getAllAsync</a>, <a href="/javascript/api/office/office.bindings#getbyidasync-id--options--callback-" target="_blank">getByIdAsync</a>, and <a href="/javascript/api/office/office.bindings#releasebyidasync-id--options--callback-" target="_blank">releaseByIdAsync</a> methods of the <span class="keyword">Bindings</span> object for accessing and removing bindings in the document.</span></span></p></li><li><p><span data-ttu-id="84377-126">Метод <a href="/javascript/api/office/office.document#getfilepropertiesasync-options--callback-" target="_blank">Document.getFilePropertiesAsync</a> для доступа к свойствам файла документа, таким как URL-адрес документа.</span><span class="sxs-lookup"><span data-stu-id="84377-126">The <a href="/javascript/api/office/office.document#getfilepropertiesasync-options--callback-" target="_blank">Document.getFilePropertiesAsync</a> method to access document file properties, such as the URL of the document.</span></span></p></li><li><p><span data-ttu-id="84377-127">Метод <a href="/javascript/api/office/office.document#gotobyidasync-id--gototype--options--callback-" target="_blank">Document.goToByIdAsync</a> для перехода к именованным объектам и расположениям в документе.</span><span class="sxs-lookup"><span data-stu-id="84377-127">The <a href="/javascript/api/office/office.document#gotobyidasync-id--gototype--options--callback-" target="_blank">Document.goToByIdAsync</a> method to navigate to named objects and locations in the document.</span></span></p></li><li><p><span data-ttu-id="84377-128">Для надстроек области задач для Project — все методы "get" объекта <a href="/javascript/api/office/office.document" target="_blank">ProjectDocument</a>.</span><span class="sxs-lookup"><span data-stu-id="84377-128">For task pane add-ins for Project, all of the "get" methods of the <a href="/javascript/api/office/office.document" target="_blank">ProjectDocument</a> object.</span></span> </p></li></ul>|
|<span data-ttu-id="84377-129">**ReadAllDocument**</span><span class="sxs-lookup"><span data-stu-id="84377-129">**ReadAllDocument**</span></span>|<span data-ttu-id="84377-130">В дополнение к интерфейсам API, предоставляемым разрешениями **Restricted** и **ReadDocument** , предоставляет следующие дополнительные права доступа к данным документа:</span><span class="sxs-lookup"><span data-stu-id="84377-130">In addition to the API allowed by the **Restricted** and **ReadDocument** permissions, allows the following additional access to document data:</span></span><br/><ul><li><p><span data-ttu-id="84377-131">Методы <span class="keyword">Document.getSelectedDataAsync</span> и <span class="keyword">Document.getFileAsync</span> получают доступ к коду OOXML документа (который кроме текста может содержать форматирование, ссылки, встроенную графику, комментарии, редакции и т. д.).</span><span class="sxs-lookup"><span data-stu-id="84377-131">The <span class="keyword">Document.getSelectedDataAsync</span> and <span class="keyword">Document.getFileAsync</span> methods can access the underlying OOXML code of the document (which in addition to the text may include formatting, links, embedded graphics, comments, revisions, and so forth).</span></span></p></li></ul>|
|<span data-ttu-id="84377-132">**WriteDocument**</span><span class="sxs-lookup"><span data-stu-id="84377-132">**WriteDocument**</span></span>|<span data-ttu-id="84377-133">В дополнение к интерфейсам API, предоставляемым разрешением **Restricted** , добавляет доступ к следующим элементам API:</span><span class="sxs-lookup"><span data-stu-id="84377-133">In addition to the API allowed by the **Restricted** permission, adds access to the following API members:</span></span><br/><ul><li><p><span data-ttu-id="84377-134">Метод <a href="/javascript/api/office/office.document#setselecteddataasync-data--options--callback-" target="_blank">Document.setSelectedDataAsync</a> для записи данных в выделенную пользователем область документа.</span><span class="sxs-lookup"><span data-stu-id="84377-134">The <a href="/javascript/api/office/office.document#setselecteddataasync-data--options--callback-" target="_blank">Document.setSelectedDataAsync</a> method to write to the user's selection in the document.</span></span></p></li></ul>|
|<span data-ttu-id="84377-135">**ReadWriteDocument**</span><span class="sxs-lookup"><span data-stu-id="84377-135">**ReadWriteDocument**</span></span>|<span data-ttu-id="84377-136">В дополнение к интерфейсам API, предоставляемым разрешениями **Restricted**, **ReadDocument**, **ReadAllDocument**и **WriteDocument** , предоставляется доступ ко всем оставшимся API, поддерживаемым контентными надстройками и надстройками области задач, в том числе методы для подписки на события. Необходимо объявить разрешение **ReadWriteDocument** для доступа к этим дополнительным элементам API:</span><span class="sxs-lookup"><span data-stu-id="84377-136">In addition to the API allowed by the **Restricted**, **ReadDocument**, **ReadAllDocument**, and **WriteDocument** permissions, includes access to all remaining API supported by content and task pane add-ins, including methods for subscribing to events.You must declare the **ReadWriteDocument** permission to access these additional API members:</span></span><br/><ul><li><p><span data-ttu-id="84377-137">Метод <a href="/javascript/api/office/office.binding#setdataasync-data--options--callback-" target="_blank">Binding.setDataAsync</a> для записи связанных областей документа.</span><span class="sxs-lookup"><span data-stu-id="84377-137">The <a href="/javascript/api/office/office.binding#setdataasync-data--options--callback-" target="_blank">Binding.setDataAsync</a> method for writing to bound regions of the document.</span></span></p></li><li><p><span data-ttu-id="84377-138">Метод <a href="/javascript/api/office/office.tablebinding#addrowsasync-rows--options--callback-" target="_blank">TableBinding.addRowsAsync</a> для добавления строк в связанные таблицы.</span><span class="sxs-lookup"><span data-stu-id="84377-138">The <a href="/javascript/api/office/office.tablebinding#addrowsasync-rows--options--callback-" target="_blank">TableBinding.addRowsAsync</a> method for adding rows to bound tables.</span></span></p></li><li><p><span data-ttu-id="84377-139">Метод <a href="/javascript/api/office/office.tablebinding#addcolumnsasync-tabledata--options--callback-" target="_blank">TableBinding.addColumnsAsync</a> для добавления столбцов в связанные таблицы.</span><span class="sxs-lookup"><span data-stu-id="84377-139">The <a href="/javascript/api/office/office.tablebinding#addcolumnsasync-tabledata--options--callback-" target="_blank">TableBinding.addColumnsAsync</a> method for adding columns to bound tables.</span></span></p></li><li><p><span data-ttu-id="84377-140">Метод <a href="/javascript/api/office/office.tablebinding#deletealldatavaluesasync-options--callback-" target="_blank">TableBinding.deleteAllDataValuesAsync</a> для удаления всех данных в связанной таблице.</span><span class="sxs-lookup"><span data-stu-id="84377-140">The <a href="/javascript/api/office/office.tablebinding#deletealldatavaluesasync-options--callback-" target="_blank">TableBinding.deleteAllDataValuesAsync</a> method for deleting all data in a bound table.</span></span></p></li><li><p><span data-ttu-id="84377-141">Методы <a href="/javascript/api/office/office.tablebinding#setformatsasync-cellformat--options--callback-" target="_blank">setFormatsAsync</a>, <a href="/javascript/api/office/office.tablebinding#clearformatsasync-options--callback-" target="_blank">clearFormatsAsync</a> и <a href="/javascript/api/office/office.tablebinding#settableoptionsasync-tableoptions--options--callback-" target="_blank">setTableOptionsAsync</a> объекта <span class="keyword">TableBinding</span> для настройки форматирования и параметров связанных таблиц.</span><span class="sxs-lookup"><span data-stu-id="84377-141">The <a href="/javascript/api/office/office.tablebinding#setformatsasync-cellformat--options--callback-" target="_blank">setFormatsAsync</a>, <a href="/javascript/api/office/office.tablebinding#clearformatsasync-options--callback-" target="_blank">clearFormatsAsync</a>, and <a href="/javascript/api/office/office.tablebinding#settableoptionsasync-tableoptions--options--callback-" target="_blank">setTableOptionsAsync</a> methods of the <span class="keyword">TableBinding</span> object for setting formatting and options on bound tables.</span></span></p></li><li><p><span data-ttu-id="84377-142">Все элементы объектов <a href="/javascript/api/office/office.customxmlnode" target="_blank">CustomXmlNode</a>, <a href="/javascript/api/office/office.customxmlpart" target="_blank">CustomXmlPart</a>, <a href="/javascript/api/office/office.customxmlparts" target="_blank">CustomXmlParts</a> и <a href="/javascript/api/office/office.customxmlprefixmappings" target="_blank">CustomXmlPrefixMappings</a>.</span><span class="sxs-lookup"><span data-stu-id="84377-142">All of the members of the <a href="/javascript/api/office/office.customxmlnode" target="_blank">CustomXmlNode</a>, <a href="/javascript/api/office/office.customxmlpart" target="_blank">CustomXmlPart</a>, <a href="/javascript/api/office/office.customxmlparts" target="_blank">CustomXmlParts</a>, and <a href="/javascript/api/office/office.customxmlprefixmappings" target="_blank">CustomXmlPrefixMappings</a> objects.</span></span></p></li><li><p><span data-ttu-id="84377-143">Все методы для подписки на события, поддерживаемые контентными надстройками и надстройками области задач, в частности методы <span class="keyword">addHandlerAsync</span> и <span class="keyword">removeHandlerAsync</span> объектов <a href="/javascript/api/office/office.binding" target="_blank">Binding</a>, <a href="/javascript/api/office/office.customxmlpart" target="_blank">CustomXmlPart</a>, <a href="/javascript/api/office/office.document" target="_blank">Document</a>, <a href="/javascript/api/office/office.document" target="_blank">ProjectDocument</a> и <a href="/javascript/api/office/office.document#settings" target="_blank">Settings</a>.</span><span class="sxs-lookup"><span data-stu-id="84377-143">All of the methods for subscribing to the events supported by content and task pane add-ins, specifically the <span class="keyword">addHandlerAsync</span> and <span class="keyword">removeHandlerAsync</span> methods of the <a href="/javascript/api/office/office.binding" target="_blank">Binding</a>, <a href="/javascript/api/office/office.customxmlpart" target="_blank">CustomXmlPart</a>, <a href="/javascript/api/office/office.document" target="_blank">Document</a>, <a href="/javascript/api/office/office.document" target="_blank">ProjectDocument</a>, and <a href="/javascript/api/office/office.document#settings" target="_blank">Settings</a> objects.</span></span></p></li></ul>|

## <a name="see-also"></a><span data-ttu-id="84377-144">См. также</span><span class="sxs-lookup"><span data-stu-id="84377-144">See also</span></span>

- [<span data-ttu-id="84377-145">Конфиденциальность и безопасность надстроек Office</span><span class="sxs-lookup"><span data-stu-id="84377-145">Privacy and security for Office Add-ins</span></span>](../concepts/privacy-and-security.md)
