---
title: Создание проектов надстроек Office с помощью генератора Yeoman
description: Узнайте, как создавать проекты надстроек Office с помощью генератора Yeoman для надстроек Office.
ms.date: 08/19/2022
ms.localizationpriority: high
ms.openlocfilehash: f109c4dbc386a4cc23f72d0c67f9e4904360bba4
ms.sourcegitcommit: 0be4cd0680d638cf96c12263a71af59ff9f51f5a
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/24/2022
ms.locfileid: "67422798"
---
# <a name="create-office-add-in-projects-using-the-yeoman-generator"></a>Создание проектов надстроек Office с помощью генератора Yeoman

Генератор [Yeoman для надстроек Office](https://github.com/OfficeDev/generator-office) (также называемый Yo Office) — это интерактивное Node.js командной строки, которое создает проекты разработки надстроек Office. Мы рекомендуем использовать это средство для создания проектов надстроек, за исключением случаев, когда серверный код надстройки должен быть в . Язык на основе NET (например, C# или VB.Net) или надстройка, размещенная на сервере IIS. В любой из двух последних ситуаций используйте [Visual Studio для создания надстройки](develop-add-ins-visual-studio.md).

Проекты, созданные средством, имеют следующие характеристики.

- Они имеют стандартную [конфигурацию npm](https://www.npmjs.com/) , которая включает **файл package.json** .
- Они включают несколько полезных сценариев для сборки проекта, запуска сервера, загрузки неопубликоваемой надстройки в Office и выполнения других задач.
- Они используют [webpack в](https://webpack.js.org/) качестве средства запуска пакетов и базового средства выполнения задач.
- В режиме разработки они размещаются на localhost на сервере webpack на основе Node.js webpack-dev-server, ориентированной на разработку версии [express server,](http://expressjs.com/) которая поддерживает горячую перезагрузку и повторную компиляцию при изменении.
- По умолчанию все зависимости устанавливаются средством, но вы можете отложить установку с помощью аргумента командной строки.
- Они включают полный манифест надстройки.
- У них есть надстройка Hello World уровня, которая готова к запуску сразу после завершения работы средства.
- К ним относятся полизаполнение и трансплер, настроенные для транспилирования TypeScript и последних версий JavaScript, в ES5 JavaScript. Эти функции гарантируют, что надстройка поддерживается во всех средах выполнения, в которых могут работать надстройки Office, включая Internet Explorer.

> [!TIP]
> Если вы хотите значительно отойти от этих вариантов, например с помощью другого средства выполнения задач или другого сервера, рекомендуется при запуске средства выбрать параметр "Только манифест ["](#manifest-only-option).

## <a name="install-the-generator"></a>Установка генератора

[!include[Set up requirements](../includes/set-up-dev-environment-beforehand.md)]
[!include[Yeoman generator prerequisites](../includes/quickstart-yo-prerequisites.md)]

## <a name="use-the-tool"></a>Использование средства

Запустите средство с помощью следующей команды в системной командной строке (а не в окне Bash).

```command&nbsp;line
yo office 
```

Необходимо загрузить много ресурсов, поэтому перед запуском средства может потребоваться 20 секунд. Средство задает ряд вопросов. Для некоторых просто введите ответ на запрос. Другим пользователям предоставляется список возможных ответов. Если задан список, выберите его и нажмите клавишу ВВОД.

В первом вопросе предлагается выбрать один из шести типов проектов. Доступны следующие варианты:

- **Проект области задач надстройки Office**
- **Проект области задач надстройки Office с использованием Angular платформы**
- **Проект области задач надстройки Office с использованием React платформы**
- **Проект области задач надстройки Office, поддерживающий единый вход**
- **Проект надстройки Office, содержащий только манифест**
- **Проект надстройки пользовательских функций Excel**

![Снимок экрана: запрос типа проекта и возможные ответы в генераторе Yeoman.](../images/yo-office-project-type-prompt.png)

> [!NOTE]
> Проект **области** задач надстройки Office, поддерживающий параметр единого входа, создает проект, который можно использовать для просмотра принципов работы единого входа в надстройке. Проект нельзя использовать в качестве основы рабочей надстройки. Чтобы получить проект с поддержкой единого входа, который может быть основой рабочей надстройки, ознакомьтесь с версией "Полная" одного из примеров единого входа в нашем репозитории [примеров.](https://github.com/OfficeDev/Office-Add-in-samples/tree/main/Samples/auth)
>
> Проект **надстройки Office** , содержащий параметр "Только манифест", создает проект, содержащий базовый манифест надстройки и минимальный шаблон. Дополнительные сведения о параметре см. в [разделе "Только манифест"](#manifest-only-option).

В следующем вопросе вам будет предложено выбрать **между TypeScript** и **JavaScript**. (Этот вопрос пропускается, если в предыдущем вопросе был выбран параметр только для манифеста.)

![Снимок экрана, показывающий, что пользователь выбрал "Проект области задач надстройки Office" для предыдущего вопроса и отображает запрос языка и возможные ответы, TypeScript и JavaScript, в генераторе Yeoman.](../images/yo-office-language-prompt.png)

Затем вам будет предложено присвоить надстройке имя. Имя, которое вы укажете, будет использоваться в манифесте надстройки, но его можно изменить позже.

![Снимок экрана: пользователь выбрал TypeScript для предыдущего вопроса и отображает запрос имени надстройки в генераторе Yeoman.](../images/yo-office-name-prompt.png)

Затем вам будет предложено выбрать приложение Office, в котором должна работать надстройка. Существует шесть возможных приложений: **Excel**, **OneNote**, **Outlook**, **PowerPoint**, **Project** и **Word**. Необходимо выбрать только один, но вы можете изменить манифест позже для поддержки дополнительных приложений Office. Исключением является Outlook. Манифест, поддерживающие Outlook, не может поддерживать любое другое приложение Office.

![Снимок экрана: пользователь с именем проекта "Надстройка Contoso" и запросом приложения Office и возможными ответами в генераторе Yeoman.](../images/yo-office-host-prompt.png)

После ответа на этот вопрос генератор создает проект и устанавливает зависимости. В выходных **данных** npm на экране могут отображаться сообщения WARN. Их можно игнорировать. Кроме того, могут появиться сообщения об обнаружении уязвимостей. Пока их можно игнорировать, но в конечном итоге потребуется исправить их до выпуска надстройки в рабочую среду. Дополнительные сведения об устранении уязвимостей см. в браузере и выполните поиск по запросу "уязвимость npm".

Если создание прошло успешно, вы увидите сообщение **с поздравлением!** сообщение в командном окне, а затем некоторые предлагаемые дальнейшие действия. (Если вы используете генератор в рамках краткого руководства или руководства, пропустите следующие шаги в командной окне и следуйте инструкциям в этой статье.)

> [!TIP]
> Если вы хотите создать шаблон проекта надстройки Office, но отложить установку зависимостей, `--skip-install` добавьте этот параметр в команду `yo office` . Ниже приведен код в качестве примера.
>
> ```command&nbsp;line
> yo office --skip-install
> ```
>
> Когда все будет готово к установке зависимостей, перейдите в корневую папку проекта в командной строке и введите `npm install`.

## <a name="manifest-only-option"></a>Параметр "Только манифест"

Этот параметр создает только манифест для надстройки. В итоговом проекте нет надстройки Hello World, скриптов или зависимостей. Используйте этот параметр в следующих сценариях.

- Вы хотите использовать разные инструменты, чем те, которые проект генератора Yeoman устанавливает и настраивает по умолчанию. Например, вы хотите использовать другой пакет, транспилер, средство выполнения задач или сервер разработки.
- Вы хотите использовать платформу разработки веб-приложений, кроме Angular или React, например Vue.

Пример использования генератора с параметром только манифеста см. в статье "Использование Vue для создания надстройки области [задач Excel"](../quickstarts/excel-quickstart-vue.md).

## <a name="use-command-line-parameters"></a>Использование параметров командной строки

Вы также можете добавить параметры в команду `yo office` . Наиболее распространенные из них:

- `yo office --details`: выведите краткую справку обо всех остальных параметрах командной строки.
- `yo office --skip-install`: это предотвратит установку зависимостей генератором.

Подробные сведения о параметрах командной строки см. в файле сведений о генераторе в генераторе [Yeoman для надстроек Office](https://github.com/officedev/generator-office).

## <a name="troubleshooting"></a>Устранение неполадок

Если при использовании средства возникают проблемы, сначала необходимо переустановить его, чтобы убедиться, что у вас установлена последняя версия. (Дополнительные [сведения см. в разделе "Установка](#install-the-generator) генератора".) Если это не устраните проблему, найдите средство в репозитории [GitHub](https://github.com/OfficeDev/generator-office/issues) , чтобы узнать, сталкивались ли другие пользователи с такой же проблемой и нашли ли они решение. Если у вас ее нет, [создайте новую проблему](https://github.com/OfficeDev/generator-office/issues/new?assignees=&labels=needs+triage&template=bug_report.md&title=).
