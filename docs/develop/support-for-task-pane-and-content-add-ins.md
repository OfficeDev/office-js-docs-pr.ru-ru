---
title: Поддержка API JavaScript для Office для контентных надстроек и надстроек области задач в Office 2013
description: Используйте API JavaScript для Office, чтобы создать область задач в Office 2013.
ms.date: 02/27/2020
localization_priority: Normal
ms.openlocfilehash: 334db88bbec07755678e3ba35e0d4998951ff5ab
ms.sourcegitcommit: be23b68eb661015508797333915b44381dd29bdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/08/2020
ms.locfileid: "44609708"
---
# <a name="office-javascript-api-support-for-content-and-task-pane-add-ins-in-office-2013"></a><span data-ttu-id="c3ae2-103">Поддержка API JavaScript для Office для контентных надстроек и надстроек области задач в Office 2013</span><span class="sxs-lookup"><span data-stu-id="c3ae2-103">Office JavaScript API support for content and task pane add-ins in Office 2013</span></span>

[!include[information about the common API](../includes/alert-common-api-info.md)]

<span data-ttu-id="c3ae2-p101">Вы можете использовать [API JavaScript для Office](../reference/javascript-api-for-office.md) для создания надстроек области задач или контентных надстроек для ведущих приложений Office 2013. Объекты и методы, поддерживаемые контентными надстройками и надстройками области задач, можно сгруппировать указанным ниже образом.</span><span class="sxs-lookup"><span data-stu-id="c3ae2-p101">You can use the [Office JavaScript API](../reference/javascript-api-for-office.md) to create task pane or content add-ins for Office 2013 host applications. The objects and methods that content and task pane add-ins support are categorized as follows:</span></span>

1. <span data-ttu-id="c3ae2-106">**Общие объекты, которые используются совместно с другими надстройками Office.** К этим объектам относятся [Office](/javascript/api/office), [context](/javascript/api/office/office.context)и [asyncResult](/javascript/api/office/office.asyncresult).</span><span class="sxs-lookup"><span data-stu-id="c3ae2-106">**Common objects shared with other Office Add-ins.** These objects include [Office](/javascript/api/office), [Context](/javascript/api/office/office.context), and [AsyncResult](/javascript/api/office/office.asyncresult).</span></span> <span data-ttu-id="c3ae2-107">`Office`Объект является корневым объектом API JavaScript для Office.</span><span class="sxs-lookup"><span data-stu-id="c3ae2-107">The `Office` object is the root object of the Office JavaScript API.</span></span> <span data-ttu-id="c3ae2-108">`Context`Объект представляет среду выполнения надстройки.</span><span class="sxs-lookup"><span data-stu-id="c3ae2-108">The `Context` object represents the add-in's runtime environment.</span></span> <span data-ttu-id="c3ae2-109">Оба `Office` и `Context` являются основными объектами для любой надстройки Office.</span><span class="sxs-lookup"><span data-stu-id="c3ae2-109">Both `Office` and `Context` are the fundamental objects for any Office Add-in.</span></span> <span data-ttu-id="c3ae2-110">`AsyncResult`Объект представляет результаты асинхронной операции, например данные, возвращенные в `getSelectedDataAsync` метод, который считывает сведения о том, что пользователь выбрал в документе.</span><span class="sxs-lookup"><span data-stu-id="c3ae2-110">The `AsyncResult` object represents the results of an asynchronous operation, such as the data returned to the `getSelectedDataAsync` method, which reads what a user has selected in a document.</span></span>

2. <span data-ttu-id="c3ae2-111">**Объект Document.**</span><span class="sxs-lookup"><span data-stu-id="c3ae2-111">**The Document object.**</span></span> <span data-ttu-id="c3ae2-112">Большей частью API, доступной для контентных надстроек и надстроек области задач, можно воспользоваться с помощью методов, свойств и событий объекта [Document](/javascript/api/office/office.document).</span><span class="sxs-lookup"><span data-stu-id="c3ae2-112">The majority of the API available to content and task pane add-ins is exposed through the methods, properties, and events of the [Document](/javascript/api/office/office.document) object.</span></span> <span data-ttu-id="c3ae2-113">Контентная надстройка или надстройка области задач может использовать свойство [Office.context.document](/javascript/api/office/office.context#document) для доступа к объекту **Document** и с его помощью получать доступ к ключевым компонентам API для работы с данными в документах, например к объектам [Bindings](/javascript/api/office/office.bindings) и [CustomXmlParts](/javascript/api/office/office.customxmlparts) и методам [getSelectedDataAsync](/javascript/api/office/office.document#getselecteddataasync-coerciontype--options--callback-), [setSelectedDataAsync](/javascript/api/office/office.document#setselecteddataasync-data--options--callback-)и [getFileAsync](/javascript/api/office/office.document#getfileasync-filetype--options--callback-).</span><span class="sxs-lookup"><span data-stu-id="c3ae2-113">A content or task pane add-in can use the [Office.context.document](/javascript/api/office/office.context#document) property to access the **Document** object, and through it, can access the key members of the API for working with data in documents, such as the [Bindings](/javascript/api/office/office.bindings) and [CustomXmlParts](/javascript/api/office/office.customxmlparts) objects, and the [getSelectedDataAsync](/javascript/api/office/office.document#getselecteddataasync-coerciontype--options--callback-), [setSelectedDataAsync](/javascript/api/office/office.document#setselecteddataasync-data--options--callback-), and [getFileAsync](/javascript/api/office/office.document#getfileasync-filetype--options--callback-) methods.</span></span> <span data-ttu-id="c3ae2-114">`Document`Объект также предоставляет свойство [mode](/javascript/api/office/office.document#mode) для определения того, является ли документ предназначен только для чтения или находится в режиме редактирования, свойство [URL](/javascript/api/office/office.document#url) для получения URL-адреса текущего документа и доступа к объекту [Settings](/javascript/api/office/office.settings) .</span><span class="sxs-lookup"><span data-stu-id="c3ae2-114">The `Document` object also provides the [mode](/javascript/api/office/office.document#mode) property for determining whether a document is read-only or in edit mode, the [url](/javascript/api/office/office.document#url) property to get the URL of the current document, and access to the [Settings](/javascript/api/office/office.settings) object.</span></span> <span data-ttu-id="c3ae2-115">`Document`Объект также поддерживает добавление обработчиков событий для события [SelectionChanged](/javascript/api/office/office.documentselectionchangedeventargs) , чтобы можно было обнаружить, когда пользователь изменяет свой выбор в документе.</span><span class="sxs-lookup"><span data-stu-id="c3ae2-115">The `Document` object also supports adding event handlers for the [SelectionChanged](/javascript/api/office/office.documentselectionchangedeventargs) event, so you can detect when a user changes their selection in the document.</span></span>

   <span data-ttu-id="c3ae2-116">Надстройка области задач или контентная надстройка может получать доступ к `Document` объекту только после загрузки модели DOM и среды выполнения, обычно в обработчике события для события [Office. Initialize](/javascript/api/office) .</span><span class="sxs-lookup"><span data-stu-id="c3ae2-116">A content or task pane add-in can access the `Document` object only after the DOM and runtime environment has been loaded, typically in the event handler for the [Office.initialize](/javascript/api/office) event.</span></span> <span data-ttu-id="c3ae2-117">Сведения о потоке событий при инициализации надстройки и проверке успешности загрузки модели DOM и среды выполнения см. в разделе [Loading the DOM and runtime environment](loading-the-dom-and-runtime-environment.md).</span><span class="sxs-lookup"><span data-stu-id="c3ae2-117">For information about the flow of events when an add-in is initialized, and how to check that the DOM and runtime and loaded successfully, see [Loading the DOM and runtime environment](loading-the-dom-and-runtime-environment.md).</span></span>

3. <span data-ttu-id="c3ae2-p105">**Объекты для работы с конкретными функциями.** Для работы с конкретными функциями API используйте указанные ниже объекты и методы.</span><span class="sxs-lookup"><span data-stu-id="c3ae2-p105">**Objects for working with specific features.** To work with specific features of the API, use the following objects and methods:</span></span>

    - <span data-ttu-id="c3ae2-120">Используйте методы объекта [Bindings](/javascript/api/office/office.bindings) для создания или получения привязок и методы и свойства объекта [Binding](/javascript/api/office/office.binding) для работы с данными.</span><span class="sxs-lookup"><span data-stu-id="c3ae2-120">The methods of the [Bindings](/javascript/api/office/office.bindings) object to create or get bindings, and the methods and properties of the [Binding](/javascript/api/office/office.binding) object to work with data.</span></span>

    - <span data-ttu-id="c3ae2-121">Используйте объекты [CustomXmlParts](/javascript/api/office/office.customxmlparts), [CustomXmlPart](/javascript/api/office/office.customxmlpart) и сопоставленные с ними объекты для создания пользовательских XML-частей в документах Word и управления ими.</span><span class="sxs-lookup"><span data-stu-id="c3ae2-121">The [CustomXmlParts](/javascript/api/office/office.customxmlparts), [CustomXmlPart](/javascript/api/office/office.customxmlpart) and associated objects to create and manipulate custom XML parts in Word documents.</span></span>

    - <span data-ttu-id="c3ae2-122">Используйте объекты [File](/javascript/api/office/office.file) и [Slice](/javascript/api/office/office.slice) для создания копии всего документа, его разбивки на блоки или "фрагменты" и последующего считывания или передачи данных, содержащихся в этих фрагментах.</span><span class="sxs-lookup"><span data-stu-id="c3ae2-122">The [File](/javascript/api/office/office.file) and [Slice](/javascript/api/office/office.slice) objects to create a copy of the entire document, break it into chunks or "slices", and then read or transmit the data in those slices.</span></span>

    - <span data-ttu-id="c3ae2-123">Используйте объект [Settings](/javascript/api/office/office.settings) для сохранения пользовательских данных, например настроек пользователей и состояния надстройки.</span><span class="sxs-lookup"><span data-stu-id="c3ae2-123">The [Settings](/javascript/api/office/office.settings) object to save custom data, such as user preferences, and add-in state.</span></span>


> [!IMPORTANT]
> <span data-ttu-id="c3ae2-124">Некоторые элементы API поддерживаются не всеми приложениями Office, в которых могут размещаться контентные надстройки и надстройки области задач. Чтобы определить, какие элементы поддерживаются, см. один из указанных ниже ресурсов.</span><span class="sxs-lookup"><span data-stu-id="c3ae2-124">Some of the API members aren't supported across all Office applications that can host content and task pane add-ins. To determine which members are supported, see any of the following:</span></span>

<span data-ttu-id="c3ae2-125">Сводка по поддержке API JavaScript для Office в ведущих приложениях Office приведена [в статье Общие сведения об API JavaScript для Office](understanding-the-javascript-api-for-office.md).</span><span class="sxs-lookup"><span data-stu-id="c3ae2-125">For a summary of Office JavaScript API support across Office host applications, see [Understanding the Office JavaScript API](understanding-the-javascript-api-for-office.md).</span></span>


## <a name="reading-and-writing-to-an-active-selection"></a><span data-ttu-id="c3ae2-126">Чтение и запись данных в активное выделение</span><span class="sxs-lookup"><span data-stu-id="c3ae2-126">Reading and writing to an active selection</span></span>

<span data-ttu-id="c3ae2-127">Вы можете считывать данные из текущего выделения пользователя в документе, электронной таблице или презентации, а также записывать их в это выделение.</span><span class="sxs-lookup"><span data-stu-id="c3ae2-127">You can read or write to the user's current selection in a document, spreadsheet, or presentation.</span></span> <span data-ttu-id="c3ae2-128">В зависимости от ведущего приложения можно указать тип структуры данных, которая будет считана или записана, в качестве параметра методов [getSelectedDataAsync](/javascript/api/office/office.document#getselecteddataasync-coerciontype--options--callback-) и [setSelectedDataAsync](/javascript/api/office/office.document#setselecteddataasync-data--options--callback-) объекта [Document](/javascript/api/office/office.document).</span><span class="sxs-lookup"><span data-stu-id="c3ae2-128">Depending on the host application for your add-in, you can specify the type of data structure to read or write as a parameter in the [getSelectedDataAsync](/javascript/api/office/office.document#getselecteddataasync-coerciontype--options--callback-) and [setSelectedDataAsync](/javascript/api/office/office.document#setselecteddataasync-data--options--callback-) methods of the [Document](/javascript/api/office/office.document) object.</span></span> <span data-ttu-id="c3ae2-129">Например, вы можете указать любой тип данных (текст, HTML, табличные данные или Office Open XML) для Word, текст и табличные данные для Excel, а также текст для PowerPoint и Project.</span><span class="sxs-lookup"><span data-stu-id="c3ae2-129">For example, you can specify any type of data (text, HTML, tabular data, or Office Open XML) for Word, text and tabular data for Excel, and text for PowerPoint and Project.</span></span> <span data-ttu-id="c3ae2-130">Вы также можете создать обработчики событий для обнаружения изменений в выделении пользователя.</span><span class="sxs-lookup"><span data-stu-id="c3ae2-130">You can also create event handlers to detect changes to the user's selection.</span></span> <span data-ttu-id="c3ae2-131">В примере ниже показано, как получить данные из выделенного фрагмента в виде текста с помощью `getSelectedDataAsync` метода.</span><span class="sxs-lookup"><span data-stu-id="c3ae2-131">The following example gets data from the selection as text using the `getSelectedDataAsync` method.</span></span>


```js
Office.context.document.getSelectedDataAsync(
    Office.CoercionType.Text, function (asyncResult) {
        if (asyncResult.status == Office.AsyncResultStatus.Failed) {
            write('Action failed. Error: ' + asyncResult.error.message);
        }
        else {
            write('Selected data: ' + asyncResult.value);
        }
    });

// Function that writes to a div with id='message' on the page.
function write(message){
    document.getElementById('message').innerText += message;
}

```

<span data-ttu-id="c3ae2-132">Дополнительные сведения и примеры см. в статье [Чтение и запись данных в активное выделение в документе или в электронной таблице](read-and-write-data-to-the-active-selection-in-a-document-or-spreadsheet.md).</span><span class="sxs-lookup"><span data-stu-id="c3ae2-132">For more details and examples, see [Read and write data to the active selection in a document or spreadsheet](read-and-write-data-to-the-active-selection-in-a-document-or-spreadsheet.md).</span></span>


## <a name="binding-to-a-region-in-a-document-or-spreadsheet"></a><span data-ttu-id="c3ae2-133">Привязка к областям в документе или электронной таблице</span><span class="sxs-lookup"><span data-stu-id="c3ae2-133">Binding to a region in a document or spreadsheet</span></span>

<span data-ttu-id="c3ae2-134">Можно использовать `getSelectedDataAsync` `setSelectedDataAsync` методы и для чтения или записи в выделенный фрагмент пользователя в *current* документе, электронной таблице или презентации.</span><span class="sxs-lookup"><span data-stu-id="c3ae2-134">You can use the `getSelectedDataAsync` and `setSelectedDataAsync` methods to read or write to the user's *current* selection in a document, spreadsheet, or presentation.</span></span> <span data-ttu-id="c3ae2-135">Тем не менее если вам необходимо обращаться к одной области документа в различных сеансах запущенной надстройки, не принуждая пользователя делать выбор, сначала потребуется создать привязку к этой области.</span><span class="sxs-lookup"><span data-stu-id="c3ae2-135">However, if you would like to access the same region in a document across sessions of running your add-in without requiring the user to make a selection, you should first bind to that region.</span></span> <span data-ttu-id="c3ae2-136">Вы также сможете подписаться на события изменения данных и выделения только для этой привязанной области.</span><span class="sxs-lookup"><span data-stu-id="c3ae2-136">You can also subscribe to data and selection change events for that bound region.</span></span>

<span data-ttu-id="c3ae2-p108">Привязку можно добавить с помощью методов [addFromNamedItemAsync](/javascript/api/office/office.bindings#addfromnameditemasync-itemname--bindingtype--options--callback-), [addFromPromptAsync](/javascript/api/office/office.bindings#addfrompromptasync-bindingtype--options--callback-) или [addFromSelectionAsync](/javascript/api/office/office.bindings#addfromselectionasync-bindingtype--options--callback-) объекта [Bindings](/javascript/api/office/office.bindings). Они возвращают идентификатор, который можно использовать для доступа к данным в привязке или для подписки на события изменения данных или выделения в привязанной области.</span><span class="sxs-lookup"><span data-stu-id="c3ae2-p108">You can add a binding by using [addFromNamedItemAsync](/javascript/api/office/office.bindings#addfromnameditemasync-itemname--bindingtype--options--callback-), [addFromPromptAsync](/javascript/api/office/office.bindings#addfrompromptasync-bindingtype--options--callback-), or [addFromSelectionAsync](/javascript/api/office/office.bindings#addfromselectionasync-bindingtype--options--callback-) methods of the [Bindings](/javascript/api/office/office.bindings) object. These methods return an identifier that you can use to access data in the binding, or to subscribe to its data change or selection change events.</span></span>

<span data-ttu-id="c3ae2-139">Ниже приведен пример, в котором показано, как добавить привязку к текущему выбранному тексту в документе с помощью `Bindings.addFromSelectionAsync` метода.</span><span class="sxs-lookup"><span data-stu-id="c3ae2-139">The following is an example that adds a binding to the currently selected text in a document, by using the `Bindings.addFromSelectionAsync` method.</span></span>



```js
Office.context.document.bindings.addFromSelectionAsync(
    Office.BindingType.Text, { id: 'myBinding' }, function (asyncResult) {
    if (asyncResult.status == Office.AsyncResultStatus.Failed) {
        write('Action failed. Error: ' + asyncResult.error.message);
    } else {
        write('Added new binding with type: ' +
            asyncResult.value.type + ' and id: ' + asyncResult.value.id);
    }
});

// Function that writes to a div with id='message' on the page.
function write(message){
    document.getElementById('message').innerText += message; 
}
```

<span data-ttu-id="c3ae2-140">Дополнительные сведения и примеры см. в статье [Привязка к областям в документе или электронной таблице](bind-to-regions-in-a-document-or-spreadsheet.md).</span><span class="sxs-lookup"><span data-stu-id="c3ae2-140">For more details and examples, see [Bind to regions in a document or spreadsheet](bind-to-regions-in-a-document-or-spreadsheet.md).</span></span>


## <a name="getting-entire-documents"></a><span data-ttu-id="c3ae2-141">Получение документов целиком</span><span class="sxs-lookup"><span data-stu-id="c3ae2-141">Getting entire documents</span></span>

<span data-ttu-id="c3ae2-142">Если надстройка области задач работает в PowerPoint или Word, то для получения презентации или документа целиком вы можете использовать методы [Document.getFileAsync](/javascript/api/office/office.document#getfileasync-filetype--options--callback-), [File.getSliceAsync](/javascript/api/office/office.file#getsliceasync-sliceindex--callback-)и [File.closeAsync](/javascript/api/office/office.file#closeasync-callback-).</span><span class="sxs-lookup"><span data-stu-id="c3ae2-142">If your task pane add-in runs in PowerPoint or Word, you can use the [Document.getFileAsync](/javascript/api/office/office.document#getfileasync-filetype--options--callback-), [File.getSliceAsync](/javascript/api/office/office.file#getsliceasync-sliceindex--callback-), and [File.closeAsync](/javascript/api/office/office.file#closeasync-callback-) methods to get an entire presentation or document.</span></span>

<span data-ttu-id="c3ae2-143">При вызове `Document.getFileAsync` вы получите копию документа в объекте [File](/javascript/api/office/office.file) .</span><span class="sxs-lookup"><span data-stu-id="c3ae2-143">When you call `Document.getFileAsync` you get a copy of the document in a [File](/javascript/api/office/office.file) object.</span></span> <span data-ttu-id="c3ae2-144">`File`Объект предоставляет доступ к документу в виде фрагментов, представленных в виде объектов [slice](/javascript/api/office/office.slice) .</span><span class="sxs-lookup"><span data-stu-id="c3ae2-144">The `File` object provides access to the document in "chunks" represented as [Slice](/javascript/api/office/office.slice) objects.</span></span> <span data-ttu-id="c3ae2-145">При вызове `getFileAsync` можно указать тип файла (текст или сжатый формат Open Office XML) и размер срезов (до 4 МБ).</span><span class="sxs-lookup"><span data-stu-id="c3ae2-145">When you call `getFileAsync`, you can specify the file type (text or compressed Open Office XML format), and size of the slices (up to 4MB).</span></span> <span data-ttu-id="c3ae2-146">Чтобы получить доступ к содержимому `File` объекта, затем вызывается метод, `File.getSliceAsync` который возвращает необработанные данные в свойстве [slice. Data](/javascript/api/office/office.slice#data) .</span><span class="sxs-lookup"><span data-stu-id="c3ae2-146">To access the contents of the `File` object, you then call `File.getSliceAsync` which returns the raw data in the [Slice.data](/javascript/api/office/office.slice#data) property.</span></span> <span data-ttu-id="c3ae2-147">Если вы выбрали сжатый формат, то получите данные файлов в виде массива байтов.</span><span class="sxs-lookup"><span data-stu-id="c3ae2-147">If you specified compressed format, you will get the file data as a byte array.</span></span> <span data-ttu-id="c3ae2-148">Если вы передаете файл в веб-службу, перед отправкой можно преобразовать сжатые необработанные данные в строку с кодировкой Base64.</span><span class="sxs-lookup"><span data-stu-id="c3ae2-148">If you are transmitting the file to a web service, you can transform the compressed raw data to a base64-encoded string before submission.</span></span> <span data-ttu-id="c3ae2-149">Наконец, когда вы закончите извлечение фрагментов файла, используйте метод, `File.closeAsync` чтобы закрыть документ.</span><span class="sxs-lookup"><span data-stu-id="c3ae2-149">Finally, when you are finished getting slices of the file, use the `File.closeAsync` method to close the document.</span></span>

<span data-ttu-id="c3ae2-150">Дополнительные сведения см. в инструкции по [получению документа целиком из надстройки для PowerPoint или Word](../word/get-the-whole-document-from-an-add-in-for-word.md).</span><span class="sxs-lookup"><span data-stu-id="c3ae2-150">For more details, see how to [get the whole document from an add-in for PowerPoint or Word](../word/get-the-whole-document-from-an-add-in-for-word.md).</span></span>


## <a name="reading-and-writing-custom-xml-parts-of-a-word-document"></a><span data-ttu-id="c3ae2-151">Чтение и запись настраиваемых XML-частей документа Word</span><span class="sxs-lookup"><span data-stu-id="c3ae2-151">Reading and writing custom XML parts of a Word document</span></span>

<span data-ttu-id="c3ae2-p110">С помощью формата файлов Open Office XML и элементов управления контентом вы можете добавлять пользовательские XML-части в документ Word и привязывать элементы в XML-частях к элементам управления контентом в этом документе. При открытии документа Word считывает и автоматически заполняет привязанные элементы управления контентом данными из пользовательских XML-частей. Кроме того, пользователи могут записывать данные в элементы управления контентом. Когда пользователь сохраняет документ, данные в элементах управления также сохраняются в привязанных XML-частях. Надстройки области задач для Word могут использовать свойство [Document.customXmlParts](/javascript/api/office/office.document#customxmlparts), а также объекты [CustomXmlParts](/javascript/api/office/office.customxmlparts), [CustomXmlPart](/javascript/api/office/office.customxmlpart)и [CustomXmlNode](/javascript/api/office/office.customxmlnode) для динамического считывания и записи данных в документ.</span><span class="sxs-lookup"><span data-stu-id="c3ae2-p110">Using the Open Office XML file format and content controls, you can add custom XML parts to a Word document and bind elements in the XML parts to content controls in that document. When you open the document, Word reads and automatically populates bound content controls with data from the custom XML parts. Users can also write data into the content controls, and when the user saves the document, the data in the controls will be saved to the bound XML parts. Task pane add-ins for Word, can use the [Document.customXmlParts](/javascript/api/office/office.document#customxmlparts) property,[CustomXmlParts](/javascript/api/office/office.customxmlparts), [CustomXmlPart](/javascript/api/office/office.customxmlpart), and [CustomXmlNode](/javascript/api/office/office.customxmlnode) objects to read and write data dynamically to the document.</span></span>

<span data-ttu-id="c3ae2-p111">Пользовательские XML-части можно сопоставить с пространствами имен. Чтобы получить данные из пользовательских XML-частей в пространстве имен, используйте метод [CustomXmlParts.getByNamespaceAsync](/javascript/api/office/office.customxmlparts#getbynamespaceasync-ns--options--callback-).</span><span class="sxs-lookup"><span data-stu-id="c3ae2-p111">Custom XML parts may be associated with namespaces. To get data from custom XML parts in a namespace, use the [CustomXmlParts.getByNamespaceAsync](/javascript/api/office/office.customxmlparts#getbynamespaceasync-ns--options--callback-) method.</span></span>

<span data-ttu-id="c3ae2-p112">Кроме того, вы можете использовать метод [CustomXmlParts.getByIdAsync](/javascript/api/office/office.customxmlparts#getbyidasync-id--options--callback-), чтобы получить доступ к пользовательским XML-частям по их GUID. После этого можно получить XML-данные с помощью метода [CustomXmlPart.getXmlAsync](/javascript/api/office/office.customxmlpart#getxmlasync-options--callback-).</span><span class="sxs-lookup"><span data-stu-id="c3ae2-p112">You can also use the [CustomXmlParts.getByIdAsync](/javascript/api/office/office.customxmlparts#getbyidasync-id--options--callback-) method to access custom XML parts by their GUIDs. After getting a custom XML part, use the [CustomXmlPart.getXmlAsync](/javascript/api/office/office.customxmlpart#getxmlasync-options--callback-) method to get the XML data.</span></span>

<span data-ttu-id="c3ae2-160">Чтобы добавить в документ новую пользовательскую XML-часть, используйте `Document.customXmlParts` свойство для получения настраиваемых XML-частей в документе и вызовите метод [CustomXmlParts. addAsync](/javascript/api/office/office.customxmlparts#addasync-xml--options--callback-) .</span><span class="sxs-lookup"><span data-stu-id="c3ae2-160">To add a new custom XML part to a document, use the `Document.customXmlParts` property to get the custom XML parts that are in the document, and call the [CustomXmlParts.addAsync](/javascript/api/office/office.customxmlparts#addasync-xml--options--callback-) method.</span></span>

<span data-ttu-id="c3ae2-161">Подробные сведения о работе с пользовательскими XML-частями с помощью надстройки области задач см. в статье [Создание улучшенных надстроек для Word с помощью Office Open XML](../word/create-better-add-ins-for-word-with-office-open-xml.md).</span><span class="sxs-lookup"><span data-stu-id="c3ae2-161">For detailed information about how to work with custom XML parts with a task pane add-in, see [Creating Better Add-ins for Word with Office Open XML](../word/create-better-add-ins-for-word-with-office-open-xml.md).</span></span>


## <a name="persisting-add-in-settings"></a><span data-ttu-id="c3ae2-162">Сохранение настроек надстроек</span><span class="sxs-lookup"><span data-stu-id="c3ae2-162">Persisting add-in settings</span></span>


<span data-ttu-id="c3ae2-163">Надстройкам часто требуется сохранять пользовательские данные, например настройки пользователя или состояние надстройки, и запрашивать их при следующем запуске.</span><span class="sxs-lookup"><span data-stu-id="c3ae2-163">Often you need to save custom data for your add-in, such as a user's preferences or the add-in's state, and access that data the next time the add-in is opened.</span></span> <span data-ttu-id="c3ae2-164">Для этого можно использовать стандартные методы веб-программирования, например файлы cookie в браузере или веб-хранилище HTML 5.</span><span class="sxs-lookup"><span data-stu-id="c3ae2-164">You can use common web programming techniques to save that data, such as browser cookies or HTML 5 web storage.</span></span> <span data-ttu-id="c3ae2-165">Кроме того, если надстройка работает в Excel, PowerPoint или Word, вы можете использовать методы объекта [Settings](/javascript/api/office/office.settings).</span><span class="sxs-lookup"><span data-stu-id="c3ae2-165">Alternatively, if your add-in runs in Excel, PowerPoint, or Word, you can use the methods of the [Settings](/javascript/api/office/office.settings) object.</span></span> <span data-ttu-id="c3ae2-166">Данные, созданные с помощью `Settings` объекта, хранятся в электронной таблице, презентации или документе, в которую надстройка была вставлена и сохранена.</span><span class="sxs-lookup"><span data-stu-id="c3ae2-166">Data created with the `Settings` object is stored in the spreadsheet, presentation, or document that the add-in was inserted into and saved with.</span></span> <span data-ttu-id="c3ae2-167">Данные доступны только для создавшей их надстройки.</span><span class="sxs-lookup"><span data-stu-id="c3ae2-167">This data is available to only the add-in that created it.</span></span>

<span data-ttu-id="c3ae2-168">Чтобы избежать обмена данными с сервером, на котором хранится документ, данные, созданные с помощью `Settings` объекта, управляются в памяти во время выполнения.</span><span class="sxs-lookup"><span data-stu-id="c3ae2-168">To avoid roundtrips to the server where the document is stored, data created with the `Settings` object is managed in memory at run time.</span></span> <span data-ttu-id="c3ae2-169">Ранее сохраненные данные настроек загружаются в память при инициализации надстройки, а внесенные в эти данные изменения сохраняются в документе только при вызове метода [Settings.saveAsync](/javascript/api/office/office.settings#saveasync-options--callback-).</span><span class="sxs-lookup"><span data-stu-id="c3ae2-169">Previously saved settings data is loaded into memory when the add-in is initialized, and changes to that data are only saved back to the document when you call the [Settings.saveAsync](/javascript/api/office/office.settings#saveasync-options--callback-) method.</span></span> <span data-ttu-id="c3ae2-170">Для внутренних целей данные хранятся в сериализованном объекте JSON в виде пар "имя-значение".</span><span class="sxs-lookup"><span data-stu-id="c3ae2-170">Internally, the data is stored in a serialized JSON object as name/value pairs.</span></span> <span data-ttu-id="c3ae2-171">Вы можете использовать методы [get](/javascript/api/office/office.settings#get-name-), [set](/javascript/api/office/office.settings#set-name--value-) и [remove](/javascript/api/office/office.settings#remove-name-) объекта **Settings** для чтения, записи и удаления элементов из копии данных, хранящейся в памяти.</span><span class="sxs-lookup"><span data-stu-id="c3ae2-171">You use the [get](/javascript/api/office/office.settings#get-name-), [set](/javascript/api/office/office.settings#set-name--value-), and [remove](/javascript/api/office/office.settings#remove-name-) methods of the **Settings** object, to read, write, and delete items from the in-memory copy of the data.</span></span> <span data-ttu-id="c3ae2-172">Ниже приведена строка кода, позволяющая создать настройку с именем `themeColor` и задать для нее значение green.</span><span class="sxs-lookup"><span data-stu-id="c3ae2-172">The following line of code shows how to create a setting named `themeColor` and set its value to 'green'.</span></span>




```js
Office.context.document.settings.set('themeColor', 'green');
```

<span data-ttu-id="c3ae2-173">Так как данные параметров, созданные или удаленные с помощью `set` методов и, `remove` работают с копией данных в памяти, необходимо вызвать метод `saveAsync` сохранения изменений данных параметров в документе, с которым работает ваша надстройка.</span><span class="sxs-lookup"><span data-stu-id="c3ae2-173">Because settings data created or deleted with the `set` and `remove` methods is acting on an in-memory copy of the data, you must call `saveAsync` to persist changes to settings data into the document your add-in is working with.</span></span>

<span data-ttu-id="c3ae2-174">Дополнительные сведения о работе с настраиваемыми данными с помощью методов `Settings` объекта см. в статье [Сохранение состояния и параметров надстройки](persisting-add-in-state-and-settings.md).</span><span class="sxs-lookup"><span data-stu-id="c3ae2-174">For more details about working with custom data using the methods of the `Settings` object, see [Persisting add-in state and settings](persisting-add-in-state-and-settings.md).</span></span>


## <a name="reading-properties-of-a-project-document"></a><span data-ttu-id="c3ae2-175">Чтение свойств документа проекта</span><span class="sxs-lookup"><span data-stu-id="c3ae2-175">Reading properties of a project document</span></span>

<span data-ttu-id="c3ae2-176">Если надстройка области задач выполняется в Project, то она может считывать данные из некоторых полей, ресурсов и полей задач в активном проекте.</span><span class="sxs-lookup"><span data-stu-id="c3ae2-176">If your task pane add-in runs in Project, your add-in can read data from some of the project fields, resource, and task fields in the active project.</span></span> <span data-ttu-id="c3ae2-177">Для этого используются методы и события объекта [ProjectDocument](/javascript/api/office/office.document) , которые расширяют `Document` объект для предоставления дополнительных функциональных возможностей, связанных с проектом.</span><span class="sxs-lookup"><span data-stu-id="c3ae2-177">To do that, you use the methods and events of the [ProjectDocument](/javascript/api/office/office.document) object, which extends the `Document` object to provide additional Project-specific functionality.</span></span>

<span data-ttu-id="c3ae2-178">Примеры считывания данных Project см. в статье [Создание первой надстройки области задач для Project 2013 с использованием текстового редактора](../project/create-your-first-task-pane-add-in-for-project-by-using-a-text-editor.md).</span><span class="sxs-lookup"><span data-stu-id="c3ae2-178">For examples of reading Project data, see [Create your first task pane add-in for Project 2013 by using a text editor](../project/create-your-first-task-pane-add-in-for-project-by-using-a-text-editor.md).</span></span>


## <a name="permissions-model-and-governance"></a><span data-ttu-id="c3ae2-179">Модель разрешений и управление</span><span class="sxs-lookup"><span data-stu-id="c3ae2-179">Permissions model and governance</span></span>

<span data-ttu-id="c3ae2-180">Надстройка использует `Permissions` элемент в своем манифесте, чтобы запросить разрешение на доступ к требуемому уровню функциональности API JavaScript для Office.</span><span class="sxs-lookup"><span data-stu-id="c3ae2-180">Your add-in uses the `Permissions` element in its manifest to request permission to access the level of functionality it requires from the Office JavaScript API.</span></span> <span data-ttu-id="c3ae2-181">Например, если надстройке требуется доступ для чтения и записи к документу, его манифест должен указывать в `ReadWriteDocument` качестве текстового значения в `Permissions` элементе.</span><span class="sxs-lookup"><span data-stu-id="c3ae2-181">For example, if your add-in requires read/write access to the document, its manifest must specify `ReadWriteDocument` as the text value in its `Permissions` element.</span></span> <span data-ttu-id="c3ae2-182">Так как разрешения обеспечивают конфиденциальность и безопасность пользователей, рекомендуется запросить минимальный уровень разрешений, необходимый для работы надстройки.</span><span class="sxs-lookup"><span data-stu-id="c3ae2-182">Because permissions exist to protect a user's privacy and security, as a best practice you should request the minimum level of permissions it needs for its features.</span></span> <span data-ttu-id="c3ae2-183">В примере ниже показано, как запросить разрешение **ReadDocument** в манифесте надстройки области задач.</span><span class="sxs-lookup"><span data-stu-id="c3ae2-183">The following example shows how to request the **ReadDocument** permission in a task pane's manifest.</span></span>


```XML
<?xml version="1.0" encoding="utf-8"?>
<OfficeApp xmlns="http://schemas.microsoft.com/office/appforoffice/1.0"
 xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
 xsi:type="TaskPaneApp">
???<!-- Other manifest elements omitted. -->
  <Permissions>ReadDocument</Permissions>
???
</OfficeApp>

```

<span data-ttu-id="c3ae2-184">Дополнительные сведения см в статье [запрашивание разрешений для использования API в](requesting-permissions-for-api-use-in-content-and-task-pane-add-ins.md)надстройках.</span><span class="sxs-lookup"><span data-stu-id="c3ae2-184">For more information, see [Requesting permissions for API use in add-ins](requesting-permissions-for-api-use-in-content-and-task-pane-add-ins.md).</span></span>


## <a name="see-also"></a><span data-ttu-id="c3ae2-185">См. также</span><span class="sxs-lookup"><span data-stu-id="c3ae2-185">See also</span></span>

- [<span data-ttu-id="c3ae2-186">API JavaScript для Office</span><span class="sxs-lookup"><span data-stu-id="c3ae2-186">Office JavaScript API</span></span>](../reference/javascript-api-for-office.md)
- [<span data-ttu-id="c3ae2-187">Справочная схема по манифестам надстроек для Office</span><span class="sxs-lookup"><span data-stu-id="c3ae2-187">Schema reference for Office Add-ins manifests</span></span>](../develop/add-in-manifests.md)
- [<span data-ttu-id="c3ae2-188">Устранение ошибок, с которыми сталкиваются пользователи при работе с надстройками Office</span><span class="sxs-lookup"><span data-stu-id="c3ae2-188">Troubleshoot user errors with Office Add-ins</span></span>](../testing/testing-and-troubleshooting.md)
