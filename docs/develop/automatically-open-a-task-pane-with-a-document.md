---
title: Автоматическое открытие области задач с документом
description: Узнайте, как настроить надстройку Office для автоматического открытия при открытии документа.
ms.date: 07/07/2020
localization_priority: Normal
ms.openlocfilehash: 85b421a569ccb83c3d07f0f10fd4767929332f96
ms.sourcegitcommit: 7ef14753dce598a5804dad8802df7aaafe046da7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/10/2020
ms.locfileid: "45093709"
---
# <a name="automatically-open-a-task-pane-with-a-document"></a><span data-ttu-id="945c8-103">Автоматическое открытие области задач с документом</span><span class="sxs-lookup"><span data-stu-id="945c8-103">Automatically open a task pane with a document</span></span>

<span data-ttu-id="945c8-104">Вы можете использовать команды надстроек в надстройке Office для расширения пользовательского интерфейса Office, добавляя кнопки на ленту приложения Office.</span><span class="sxs-lookup"><span data-stu-id="945c8-104">You can use add-in commands in your Office Add-in to extend the Office UI by adding buttons to the Office app ribbon.</span></span> <span data-ttu-id="945c8-105">Когда пользователи нажимают кнопки, выполняются различные операции (например, открывается область задач).</span><span class="sxs-lookup"><span data-stu-id="945c8-105">When users click your command button, an action occurs, such as opening a task pane.</span></span>

<span data-ttu-id="945c8-106">В некоторых сценариях требуется, чтобы область задач открывалась автоматически вместе с документом без явного взаимодействия с пользователем.</span><span class="sxs-lookup"><span data-stu-id="945c8-106">Some scenarios require that a task pane open automatically when a document opens, without explicit user interaction.</span></span> <span data-ttu-id="945c8-107">Функция автоматического открытия области задач, представленная в наборе требований AddInCommands 1.1, позволяет автоматически открывать область задач, если это требуется в вашем сценарии.</span><span class="sxs-lookup"><span data-stu-id="945c8-107">You can use the autoopen task pane feature, introduced in the AddInCommands 1.1 requirement set, to automatically open a task pane when your scenario requires it.</span></span>


## <a name="how-is-the-autoopen-feature-different-from-inserting-a-task-pane"></a><span data-ttu-id="945c8-108">Чем функция автоматического открытия отличается от вставки области задач?</span><span class="sxs-lookup"><span data-stu-id="945c8-108">How is the autoopen feature different from inserting a task pane?</span></span>

<span data-ttu-id="945c8-109">Если пользователь запускает надстройки, которые не используют команды надстроек (например, в Office 2013), они вставляются в документ и сохраняются в нем.</span><span class="sxs-lookup"><span data-stu-id="945c8-109">When a user launches add-ins that don't use add-in commands - for example, add-ins that run in Office 2013 - they are inserted into the document, and persist in that document.</span></span> <span data-ttu-id="945c8-110">Таким образом, при открытии этого документа другими пользователями, им будет предложено установить надстройку и откроется область задач.</span><span class="sxs-lookup"><span data-stu-id="945c8-110">As a result, when other users open the document, they are prompted to install the add-in, and the task pane opens.</span></span> <span data-ttu-id="945c8-111">Проблема с этой моделью состоит в том, что во многих случаях пользователи не хотят, чтобы надстройка сохранялась в документе.</span><span class="sxs-lookup"><span data-stu-id="945c8-111">The challenge with this model is that in many cases, users don't want the add-in to persist in the document.</span></span> <span data-ttu-id="945c8-112">Например, учащийся, который использует надстройку словаря в документе Word, может не захотеть, чтобы его преподаватели или одноклассники получили запрос на установку этой надстройки при открытии документа.</span><span class="sxs-lookup"><span data-stu-id="945c8-112">For example, a student who uses a dictionary add-in in a Word document might not want their classmates or teachers to be prompted to install that add-in when they open the document.</span></span>

<span data-ttu-id="945c8-113">Функция автоматического открытия позволяет явно определить или дать разрешение пользователю определять необходимость в сохранении конкретной надстройки области задач в конкретном документе.</span><span class="sxs-lookup"><span data-stu-id="945c8-113">With the autoopen feature, you can explicitly define or allow the user to define whether a specific task pane add-in persists in a specific document.</span></span>

## <a name="support-and-availability"></a><span data-ttu-id="945c8-114">Поддержка и доступность</span><span class="sxs-lookup"><span data-stu-id="945c8-114">Support and availability</span></span>

<span data-ttu-id="945c8-115">Функция автоматического открытия</span><span class="sxs-lookup"><span data-stu-id="945c8-115">The autoopen feature is currently</span></span> <!-- in **developer preview** and it is only --> <span data-ttu-id="945c8-116">поддерживается в продуктах и платформах, перечисленных ниже.</span><span class="sxs-lookup"><span data-stu-id="945c8-116">supported in the following products and platforms.</span></span>

|<span data-ttu-id="945c8-117">**Продукты**</span><span class="sxs-lookup"><span data-stu-id="945c8-117">**Products**</span></span>|<span data-ttu-id="945c8-118">**Платформы**</span><span class="sxs-lookup"><span data-stu-id="945c8-118">**Platforms**</span></span>|
|:-----------|:------------|
|<ul><li><span data-ttu-id="945c8-119">Word</span><span class="sxs-lookup"><span data-stu-id="945c8-119">Word</span></span></li><li><span data-ttu-id="945c8-120">Excel</span><span class="sxs-lookup"><span data-stu-id="945c8-120">Excel</span></span></li><li><span data-ttu-id="945c8-121">PowerPoint</span><span class="sxs-lookup"><span data-stu-id="945c8-121">PowerPoint</span></span></li></ul>|<span data-ttu-id="945c8-122">Поддерживаемые платформы для всех продуктов:</span><span class="sxs-lookup"><span data-stu-id="945c8-122">Supported platforms for all products:</span></span><ul><li><span data-ttu-id="945c8-123">Office on Windows Desktop.</span><span class="sxs-lookup"><span data-stu-id="945c8-123">Office on Windows Desktop.</span></span> <span data-ttu-id="945c8-124">Build 16.0.8121.1000+</span><span class="sxs-lookup"><span data-stu-id="945c8-124">Build 16.0.8121.1000+</span></span></li><li><span data-ttu-id="945c8-125">Office on Mac.</span><span class="sxs-lookup"><span data-stu-id="945c8-125">Office on Mac.</span></span> <span data-ttu-id="945c8-126">Build 15.34.17051500+</span><span class="sxs-lookup"><span data-stu-id="945c8-126">Build 15.34.17051500+</span></span></li><li><span data-ttu-id="945c8-127">Office в Интернете</span><span class="sxs-lookup"><span data-stu-id="945c8-127">Office on the web</span></span></li></ul>|


## <a name="best-practices"></a><span data-ttu-id="945c8-128">Рекомендации</span><span class="sxs-lookup"><span data-stu-id="945c8-128">Best practices</span></span>

<span data-ttu-id="945c8-129">При использовании функции автоматического открытия придерживайтесь указанных рекомендаций.</span><span class="sxs-lookup"><span data-stu-id="945c8-129">Apply the following best practices when you use the autoopen feature:</span></span>

- <span data-ttu-id="945c8-130">Используйте функцию автоматического открытия, если она повысит эффективность работы пользователей в подобных случаях:</span><span class="sxs-lookup"><span data-stu-id="945c8-130">Use the autoopen feature when it will help make your add-in users more efficient, such as:</span></span>
  - <span data-ttu-id="945c8-131">When the document needs the add-in in order to function properly.</span><span class="sxs-lookup"><span data-stu-id="945c8-131">When the document needs the add-in in order to function properly.</span></span> <span data-ttu-id="945c8-132">For example, a spreadsheet that includes stock values that are periodically refreshed by an add-in.</span><span class="sxs-lookup"><span data-stu-id="945c8-132">For example, a spreadsheet that includes stock values that are periodically refreshed by an add-in.</span></span> <span data-ttu-id="945c8-133">The add-in should open automatically when the spreadsheet is opened to keep the values up to date.</span><span class="sxs-lookup"><span data-stu-id="945c8-133">The add-in should open automatically when the spreadsheet is opened to keep the values up to date.</span></span>
  - <span data-ttu-id="945c8-134">When the user will most likely always use the add-in with a particular document.</span><span class="sxs-lookup"><span data-stu-id="945c8-134">When the user will most likely always use the add-in with a particular document.</span></span> <span data-ttu-id="945c8-135">For example, an add-in that helps users fill in or change data in a document by pulling information from a backend system.</span><span class="sxs-lookup"><span data-stu-id="945c8-135">For example, an add-in that helps users fill in or change data in a document by pulling information from a backend system.</span></span>
- <span data-ttu-id="945c8-136">Allow users to turn on or turn off the autoopen feature.</span><span class="sxs-lookup"><span data-stu-id="945c8-136">Allow users to turn on or turn off the autoopen feature.</span></span> <span data-ttu-id="945c8-137">Include an option in your UI for users to choose to no longer automatically open the add-in task pane.</span><span class="sxs-lookup"><span data-stu-id="945c8-137">Include an option in your UI for users to choose to no longer automatically open the add-in task pane.</span></span>  
- <span data-ttu-id="945c8-138">Обнаружение набора требований используется для определения доступности функции автоматического открытия и обеспечения резервного поведения, если это не так.</span><span class="sxs-lookup"><span data-stu-id="945c8-138">Use requirement set detection to determine whether the autoopen feature is available, and provide a fallback behavior if it isn't.</span></span>
- <span data-ttu-id="945c8-139">Не используйте функцию автоматического открытия, чтобы искусственно увеличивать показатели использования надстройки.</span><span class="sxs-lookup"><span data-stu-id="945c8-139">Don't use the autoopen feature to artificially increase usage of your add-in.</span></span> <span data-ttu-id="945c8-140">Если вы не хотите, чтобы ваша надстройка автоматически открывалась с определенными документами, эта функция может раздражать пользователей.</span><span class="sxs-lookup"><span data-stu-id="945c8-140">If it doesn't make sense for your add-in to open automatically with certain documents, this feature can annoy users.</span></span>

    > [!NOTE]
    > <span data-ttu-id="945c8-141">Если корпорация Майкрософт обнаружит, что функция автоматического открытия применяется не по назначению, возможно исключение вашей надстройки из AppSource.</span><span class="sxs-lookup"><span data-stu-id="945c8-141">If Microsoft detects abuse of the autoopen feature, your add-in might be rejected from AppSource.</span></span>

- <span data-ttu-id="945c8-142">Don't use this feature to pin multiple task panes.</span><span class="sxs-lookup"><span data-stu-id="945c8-142">Don't use this feature to pin multiple task panes.</span></span> <span data-ttu-id="945c8-143">You can only set one pane of your add-in to open automatically with a document.</span><span class="sxs-lookup"><span data-stu-id="945c8-143">You can only set one pane of your add-in to open automatically with a document.</span></span>  

## <a name="implementation"></a><span data-ttu-id="945c8-144">Реализация</span><span class="sxs-lookup"><span data-stu-id="945c8-144">Implementation</span></span>

<span data-ttu-id="945c8-145">Выполните следующие действия, чтобы использовать функцию автоматического открытия.</span><span class="sxs-lookup"><span data-stu-id="945c8-145">To implement the autoopen feature:</span></span>

- <span data-ttu-id="945c8-146">Укажите область задач, которую необходимо открывать автоматически.</span><span class="sxs-lookup"><span data-stu-id="945c8-146">Specify the task pane to be opened automatically.</span></span>
- <span data-ttu-id="945c8-147">Отметьте документ, в котором будет автоматически открываться эта область задач.</span><span class="sxs-lookup"><span data-stu-id="945c8-147">Tag the document to automatically open the task pane.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="945c8-148">The pane that you designate to open automatically will only open if the add-in is already installed on the user's device.</span><span class="sxs-lookup"><span data-stu-id="945c8-148">The pane that you designate to open automatically will only open if the add-in is already installed on the user's device.</span></span> <span data-ttu-id="945c8-149">If the user does not have the add-in installed when they open a document, the autoopen feature will not work and the setting will be ignored.</span><span class="sxs-lookup"><span data-stu-id="945c8-149">If the user does not have the add-in installed when they open a document, the autoopen feature will not work and the setting will be ignored.</span></span> <span data-ttu-id="945c8-150">If you also require the add-in to be distributed with the document you need to set the visibility property to 1; this can only be done using OpenXML, an example is provided later in this article.</span><span class="sxs-lookup"><span data-stu-id="945c8-150">If you also require the add-in to be distributed with the document you need to set the visibility property to 1; this can only be done using OpenXML, an example is provided later in this article.</span></span>

### <a name="step-1-specify-the-task-pane-to-open"></a><span data-ttu-id="945c8-151">Этап 1. Указание области задач, которую необходимо открывать</span><span class="sxs-lookup"><span data-stu-id="945c8-151">Step 1: Specify the task pane to open</span></span>

<span data-ttu-id="945c8-152">To specify the task pane to open automatically, set the [TaskpaneId](../reference/manifest/action.md#taskpaneid) value to **Office.AutoShowTaskpaneWithDocument**.</span><span class="sxs-lookup"><span data-stu-id="945c8-152">To specify the task pane to open automatically, set the [TaskpaneId](../reference/manifest/action.md#taskpaneid) value to **Office.AutoShowTaskpaneWithDocument**.</span></span> <span data-ttu-id="945c8-153">You can only set this value on one task pane.</span><span class="sxs-lookup"><span data-stu-id="945c8-153">You can only set this value on one task pane.</span></span> <span data-ttu-id="945c8-154">If you set this value on multiple task panes, the first occurrence of the value will be recognized and the others will be ignored.</span><span class="sxs-lookup"><span data-stu-id="945c8-154">If you set this value on multiple task panes, the first occurrence of the value will be recognized and the others will be ignored.</span></span>

<span data-ttu-id="945c8-155">Ниже представлен пример, где для TaskPaneId задано значение Office.AutoShowTaskpaneWithDocument.</span><span class="sxs-lookup"><span data-stu-id="945c8-155">The following example shows the TaskPaneId value set to Office.AutoShowTaskpaneWithDocument.</span></span>

```xml
<Action xsi:type="ShowTaskpane">
    <TaskpaneId>Office.AutoShowTaskpaneWithDocument</TaskpaneId>
    <SourceLocation resid="Contoso.Taskpane.Url" />
</Action>
```

### <a name="step-2-tag-the-document-to-automatically-open-the-task-pane"></a><span data-ttu-id="945c8-156">Этап 2. Установка отметки для документа, вместе с которым будет автоматически открываться область задач</span><span class="sxs-lookup"><span data-stu-id="945c8-156">Step 2: Tag the document to automatically open the task pane</span></span>

<span data-ttu-id="945c8-157">You can tag the document to trigger the autoopen feature in one of two ways.</span><span class="sxs-lookup"><span data-stu-id="945c8-157">You can tag the document to trigger the autoopen feature in one of two ways.</span></span> <span data-ttu-id="945c8-158">Pick the alternative that works best for your scenario.</span><span class="sxs-lookup"><span data-stu-id="945c8-158">Pick the alternative that works best for your scenario.</span></span>  


#### <a name="tag-the-document-on-the-client-side"></a><span data-ttu-id="945c8-159">Установка отметки для документа на стороне клиента</span><span class="sxs-lookup"><span data-stu-id="945c8-159">Tag the document on the client side</span></span>

<span data-ttu-id="945c8-160">Используйте метод Office.js [settings.set](/javascript/api/office/office.settings), чтобы установить для **Office.AutoShowTaskpaneWithDocument** значение **true**, как показано в следующем примере.</span><span class="sxs-lookup"><span data-stu-id="945c8-160">Use the Office.js [settings.set](/javascript/api/office/office.settings) method to set **Office.AutoShowTaskpaneWithDocument** to **true**, as shown in the following example.</span></span>

```js
Office.context.document.settings.set("Office.AutoShowTaskpaneWithDocument", true);
Office.context.document.settings.saveAsync();
```

<span data-ttu-id="945c8-161">Используйте этот метод, если нужно отметить документ в рамках взаимодействия с надстройкой (например, после создания пользователем привязки или выбора параметра, он сможет указать необходимость в автоматическом открытии области).</span><span class="sxs-lookup"><span data-stu-id="945c8-161">Use this method if you need to tag the document as part of your add-in interaction (for example, as soon as the user creates a binding, or chooses an option to indicate that they want the pane to open automatically).</span></span>

#### <a name="use-open-xml-to-tag-the-document"></a><span data-ttu-id="945c8-162">Установка отметки для документа с помощью Open XML</span><span class="sxs-lookup"><span data-stu-id="945c8-162">Use Open XML to tag the document</span></span>

<span data-ttu-id="945c8-163">You can use Open XML to create or modify a document and add the appropriate Open Office XML markup to trigger the autoopen feature.</span><span class="sxs-lookup"><span data-stu-id="945c8-163">You can use Open XML to create or modify a document and add the appropriate Open Office XML markup to trigger the autoopen feature.</span></span> <span data-ttu-id="945c8-164">For a sample that shows you how to do this, see [Office-OOXML-EmbedAddin](https://github.com/OfficeDev/Office-OOXML-EmbedAddin).</span><span class="sxs-lookup"><span data-stu-id="945c8-164">For a sample that shows you how to do this, see [Office-OOXML-EmbedAddin](https://github.com/OfficeDev/Office-OOXML-EmbedAddin).</span></span>

<span data-ttu-id="945c8-165">Добавьте в документ две части Open XML:</span><span class="sxs-lookup"><span data-stu-id="945c8-165">Add two Open XML parts to the document:</span></span>

- <span data-ttu-id="945c8-166">часть `webextension`.</span><span class="sxs-lookup"><span data-stu-id="945c8-166">A `webextension` part</span></span>
- <span data-ttu-id="945c8-167">часть `taskpane`.</span><span class="sxs-lookup"><span data-stu-id="945c8-167">A `taskpane` part</span></span>

<span data-ttu-id="945c8-168">В примере ниже показано, как добавить часть `webextension`.</span><span class="sxs-lookup"><span data-stu-id="945c8-168">The following example shows how to add the `webextension` part.</span></span>

```xml
<we:webextension xmlns:we="http://schemas.microsoft.com/office/webextensions/webextension/2010/11" id="[ADD-IN ID PER MANIFEST]">
  <we:reference id="[GUID or AppSource asset ID]" version="[your add-in version]" store="[Pointer to store or catalog]" storeType="[Store or catalog type]"/>
  <we:alternateReferences/>
  <we:properties>
   <we:property name="Office.AutoShowTaskpaneWithDocument" value="true"/>
  </we:properties>
  <we:bindings/>
  <we:snapshot xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships"/>
</we:webextension>
```

<span data-ttu-id="945c8-169">Часть `webextension` содержит контейнер свойств, а также свойство под названием **Office.AutoShowTaskpaneWithDocument**, для которого необходимо установить значение `true`.</span><span class="sxs-lookup"><span data-stu-id="945c8-169">The `webextension` part includes a property bag and a property named **Office.AutoShowTaskpaneWithDocument** that must be set to `true`.</span></span>

<span data-ttu-id="945c8-170">Часть `webextension` также содержит ссылку на магазин или каталог с атрибутами для `id`, `storeType`, `store` и `version`.</span><span class="sxs-lookup"><span data-stu-id="945c8-170">The `webextension` part also includes a reference to the store or catalog with attributes for `id`, `storeType`, `store`, and `version`.</span></span> <span data-ttu-id="945c8-171">Только четыре значения `storeType` относятся к функции автоматического открытия.</span><span class="sxs-lookup"><span data-stu-id="945c8-171">Of the `storeType` values, only four are relevant to the autoopen feature.</span></span> <span data-ttu-id="945c8-172">Значения остальных трех атрибутов зависят от значения для `storeType`, как показано в таблице ниже.</span><span class="sxs-lookup"><span data-stu-id="945c8-172">The values for the other three attributes depend on the value for `storeType`, as shown in the following table.</span></span>

| <span data-ttu-id="945c8-173">Значение **`storeType`**</span><span class="sxs-lookup"><span data-stu-id="945c8-173">**`storeType` value**</span></span> | <span data-ttu-id="945c8-174">Значение **`id`**</span><span class="sxs-lookup"><span data-stu-id="945c8-174">**`id` value**</span></span>    |<span data-ttu-id="945c8-175">**Значение `store`**</span><span class="sxs-lookup"><span data-stu-id="945c8-175">**`store` value**</span></span> | <span data-ttu-id="945c8-176">**Значение `version`**</span><span class="sxs-lookup"><span data-stu-id="945c8-176">**`version` value**</span></span>|
|:---------------|:---------------|:---------------|:---------------|
|<span data-ttu-id="945c8-177">OMEX (AppSource)</span><span class="sxs-lookup"><span data-stu-id="945c8-177">OMEX (AppSource)</span></span>|<span data-ttu-id="945c8-178">ИД ресурса AppSource для надстройки (см. примечание)</span><span class="sxs-lookup"><span data-stu-id="945c8-178">The AppSource asset ID of the add-in (see Note)</span></span>|<span data-ttu-id="945c8-179">Код языка для AppSource (например, "ru-ru").</span><span class="sxs-lookup"><span data-stu-id="945c8-179">The locale of AppSource; for example, "en-us".</span></span>|<span data-ttu-id="945c8-180">Версия каталога AppSource (см. примечание)</span><span class="sxs-lookup"><span data-stu-id="945c8-180">The version in the AppSource catalog (see Note)</span></span>|
|<span data-ttu-id="945c8-181">FileSystem (сетевая папка)</span><span class="sxs-lookup"><span data-stu-id="945c8-181">FileSystem (a network share)</span></span>|<span data-ttu-id="945c8-182">GUID надстройки в ее манифесте.</span><span class="sxs-lookup"><span data-stu-id="945c8-182">The GUID of the add-in in the add-in manifest.</span></span>|<span data-ttu-id="945c8-183">Путь к сетевой папке (например, "\\\\MyComputer\\MySharedFolder").</span><span class="sxs-lookup"><span data-stu-id="945c8-183">The path of the network share; for example, "\\\\MyComputer\\MySharedFolder".</span></span>|<span data-ttu-id="945c8-184">Версия в манифесте надстройки.</span><span class="sxs-lookup"><span data-stu-id="945c8-184">The version in the add-in manifest.</span></span>|
|<span data-ttu-id="945c8-185">EXCatalog (развертывание через Exchange Server)</span><span class="sxs-lookup"><span data-stu-id="945c8-185">EXCatalog (deployment via the Exchange server)</span></span> |<span data-ttu-id="945c8-186">GUID надстройки в ее манифесте.</span><span class="sxs-lookup"><span data-stu-id="945c8-186">The GUID of the add-in in the add-in manifest.</span></span>|<span data-ttu-id="945c8-187">EXCatalog.</span><span class="sxs-lookup"><span data-stu-id="945c8-187">"EXCatalog".</span></span> <span data-ttu-id="945c8-188">Строка EXCatalog — это строка, используемая для надстроек, использующих централизованное развертывание в центре администрирования Microsoft 365.</span><span class="sxs-lookup"><span data-stu-id="945c8-188">EXCatalog row is the row to use with add-ins that use Centralized Deployment in the Microsoft 365 admin center.</span></span>|<span data-ttu-id="945c8-189">Версия в манифесте надстройки.</span><span class="sxs-lookup"><span data-stu-id="945c8-189">The version in the add-in manifest.</span></span>
|<span data-ttu-id="945c8-190">Registry (реестр системы)</span><span class="sxs-lookup"><span data-stu-id="945c8-190">Registry (System registry)</span></span>|<span data-ttu-id="945c8-191">GUID надстройки в ее манифесте.</span><span class="sxs-lookup"><span data-stu-id="945c8-191">The GUID of the add-in in the add-in manifest.</span></span>|<span data-ttu-id="945c8-192">"developer"</span><span class="sxs-lookup"><span data-stu-id="945c8-192">"developer"</span></span>|<span data-ttu-id="945c8-193">Версия в манифесте надстройки.</span><span class="sxs-lookup"><span data-stu-id="945c8-193">The version in the add-in manifest.</span></span>|

> [!NOTE]
> <span data-ttu-id="945c8-194">To find the asset ID and version of an add-in in AppSource, go to the AppSource landing page for the add-in.</span><span class="sxs-lookup"><span data-stu-id="945c8-194">To find the asset ID and version of an add-in in AppSource, go to the AppSource landing page for the add-in.</span></span> <span data-ttu-id="945c8-195">The asset ID appears in the address bar in the browser.</span><span class="sxs-lookup"><span data-stu-id="945c8-195">The asset ID appears in the address bar in the browser.</span></span> <span data-ttu-id="945c8-196">The version is listed in the **Details** section of the page.</span><span class="sxs-lookup"><span data-stu-id="945c8-196">The version is listed in the **Details** section of the page.</span></span>

<span data-ttu-id="945c8-197">Дополнительные сведения об исправлении webextension см. в документе [[MS-OWEXML] 2.2.5. WebExtensionReference](https://msdn.microsoft.com/library/hh695383(v=office.12).aspx).</span><span class="sxs-lookup"><span data-stu-id="945c8-197">For more information about the webextension markup, see [[MS-OWEXML] 2.2.5. WebExtensionReference](https://msdn.microsoft.com/library/hh695383(v=office.12).aspx).</span></span>

<span data-ttu-id="945c8-198">В примере ниже показано, как добавить часть `taskpane`.</span><span class="sxs-lookup"><span data-stu-id="945c8-198">The following example shows how to add the `taskpane` part.</span></span>

```xml
<wetp:taskpane dockstate="right" visibility="0" width="350" row="4" xmlns:wetp="http://schemas.microsoft.com/office/webextensions/taskpanes/2010/11">
  <wetp:webextensionref xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships" r:id="rId1" />
</wetp:taskpane>
```

<span data-ttu-id="945c8-199">Обратите внимание, что в этом примере для атрибута `visibility` установлено значение "0".</span><span class="sxs-lookup"><span data-stu-id="945c8-199">Note that in this example, the `visibility` attribute is set to "0".</span></span> <span data-ttu-id="945c8-200">Это означает, что после добавления частей webextension и `taskpane` при первом открытии документа пользователю необходимо будет установить надстройку, нажав кнопку **Надстройка** на ленте.</span><span class="sxs-lookup"><span data-stu-id="945c8-200">This means that after the webextension and `taskpane` parts are added, the first time the document is opened, the user has to install the add-in from the **Add-in** button on the ribbon.</span></span> <span data-ttu-id="945c8-201">После этого область задач надстройки будет открываться автоматически вместе с файлом.</span><span class="sxs-lookup"><span data-stu-id="945c8-201">Thereafter, the add-in task pane opens automatically when the file is opened.</span></span> <span data-ttu-id="945c8-202">Кроме того, если установить для `visibility` значение "0", можно с помощью Office.js предоставить пользователям возможность включать и выключать функцию автоматического открытия.</span><span class="sxs-lookup"><span data-stu-id="945c8-202">Also, when you set `visibility` to "0", you can use Office.js to enable users to turn on or turn off the autoopen feature.</span></span> <span data-ttu-id="945c8-203">В частности, ваш скрипт устанавливает для параметра документа **Office.AutoShowTaskpaneWithDocument** значение `true` или `false`.</span><span class="sxs-lookup"><span data-stu-id="945c8-203">Specifically, your script sets the **Office.AutoShowTaskpaneWithDocument** document setting to `true` or `false`.</span></span> <span data-ttu-id="945c8-204">(Дополнительные сведения см. в разделе [Установка отметки для документа на стороне клиента](#tag-the-document-on-the-client-side).)</span><span class="sxs-lookup"><span data-stu-id="945c8-204">(For details, see [Tag the document on the client side](#tag-the-document-on-the-client-side).)</span></span>

<span data-ttu-id="945c8-205">If `visibility` is set to "1", the task pane opens automatically the first time the document is opened.</span><span class="sxs-lookup"><span data-stu-id="945c8-205">If `visibility` is set to "1", the task pane opens automatically the first time the document is opened.</span></span> <span data-ttu-id="945c8-206">The user is prompted to trust the add-in, and when trust is granted, the add-in opens.</span><span class="sxs-lookup"><span data-stu-id="945c8-206">The user is prompted to trust the add-in, and when trust is granted, the add-in opens.</span></span> <span data-ttu-id="945c8-207">Thereafter, the add-in task pane opens automatically when the file is opened.</span><span class="sxs-lookup"><span data-stu-id="945c8-207">Thereafter, the add-in task pane opens automatically when the file is opened.</span></span> <span data-ttu-id="945c8-208">However, when `visibility` is set to "1", you can't use Office.js to enable users to turn on or turn off the autoopen feature.</span><span class="sxs-lookup"><span data-stu-id="945c8-208">However, when `visibility` is set to "1", you can't use Office.js to enable users to turn on or turn off the autoopen feature.</span></span>

<span data-ttu-id="945c8-209">Значение "1" отлично подходит для свойства `visibility`, если надстройка и шаблон или содержимое документа интегрированы настолько тесно, что пользователь не откажется от использования функции автоматического открытия.</span><span class="sxs-lookup"><span data-stu-id="945c8-209">Setting `visibility` to "1" is a good choice when the add-in and the template or content of the document are so closely integrated that the user would not opt out of the autoopen feature.</span></span>

> [!NOTE]
> <span data-ttu-id="945c8-210">If you want to distribute your add-in with the document, so that users are prompted to install it, you must set the visibility property to 1.</span><span class="sxs-lookup"><span data-stu-id="945c8-210">If you want to distribute your add-in with the document, so that users are prompted to install it, you must set the visibility property to 1.</span></span> <span data-ttu-id="945c8-211">You can only do this via Open XML.</span><span class="sxs-lookup"><span data-stu-id="945c8-211">You can only do this via Open XML.</span></span>

<span data-ttu-id="945c8-212">An easy way to write the XML is to first run your add-in and [tag the document on the client side](#tag-the-document-on-the-client-side) to write the value, and then save the document and inspect the XML that is generated.</span><span class="sxs-lookup"><span data-stu-id="945c8-212">An easy way to write the XML is to first run your add-in and [tag the document on the client side](#tag-the-document-on-the-client-side) to write the value, and then save the document and inspect the XML that is generated.</span></span> <span data-ttu-id="945c8-213">Office will detect and provide the appropriate attribute values.</span><span class="sxs-lookup"><span data-stu-id="945c8-213">Office will detect and provide the appropriate attribute values.</span></span> <span data-ttu-id="945c8-214">You can also use the [Open XML SDK 2.5 Productivity Tool](https://www.microsoft.com/download/details.aspx?id=30425) tool to generate C# code to programmatically add the markup based on the XML you generate.</span><span class="sxs-lookup"><span data-stu-id="945c8-214">You can also use the [Open XML SDK 2.5 Productivity Tool](https://www.microsoft.com/download/details.aspx?id=30425) tool to generate C# code to programmatically add the markup based on the XML you generate.</span></span>

## <a name="test-and-verify-opening-task-panes"></a><span data-ttu-id="945c8-215">Тестирование и проверка открытия областей задач</span><span class="sxs-lookup"><span data-stu-id="945c8-215">Test and verify opening task panes</span></span>

<span data-ttu-id="945c8-216">Вы можете развернуть тестовую версию надстройки, которая будет автоматически открывать область задач с помощью централизованного развертывания с помощью центра администрирования Microsoft 365.</span><span class="sxs-lookup"><span data-stu-id="945c8-216">You can deploy a test version of your add-in that will automatically open a task pane using Centralized Deployment via the Microsoft 365 admin center.</span></span> <span data-ttu-id="945c8-217">В примере ниже показано, как надстройки вставляются в каталог централизованного развертывания при помощи EXCatalog (версии из магазина).</span><span class="sxs-lookup"><span data-stu-id="945c8-217">The following example shows how add-ins are inserted from the Centralized Deployment catalog using the EXCatalog store version.</span></span>

```xml
<we:webextension xmlns:we="http://schemas.microsoft.com/office/webextensions/webextension/2010/11" id="{52811C31-4593-43B8-A697-EB873422D156}">
    <we:reference id="af8fa5ba-4010-4bcc-9e03-a91ddadf6dd3" version="1.0.0.0" store="EXCatalog" storeType="EXCatalog"/>
    <we:alternateReferences/>
    <we:properties/>
    <we:bindings/>
    <we:snapshot xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships"/>
</we:webextension>
```

<span data-ttu-id="945c8-218">Вы можете протестировать предыдущий пример, используя подписку на Microsoft 365, чтобы испытать централизованное развертывание и убедиться в том, что ваша надстройка работает должным образом.</span><span class="sxs-lookup"><span data-stu-id="945c8-218">You can test the previous example by using your Microsoft 365 subscription to try out Centralized Deployment and verify that your add-in works as expected.</span></span> <span data-ttu-id="945c8-219">Если у вас еще нет подписки на Microsoft 365, вы можете получить бесплатную, 90 день реневабле подписку на Microsoft 365, присоединяясь к [программе microsoft 365 Developer Program](https://developer.microsoft.com/office/dev-program).</span><span class="sxs-lookup"><span data-stu-id="945c8-219">If you don't already have a Microsoft 365 subscription, you can get a free, 90-day renewable Microsoft 365 subscription by joining the [Microsoft 365 developer program](https://developer.microsoft.com/office/dev-program).</span></span>

## <a name="see-also"></a><span data-ttu-id="945c8-220">См. также</span><span class="sxs-lookup"><span data-stu-id="945c8-220">See also</span></span>

<span data-ttu-id="945c8-221">Пример использования функции автоматического открытия см. [на странице с примерами команд для надстройки Office](https://github.com/OfficeDev/Office-Add-in-Commands-Samples/tree/master/AutoOpenTaskpane).</span><span class="sxs-lookup"><span data-stu-id="945c8-221">For a sample that shows you how to use the autoopen feature, see [Office Add-in commands samples](https://github.com/OfficeDev/Office-Add-in-Commands-Samples/tree/master/AutoOpenTaskpane).</span></span>
<span data-ttu-id="945c8-222">[Присоединяйтесь к программе для разработчиков Microsoft 365](/office/developer-program/office-365-developer-program).</span><span class="sxs-lookup"><span data-stu-id="945c8-222">[Join the Microsoft 365 developer program](/office/developer-program/office-365-developer-program).</span></span>
