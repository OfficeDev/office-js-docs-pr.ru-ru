---
title: Отладка надстроек Office в Visual Studio
description: Используйте Visual Studio для отладки надстроек Office в настольном клиенте Office для Windows
ms.date: 12/31/2019
localization_priority: Normal
ms.openlocfilehash: 018bfa24424514598d323c29d165e3e8ec066a8e
ms.sourcegitcommit: 7ef14753dce598a5804dad8802df7aaafe046da7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/10/2020
ms.locfileid: "45093660"
---
# <a name="debug-office-add-ins-in-visual-studio"></a><span data-ttu-id="fa417-103">Отладка надстроек Office в Visual Studio</span><span class="sxs-lookup"><span data-stu-id="fa417-103">Debug Office Add-ins in Visual Studio</span></span>

<span data-ttu-id="fa417-104">В этой статье описано, как использовать Visual Studio 2019 для отладки надстроек Office в настольном клиенте Office в Windows.</span><span class="sxs-lookup"><span data-stu-id="fa417-104">This article describes how to use Visual Studio 2019 to debug an Office Add-in in the Office desktop client on Windows.</span></span> <span data-ttu-id="fa417-105">Если вы используете другую версию Visual Studio, процедура может несколько отличаться.</span><span class="sxs-lookup"><span data-stu-id="fa417-105">If you're using another version of Visual Studio, the procedures might vary slightly.</span></span> 

> [!NOTE]
> <span data-ttu-id="fa417-106">Visual Studio невозможно использовать для отладки надстроек Office в Интернете или Office для Mac.</span><span class="sxs-lookup"><span data-stu-id="fa417-106">You can't use Visual Studio to debug add-ins in Office on the web or Mac.</span></span> <span data-ttu-id="fa417-107">Сведения об отладке на этих платформах см. в статьях [Отладка надстроек Office в Office в Интернете](../testing/debug-add-ins-in-office-online.md) и [Отладка надстроек Office на Mac](../testing/debug-office-add-ins-on-ipad-and-mac.md).</span><span class="sxs-lookup"><span data-stu-id="fa417-107">For information about debugging on these platforms, see [Debug Office Add-ins in Office on the web](../testing/debug-add-ins-in-office-online.md) or [Debug Office Add-ins on a Mac](../testing/debug-office-add-ins-on-ipad-and-mac.md).</span></span>

## <a name="enable-debugging-for-add-in-commands-and-ui-less-code"></a><span data-ttu-id="fa417-108">Включение отладки для команд надстроек и кода без пользовательского интерфейса</span><span class="sxs-lookup"><span data-stu-id="fa417-108">Enable debugging for add-in commands and UI-less code</span></span>

<span data-ttu-id="fa417-109">Когда Visual Studio выполняет отладку Office для Windows, надстройка размещается в экземпляре браузера Microsoft Internet Explorer или Microsoft Edge.</span><span class="sxs-lookup"><span data-stu-id="fa417-109">When Visual Studio debugs Office on Windows, the add-in is hosted in either a Microsoft Internet Explorer or Microsoft Edge browser instance.</span></span> <span data-ttu-id="fa417-110">Сведения об определении браузера, используемого на компьютере разработки, см. в статье [Браузеры, используемые надстройками Office](../concepts/browsers-used-by-office-web-add-ins.md).</span><span class="sxs-lookup"><span data-stu-id="fa417-110">To determine which browser is being used on your development computer, see [Browsers used by Office Add-ins](../concepts/browsers-used-by-office-web-add-ins.md).</span></span>
> [!NOTE]
> <span data-ttu-id="fa417-111">В следующей процедуре переменная среды JS_Debug больше не требуется.</span><span class="sxs-lookup"><span data-stu-id="fa417-111">The JS_Debug environment variable is no longer needed in the following procedure.</span></span> <span data-ttu-id="fa417-112">Дополнительные сведения см. в статье [Действия отладки в веб-надстройках Office](https://developercommunity.visualstudio.com/content/problem/740413/office-development-inconsistent-script-debugging-b.html) на форуме технической поддержки сообщества разработчиков Майкрософт.</span><span class="sxs-lookup"><span data-stu-id="fa417-112">For more information, see [Debugging behaviors in Office web add-ins](https://developercommunity.visualstudio.com/content/problem/740413/office-development-inconsistent-script-debugging-b.html) on the Microsoft Developer Community support forum.</span></span>

[!include[Enable debugging on Microsoft Edge DevTools](../includes/enable-debugging-on-edge-devtools.md)]

## <a name="review-the-build-and-debug-properties"></a><span data-ttu-id="fa417-113">Просмотр параметров сборки и отладки</span><span class="sxs-lookup"><span data-stu-id="fa417-113">Review the build and debug properties</span></span>

<span data-ttu-id="fa417-114">Перед началом отладки просмотрите свойства каждого проекта и убедитесь, что Visual Studio откроет нужное хост-приложение, а другие параметры сборки и отладки заданы правильно.</span><span class="sxs-lookup"><span data-stu-id="fa417-114">Before you start debugging, review the properties of each project to confirm that Visual Studio will open the desired host application and that other build and debug properties are set appropriately.</span></span>

### <a name="add-in-project-properties"></a><span data-ttu-id="fa417-115">Свойства проекта надстройки</span><span class="sxs-lookup"><span data-stu-id="fa417-115">Add-in project properties</span></span>

<span data-ttu-id="fa417-116">Откройте окно**Свойства** в проекте надстройки для просмотра свойств проекта:</span><span class="sxs-lookup"><span data-stu-id="fa417-116">Open the **Properties** window for the add-in project to review project properties:</span></span>

1. <span data-ttu-id="fa417-117">В **Обозревателе решений** выберите проект надстройки (*не* проект веб-приложения).</span><span class="sxs-lookup"><span data-stu-id="fa417-117">In **Solution Explorer**, choose the add-in project (*not* the web application project).</span></span>

2. <span data-ttu-id="fa417-118">В панели меню выберите **Вид** > **Окно свойств**.</span><span class="sxs-lookup"><span data-stu-id="fa417-118">From the menu bar, choose **View** > **Properties Window**.</span></span>

<span data-ttu-id="fa417-119">В следующей таблице описываются свойства проекта надстройки.</span><span class="sxs-lookup"><span data-stu-id="fa417-119">The following table describes the properties of the add-in project.</span></span>

|<span data-ttu-id="fa417-120">**Свойство**</span><span class="sxs-lookup"><span data-stu-id="fa417-120">**Property**</span></span>|<span data-ttu-id="fa417-121">**Описание**</span><span class="sxs-lookup"><span data-stu-id="fa417-121">**Description**</span></span>|
|:-----|:-----|
|<span data-ttu-id="fa417-122">**Действие при запуске**</span><span class="sxs-lookup"><span data-stu-id="fa417-122">**Start Action**</span></span>|<span data-ttu-id="fa417-123">Определяет режим отладки для вашей надстройки.</span><span class="sxs-lookup"><span data-stu-id="fa417-123">Specifies the debug mode for your add-in.</span></span> <span data-ttu-id="fa417-124">В настоящее время только режим**классического клиента Office** поддерживается для проектов надстройки Office.</span><span class="sxs-lookup"><span data-stu-id="fa417-124">Currently only **Office Desktop Client** mode is supported for Office Add-in projects.</span></span>|
|<span data-ttu-id="fa417-125">**Начальный документ**</span><span class="sxs-lookup"><span data-stu-id="fa417-125">**Start Document**</span></span><br/><span data-ttu-id="fa417-126">(только для надстроек Excel, PowerPoint и Word)</span><span class="sxs-lookup"><span data-stu-id="fa417-126">(Excel, PowerPoint, and Word add-ins only)</span></span>|<span data-ttu-id="fa417-127">Указывает, какой документ следует открыть при запуске проекта.</span><span class="sxs-lookup"><span data-stu-id="fa417-127">Specifies what document to open when you start the project.</span></span>|
|<span data-ttu-id="fa417-128">**Веб-проект**</span><span class="sxs-lookup"><span data-stu-id="fa417-128">**Web Project**</span></span>|<span data-ttu-id="fa417-129">Определяет имя веб-проекта, связанного с надстройкой.</span><span class="sxs-lookup"><span data-stu-id="fa417-129">Specifies the name of the web project associated with the add-in.</span></span>|
|<span data-ttu-id="fa417-130">**Адрес электронной почты**</span><span class="sxs-lookup"><span data-stu-id="fa417-130">**Email Address**</span></span><br/><span data-ttu-id="fa417-131">(только для надстроек Outlook)</span><span class="sxs-lookup"><span data-stu-id="fa417-131">(Outlook add-ins only)</span></span>|<span data-ttu-id="fa417-132">Указывает адрес электронной почты учетной записи пользователя на сервере Exchange Server или Exchange Online, который вы хотите использовать для проверки надстройки Outlook.</span><span class="sxs-lookup"><span data-stu-id="fa417-132">Specifies the email address of the user account in Exchange Server or Exchange Online that you want to use to test your Outlook add-in.</span></span>|
|<span data-ttu-id="fa417-133">**EWS Url**</span><span class="sxs-lookup"><span data-stu-id="fa417-133">**EWS Url**</span></span><br/><span data-ttu-id="fa417-134">(только для надстроек Outlook)</span><span class="sxs-lookup"><span data-stu-id="fa417-134">(Outlook add-ins only)</span></span>|<span data-ttu-id="fa417-135">URL-адрес веб-службы Exchange (пример: `https://www.contoso.com/ews/exchange.aspx`).</span><span class="sxs-lookup"><span data-stu-id="fa417-135">Exchange Web service URL (For example: `https://www.contoso.com/ews/exchange.aspx`).</span></span> |
|<span data-ttu-id="fa417-136">**URL-адрес OWA**</span><span class="sxs-lookup"><span data-stu-id="fa417-136">**OWA Url**</span></span><br/><span data-ttu-id="fa417-137">(только для надстроек Outlook)</span><span class="sxs-lookup"><span data-stu-id="fa417-137">(Outlook add-ins only)</span></span>|<span data-ttu-id="fa417-138">URL-адрес Outlook в Интернете (например, `https://www.contoso.com/owa`).</span><span class="sxs-lookup"><span data-stu-id="fa417-138">Outlook on the web URL (For example: `https://www.contoso.com/owa`).</span></span>|
|<span data-ttu-id="fa417-139">**Использование многофакторной проверки подлинности**</span><span class="sxs-lookup"><span data-stu-id="fa417-139">**Use multi-factor auth**</span></span><br/><span data-ttu-id="fa417-140">(только для надстроек Outlook)</span><span class="sxs-lookup"><span data-stu-id="fa417-140">(Outlook add-ins only)</span></span>|<span data-ttu-id="fa417-141">Логическое значение, которое определяет, следует ли использовать многофакторную проверку подлинности.</span><span class="sxs-lookup"><span data-stu-id="fa417-141">Boolean value that indicates whether multi-factor authentication should be used.</span></span>|
|<span data-ttu-id="fa417-142">**Имя пользователя**</span><span class="sxs-lookup"><span data-stu-id="fa417-142">**User Name**</span></span><br/><span data-ttu-id="fa417-143">(только для надстроек Outlook)</span><span class="sxs-lookup"><span data-stu-id="fa417-143">(Outlook add-ins only)</span></span>|<span data-ttu-id="fa417-144">Определяет имя учетной записи на сервере Exchange Server или Exchange Online, которое вы хотите использовать для проверки вашей надстройки Outlook.</span><span class="sxs-lookup"><span data-stu-id="fa417-144">Specifies the name of the user account in Exchange Server or Exchange Online that you want to use to test your Outlook add-in.</span></span>|
|<span data-ttu-id="fa417-145">\*\*Файл проекта \*\*</span><span class="sxs-lookup"><span data-stu-id="fa417-145">**Project File**</span></span>|<span data-ttu-id="fa417-146">Задает имя файла, в котором указаны сборка, конфигурация и другие сведения о проекте.</span><span class="sxs-lookup"><span data-stu-id="fa417-146">Specifies the name of the file containing build, configuration, and other information about the project.</span></span>|
|<span data-ttu-id="fa417-147">**Папка проекта**</span><span class="sxs-lookup"><span data-stu-id="fa417-147">**Project Folder**</span></span>|<span data-ttu-id="fa417-148">Расположение файла проекта.</span><span class="sxs-lookup"><span data-stu-id="fa417-148">The location of the project file.</span></span>|

> [!NOTE]
> <span data-ttu-id="fa417-149">Для надстройки Outlook вы можете задать значения для одной или нескольких используемых только для\*надстроек Outlook свойств \* в окне **Свойства**, но делать это необязательно.</span><span class="sxs-lookup"><span data-stu-id="fa417-149">For an Outlook add-in, you may choose to specify values for one or more of the *Outlook add-in only* properties in the **Properties** window, but doing so is not required.</span></span>

### <a name="web-application-project-properties"></a><span data-ttu-id="fa417-150">Свойства проекта веб-приложения</span><span class="sxs-lookup"><span data-stu-id="fa417-150">Web application project properties</span></span>

<span data-ttu-id="fa417-151">Откройте окно**Свойства** в проекте веб-приложения для просмотра свойств проекта:</span><span class="sxs-lookup"><span data-stu-id="fa417-151">Open the **Properties** window for the web application project to review project properties:</span></span>

1. <span data-ttu-id="fa417-152">В **обозревателе решений**выберите проект веб-приложение.</span><span class="sxs-lookup"><span data-stu-id="fa417-152">In **Solution Explorer**, choose the web application project.</span></span>

2. <span data-ttu-id="fa417-153">В панели меню выберите **Вид** > **Окно свойств**.</span><span class="sxs-lookup"><span data-stu-id="fa417-153">From the menu bar, choose **View** > **Properties Window**.</span></span>

<span data-ttu-id="fa417-154">В таблице ниже описаны свойства проекта веб-приложения, которые наиболее подходят для проектов надстройки Office.</span><span class="sxs-lookup"><span data-stu-id="fa417-154">The following table describes the properties of the web application project that are most relevant to Office Add-in projects.</span></span>

|<span data-ttu-id="fa417-155">**Свойство**</span><span class="sxs-lookup"><span data-stu-id="fa417-155">**Property**</span></span>|<span data-ttu-id="fa417-156">**Описание**</span><span class="sxs-lookup"><span data-stu-id="fa417-156">**Description**</span></span>|
|:-----|:-----|
|<span data-ttu-id="fa417-157">**SSL включен**</span><span class="sxs-lookup"><span data-stu-id="fa417-157">**SSL Enabled**</span></span>|<span data-ttu-id="fa417-158">Указывает, включен ли SSL на сайте.</span><span class="sxs-lookup"><span data-stu-id="fa417-158">Specifies whether SSL is enabled on the site.</span></span> <span data-ttu-id="fa417-159">Это свойство должно иметь значение **True** для проектов надстройки Office.</span><span class="sxs-lookup"><span data-stu-id="fa417-159">This property should be set to **True** for Office Add-in projects.</span></span>|
|<span data-ttu-id="fa417-160">**URL-АДРЕС SSL**</span><span class="sxs-lookup"><span data-stu-id="fa417-160">**SSL URL**</span></span>|<span data-ttu-id="fa417-161">Задает защищенный HTTPS URL-адрес сайта.</span><span class="sxs-lookup"><span data-stu-id="fa417-161">Specifies the secure HTTPS URL for the site.</span></span> <span data-ttu-id="fa417-162">Только для чтения.</span><span class="sxs-lookup"><span data-stu-id="fa417-162">Read-only.</span></span>|
|<span data-ttu-id="fa417-163">**URL**</span><span class="sxs-lookup"><span data-stu-id="fa417-163">**URL**</span></span>|<span data-ttu-id="fa417-164">Задает HTTP URL-адрес сайта.</span><span class="sxs-lookup"><span data-stu-id="fa417-164">Specifies the HTTP URL for the site.</span></span> <span data-ttu-id="fa417-165">Только для чтения.</span><span class="sxs-lookup"><span data-stu-id="fa417-165">Read-only.</span></span>|
|<span data-ttu-id="fa417-166">\*\*Файл проекта \*\*</span><span class="sxs-lookup"><span data-stu-id="fa417-166">**Project File**</span></span>|<span data-ttu-id="fa417-167">Задает имя файла, в котором указаны сборка, конфигурация и другие сведения о проекте.</span><span class="sxs-lookup"><span data-stu-id="fa417-167">Specifies the name of the file containing build, configuration, and other information about the project.</span></span>|
|<span data-ttu-id="fa417-168">**Папка проекта**</span><span class="sxs-lookup"><span data-stu-id="fa417-168">**Project Folder**</span></span>|<span data-ttu-id="fa417-169">Указывает расположение файла проекта.</span><span class="sxs-lookup"><span data-stu-id="fa417-169">Specifies the location of the project file.</span></span> <span data-ttu-id="fa417-170">Только для чтения.</span><span class="sxs-lookup"><span data-stu-id="fa417-170">Read-only.</span></span> <span data-ttu-id="fa417-171">Файл манифеста, который генерирует Visual Studio во время выполнения, записывается в папку `bin\Debug\OfficeAppManifests` в этом расположении.</span><span class="sxs-lookup"><span data-stu-id="fa417-171">The manifest file that Visual Studio generates at runtime is written to the `bin\Debug\OfficeAppManifests` folder in this location.</span></span>|

## <a name="use-an-existing-document-to-debug-the-add-in"></a><span data-ttu-id="fa417-172">Использование существующего документа для отладки надстройки</span><span class="sxs-lookup"><span data-stu-id="fa417-172">Use an existing document to debug the add-in</span></span>

<span data-ttu-id="fa417-173">Если у вас есть документ, содержащий тестовые данные, которые вы хотите использовать при отладке надстройки Excel, PowerPoint или Word, Visual Studio можно настроить на открытия документа при запуске проекта.</span><span class="sxs-lookup"><span data-stu-id="fa417-173">If you have a document that contains test data you want to use while debugging your Excel, PowerPoint, or Word add-in, Visual Studio can be configured to open that document when you start the project.</span></span> <span data-ttu-id="fa417-174">Чтобы указать существующий документ для использования при отладке надстройки, выполните указанные ниже действия.</span><span class="sxs-lookup"><span data-stu-id="fa417-174">To specify an existing document to use while debugging the add-in, complete the following steps.</span></span>

1. <span data-ttu-id="fa417-175">В **Обозревателе решений** выберите проект надстройки (*не* проект веб-приложения).</span><span class="sxs-lookup"><span data-stu-id="fa417-175">In **Solution Explorer**, choose the add-in project (*not* the web application project).</span></span>

2. <span data-ttu-id="fa417-176">В строке меню выберите **Проект** > **добавить существующий элемент**.</span><span class="sxs-lookup"><span data-stu-id="fa417-176">From the menu bar, choose **Project** > **Add Existing Item**.</span></span>

3. <span data-ttu-id="fa417-177">В диалоговом окне **Добавление существующего элемента** найдите и выберите документ, который вы хотите добавить.</span><span class="sxs-lookup"><span data-stu-id="fa417-177">In the **Add Existing Item** dialog box, locate and select the document that you want to add.</span></span>

4. <span data-ttu-id="fa417-178">Нажмите кнопку **Добавить**, чтобы добавить документ в проект.</span><span class="sxs-lookup"><span data-stu-id="fa417-178">Choose the **Add** button to add the document to your project.</span></span>

5. <span data-ttu-id="fa417-179">В **Обозревателе решений** выберите проект надстройки (*не* проект веб-приложения).</span><span class="sxs-lookup"><span data-stu-id="fa417-179">In **Solution Explorer**, choose the add-in project (*not* the web application project).</span></span>

6. <span data-ttu-id="fa417-180">В панели меню выберите **Вид** > **Окно свойств**.</span><span class="sxs-lookup"><span data-stu-id="fa417-180">From the menu bar, choose **View** > **Properties Window**.</span></span>

7. <span data-ttu-id="fa417-181">В окне**Свойства** выберите список **Стартовый документ**, а затем выберите документ, который вы добавили в проект.</span><span class="sxs-lookup"><span data-stu-id="fa417-181">In the **Properties** window, choose the **Start Document** list, and then select the document that you added to the project.</span></span> <span data-ttu-id="fa417-182">Проект теперь настроен на запуск надстройки в данном документе.</span><span class="sxs-lookup"><span data-stu-id="fa417-182">The project is now configured to start the add-in in that document.</span></span>

## <a name="start-the-project"></a><span data-ttu-id="fa417-183">Запуск проекта</span><span class="sxs-lookup"><span data-stu-id="fa417-183">Start the project</span></span>

<span data-ttu-id="fa417-184">Для запуска проекта выберите **Отладка** > **Начать отладку** в строке меню.</span><span class="sxs-lookup"><span data-stu-id="fa417-184">Start the project by choosing **Debug** > **Start Debugging** from the menu bar.</span></span> <span data-ttu-id="fa417-185">Visual Studio будет автоматически собирать решение и запускать Office для размещения вашей надстройки.</span><span class="sxs-lookup"><span data-stu-id="fa417-185">Visual Studio will automatically build the solution and start Office to host your add-in.</span></span>

> [!NOTE]
> <span data-ttu-id="fa417-186">При запуске проекта надстройки Outlook вам будет предложено ввести учетные данные для входа.</span><span class="sxs-lookup"><span data-stu-id="fa417-186">When you start an Outlook add-in project, you'll be prompted for login credentials.</span></span> <span data-ttu-id="fa417-187">Если вам будет предложено повторно войти в систему или получить сообщение о том, что вы не уполномочены, то обычная проверка подлинности может быть отключена для учетных записей на клиенте Microsoft 365.</span><span class="sxs-lookup"><span data-stu-id="fa417-187">If you're asked to log in repeatedly or if you receive an error that you are unauthorized, then Basic Auth may be disabled for accounts on your Microsoft 365 tenant.</span></span> <span data-ttu-id="fa417-188">В этом случае попробуйте использовать учетную запись Майкрософт.</span><span class="sxs-lookup"><span data-stu-id="fa417-188">In this case, try using a Microsoft account instead.</span></span> <span data-ttu-id="fa417-189">Кроме того, может потребоваться задать в диалоговом окне свойств проекта веб-надстройки Outlook для свойства "Использовать многофакторную проверку подлинности" значение "True".</span><span class="sxs-lookup"><span data-stu-id="fa417-189">You may also need to set the property "Use multi-factor auth" to True in the Outlook Web Add-in project properties dialog.</span></span>

<span data-ttu-id="fa417-190">Когда Visual Studio выполняет сборку проекта, происходит выполнение следующих действий:</span><span class="sxs-lookup"><span data-stu-id="fa417-190">When Visual Studio builds the project it performs the following tasks:</span></span>

1. <span data-ttu-id="fa417-191">Создает копию XML-файл манифеста и добавляет ее в каталоге `_ProjectName_\bin\Debug\OfficeAppManifests`.</span><span class="sxs-lookup"><span data-stu-id="fa417-191">Creates a copy of the XML manifest file and adds it to  `_ProjectName_\bin\Debug\OfficeAppManifests` directory.</span></span> <span data-ttu-id="fa417-192">Хост-приложение использует эту копию, когда вы запускаете Visual Studio и выполняете отладку надстройки.</span><span class="sxs-lookup"><span data-stu-id="fa417-192">The host application consumes this copy when you start Visual Studio and debug the add-in.</span></span>

2. <span data-ttu-id="fa417-193">Создает набор записей реестра на компьютере, который позволяет отображать надстройку в хост-приложении.</span><span class="sxs-lookup"><span data-stu-id="fa417-193">Creates a set of registry entries on your computer that enable the add-in to appear in the host application.</span></span>

3. <span data-ttu-id="fa417-194">Выполняет сборку проекта веб-приложения, а затем развертывает его на локальном веб-сервере IIS (https://localhost).</span><span class="sxs-lookup"><span data-stu-id="fa417-194">Builds the web application project, and then deploys it to the local IIS web server (https://localhost).</span></span>

4. <span data-ttu-id="fa417-195">Если это первый проект надстройки, который вы развернули на локальный веб-сервер IIS, вам может быть предложено установить самозаверяющий сертификат в хранилище доверенных корневых сертификатов текущего пользователя.</span><span class="sxs-lookup"><span data-stu-id="fa417-195">If this is the first add-in project that you have deployed to local IIS web server, you may be prompted to install a Self-Signed Certificate to the current user's Trusted Root Certificate store.</span></span> <span data-ttu-id="fa417-196">Это необходимо для того, чтобы приложение IIS Express отображало содержимое вашей надстройки правильно.</span><span class="sxs-lookup"><span data-stu-id="fa417-196">This is required for IIS Express to display the content of your add-in correctly.</span></span>

> [!NOTE]
> <span data-ttu-id="fa417-197">Последняя версия Office может использовать более новый веб-элемент управления для отображения содержимого надстройки при запуске в Windows 10.</span><span class="sxs-lookup"><span data-stu-id="fa417-197">The latest version of Office may use a newer web control to display the add-in contents when running on Windows 10.</span></span> <span data-ttu-id="fa417-198">В таком случае, Visual Studio может предложить добавить исключение замыкания локальной сети на себя.</span><span class="sxs-lookup"><span data-stu-id="fa417-198">If this is the case, Visual Studio may prompt you to add a local network loopback exemption.</span></span> <span data-ttu-id="fa417-199">Это требуется для того, чтобы веб-элемент управления в хост-приложении Office мог получить доступ к веб-сайту, развернутому на локальном веб-сервере IIS.</span><span class="sxs-lookup"><span data-stu-id="fa417-199">This is required for the web control, in the Office host application, to be able to access the website deployed to the local IIS web server.</span></span> <span data-ttu-id="fa417-200">Эту настройку также можно изменить в любое время в Visual Studio в разделе **Инструменты** > **Параметры** > **Средства Office (веб)** > **Отладка веб-настройки**.</span><span class="sxs-lookup"><span data-stu-id="fa417-200">You can also change this setting anytime in Visual Studio under **Tools** > **Options** > **Office Tools (Web)** > **Web Add-In Debugging**.</span></span>

<span data-ttu-id="fa417-201">Затем Visual Studio выполняет следующее:</span><span class="sxs-lookup"><span data-stu-id="fa417-201">Next, Visual Studio does the following:</span></span>

1. <span data-ttu-id="fa417-202">Изменяет элемент [SourceLocation](../reference/manifest/sourcelocation.md) XML-файла манифеста, выполняя замену маркера `~remoteAppUrl` с полностью отвечающим требованиям адресом начальной страницы (например, `https://localhost:44302/Home.html`).</span><span class="sxs-lookup"><span data-stu-id="fa417-202">Modifies the [SourceLocation](../reference/manifest/sourcelocation.md) element of the XML manifest file by replacing the `~remoteAppUrl` token with the fully qualified address of the start page (for example, `https://localhost:44302/Home.html`).</span></span>

2. <span data-ttu-id="fa417-203">Запускает проект веб-приложения в IIS Express.</span><span class="sxs-lookup"><span data-stu-id="fa417-203">Starts the web application project in IIS Express.</span></span>

3. <span data-ttu-id="fa417-204">Открывает хост-приложение.</span><span class="sxs-lookup"><span data-stu-id="fa417-204">Opens the host application.</span></span>

<span data-ttu-id="fa417-205">Visual Studio не отображает ошибки проверки в окне **ВЫВОД** при построении проекта.</span><span class="sxs-lookup"><span data-stu-id="fa417-205">Visual Studio doesn't show validation errors in the **OUTPUT** window when you build the project.</span></span> <span data-ttu-id="fa417-206">Visual Studio генерирует ошибки и предупреждения в окне **СПИСОК ОШИБОК** при их появлении.</span><span class="sxs-lookup"><span data-stu-id="fa417-206">Visual Studio reports errors and warnings in the **ERRORLIST** window as they occur.</span></span> <span data-ttu-id="fa417-207">Visual Studio также генерирует отчеты об ошибках проверки, отображая волнистые линии (называется волнистой линией) различных цветов в редакторе кода и текста.</span><span class="sxs-lookup"><span data-stu-id="fa417-207">Visual Studio also reports validation errors by showing wavy underlines (known as squiggles) of different colors in the code and text editor.</span></span> <span data-ttu-id="fa417-208">Эти отметки уведомляют о проблемах, которые Visual Studio обнаружил в вашем коде.</span><span class="sxs-lookup"><span data-stu-id="fa417-208">These marks notify you of problems that Visual Studio detected in your code.</span></span> <span data-ttu-id="fa417-209">Дополнительные сведения о том, как включить или отключить проверку см. в статье [Параметры, текстовый редактор, JavaScript, IntelliSense](/visualstudio/ide/reference/options-text-editor-javascript-intellisense?view=vs-2019).</span><span class="sxs-lookup"><span data-stu-id="fa417-209">For more information about how to enable or disable validation, see [Options, Text Editor, JavaScript, IntelliSense](/visualstudio/ide/reference/options-text-editor-javascript-intellisense?view=vs-2019).</span></span>

<span data-ttu-id="fa417-210">Чтобы просмотреть правила проверки XML-файла манифеста проекта, ознакомьтесь с разделом [XML-манифест надстройки для Office](../develop/add-in-manifests.md).</span><span class="sxs-lookup"><span data-stu-id="fa417-210">To review the validation rules of the XML manifest file in your project, see [Office Add-ins XML manifest](../develop/add-in-manifests.md).</span></span>

## <a name="debug-the-code-for-an-excel-powerpoint-or-word-add-in"></a><span data-ttu-id="fa417-211">Отладка кода для надстройки Excel, PowerPoint или Word</span><span class="sxs-lookup"><span data-stu-id="fa417-211">Debug the code for an Excel, PowerPoint, or Word add-in</span></span>

<span data-ttu-id="fa417-212">Если ваша надстройка не отображается в документе, который отображается хост-приложением (Excel, PowerPoint или Word) после [запуска проекта](#start-the-project), вручную запустите надстройку в хост-приложением.</span><span class="sxs-lookup"><span data-stu-id="fa417-212">If your add-in isn't visible within the document that's displayed in the host application (Excel, PowerPoint, or Word) after you've [started the project](#start-the-project), manually launch the add-in in the host application.</span></span> <span data-ttu-id="fa417-213">Например, запустите вашу надстройку области задач, нажав кнопку **Показать область задач** на ленте вкладки **Домой**. После того как ваша надстройка будет отображена в Excel, PowerPoint или Word, вы можете выполнить отладку вашего кода, выполнив следующее:</span><span class="sxs-lookup"><span data-stu-id="fa417-213">For example, launch your task pane add-in by choosing the **Show Taskpane** button in the ribbon of the **Home** tab. After your add-in is displayed in Excel, PowerPoint, or Word, you can debug your code by doing the following:</span></span>

1. <span data-ttu-id="fa417-214">В Excel, PowerPoint или Word, выберите вкладку **Вставка**, а затем нажмите стрелку вниз, находящуюся справа от панели**Мои надстройки**.</span><span class="sxs-lookup"><span data-stu-id="fa417-214">In Excel, PowerPoint, or Word, choose the **Insert** tab and then choose the down-arrow located to the right of **My Add-ins**.</span></span>

    ![Лента "Вставка" в Excel для Windows с выделенной стрелкой "Мои надстройки"](../images/excel-cf-register-add-in-1b.png)

2. <span data-ttu-id="fa417-216">В списке доступных надстроек найдите раздел **Надстройки разработчика** и выберите вашу надстройку, чтобы зарегистрировать ее.</span><span class="sxs-lookup"><span data-stu-id="fa417-216">In the list of available add-ins, find the **Developer Add-ins** section and select the your add-in to register it.</span></span>

3. <span data-ttu-id="fa417-217">В среде Visual Studio задайте точки останова в вашем коде.</span><span class="sxs-lookup"><span data-stu-id="fa417-217">In Visual Studio, set breakpoints in your code.</span></span>

4. <span data-ttu-id="fa417-218">В Excel, PowerPoint или Word выполняется взаимодействие с надстройкой.</span><span class="sxs-lookup"><span data-stu-id="fa417-218">In Excel, PowerPoint, or Word, interact with your add-in.</span></span>

5. <span data-ttu-id="fa417-219">Так как точки останова отмечены в среде Visual Studio, просмотрите код поэтапно при необходимости.</span><span class="sxs-lookup"><span data-stu-id="fa417-219">As breakpoints are hit in Visual Studio, step through the code as needed.</span></span>

<span data-ttu-id="fa417-220">Вы можете изменить свой код и оценить результаты этих изменений для вашей надстройки, без необходимости закрытия хост-приложения и перезапуска проекта.</span><span class="sxs-lookup"><span data-stu-id="fa417-220">You can change your code and review the effects of those changes in your add-in without having to close the host application and restart the project.</span></span> <span data-ttu-id="fa417-221">После сохранения изменений вашего кода просто перезагрузите надстройку в хост-приложении.</span><span class="sxs-lookup"><span data-stu-id="fa417-221">After you save changes to your code, simply reload the add-in in the host application.</span></span> <span data-ttu-id="fa417-222">Например, выполните перезагрузку области задач надстройки, нажав правый верхний угол области задач, чтобы активировать [меню персонализации](../design/task-pane-add-ins.md#personality-menu) и выбрав **Перезагрузка**.</span><span class="sxs-lookup"><span data-stu-id="fa417-222">For example, reload a task pane add-in by choosing the top-right corner of the task pane to activate the [personality menu](../design/task-pane-add-ins.md#personality-menu) and then choose **Reload**.</span></span>

## <a name="debug-the-code-for-an-outlook-add-in"></a><span data-ttu-id="fa417-223">Отладка кода для надстройки Outlook</span><span class="sxs-lookup"><span data-stu-id="fa417-223">Debug the code for an Outlook add-in</span></span>

<span data-ttu-id="fa417-224">После того как вы [запустили проект](#start-the-project), Visual Studio открывает Outlook, чтобы разместить вашу надстройку, откройте сообщение электронной почты или элемент встречи.</span><span class="sxs-lookup"><span data-stu-id="fa417-224">After you've [started the project](#start-the-project) and Visual Studio launches Outlook to host your add-in, open an email message or appointment item.</span></span> 

<span data-ttu-id="fa417-225">Outlook activates the add-in for the item as long as the activation criteria are met.</span><span class="sxs-lookup"><span data-stu-id="fa417-225">Outlook activates the add-in for the item as long as the activation criteria are met.</span></span> <span data-ttu-id="fa417-226">The add-in bar appears at the top of the Inspector window or Reading Pane, and your Outlook add-in appears as a button in the add-in bar.</span><span class="sxs-lookup"><span data-stu-id="fa417-226">The add-in bar appears at the top of the Inspector window or Reading Pane, and your Outlook add-in appears as a button in the add-in bar.</span></span> <span data-ttu-id="fa417-227">If your add-in has an add-in command, a button will appear in the ribbon, either in the default tab or a specified custom tab, and the add-in will not appear in the add-in bar.</span><span class="sxs-lookup"><span data-stu-id="fa417-227">If your add-in has an add-in command, a button will appear in the ribbon, either in the default tab or a specified custom tab, and the add-in will not appear in the add-in bar.</span></span>

<span data-ttu-id="fa417-228">Чтобы просмотреть надстройку Outlook, нажмите кнопку для вашей надстройки Outlook.</span><span class="sxs-lookup"><span data-stu-id="fa417-228">To view your Outlook add-in, choose the button for your Outlook add-in.</span></span> <span data-ttu-id="fa417-229">После отображения вашей надстройки в Outlook, вы можете выполнить отладку кода с помощью описанных ниже действий:</span><span class="sxs-lookup"><span data-stu-id="fa417-229">After your add-in is displayed in Outlook, you can debug your code by doing the following:</span></span>

1. <span data-ttu-id="fa417-230">В среде Visual Studio задайте точки останова в вашем коде.</span><span class="sxs-lookup"><span data-stu-id="fa417-230">In Visual Studio, set breakpoints in your code.</span></span>

2. <span data-ttu-id="fa417-231">В Outlook откройте надстройку.</span><span class="sxs-lookup"><span data-stu-id="fa417-231">In Outlook, interact with your add-in.</span></span>

3. <span data-ttu-id="fa417-232">Так как точки останова отмечены в среде Visual Studio, просмотрите код поэтапно при необходимости.</span><span class="sxs-lookup"><span data-stu-id="fa417-232">As breakpoints are hit in Visual Studio, step through the code as needed.</span></span>

<span data-ttu-id="fa417-233">Вы можете изменить свой код и оценить результаты этих изменений для вашей надстройки, без необходимости закрытия Outlook и перезапуска проекта.</span><span class="sxs-lookup"><span data-stu-id="fa417-233">You can change your code and review the effects of those changes in your add-in without having to close Outlook and restart the project.</span></span> <span data-ttu-id="fa417-234">После сохранения изменений вашего кода просто откройте контекстное меню для надстройки (в Outlook) и выберите кнопку **Перезагрузка**.</span><span class="sxs-lookup"><span data-stu-id="fa417-234">After you save changes to your code, simply open the shortcut menu for the add-in (in Outlook), and then choose **Reload**.</span></span>

## <a name="next-steps"></a><span data-ttu-id="fa417-235">Дальнейшие действия</span><span class="sxs-lookup"><span data-stu-id="fa417-235">Next steps</span></span>

<span data-ttu-id="fa417-236">Если надстройка работает корректно, см. статью [Развертывание и публикация вашей надстройки Office](../publish/publish.md), чтобы ознакомиться со способами распространения вашей надстройки среди пользователей.</span><span class="sxs-lookup"><span data-stu-id="fa417-236">After your add-in is working as desired, see [Deploy and publish your Office Add-in](../publish/publish.md) to learn about the ways you can distribute the add-in to users.</span></span>
