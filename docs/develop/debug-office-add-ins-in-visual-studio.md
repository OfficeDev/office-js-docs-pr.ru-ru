---
title: Отладка надстроек Office в Visual Studio
description: Используйте Visual Studio для отладки надстроек Office в настольном клиенте Office для Windows
ms.date: 12/31/2019
localization_priority: Normal
ms.openlocfilehash: 3bfbc52a8739cb5d51868794f1be701de52b292e
ms.sourcegitcommit: d15bca2c12732f8599be2ec4b2adc7c254552f52
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/12/2020
ms.locfileid: "41950602"
---
# <a name="debug-office-add-ins-in-visual-studio"></a>Отладка надстроек Office в Visual Studio

В этой статье описано, как использовать Visual Studio 2019 для отладки надстроек Office в настольном клиенте Office в Windows. Если вы используете другую версию Visual Studio, процедура может несколько отличаться. 

> [!NOTE]
> Visual Studio невозможно использовать для отладки надстроек Office в Интернете или Office для Mac. Сведения об отладке на этих платформах см. в статьях [Отладка надстроек Office в Office в Интернете](../testing/debug-add-ins-in-office-online.md) и [Отладка надстроек Office на Mac](../testing/debug-office-add-ins-on-ipad-and-mac.md).

## <a name="enable-debugging-for-add-in-commands-and-ui-less-code"></a>Включение отладки для команд надстроек и кода без пользовательского интерфейса

Когда Visual Studio выполняет отладку Office для Windows, надстройка размещается в экземпляре браузера Microsoft Internet Explorer или Microsoft Edge. Сведения об определении браузера, используемого на компьютере разработки, см. в статье [Браузеры, используемые надстройками Office](../concepts/browsers-used-by-office-web-add-ins.md).
> [!NOTE]
> В следующей процедуре переменная среды JS_Debug больше не требуется. Дополнительные сведения см. в статье [Действия отладки в веб-надстройках Office](https://developercommunity.visualstudio.com/content/problem/740413/office-development-inconsistent-script-debugging-b.html) на форуме технической поддержки сообщества разработчиков Майкрософт.

[!include[Enable debugging on Microsoft Edge DevTools](../includes/enable-debugging-on-edge-devtools.md)]

## <a name="review-the-build-and-debug-properties"></a>Просмотр параметров сборки и отладки

Перед началом отладки просмотрите свойства каждого проекта и убедитесь, что Visual Studio откроет нужное хост-приложение, а другие параметры сборки и отладки заданы правильно.

### <a name="add-in-project-properties"></a>Свойства проекта надстройки

Откройте окно**Свойства** в проекте надстройки для просмотра свойств проекта:

1. В **Обозревателе решений** выберите проект надстройки,  (*не* проект веб-приложения).

2. В панели меню выберите пункт **Вид** >  **Окно свойств**.

В следующей таблице описываются свойства проекта надстройки.

|**Свойство**|**Описание**|
|:-----|:-----|
|**Действие при запуске**|Определяет режим отладки для вашей надстройки. В настоящее время только режим**классического клиента Office** поддерживается для проектов надстройки Office.|
|**Начальный документ**<br/>(только для надстроек Excel, PowerPoint и Word)|Указывает, какой документ следует открыть при запуске проекта.|
|**Веб-проект**|Определяет имя веб-проекта, связанного с надстройкой.|
|**Адрес электронной почты**<br/>(только для надстроек Outlook)|Указывает адрес электронной почты учетной записи пользователя на сервере Exchange Server или Exchange Online, который вы хотите использовать для проверки надстройки Outlook.|
|**EWS Url**<br/>(только для надстроек Outlook)|URL-адрес веб-службы Exchange (пример: `https://www.contoso.com/ews/exchange.aspx`). |
|**URL-адрес OWA**<br/>(только для надстроек Outlook)|URL-адрес Outlook в Интернете (например, `https://www.contoso.com/owa`).|
|**Использование многофакторной проверки подлинности**<br/>(только для надстроек Outlook)|Логическое значение, которое определяет, следует ли использовать многофакторную проверку подлинности.|
|**Имя пользователя**<br/>(только для надстроек Outlook)|Определяет имя учетной записи на сервере Exchange Server или Exchange Online, которое вы хотите использовать для проверки вашей надстройки Outlook.|
|**Файл проекта **|Задает имя файла, в котором указаны сборка, конфигурация и другие сведения о проекте.|
|**Папка проекта**|Расположение файла проекта.|

> [!NOTE]
> Для надстройки Outlook вы можете задать значения для одной или нескольких используемых только для*надстроек Outlook свойств * в окне **Свойства**, но делать это необязательно.

### <a name="web-application-project-properties"></a>Свойства проекта веб-приложения

Откройте окно**Свойства** в проекте веб-приложения для просмотра свойств проекта:

1. В **Обозревателе решений** выберите проект веб-приложения.

2. В панели меню выберите пункт **Вид** >  **Окно свойств**.

В таблице ниже описаны свойства проекта веб-приложения, которые наиболее подходят для проектов надстройки Office.

|**Свойство**|**Описание**|
|:-----|:-----|
|**SSL включен**|Указывает, включен ли SSL на сайте. Это свойство должно иметь значение **True** для проектов надстройки Office.|
|**URL-АДРЕС SSL**|Задает защищенный HTTPS URL-адрес сайта. Только для чтения.|
|**URL**|Задает HTTP URL-адрес сайта. Только для чтения.|
|**Файл проекта **|Задает имя файла, в котором указаны сборка, конфигурация и другие сведения о проекте.|
|**Папка проекта**|Указывает расположение файла проекта. Только для чтения. Файл манифеста, который генерирует Visual Studio во время выполнения, записывается в папку `bin\Debug\OfficeAppManifests` в этом расположении.|

## <a name="use-an-existing-document-to-debug-the-add-in"></a>Использование существующего документа для отладки надстройки

Если у вас есть документ, содержащий тестовые данные, которые вы хотите использовать при отладке надстройки Excel, PowerPoint или Word, Visual Studio можно настроить на открытия документа при запуске проекта. Чтобы указать существующий документ для использования при отладке надстройки, выполните указанные ниже действия.

1. В **Обозревателе решений** выберите проект надстройки (*не* проект веб-приложения).

2. В строке меню выберите **Проект** > **добавить существующий элемент**.

3. В диалоговом окне **Добавление существующего элемента** найдите и выберите документ, который вы хотите добавить.

4. Нажмите кнопку **Добавить**, чтобы добавить документ в проект.

5. В **Обозревателе решений** выберите проект надстройки (*не* проект веб-приложения).

6. В панели меню выберите **Вид** > **Окно свойств**.

7. В окне**Свойства** выберите список **Стартовый документ**, а затем выберите документ, который вы добавили в проект. Проект теперь настроен на запуск надстройки в данном документе.

## <a name="start-the-project"></a>Запуск проекта

Для запуска проекта выберите **Отладка** > **Начать отладку** в строке меню. Visual Studio будет автоматически собирать решение и запускать Office для размещения вашей надстройки.

> [!NOTE]
> При запуске проекта надстройки Outlook вам будет предложено ввести учетные данные для входа. Если вам постоянно приходится входить в систему или появляется сообщение об ошибке авторизации, Basic Auth может быть отключен для учетных записей в вашем клиенте Office 365. В этом случае попробуйте использовать учетную запись Майкрософт. Кроме того, может потребоваться задать в диалоговом окне свойств проекта веб-надстройки Outlook для свойства "Использовать многофакторную проверку подлинности" значение "True".

Когда Visual Studio выполняет сборку проекта, происходит выполнение следующих действий:

1. Создает копию XML-файл манифеста и добавляет ее в каталоге `_ProjectName_\bin\Debug\OfficeAppManifests`. Хост-приложение использует эту копию, когда вы запускаете Visual Studio и выполняете отладку надстройки.

2. Создает набор записей реестра на компьютере, который позволяет отображать надстройку в хост-приложении.

3. Выполняет сборку проекта веб-приложения, а затем развертывает его на локальном веб-сервере IIS (https://localhost).

4. Если это первый проект надстройки, который вы развернули на локальный веб-сервер IIS, вам может быть предложено установить самозаверяющий сертификат в хранилище доверенных корневых сертификатов текущего пользователя. Это необходимо для того, чтобы приложение IIS Express отображало содержимое вашей надстройки правильно.

> [!NOTE]
> Последняя версия Office может использовать более новый веб-элемент управления для отображения содержимого надстройки при запуске в Windows 10. В таком случае, Visual Studio может предложить добавить исключение замыкания локальной сети на себя. Это требуется для того, чтобы веб-элемент управления в хост-приложении Office мог получить доступ к веб-сайту, развернутому на локальном веб-сервере IIS. Эту настройку также можно изменить в любое время в Visual Studio в разделе **Инструменты** > **Параметры** > **Средства Office (веб)** > **Отладка веб-настройки**.

Затем Visual Studio выполняет следующее:

1. Изменяет элемент [SourceLocation](/office/dev/add-ins/reference/manifest/sourcelocation) XML-файла манифеста, выполняя замену маркера `~remoteAppUrl` с полностью отвечающим требованиям адресом начальной страницы (например, `https://localhost:44302/Home.html`).

2. Запускает проект веб-приложения в IIS Express.

3. Открывает хост-приложение.

Visual Studio не отображает ошибки проверки в окне **ВЫХОДНЫЕ ДАННЫЕ** при сборке проекта. Visual Studio генерирует ошибки и предупреждения в окне **СПИСОК ОШИБОК** при их появлении. Visual Studio также генерирует отчеты об ошибках проверки, отображая волнистые линии (называется волнистой линией) различных цветов в редакторе кода и текста. Эти отметки уведомляют о проблемах, которые Visual Studio обнаружил в вашем коде. Дополнительные сведения о том, как включить или отключить проверку см. в статье [Параметры, текстовый редактор, JavaScript, IntelliSense](/visualstudio/ide/reference/options-text-editor-javascript-intellisense?view=vs-2019).

Чтобы просмотреть правила проверки XML-файла манифеста проекта, ознакомьтесь с разделом [XML-манифест надстройки для Office](../develop/add-in-manifests.md).

## <a name="debug-the-code-for-an-excel-powerpoint-or-word-add-in"></a>Отладка кода для надстройки Excel, PowerPoint или Word

Если ваша надстройка не отображается в документе, который отображается хост-приложением (Excel, PowerPoint или Word) после [запуска проекта](#start-the-project), вручную запустите надстройку в хост-приложением. Например, запустите вашу надстройку области задач, нажав кнопку **Показать область задач** на ленте вкладки **Домой**. После того как ваша надстройка будет отображена в Excel, PowerPoint или Word, вы можете выполнить отладку вашего кода, выполнив следующее:

1. В Excel, PowerPoint или Word, выберите вкладку **Вставка**, а затем нажмите стрелку вниз, находящуюся справа от панели**Мои надстройки**.

    ![Лента "Вставка" в Excel для Windows с выделенной стрелкой "Мои надстройки"](../images/excel-cf-register-add-in-1b.png)

2. В списке доступных надстроек найдите раздел **Надстройки разработчика** и выберите вашу надстройку, чтобы зарегистрировать ее.

3. В среде Visual Studio задайте точки останова в вашем коде.

4. В Excel, PowerPoint или Word выполняется взаимодействие с надстройкой.

5. Так как точки останова отмечены в среде Visual Studio, просмотрите код поэтапно при необходимости.

Вы можете изменить свой код и оценить результаты этих изменений для вашей надстройки, без необходимости закрытия хост-приложения и перезапуска проекта. После сохранения изменений вашего кода просто перезагрузите надстройку в хост-приложении. Например, выполните перезагрузку области задач надстройки, нажав правый верхний угол области задач, чтобы активировать [меню персонализации](../design/task-pane-add-ins.md#personality-menu) и выбрав **Перезагрузка**.

## <a name="debug-the-code-for-an-outlook-add-in"></a>Отладка кода для надстройки Outlook

После того как вы [запустили проект](#start-the-project), Visual Studio открывает Outlook, чтобы разместить вашу надстройку, откройте сообщение электронной почты или элемент встречи. 

Outlook активирует надстройка для этого элемента, если соблюдаются критерии активации. В верхней части окна инспектора или области чтения появляется строка надстройка, и надстройка Outlook отображается в строке надстройка в виде кнопки. Если в вашей надстройке есть команда, на ленте появится кнопка (либо на вкладке по умолчанию, либо на пользовательской вкладке), а надстройка не будет отображаться в области надстройка.

Чтобы просмотреть надстройку Outlook, нажмите кнопку для вашей надстройки Outlook. После отображения вашей надстройки в Outlook, вы можете выполнить отладку кода с помощью описанных ниже действий:

1. В среде Visual Studio задайте точки останова в вашем коде.

2. В Outlook откройте надстройку.

3. Так как точки останова отмечены в среде Visual Studio, просмотрите код поэтапно при необходимости.

Вы можете изменить свой код и оценить результаты этих изменений для вашей надстройки, без необходимости закрытия Outlook и перезапуска проекта. После сохранения изменений вашего кода просто откройте контекстное меню для надстройки (в Outlook) и выберите кнопку **Перезагрузка**.

## <a name="next-steps"></a>Дальнейшие действия

Если надстройка работает корректно, см. статью [Развертывание и публикация вашей надстройки Office](../publish/publish.md), чтобы ознакомиться со способами распространения вашей надстройки среди пользователей.
