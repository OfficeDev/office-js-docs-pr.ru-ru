---
title: Ограничения ресурсов и оптимизация производительности надстроек Office
description: Сведения об ограничении ресурсов платформы надстройки Office, в том числе ЦП и памяти.
ms.date: 07/29/2020
localization_priority: Normal
ms.openlocfilehash: 8c64e5a836d6b998ccd7022e71f595bb331bba8c
ms.sourcegitcommit: 9609bd5b4982cdaa2ea7637709a78a45835ffb19
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/28/2020
ms.locfileid: "47293333"
---
# <a name="resource-limits-and-performance-optimization-for-office-add-ins"></a><span data-ttu-id="cfb08-103">Ограничения ресурсов и оптимизация производительности надстроек Office</span><span class="sxs-lookup"><span data-stu-id="cfb08-103">Resource limits and performance optimization for Office Add-ins</span></span>

<span data-ttu-id="cfb08-p101">Чтобы обеспечить максимальное удобство работы для пользователей, разработчику необходимо убедиться, что надстройка Office работает в заданных пределах использования ЦП и памяти, что она достаточно надежна, а в случае надстроек Outlook еще и проверить время ответа при оценке регулярных выражений. Эти ограничения на использование ресурсов среды выполнения применяются только к надстройкам, запущенным в клиентах Office для Windows и OS X, но не в мобильных приложениях или браузере.</span><span class="sxs-lookup"><span data-stu-id="cfb08-p101">To create the best experience for your users, ensure that your Office Add-in performs within specific limits for CPU core and memory usage, reliability, and, for Outlook add-ins, the response time for evaluating regular expressions. These run-time resource usage limits apply to add-ins running in Office clients on Windows and OS X, but not on mobile apps or in a browser.</span></span>

<span data-ttu-id="cfb08-106">Вы также можете оптимизировать работу надстроек на мобильных устройствах и компьютерах, оптимизировав использование ресурсов в проекте и реализации.</span><span class="sxs-lookup"><span data-stu-id="cfb08-106">You can also optimize the performance of your add-ins on desktop and mobile devices by optimizing the use of resources in your add-in design and implementation.</span></span>

## <a name="resource-usage-limits-for-add-ins"></a><span data-ttu-id="cfb08-107">Ограничения на использование ресурсов для надстроек</span><span class="sxs-lookup"><span data-stu-id="cfb08-107">Resource usage limits for add-ins</span></span>

<span data-ttu-id="cfb08-108">Пределы использования ресурсов во время выполнения применяются ко всем типам надстроек Office. Эти пределы помогают обеспечить производительность пользователей и устранять атаки типа "отказ в обслуживании".</span><span class="sxs-lookup"><span data-stu-id="cfb08-108">Run-time resource usage limits apply to all types of Office Add-ins. These limits help ensure performance for your users and mitigate denial-of-service attacks.</span></span> <span data-ttu-id="cfb08-109">Обязательно протестируйте надстройку Office в целевом приложении Office, используя диапазон возможных данных, и Измерьте производительность с учетом следующих пределов использования во время выполнения:</span><span class="sxs-lookup"><span data-stu-id="cfb08-109">Be sure to test your Office Add-in on your target Office application by using a range of possible data, and measure its performance against the following run-time usage limits:</span></span>

- <span data-ttu-id="cfb08-110">**Загрузка ядра ЦП**. Загрузка одного ядра ЦП не должна превышать 90 % (проверяется три раза с интервалом 5 секунд).</span><span class="sxs-lookup"><span data-stu-id="cfb08-110">**CPU core usage** - A single CPU core usage threshold of 90%, observed three times in default 5-second intervals.</span></span>

   <span data-ttu-id="cfb08-111">Интервал по умолчанию для проверки использования ЦП для клиента Office составляет каждые 5 секунд.</span><span class="sxs-lookup"><span data-stu-id="cfb08-111">The default interval for an Office client to check CPU core usage is every 5 seconds.</span></span> <span data-ttu-id="cfb08-112">Если клиент Office обнаружит, что использование ядра ЦП для надстройки превышает пороговое значение, отображается сообщение о том, что пользователю нужно продолжить выполнение надстройки.</span><span class="sxs-lookup"><span data-stu-id="cfb08-112">If the Office client detects the CPU core usage of an add-in is above the threshold value, it displays a message asking if the user wants to continue running the add-in.</span></span> <span data-ttu-id="cfb08-113">Если пользователь решит продолжить, клиент Office не будет спрашивать этого пользователя в течение этого сеанса редактирования.</span><span class="sxs-lookup"><span data-stu-id="cfb08-113">If the user chooses to continue, the Office client does not ask the user again during that edit session.</span></span> <span data-ttu-id="cfb08-114">С помощью раздела реестра **AlertInterval** администраторы могут повысить пороговое значение, чтобы это сообщение отображалось реже, если пользователи работают с надстройками, требующими больших затрат ресурсов ЦП.</span><span class="sxs-lookup"><span data-stu-id="cfb08-114">Administrators might want to use the **AlertInterval** registry key to raise the threshold to reduce the display of this warning message if users run CPU-intensive add-ins.</span></span>

- <span data-ttu-id="cfb08-115">**Использование памяти**. Пороговое значение использования памяти по умолчанию, которое определяется динамически на основе доступной физической памяти устройства.</span><span class="sxs-lookup"><span data-stu-id="cfb08-115">**Memory usage** - A default memory usage threshold that is dynamically determined based on the available physical memory of the device.</span></span>

   <span data-ttu-id="cfb08-116">По умолчанию, когда клиент Office обнаружит, что использование физической памяти на устройстве превышает 80% доступной памяти, клиент начинает мониторинг использования памяти надстройки на уровне документа для контентных надстроек и надстроек области задач, а также на уровне почтового ящика для надстроек Outlook. С интервалом по умолчанию, равным 5 секунд, клиент предупреждает пользователя, если использование физической памяти для набора надстроек на уровне документа или почтового ящика превышает 50%.</span><span class="sxs-lookup"><span data-stu-id="cfb08-116">By default, when a Office client detects that physical memory usage on a device exceeds 80% of the available memory, the client starts monitoring the add-in's memory usage, at a document level for content and task pane add-ins, and at a mailbox level for Outlook add-ins. At a default interval of 5 seconds, the client warns the user if physical memory usage for a set of add-ins at the document or mailbox level exceeds 50%.</span></span> <span data-ttu-id="cfb08-117">Этот предел использования памяти рассчитан для физической, а не виртуальной памяти, и позволяет обеспечить производительность на устройствах с ограниченной оперативной памятью, таких как планшеты.</span><span class="sxs-lookup"><span data-stu-id="cfb08-117">This memory usage limit uses physical rather than virtual memory to ensure performance on devices with limited RAM, such as tablets.</span></span> <span data-ttu-id="cfb08-118">Администраторы могут переопределить этот динамический параметр с явным пределом, используя раздел реестра **абсолютные memoryalertthreshold** Windows в качестве глобального параметра, ИК-связи настройте интервал оповещений, используя ключ **алертинтервал** в качестве глобального параметра.</span><span class="sxs-lookup"><span data-stu-id="cfb08-118">Administrators can override this dynamic setting with an explicit limit by using the **MemoryAlertThreshold** Windows registry key as a global setting, ir adjust the alert interval by using the **AlertInterval** key as a global setting.</span></span>

- <span data-ttu-id="cfb08-119">**Устойчивость к сбоям**. По умолчанию надстройка должна давать сбой не более четыре раз.</span><span class="sxs-lookup"><span data-stu-id="cfb08-119">**Crash tolerance** - A default limit of four crashes for an add-in.</span></span>

   <span data-ttu-id="cfb08-120">Администраторы могут настраивать предельное количество сбоев с помощью раздела реестра **RestartManagerRetryLimit**.</span><span class="sxs-lookup"><span data-stu-id="cfb08-120">Administrators can adjust the threshold for crashes by using the **RestartManagerRetryLimit** registry key.</span></span>

- <span data-ttu-id="cfb08-121">**Блокирование надстройки**. Отсутствие ответа должно длиться не более 5 секунд.</span><span class="sxs-lookup"><span data-stu-id="cfb08-121">**Application blocking** - Prolonged unresponsiveness threshold of 5 seconds for an add-in.</span></span>

   <span data-ttu-id="cfb08-122">Это влияет на взаимодействие пользователя с надстройкой и приложением Office.</span><span class="sxs-lookup"><span data-stu-id="cfb08-122">This affects the user's experiences of the add-in and the Office application.</span></span> <span data-ttu-id="cfb08-123">В этом случае приложение Office автоматически перезапускает все активные надстройки для документа или почтового ящика (если это необходимо) и предупреждает пользователя о том, что надстройка перестала отвечать на запросы.</span><span class="sxs-lookup"><span data-stu-id="cfb08-123">When this occurs, the Office application automatically restarts all the active add-ins for a document or mailbox (where applicable), and warns the user as to which add-in became unresponsive.</span></span> <span data-ttu-id="cfb08-124">Этот порог может достигаться, если надстройка нерегулярно использует вычислительные ресурсы при выполнении длительных задач.</span><span class="sxs-lookup"><span data-stu-id="cfb08-124">Add-ins can reach this threshold when they do not regularly yield processing while performing long-running tasks.</span></span> <span data-ttu-id="cfb08-125">Существуют методики, позволяющие избежать блокировки.</span><span class="sxs-lookup"><span data-stu-id="cfb08-125">There are techniques to ensure that blocking does not occur.</span></span> <span data-ttu-id="cfb08-126">Администраторы не могут переопределять это пороговое значение.</span><span class="sxs-lookup"><span data-stu-id="cfb08-126">Administrators cannot override this threshold.</span></span>

### <a name="outlook-add-ins"></a><span data-ttu-id="cfb08-127">Надстройки Outlook</span><span class="sxs-lookup"><span data-stu-id="cfb08-127">Outlook add-ins</span></span>

<span data-ttu-id="cfb08-p106">Если какая-либо надстройка Outlook превышает описанные пороговые значения, касающиеся числа сбоев или использования ЦП и памяти, Outlook отключает надстройку. В Центре администрирования Exchange состояние надстройки отображается как "Отключено".</span><span class="sxs-lookup"><span data-stu-id="cfb08-p106">If any Outlook add-in exceeds the preceding thresholds for CPU core or memory usage, or tolerance limit for crashes, Outlook disables the add-in. The Exchange Admin Center displays the disabled status of the app.</span></span>

> [!NOTE]
> <span data-ttu-id="cfb08-130">Хотя только полнофункциональные клиенты Outlook (не Outlook в Интернете или для мобильных устройств) отслеживают использование ресурсов, если полнофункциональный клиент отключит надстройку Outlook, эта надстройка также будет отключена в Outlook в Интернете и для мобильных устройств.</span><span class="sxs-lookup"><span data-stu-id="cfb08-130">Even though only the Outlook rich clients and not Outlook on the web or mobile devices monitor resource usage, if a rich client disables an Outlook add-in, that add-in is also disabled for use in Outlook on the web and mobile devices.</span></span>

<span data-ttu-id="cfb08-131">Помимо правил, связанных с памятью, надежностью и ядром ЦП, надстройки Outlook должны соблюдать при активации следующие правила:</span><span class="sxs-lookup"><span data-stu-id="cfb08-131">In addition to the CPU core, memory, and reliability rules, Outlook add-ins should observe the following rules on activation:</span></span>

- <span data-ttu-id="cfb08-p107">**Время ответа при оценке регулярных выражений**. По умолчанию Outlook должна оценивать все регулярные выражения в манифесте надстройки Outlook не более 1000 миллисекунд. При превышении этого значения Outlook повторит оценку позже.</span><span class="sxs-lookup"><span data-stu-id="cfb08-p107">**Regular expressions response time** - A default threshold of 1,000 milliseconds for Outlook to evaluate all regular expressions in the manifest of an Outlook add-in. Exceeding the threshold causes Outlook to retry evaluation at a later time.</span></span>

    <span data-ttu-id="cfb08-134">С помощью групповой политики или параметров приложения в реестре Windows администраторы могут настроить это пороговое значение по умолчанию в 1000 миллисекунд с помощью параметра **OutlookActivationAlertThreshold**.</span><span class="sxs-lookup"><span data-stu-id="cfb08-134">Using a group policy or application-specific setting in the Windows registry, administrators can adjust this default threshold value of 1,000 milliseconds in the **OutlookActivationAlertThreshold** setting.</span></span>

- <span data-ttu-id="cfb08-135">**Повторное вычисление регулярных выражений** — значение по умолчанию, равное трем значениям, по умолчанию для повторного вычисления всех регулярных выражений в манифесте.</span><span class="sxs-lookup"><span data-stu-id="cfb08-135">**Regular expressions re-evaluation** - A default limit of three times for Outlook to reevaluate all the regular expressions in a manifest.</span></span> <span data-ttu-id="cfb08-136">Если при вычислении произошел сбой из-за превышения указанного порогового значения (значение по умолчанию — 1 000 миллисекунд или значение, заданное параметром **OutlookActivationAlertThreshold**, если этот параметр существует в реестре Windows), Outlook отключает надстройку Outlook.</span><span class="sxs-lookup"><span data-stu-id="cfb08-136">If evaluation fails all three times by exceeding the applicable threshold (which is either the default of 1,000 milliseconds or a value specified by **OutlookActivationAlertThreshold**, if that setting exists in the Windows registry), Outlook disables the Outlook add-in.</span></span> <span data-ttu-id="cfb08-137">В центре администрирования Exchange отображается состояние disabled, и надстройка отключена для использования в расширенных клиентах Outlook, а также в Outlook в Интернете и на мобильных устройствах.</span><span class="sxs-lookup"><span data-stu-id="cfb08-137">The Exchange Admin Center displays the disabled status, and the add-in is disabled for use in the Outlook rich clients, and Outlook on the web and mobile devices.</span></span>

    <span data-ttu-id="cfb08-138">С помощью групповой политики или параметра приложения в реестре Windows администраторы могут настроить это число попыток оценки, используя параметр **OutlookActivationManagerRetryLimit**.</span><span class="sxs-lookup"><span data-stu-id="cfb08-138">Using a group policy or application-specific setting in the Windows registry, administrators can adjust this number of times to retry evaluation in the **OutlookActivationManagerRetryLimit** setting.</span></span>

### <a name="excel-add-ins"></a><span data-ttu-id="cfb08-139">Надстройки Excel</span><span class="sxs-lookup"><span data-stu-id="cfb08-139">Excel add-ins</span></span>

<span data-ttu-id="cfb08-140">При создании надстройки Excel учитывайте следующие ограничения размера при взаимодействии с книгой:</span><span class="sxs-lookup"><span data-stu-id="cfb08-140">If you're building an Excel add-in, be aware of the following size limitations when interacting with the workbook:</span></span>

- <span data-ttu-id="cfb08-141">В Excel в Интернете действует ограничение в 5 МБ на размер полезных данных запросов и откликов.</span><span class="sxs-lookup"><span data-stu-id="cfb08-141">Excel on the web has a payload size limit for requests and responses of 5MB.</span></span> <span data-ttu-id="cfb08-142">При превышении этого ограничения возникает ошибка `RichAPI.Error`.</span><span class="sxs-lookup"><span data-stu-id="cfb08-142">`RichAPI.Error` will be thrown if that limit is exceeded.</span></span>
- <span data-ttu-id="cfb08-143">Диапазон ограничен 5 000 000 ячейками для операций Get.</span><span class="sxs-lookup"><span data-stu-id="cfb08-143">A range is limited to five million cells for get operations.</span></span>

<span data-ttu-id="cfb08-144">Если ожидается, что вводимые пользователем данные превышают эти ограничения, обязательно проверьте данные перед вызовом `context.sync()` .</span><span class="sxs-lookup"><span data-stu-id="cfb08-144">If you expect user input to exceed these limits, be sure to check the data before calling `context.sync()`.</span></span> <span data-ttu-id="cfb08-145">При необходимости разделите операцию на небольшие части.</span><span class="sxs-lookup"><span data-stu-id="cfb08-145">Split the operation into smaller pieces as needed.</span></span> <span data-ttu-id="cfb08-146">Не забудьте позвонить `context.sync()` по каждой подоперации, чтобы избежать повторного пакетной операции.</span><span class="sxs-lookup"><span data-stu-id="cfb08-146">Be sure to call `context.sync()` for each sub-operation to avoid those operations getting batched together again.</span></span>

<span data-ttu-id="cfb08-147">Эти ограничения обычно превышаются с помощью больших диапазонов.</span><span class="sxs-lookup"><span data-stu-id="cfb08-147">These limitations are typically exceeded by large ranges.</span></span> <span data-ttu-id="cfb08-148">Надстройка может использовать [RangeAreas](/javascript/api/excel/excel.rangeareas) для стратегических обновлений ячеек в пределах большого диапазона.</span><span class="sxs-lookup"><span data-stu-id="cfb08-148">Your add-in might be able to use [RangeAreas](/javascript/api/excel/excel.rangeareas) to strategically update cells within a larger range.</span></span> <span data-ttu-id="cfb08-149">Для получения дополнительных сведений просмотрите [работу с несколькими диапазонами в](../excel/excel-add-ins-multiple-ranges.md) надстройках Excel.</span><span class="sxs-lookup"><span data-stu-id="cfb08-149">See [Work with multiple ranges simultaneously in Excel add-ins](../excel/excel-add-ins-multiple-ranges.md) for more information.</span></span>

### <a name="task-pane-and-content-add-ins"></a><span data-ttu-id="cfb08-150">Надстройки области задач и контентные надстройки</span><span class="sxs-lookup"><span data-stu-id="cfb08-150">Task pane and content add-ins</span></span>

<span data-ttu-id="cfb08-151">Если любое содержимое или надстройка области задач превышает предшествующие пороговые значения для ядра ЦП или использования памяти или ограничение допуска для сбоев, соответствующее приложение Office отображает предупреждение для пользователя.</span><span class="sxs-lookup"><span data-stu-id="cfb08-151">If any content or task pane add-in exceeds the preceding thresholds on CPU core or memory usage, or tolerance limit for crashes, the corresponding Office application displays a warning for the user.</span></span> <span data-ttu-id="cfb08-152">В этот момент пользователь может сделать одно из следующих действий:</span><span class="sxs-lookup"><span data-stu-id="cfb08-152">At this point, the user can do one of the following:</span></span>

- <span data-ttu-id="cfb08-153">Перезапустить надстройку.</span><span class="sxs-lookup"><span data-stu-id="cfb08-153">Restart the add-in.</span></span>
- <span data-ttu-id="cfb08-p113">Отменить дальнейшие оповещения о превышении заданного порога. В идеальном случае пользователь должен удалить надстройку из документа. Продолжение работы с приложением может вызвать дальнейшие проблемы производительности и стабильности.</span><span class="sxs-lookup"><span data-stu-id="cfb08-p113">Cancel further alerts about exceeding that threshold. Ideally, the user should then delete the add-in from the document; continuing the add-in would risk further performance and stability issues.</span></span>  

## <a name="verifying-resource-usage-issues-in-the-telemetry-log"></a><span data-ttu-id="cfb08-156">Проверка проблем использования ресурсов в журнале телеметрии</span><span class="sxs-lookup"><span data-stu-id="cfb08-156">Verifying resource usage issues in the Telemetry Log</span></span>

<span data-ttu-id="cfb08-p114">Office предоставляет журнал телеметрии, который поддерживает запись определенных событий (загрузку, открытие, закрытие и ошибки) решений Office, работающих на локальном компьютере, включая проблемы использование ресурсов в Надстройка Office. Если настроен журнал телеметрии, можно использовать Excel для открытия его в следующем расположении по умолчанию на локальном диске:</span><span class="sxs-lookup"><span data-stu-id="cfb08-p114">Office provides a Telemetry Log that maintains a record of certain events (loading, opening, closing, and errors) of Office solutions running on the local computer, including resource usage issues in an Office Add-in. If you have the Telemetry Log set up, you can use Excel to open the Telemetry Log in the following default location on your local drive:</span></span>

`%Users%\<Current user>\AppData\Local\Microsoft\Office\15.0\Telemetry`

<span data-ttu-id="cfb08-p115">Для каждого события надстройки, которое регистрируется в журнале телеметрии, определяются дата и время возникновения, идентификатор, серьезность, краткий описательный заголовок, понятное имя, уникальный идентификатор надстройки и приложение, внесшее сведения об этом событии в журнал. Вы можете обновить журнал телеметрии, чтобы увидеть текущие отслеживаемые события. В таблице ниже приведены примеры надстроек Outlook, которые отслеживались в журнале телеметрии.</span><span class="sxs-lookup"><span data-stu-id="cfb08-p115">For each event that the Telemetry Log tracks for an add-in, there is a date/time of the occurrence, event ID, severity, and short descriptive title for the event, the friendly name and unique ID of the add-in, and the application that logged the event. You can refresh the Telemetry Log to see the current tracked events. The following table shows examples of Outlook add-ins that were tracked in the Telemetry log.</span></span>

|<span data-ttu-id="cfb08-162">**Дата/время**</span><span class="sxs-lookup"><span data-stu-id="cfb08-162">**Date/Time**</span></span>|<span data-ttu-id="cfb08-163">**Код события**</span><span class="sxs-lookup"><span data-stu-id="cfb08-163">**Event ID**</span></span>|<span data-ttu-id="cfb08-164">**Серьезность**</span><span class="sxs-lookup"><span data-stu-id="cfb08-164">**Severity**</span></span>|<span data-ttu-id="cfb08-165">**Название**</span><span class="sxs-lookup"><span data-stu-id="cfb08-165">**Title**</span></span>|<span data-ttu-id="cfb08-166">**Файл**</span><span class="sxs-lookup"><span data-stu-id="cfb08-166">**File**</span></span>|<span data-ttu-id="cfb08-167">**ИД**</span><span class="sxs-lookup"><span data-stu-id="cfb08-167">**ID**</span></span>|<span data-ttu-id="cfb08-168">**Приложение**</span><span class="sxs-lookup"><span data-stu-id="cfb08-168">**Application**</span></span>|
|:-----|:-----|:-----|:-----|:-----|:-----|:-----|
|<span data-ttu-id="cfb08-169">8.10.2012 17:57:10</span><span class="sxs-lookup"><span data-stu-id="cfb08-169">10/8/2012 5:57:10 PM</span></span>|<span data-ttu-id="cfb08-170">7 </span><span class="sxs-lookup"><span data-stu-id="cfb08-170">7</span></span>||<span data-ttu-id="cfb08-171">Манифест надстройки загружен успешно</span><span class="sxs-lookup"><span data-stu-id="cfb08-171">add-in manifest downloaded successfully</span></span>|<span data-ttu-id="cfb08-172">Who's Who</span><span class="sxs-lookup"><span data-stu-id="cfb08-172">Who's Who</span></span>|<span data-ttu-id="cfb08-173">69cc567c-6737-4c49-88dd-123334943a22</span><span class="sxs-lookup"><span data-stu-id="cfb08-173">69cc567c-6737-4c49-88dd-123334943a22</span></span>|<span data-ttu-id="cfb08-174">Outlook</span><span class="sxs-lookup"><span data-stu-id="cfb08-174">Outlook</span></span>|
|<span data-ttu-id="cfb08-175">8.10.2012 17:57:01</span><span class="sxs-lookup"><span data-stu-id="cfb08-175">10/8/2012 5:57:01 PM</span></span>|<span data-ttu-id="cfb08-176">7 </span><span class="sxs-lookup"><span data-stu-id="cfb08-176">7</span></span>||<span data-ttu-id="cfb08-177">Манифест надстройки загружен успешно</span><span class="sxs-lookup"><span data-stu-id="cfb08-177">add-in manifest downloaded successfully</span></span>|<span data-ttu-id="cfb08-178">LinkedIn</span><span class="sxs-lookup"><span data-stu-id="cfb08-178">LinkedIn</span></span>|<span data-ttu-id="cfb08-179">333bf46d-7dad-4f2b-8cf4-c19ddc78b723</span><span class="sxs-lookup"><span data-stu-id="cfb08-179">333bf46d-7dad-4f2b-8cf4-c19ddc78b723</span></span>|<span data-ttu-id="cfb08-180">Outlook</span><span class="sxs-lookup"><span data-stu-id="cfb08-180">Outlook</span></span>|

<span data-ttu-id="cfb08-181">В таблице ниже приведен общий список событий, которые отслеживаются в журнале телеметрии для надстроек Office.</span><span class="sxs-lookup"><span data-stu-id="cfb08-181">The following table lists the events that the Telemetry Log tracks for Office Add-ins in general.</span></span>

|<span data-ttu-id="cfb08-182">**Код события**</span><span class="sxs-lookup"><span data-stu-id="cfb08-182">**Event ID**</span></span>|<span data-ttu-id="cfb08-183">**Название**</span><span class="sxs-lookup"><span data-stu-id="cfb08-183">**Title**</span></span>|<span data-ttu-id="cfb08-184">**Серьезность**</span><span class="sxs-lookup"><span data-stu-id="cfb08-184">**Severity**</span></span>|<span data-ttu-id="cfb08-185">**Описание**</span><span class="sxs-lookup"><span data-stu-id="cfb08-185">**Description**</span></span>|
|:-----|:-----|:-----|:-----|
|<span data-ttu-id="cfb08-186">7 </span><span class="sxs-lookup"><span data-stu-id="cfb08-186">7</span></span>|<span data-ttu-id="cfb08-187">Манифест надстройки загружен успешно</span><span class="sxs-lookup"><span data-stu-id="cfb08-187">Add-in manifest downloaded successfully</span></span>||<span data-ttu-id="cfb08-188">Манифест надстройки Office был успешно загружен и прочитан приложением Office.</span><span class="sxs-lookup"><span data-stu-id="cfb08-188">The manifest of the Office Add-in was successfully loaded and read by the Office application.</span></span>|
|<span data-ttu-id="cfb08-189">8 </span><span class="sxs-lookup"><span data-stu-id="cfb08-189">8</span></span>|<span data-ttu-id="cfb08-190">Манифест надстройки не загружен</span><span class="sxs-lookup"><span data-stu-id="cfb08-190">Add-in manifest did not download</span></span>|<span data-ttu-id="cfb08-191">Критический</span><span class="sxs-lookup"><span data-stu-id="cfb08-191">Critical</span></span>|<span data-ttu-id="cfb08-192">Приложению Office не удалось загрузить файл манифеста для надстройки Office из каталога SharePoint, корпоративного каталога или AppSource.</span><span class="sxs-lookup"><span data-stu-id="cfb08-192">The Office application was unable to load the manifest file for the Office Add-in from the SharePoint catalog, corporate catalog, or AppSource.</span></span>|
|<span data-ttu-id="cfb08-193">9 </span><span class="sxs-lookup"><span data-stu-id="cfb08-193">9</span></span>|<span data-ttu-id="cfb08-194">Не удается выполнить анализ разметки надстройки</span><span class="sxs-lookup"><span data-stu-id="cfb08-194">Add-in markup could not be parsed</span></span>|<span data-ttu-id="cfb08-195">Критическая</span><span class="sxs-lookup"><span data-stu-id="cfb08-195">Critical</span></span>|<span data-ttu-id="cfb08-196">Приложение Office загрузило манифест надстройка Office, но ему не удалось прочитать разметку HTML приложения.</span><span class="sxs-lookup"><span data-stu-id="cfb08-196">The Office application loaded the Office Add-in manifest, but could not read the HTML markup of the app.</span></span>|
|<span data-ttu-id="cfb08-197">10 </span><span class="sxs-lookup"><span data-stu-id="cfb08-197">10</span></span>|<span data-ttu-id="cfb08-198">Надстройка использует слишком много ресурсов ЦП</span><span class="sxs-lookup"><span data-stu-id="cfb08-198">Add-in used too much CPU</span></span>|<span data-ttu-id="cfb08-199">Критическая</span><span class="sxs-lookup"><span data-stu-id="cfb08-199">Critical</span></span>|<span data-ttu-id="cfb08-200">Приложение Надстройка Office использовало более 90 % ресурсов ЦП за конечный промежуток времени.</span><span class="sxs-lookup"><span data-stu-id="cfb08-200">The Office Add-in used more than 90% of the CPU resources over a finite period of time.</span></span>|
|<span data-ttu-id="cfb08-201">15 </span><span class="sxs-lookup"><span data-stu-id="cfb08-201">15</span></span>|<span data-ttu-id="cfb08-202">Тайм-аут поиска строки привел к отключению надстройки</span><span class="sxs-lookup"><span data-stu-id="cfb08-202">Add-in disabled due to string search time-out</span></span>||<span data-ttu-id="cfb08-p116">Надстройки Outlook выполняют поиск строки темы и основной части электронного сообщения, чтобы определить, требуется ли их отображать с использованием регулярного выражения. Клиент Outlook отключил надстройку Outlook, указанную в столбце **Файл**, из-за многократного превышения времени ожидания при попытке сопоставления регулярного выражения.</span><span class="sxs-lookup"><span data-stu-id="cfb08-p116">Outlook add-ins search the subject line and message of an e-mail to determine whether they should be displayed by using a regular expression. The Outlook add-in listed in the **File** column was disabled by Outlook because it timed out repeatedly while trying to match a regular expression.</span></span>|
|<span data-ttu-id="cfb08-205">18 </span><span class="sxs-lookup"><span data-stu-id="cfb08-205">18</span></span>|<span data-ttu-id="cfb08-206">Надстройка успешно закрыта</span><span class="sxs-lookup"><span data-stu-id="cfb08-206">Add-in closed successfully</span></span>||<span data-ttu-id="cfb08-207">Приложению Office удалось успешно закрыть надстройку Office.</span><span class="sxs-lookup"><span data-stu-id="cfb08-207">The Office application was able to close the Office Add-in successfully.</span></span>|
|<span data-ttu-id="cfb08-208">19</span><span class="sxs-lookup"><span data-stu-id="cfb08-208">19</span></span>|<span data-ttu-id="cfb08-209">Надстройка обнаружила ошибку времени выполнения</span><span class="sxs-lookup"><span data-stu-id="cfb08-209">Add-in encountered runtime error</span></span>|<span data-ttu-id="cfb08-210">Критический</span><span class="sxs-lookup"><span data-stu-id="cfb08-210">Critical</span></span>|<span data-ttu-id="cfb08-211">Приложение Надстройка Office столкнулось с проблемой и завершилось со сбоем.</span><span class="sxs-lookup"><span data-stu-id="cfb08-211">The Office Add-in had a problem that caused it to fail.</span></span> <span data-ttu-id="cfb08-212">Для получения дополнительных сведений просмотрите **журнал оповещений Microsoft Office** с помощью средства просмотра событий Windows на том компьютере, где возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="cfb08-212">For more details, look at the **Microsoft Office Alerts** log using the Windows Event Viewer on the computer that encountered the error.</span></span>|
|<span data-ttu-id="cfb08-213">двадцать</span><span class="sxs-lookup"><span data-stu-id="cfb08-213">20</span></span>|<span data-ttu-id="cfb08-214">Сбой надстройки при проверке лицензирования</span><span class="sxs-lookup"><span data-stu-id="cfb08-214">Add-in failed to verify licensing</span></span>|<span data-ttu-id="cfb08-215">Критический</span><span class="sxs-lookup"><span data-stu-id="cfb08-215">Critical</span></span>|<span data-ttu-id="cfb08-216">Не удалось проверить сведения о лицензировании для приложения Надстройка Office, возможно, срок их действия истек.</span><span class="sxs-lookup"><span data-stu-id="cfb08-216">The licensing information for the Office Add-in could not be verified and may have expired.</span></span> <span data-ttu-id="cfb08-217">Для получения дополнительных сведений просмотрите **журнал оповещений Microsoft Office** с помощью средства просмотра событий Windows на том компьютере, где возникла ошибка.</span><span class="sxs-lookup"><span data-stu-id="cfb08-217">For more details, look at the **Microsoft Office Alerts** log using the Windows Event Viewer on the computer that encountered the error.</span></span>|

<span data-ttu-id="cfb08-218">Дополнительные сведения см. в разделах [Развертывание панели мониторинга телеметрии](/previous-versions/office/office-2013-resource-kit/jj219431(v=office.15)) и [Устранение неполадок с файлами Office и пользовательскими решениями с помощью журнала телеметрии](/office/client-developer/shared/troubleshooting-office-files-and-custom-solutions-with-the-telemetry-log)</span><span class="sxs-lookup"><span data-stu-id="cfb08-218">For more information, see [Deploying Telemetry Dashboard](/previous-versions/office/office-2013-resource-kit/jj219431(v=office.15)) and [Troubleshooting Office files and custom solutions with the telemetry log](/office/client-developer/shared/troubleshooting-office-files-and-custom-solutions-with-the-telemetry-log).</span></span>

## <a name="design-and-implementation-techniques"></a><span data-ttu-id="cfb08-219">Методы проектирования и реализации</span><span class="sxs-lookup"><span data-stu-id="cfb08-219">Design and implementation techniques</span></span>

<span data-ttu-id="cfb08-220">Хотя ресурсные ограничения на использование ЦП и памяти, число сбоев и время ответа пользовательского интерфейса применяются только к Надстройки Office, работающим только на клиентах с расширенными возможностями, оптимизация использования этих ресурсов и батареи должна быть приоритетной задачей, если требуется удовлетворительная работа надстройки на всех поддерживаемых клиентах и устройствах.</span><span class="sxs-lookup"><span data-stu-id="cfb08-220">While the resources limits on CPU and memory usage, crash tolerance, UI responsiveness apply to Office Add-ins running only on the rich clients, optimizing the usage of these resources and battery should be a priority if you want your add-in to perform satisfactorily on all supporting clients and devices.</span></span> <span data-ttu-id="cfb08-221">Оптимизация особенно важна, если надстройка выполняет длительные операции или обрабатывает большие наборы данных.</span><span class="sxs-lookup"><span data-stu-id="cfb08-221">Optimization is particularly important if your add-in carries out long-running operations or handles large data sets.</span></span> <span data-ttu-id="cfb08-222">В приведенном ниже списке предлагаются некоторые способы переноса ресурсоемких и ресурсоемких операций в небольшие блоки, чтобы надстройка могла избежать чрезмерного потребления ресурсов, а приложение Office может оставаться недостаточным.</span><span class="sxs-lookup"><span data-stu-id="cfb08-222">The following list suggests some techniques to break up CPU-intensive or data-intensive operations into smaller chunks so that your add-in can avoid excessive resource consumption and the Office application can remain responsive:</span></span>

- <span data-ttu-id="cfb08-223">В сценарии, где надстройке требуется читать большой объем из неограниченного набора данных, можно применить разбиение на страницы во время чтения данных из таблицы или уменьшить размер данных в каждой небольшой операции чтения вместо попыток выполнить чтение за одну операцию.</span><span class="sxs-lookup"><span data-stu-id="cfb08-223">In a scenario where your add-in needs to read a large volume of data from an unbounded dataset, you can apply paging when reading the data from a table, or reduce the size of data in each shorter read operation, rather than attempting to complete the read in one single operation.</span></span> <span data-ttu-id="cfb08-224">Это можно сделать с помощью метода [сеттимеаут](https://developer.mozilla.org/docs/Web/API/WindowOrWorkerGlobalScope/setTimeout) глобального объекта, чтобы ограничить продолжительность ввода и вывода.</span><span class="sxs-lookup"><span data-stu-id="cfb08-224">You can do this through the [setTimeout](https://developer.mozilla.org/docs/Web/API/WindowOrWorkerGlobalScope/setTimeout) method of the global object to limit the duration of input and output.</span></span> <span data-ttu-id="cfb08-225">It also handles the data in defined chunks instead of randomly unbounded data.</span><span class="sxs-lookup"><span data-stu-id="cfb08-225">It also handles the data in defined chunks instead of randomly unbounded data.</span></span> <span data-ttu-id="cfb08-226">Кроме того, можно использовать [Async](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Statements/async_function) для решения ваших обещаний.</span><span class="sxs-lookup"><span data-stu-id="cfb08-226">Another option is to use [async](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Statements/async_function) to handle your Promises.</span></span>

- <span data-ttu-id="cfb08-p121">Если надстройка использует требовательный к ресурсам ЦП алгоритм для обработки большого объема данных, вы можете использовать рабочие веб-процессы для выполнения длительной задачи в фоновом режиме и при этом на переднем плане выполнять отдельный скрипт, например, для отображения хода выполнения в пользовательском интерфейсе. Рабочие веб-процессы не блокируют действия пользователя и позволяют HTML-странице отвечать на запросы. Пример рабочих веб-процессов приводится в статье [Основные сведения о рабочих веб-процессах](https://www.html5rocks.com/tutorials/workers/basics/). Дополнительные сведения об API рабочих веб-процессов см. в статье [Рабочие веб-процессы](https://developer.mozilla.org/docs/Web/API/Web_Workers_API).</span><span class="sxs-lookup"><span data-stu-id="cfb08-p121">If your add-in uses a CPU-intensive algorithm to process a large volume of data, you can use web workers to perform the long-running task in the background while running a separate script in the foreground, such as displaying progress in the user interface. Web workers do not block user activities and allow the HTML page to remain responsive. For an example of web workers, see [The Basics of Web Workers](https://www.html5rocks.com/tutorials/workers/basics/). See [Web Workers](https://developer.mozilla.org/docs/Web/API/Web_Workers_API) for more information about the Web Workers API.</span></span>

- <span data-ttu-id="cfb08-231">Если надстройка использует требовательный к ресурсам ЦП алгоритм, но вы можете разделить входные или выходные данные на небольшие наборы, рассмотрите возможность создать веб-службу и передать туда данные, чтобы разгрузить ЦП, и подождите асинхронный обратный вызов.</span><span class="sxs-lookup"><span data-stu-id="cfb08-231">If your add-in uses a CPU-intensive algorithm but you can divide the data input or output into smaller sets, consider creating a web service, passing the data to the web service to off-load the CPU, and wait for an asynchronous callback.</span></span>

- <span data-ttu-id="cfb08-232">Протестируйте надстройку с самым большим ожидаемым объемом данных и запретите обработку большего объема.</span><span class="sxs-lookup"><span data-stu-id="cfb08-232">Test your add-in against the highest volume of data you expect, and restrict your add-in to process up to that limit.</span></span>

### <a name="performance-improvements-with-the-application-specific-apis"></a><span data-ttu-id="cfb08-233">Улучшения производительности при использовании API для конкретных приложений</span><span class="sxs-lookup"><span data-stu-id="cfb08-233">Performance improvements with the application-specific APIs</span></span>

<span data-ttu-id="cfb08-234">Советы по повышению производительности при [использовании модели API](../develop/application-specific-api-model.md) , зависящей от приложения, предоставляют рекомендации по использованию API для приложений для Excel, OneNote, Visio и Word.</span><span class="sxs-lookup"><span data-stu-id="cfb08-234">The performance tips in [Using the application-specific API model](../develop/application-specific-api-model.md) provide guidance when using the application-specific APIs for Excel, OneNote, Visio, and Word.</span></span> <span data-ttu-id="cfb08-235">В сводке необходимо:</span><span class="sxs-lookup"><span data-stu-id="cfb08-235">In summary, you should:</span></span>

- <span data-ttu-id="cfb08-236">[Загружайте только необходимые свойства](../develop/application-specific-api-model.md#calling-load-without-parameters-not-recommended).</span><span class="sxs-lookup"><span data-stu-id="cfb08-236">[Only load necessary properties](../develop/application-specific-api-model.md#calling-load-without-parameters-not-recommended).</span></span>
- <span data-ttu-id="cfb08-237">[Минимизируйте число вызовов Sync ()](../develop/application-specific-api-model.md#performance-tip-minimize-the-number-of-sync-calls).</span><span class="sxs-lookup"><span data-stu-id="cfb08-237">[Minimize the number of sync() calls](../develop/application-specific-api-model.md#performance-tip-minimize-the-number-of-sync-calls).</span></span> <span data-ttu-id="cfb08-238">Прочтите статью [Избегайте использования метода Context. Sync в циклах](correlated-objects-pattern.md) для получения дополнительных сведений об управлении `sync` вызовами в вашем коде.</span><span class="sxs-lookup"><span data-stu-id="cfb08-238">Read [Avoid using the context.sync method in loops](correlated-objects-pattern.md) for further information on how to manage `sync` calls in your code.</span></span>
- <span data-ttu-id="cfb08-239">[Минимизируйте количество созданных прокси-объектов](../develop/application-specific-api-model.md#performance-tip-minimize-the-number-of-proxy-objects-created).</span><span class="sxs-lookup"><span data-stu-id="cfb08-239">[Minimize the number of proxy objects created](../develop/application-specific-api-model.md#performance-tip-minimize-the-number-of-proxy-objects-created).</span></span> <span data-ttu-id="cfb08-240">Кроме того, вы можете отследить прокси-объекты, как описано в следующем разделе.</span><span class="sxs-lookup"><span data-stu-id="cfb08-240">You can also untrack proxy objects, as described in the next section.</span></span>

#### <a name="untrack-unneeded-proxy-objects"></a><span data-ttu-id="cfb08-241">Отследить ненужные прокси-объекты</span><span class="sxs-lookup"><span data-stu-id="cfb08-241">Untrack unneeded proxy objects</span></span>

<span data-ttu-id="cfb08-242">[Прокси-объекты](../develop/application-specific-api-model.md#proxy-objects) хранятся в памяти до тех пор `RequestContext.sync()` , пока не будет вызван.</span><span class="sxs-lookup"><span data-stu-id="cfb08-242">[Proxy objects](../develop/application-specific-api-model.md#proxy-objects) persist in memory until `RequestContext.sync()` is called.</span></span> <span data-ttu-id="cfb08-243">Операции с большими пакетами могут создавать много прокси-объектов, необходимых надстройке лишь один раз, которые можно удалить из памяти до выполнения пакетных действий.</span><span class="sxs-lookup"><span data-stu-id="cfb08-243">Large batch operations may generate a lot of proxy objects that are only needed once by the add-in and can be released from memory before the batch executes.</span></span>

<span data-ttu-id="cfb08-244">`untrack()`Метод освобождает объект из памяти.</span><span class="sxs-lookup"><span data-stu-id="cfb08-244">The `untrack()` method releases the object from memory.</span></span> <span data-ttu-id="cfb08-245">Этот метод реализован на множестве прокси-объектов API, характерных для приложений.</span><span class="sxs-lookup"><span data-stu-id="cfb08-245">This method is implemented on many application-specific API proxy objects.</span></span> <span data-ttu-id="cfb08-246">Вызов `untrack()` после выполнения надстройки объект должен получить заметное преимущество в производительности при использовании большого числа прокси-объектов.</span><span class="sxs-lookup"><span data-stu-id="cfb08-246">Calling `untrack()` after your add-in is done with the object should yield a noticeable performance benefit when using large numbers of proxy objects.</span></span>

> [!NOTE]
> <span data-ttu-id="cfb08-247">`Range.untrack()` — это ярлык для [ClientRequestContext.trackedObjects.remove(thisRange)](/javascript/api/office/officeextension.trackedobjects#remove-object-).</span><span class="sxs-lookup"><span data-stu-id="cfb08-247">`Range.untrack()` is a shortcut for [ClientRequestContext.trackedObjects.remove(thisRange)](/javascript/api/office/officeextension.trackedobjects#remove-object-).</span></span> <span data-ttu-id="cfb08-248">Отслеживание любого прокси-объекта можно прекратить, удалив его из списка отслеживаемых объектов в контексте.</span><span class="sxs-lookup"><span data-stu-id="cfb08-248">Any proxy object can be untracked by removing it from the tracked objects list in the context.</span></span>

<span data-ttu-id="cfb08-249">В приведенном ниже примере кода Excel выделенный диапазон заполняется данными по одной ячейке за раз.</span><span class="sxs-lookup"><span data-stu-id="cfb08-249">The following Excel code sample fills a selected range with data, one cell at a time.</span></span> <span data-ttu-id="cfb08-250">После добавления значения в ячейку, диапазон отображает, что отслеживание ячейки прекращено.</span><span class="sxs-lookup"><span data-stu-id="cfb08-250">After the value is added to the cell, the range representing that cell is untracked.</span></span> <span data-ttu-id="cfb08-251">Выполните этот код с выбранным диапазоном от 10 000 до 20 000 ячеек сначала со строкой `cell.untrack()`, а затем без нее.</span><span class="sxs-lookup"><span data-stu-id="cfb08-251">Run this code with a selected range of 10,000 to 20,000 cells, first with the `cell.untrack()` line, and then without it.</span></span> <span data-ttu-id="cfb08-252">Вы должны заметить, что код выполняется с использованием строки `cell.untrack()` быстрее, чем без нее.</span><span class="sxs-lookup"><span data-stu-id="cfb08-252">You should notice the code runs faster with the `cell.untrack()` line than without it.</span></span> <span data-ttu-id="cfb08-253">Вы также можете заметить уменьшение времени отклика впоследствии, так как этап очистки занимает меньше времени.</span><span class="sxs-lookup"><span data-stu-id="cfb08-253">You may also notice a quicker response time afterwards, since the cleanup step takes less time.</span></span>

```js
Excel.run(async (context) => {
    var largeRange = context.workbook.getSelectedRange();
    largeRange.load(["rowCount", "columnCount"]);
    await context.sync();

    for (var i = 0; i < largeRange.rowCount; i++) {
        for (var j = 0; j < largeRange.columnCount; j++) {
            var cell = largeRange.getCell(i, j);
            cell.values = [[i *j]];

            // Call untrack() to release the range from memory.
            cell.untrack();
        }
    }

    await context.sync();
});
```

<span data-ttu-id="cfb08-254">Обратите внимание, что необходимость в отслеживании объектов становится важной только при работе с тысячами.</span><span class="sxs-lookup"><span data-stu-id="cfb08-254">Note that needing to untrack objects only becomes important when you're dealing with thousands of them.</span></span> <span data-ttu-id="cfb08-255">Большинству надстроек не требуется управлять отслеживанием объектов прокси-сервера.</span><span class="sxs-lookup"><span data-stu-id="cfb08-255">Most add-ins will not need to manage proxy object tracking.</span></span>

## <a name="see-also"></a><span data-ttu-id="cfb08-256">См. также</span><span class="sxs-lookup"><span data-stu-id="cfb08-256">See also</span></span>

- [<span data-ttu-id="cfb08-257">Конфиденциальность и безопасность надстроек Office</span><span class="sxs-lookup"><span data-stu-id="cfb08-257">Privacy and security for Office Add-ins</span></span>](../concepts/privacy-and-security.md)
- [<span data-ttu-id="cfb08-258">Ограничения активации и API JavaScript для надстроек Outlook</span><span class="sxs-lookup"><span data-stu-id="cfb08-258">Limits for activation and JavaScript API for Outlook add-ins</span></span>](../outlook/limits-for-activation-and-javascript-api-for-outlook-add-ins.md)
- [<span data-ttu-id="cfb08-259">Оптимизация производительности с использованием API JavaScript для Excel</span><span class="sxs-lookup"><span data-stu-id="cfb08-259">Performance optimization using the Excel JavaScript API</span></span>](../excel/performance.md)
