---
title: Конфиденциальность и безопасность надстроек Office
description: ''
ms.date: 09/26/2019
localization_priority: Normal
ms.openlocfilehash: c4f2ea5413ff1fa404c242bc729c59f9feedaca3
ms.sourcegitcommit: d15bca2c12732f8599be2ec4b2adc7c254552f52
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/12/2020
ms.locfileid: "41949719"
---
# <a name="privacy-and-security-for-office-add-ins"></a><span data-ttu-id="dcd6a-102">Конфиденциальность и безопасность надстроек Office</span><span class="sxs-lookup"><span data-stu-id="dcd6a-102">Privacy and security for Office Add-ins</span></span>

## <a name="understanding-the-add-in-runtime"></a><span data-ttu-id="dcd6a-103">Общие сведения о среде выполнения надстроек</span><span class="sxs-lookup"><span data-stu-id="dcd6a-103">Understanding the add-in runtime</span></span>

<span data-ttu-id="dcd6a-p101">Надстройки Office защищены средой выполнения надстроек (многоуровневой моделью разрешений) и регуляторами производительности. Эта инфраструктура защищает пользовательский интерфейс указанными ниже способами.</span><span class="sxs-lookup"><span data-stu-id="dcd6a-p101">Office Add-ins are secured by an add-in runtime environment, a multiple-tier permissions model, and performance governors. This framework protects the user's experience in the following ways:</span></span> 

- <span data-ttu-id="dcd6a-106">Доступ к области пользовательского интерфейса ведущего приложения является управляемым.</span><span class="sxs-lookup"><span data-stu-id="dcd6a-106">Access to the host application's UI frame is managed.</span></span>

- <span data-ttu-id="dcd6a-107">Разрешен только косвенный доступ к потоку пользовательского интерфейса ведущего приложения.</span><span class="sxs-lookup"><span data-stu-id="dcd6a-107">Only indirect access to the host application's UI thread is allowed.</span></span>

- <span data-ttu-id="dcd6a-108">Модальные взаимодействия запрещены. Например, вызовы функций JavaScript **alert**, **confirm** и **prompt** не разрешены, так как они являются модальными.</span><span class="sxs-lookup"><span data-stu-id="dcd6a-108">Modal interactions aren't allowed - for example, calls to JavaScript  **alert**, **confirm**, and **prompt** functions aren't allowed because they're modal.</span></span>

<span data-ttu-id="dcd6a-109">Кроме того, инфраструктура среды выполнения предоставляет следующие возможности, благодаря которым надстройка Office не сможет повредить среду пользователя:</span><span class="sxs-lookup"><span data-stu-id="dcd6a-109">Further, the runtime framework provides the following benefits to ensure that an Office Add-in can't damage the user's environment:</span></span>

- <span data-ttu-id="dcd6a-110">изолирует процесс, в котором работает надстройка;</span><span class="sxs-lookup"><span data-stu-id="dcd6a-110">Isolates the process the add-in runs in.</span></span>

- <span data-ttu-id="dcd6a-111">не требует замены DLL- или EXE-файлов, а также компонентов ActiveX;</span><span class="sxs-lookup"><span data-stu-id="dcd6a-111">Doesn't require .dll or .exe replacement or ActiveX components.</span></span>

- <span data-ttu-id="dcd6a-112">упрощает установку и удаление надстроек.</span><span class="sxs-lookup"><span data-stu-id="dcd6a-112">Makes add-ins easy to install and uninstall.</span></span>

<span data-ttu-id="dcd6a-113">Кроме того, вы можете управлять тем, как надстройки Office используют память, ЦП и сетевые ресурсы. Это позволяет поддерживать надлежащую производительность и надежность.</span><span class="sxs-lookup"><span data-stu-id="dcd6a-113">Also, the use of memory, CPU, and network resources by Office Add-ins is governable to ensure that good performance and reliability are maintained.</span></span>

<span data-ttu-id="dcd6a-114">В следующих разделах вкратце описывается поддержка архитектурой среды выполнения надстроек, работающих в клиентах Office на устройствах под управлением Windows, устройствах Mac с OS X и в веб-браузерах.</span><span class="sxs-lookup"><span data-stu-id="dcd6a-114">The following sections briefly describe how the runtime architecture supports running add-ins in Office clients on Windows-based devices, on OS X Mac devices, and in web browsers.</span></span>

### <a name="clients-on-windows-and-os-x-devices"></a><span data-ttu-id="dcd6a-115">Клиенты на устройствах с Windows и OS X</span><span class="sxs-lookup"><span data-stu-id="dcd6a-115">Clients on Windows and OS X devices</span></span>

<span data-ttu-id="dcd6a-p102">В поддерживаемых клиентах для настольных компьютеров и планшетов, например в Excel для Windows и Outlook для Windows и Mac, надстройки Office поддерживаются путем интеграции внутрипроцессного компонента — среды выполнения надстроек Office, которая управляет жизненным циклом надстройки и позволяет ей взаимодействовать с клиентским приложением. Сама веб-страница надстройки размещена вне процесса. Как показано на рис. 1, на настольном компьютере или планшете с ОС Windows [веб-страница надстройки размещена внутри элемента управления Internet Explorer](browsers-used-by-office-web-add-ins.md), который, в свою очередь, размещен внутри процесса среды выполнения надстройки, обеспечивающего безопасность и изоляцию работы.</span><span class="sxs-lookup"><span data-stu-id="dcd6a-p102">In supported clients for desktop and tablet devices, such as Excel on Windows, and Outlook on Windows and Mac, Office Add-ins are supported by integrating an in-process component, the Office Add-ins runtime, which manages the add-in lifecycle and enables interoperability between the add-in and the client application. The add-in webpage itself is hosted out-of-process. As shown in figure 1, on a Windows desktop or tablet device, [the add-in webpage is hosted inside an Internet Explorer or Microsoft Edge control](browsers-used-by-office-web-add-ins.md) which, in turn, is hosted inside an add-in runtime process that provides security and performance isolation.</span></span>

<span data-ttu-id="dcd6a-p103">На компьютерах с Windows в Internet Explorer для зоны "Опасные сайты" должен быть включен защищенный режим. Обычно этот режим включен по умолчанию. Если он отключен, при запуске надстройки [возникнет ошибка](https://support.microsoft.com/help/2761180/apps-for-office-don-t-start-if-you-disable-protected-mode-for-the-restricted-sites-zone-in-internet-explorer).</span><span class="sxs-lookup"><span data-stu-id="dcd6a-p103">On Windows desktops, Protected Mode in Internet Explorer must be enabled for the Restricted Site Zone. This is typically enabled by default. If it is disabled, an [error will occur](https://support.microsoft.com/help/2761180/apps-for-office-don-t-start-if-you-disable-protected-mode-for-the-restricted-sites-zone-in-internet-explorer) when you try to launch an add-in.</span></span>

<span data-ttu-id="dcd6a-122">*Рис. 1. Среда выполнения надстроек для Office в клиентах для настольных компьютеров и планшетов под управлением ОС Windows*</span><span class="sxs-lookup"><span data-stu-id="dcd6a-122">*Figure 1. Office Add-ins runtime environment in Windows-based desktop and tablet clients*</span></span>

![Инфраструктура с расширенными возможностями клиента](../images/dk2-agave-overview-02.png)

<span data-ttu-id="dcd6a-124">Как показано на приведенном ниже рисунке, на настольном компьютере Mac под управлением OS X веб-страница надстройки размещается в изолированном хост-процессе среды выполнения WebKit, что обеспечивает аналогичный уровень безопасности и защиты производительности.</span><span class="sxs-lookup"><span data-stu-id="dcd6a-124">As shown in the following figure, on an OS X Mac desktop, the add-in web page is hosted inside a sandboxed WebKit runtime host process which helps provide similar level of security and performance protection.</span></span> 

<span data-ttu-id="dcd6a-125">*Рис. 2. Среда выполнения надстроек Office в клиентах для Mac под управлением OS X*</span><span class="sxs-lookup"><span data-stu-id="dcd6a-125">*Figure 2. Office Add-ins runtime environment in OS X Mac clients*</span></span>

![Среда выполнения приложений для Office на компьютере Mac под управлением OS X](../images/dk2-agave-overview-mac-02.png)

<span data-ttu-id="dcd6a-127">Среда выполнения надстроек Office управляет взаимодействием процессов, преобразованием вызовов и событий API JavaScript в собственные вызовы и события, а также обеспечивает удаленную поддержку пользовательского интерфейса для отображения надстройки внутри документа, в области задач или рядом с электронным письмом, приглашением на собрание или встречей.</span><span class="sxs-lookup"><span data-stu-id="dcd6a-127">The Office Add-ins runtime manages interprocess communication, the translation of JavaScript API calls and events into native ones, as well as UI remoting support to enable the add-in to be rendered inside the document, in a task pane, or adjacent to an email message, meeting request, or appointment.</span></span>

### <a name="web-clients"></a><span data-ttu-id="dcd6a-128">Веб-клиенты</span><span class="sxs-lookup"><span data-stu-id="dcd6a-128">Web clients</span></span>

<span data-ttu-id="dcd6a-p104">В поддерживаемых веб-клиентах надстройки Office размещаются в объекте **iframe**, который запускается с использованием **изолированного** атрибута HTML5. Компоненты ActiveX и навигация по главной странице веб-клиента запрещены. Поддержка надстроек Office в веб-клиентах возможна благодаря интеграции API JavaScript для Office. API JavaScript управляет жизненным циклом надстройки и взаимодействием между надстройкой и веб-клиентом аналогично клиентским приложениям на компьютерах. Это взаимодействие реализуется с помощью специальной инфраструктуры отправки сообщений между фреймами. Для взаимодействия с веб-клиентом доступна та же библиотека JavaScript (Office.js), которая используется на клиентах на компьютерах. На следующем рисунке показана инфраструктура, которая поддерживает надстройки в Office, работающем в браузере, и соответствующие компоненты (веб-клиент, **iframe**, среда выполнения надстроек Office и API JavaScript для Office), необходимые для их поддержки.</span><span class="sxs-lookup"><span data-stu-id="dcd6a-p104">In supported Web clients, Office Add-ins are hosted in an  **iframe** that runs using the HTML5 **sandbox** attribute. ActiveX components or navigating the main page of the web client are not allowed. Office Add-ins support is enabled in the web clients by the integration of the JavaScript API for Office. In a similar way to the desktop client applications, the JavaScript API manages the add-in lifecycle and interoperability between the add-in and the web client. This interoperability is implemented by using a special cross-frame post message communication infrastructure. The same JavaScript library (Office.js) that is used on desktop clients is available to interact with the web client. The following figure shows the infrastructure that supports add-ins in Office running in the browser, and the relevant components (the web client, **iframe**, Office Add-ins runtime, and JavaScript API for Office) that are required to support them.</span></span>

<span data-ttu-id="dcd6a-136">*Рис. 3. Инфраструктура, поддерживающая надстройки Office в веб-клиентах Office*</span><span class="sxs-lookup"><span data-stu-id="dcd6a-136">*Figure 3. Infrastructure that supports Office Add-ins in Office web clients*</span></span>

![Инфраструктура веб-клиента](../images/dk2-agave-overview-03.png)

## <a name="add-in-integrity-in-appsource"></a><span data-ttu-id="dcd6a-138">Целостность надстроек в AppSource</span><span class="sxs-lookup"><span data-stu-id="dcd6a-138">Add-in integrity in AppSource</span></span>

<span data-ttu-id="dcd6a-p105">Вы можете публиковать свои надстройки Office в AppSource. Для поддержания целостности надстроек в AppSource используются указанные ниже меры.</span><span class="sxs-lookup"><span data-stu-id="dcd6a-p105">You can make your Office Add-ins available to the public by publishing them to AppSource. AppSource enforces the following measures to maintain the integrity of add-ins:</span></span>


- <span data-ttu-id="dcd6a-141">При обмене данными хост-сервер надстройки Office всегда должен использовать SSL.</span><span class="sxs-lookup"><span data-stu-id="dcd6a-141">Requires the host server of an Office Add-in to always use Secure Sockets Layer (SSL) to communicate.</span></span>

- <span data-ttu-id="dcd6a-142">Разработчику требуется предоставить доказательство подлинности, контрактное соглашение и соответствующую требованиям политику конфиденциальности для отправки надстроек.</span><span class="sxs-lookup"><span data-stu-id="dcd6a-142">Requires a developer to provide proof of identity, a contractual agreement, and a compliant privacy policy to submit add-ins.</span></span>

- <span data-ttu-id="dcd6a-143">Убедитесь, что источник надстроек доступен только для чтения.</span><span class="sxs-lookup"><span data-stu-id="dcd6a-143">Ensures that the source of add-ins is accessible in read-only mode.</span></span>

- <span data-ttu-id="dcd6a-144">Поддерживается система рецензий пользователей для доступных надстроек, чтобы стимулировать формирование саморегулирующегося сообщества.</span><span class="sxs-lookup"><span data-stu-id="dcd6a-144">Supports a user-review system for available add-ins to promote a self-policing community.</span></span>

## <a name="addressing-end-users-privacy-concerns"></a><span data-ttu-id="dcd6a-145">Решение вопросов, связанных с конфиденциальностью пользователей</span><span class="sxs-lookup"><span data-stu-id="dcd6a-145">Addressing end users' privacy concerns</span></span>

<span data-ttu-id="dcd6a-146">В этом разделе описывается защита, обеспечиваемая платформой надстроек Office, с точки зрения клиента (конечного пользователя), а также приводятся рекомендации по безопасной работе с персональными данными пользователей.</span><span class="sxs-lookup"><span data-stu-id="dcd6a-146">This section describes the protection offered by the Office Add-ins platform from the customer's (end user's) perspective, and provides guidelines for how to support users' expectations and how to securely handle users' personally identifiable information (PII).</span></span>

### <a name="end-users-perspective"></a><span data-ttu-id="dcd6a-147">Точка зрения пользователей</span><span class="sxs-lookup"><span data-stu-id="dcd6a-147">End users' perspective</span></span>

<span data-ttu-id="dcd6a-p106">При создании надстроек Office используются веб-технологии, работающие в элементе управления браузера или **iframe**. Из-за этого процесс работы с надстройками похож на просмотр веб-сайтов в Интернете или в интрасети. По отношению к организации надстройки могут быть внешними (если вы приобрели надстройку в AppSource) или внутренними (если надстройка получена из каталога надстроек Exchange Server, каталога приложений SharePoint либо на файловом ресурсе в сети организации). Надстройкам предоставляется ограниченный доступ к сети и большинство из них могут считывать данные из активного документа или почтового элемента, а также записывать в них данные. До того как пользователь или администратор установит или запустит надстройку, платформа надстроек применяет определенные ограничения. Но, как и при использовании любой модели расширений, при запуске незнакомых надстроек пользователю следует предпринимать определенные меры предосторожности.</span><span class="sxs-lookup"><span data-stu-id="dcd6a-p106">Office Add-ins are built using web technologies that run in a browser control or **iframe**. Because of this, using add-ins is similar to browsing to web sites on the Internet or intranet. Add-ins can be external to an organization (if you acquire the add-in from AppSource) or internal (if you acquire the add-in from an Exchange Server add-in catalog, SharePoint app catalog, or file share on an organization's network). Add-ins have limited access to the network and most add-ins can read or write to the active document or mail item. The add-in platform applies certain constraints before a user or administrator installs or starts an add-in. But as with any extensibility model, users should be cautious before starting an unknown add-in.</span></span>

<span data-ttu-id="dcd6a-154">Платформа надстроек обеспечивает конфиденциальность пользователей указанными ниже способами.</span><span class="sxs-lookup"><span data-stu-id="dcd6a-154">The add-in platform addresses end users' privacy concerns in the following ways:</span></span>

- <span data-ttu-id="dcd6a-155">Данные, обмен которыми выполняет тот веб-сервер, на котором размещена контентная надстройка, надстройка Outlook или надстройка области задач, а также данные при взаимодействии между надстройкой и всеми веб-службами, которые она использует, всегда должны быть зашифрованы в соответствии с требованиями протокола SSL.</span><span class="sxs-lookup"><span data-stu-id="dcd6a-155">Data communicated with the web server that hosts a content, Outlook or task pane add-in as well as communication between the add-in and any web services it uses must be encrypted using the Secure Socket Layer (SSL) protocol.</span></span>

- <span data-ttu-id="dcd6a-p107">Перед установкой надстройки из AppSource пользователь может просмотреть политику конфиденциальности и требования, которые ее касаются. Кроме того, надстройки Outlook, взаимодействующие с почтовыми ящиками пользователей, указывают необходимые им разрешения. Таким образом, перед установкой надстройки Outlook пользователь может просмотреть условия использования, требуемые разрешения и политику конфиденциальности.</span><span class="sxs-lookup"><span data-stu-id="dcd6a-p107">Before a user installs an add-in from AppSource, the user can view the privacy policy and requirements of that add-in. In addition, Outlook add-ins that interact with users' mailboxes surface the specific permissions that they require; the user can review the terms of use, requested permissions and privacy policy before installing an Outlook add-in.</span></span>

- <span data-ttu-id="dcd6a-p108">При общем доступе к документу пользователи также совместно используют вставленные в него или связанные с ним надстройки. Если пользователь открывает документ с надстройкой, которая ранее не использовалась, ведущее приложение отображает запрос на предоставление надстройке разрешения на запуск в документе. В среде организации ведущее приложение Office также спрашивает пользователя о том, получен ли документ из внешнего источника.</span><span class="sxs-lookup"><span data-stu-id="dcd6a-p108">When sharing a document, users also share add-ins that have been inserted in or associated with that document. If a user opens a document that contains an add-in that the user hasn't used before, the host application prompts the user to grant permission for the add-in to run in the document. In an organizational environment, the Office host application also prompts the user if the document comes from an external source.</span></span>

- <span data-ttu-id="dcd6a-161">Пользователи могут включить или отключить доступ к AppSource.</span><span class="sxs-lookup"><span data-stu-id="dcd6a-161">Users can enable or disable the access to AppSource.</span></span> <span data-ttu-id="dcd6a-162">Чтобы управлять доступом к доверенным надстройкам (контентным и области задач) и каталогам, откройте **центр управления безопасностью** в ведущем приложении Office. Для этого выберите **Файл** > **Параметры** > **Центр управления безопасностью** > **Параметры центра управления безопасностью** > **Доверенные каталоги надстроек**.</span><span class="sxs-lookup"><span data-stu-id="dcd6a-162">For content and task pane add-ins, users manage access to trusted add-ins and catalogs from the  **Trust Center** on the host Office client (opened from **File** > **Options** > **Trust Center** > **Trust Center Settings** > **Trusted Add-in Catalogs**).</span></span> <span data-ttu-id="dcd6a-163">Чтобы управлять надстройками Outlook, выберите **Файл** > **Управление надстройками** в Outlook для Windows. В Outlook для Mac нажмите кнопку **Управление надстройками** на панели надстройки.</span><span class="sxs-lookup"><span data-stu-id="dcd6a-163">For Outlook add-ins, uses can manage add-ins by choosing the  **Manage Add-ins** button: in Outlook on Windows, choose **File** > **Manage Add-ins**. In Outlook on Mac, choose the  **Manage Add-ins** button on the add-in bar.</span></span> <span data-ttu-id="dcd6a-164">В Outlook в Интернете выберите меню **Параметры** (значок шестеренки) > **Управление надстройками**. Администраторы также могут управлять доступом [с помощью групповой политики](/previous-versions/office/office-2013-resource-kit/jj219429(v=office.15)#using-group-policy-to-manage-how-users-can-install-and-use-apps-for-office).</span><span class="sxs-lookup"><span data-stu-id="dcd6a-164">In Outlook on the web, choose the **Settings** menu (gear icon) > **Manage add-ins**. Administrators can also manage this access [by using group policy](/previous-versions/office/office-2013-resource-kit/jj219429(v=office.15)#using-group-policy-to-manage-how-users-can-install-and-use-apps-for-office).</span></span>

- <span data-ttu-id="dcd6a-165">Структура платформы надстроек обеспечивает безопасную и эффективную работу пользователей благодаря следующим возможностям:</span><span class="sxs-lookup"><span data-stu-id="dcd6a-165">The design of the add-in platform provides security and performance for end users in the following ways:</span></span>

  - <span data-ttu-id="dcd6a-p110">Надстройка Office запускается в элементе управления веб-браузера, размещаемом в среде выполнения надстроек, отделенной от ведущего приложения Office. Такая структура обеспечивает изоляцию от ведущего приложения как с точки зрения безопасности, так и c точки зрения производительности.</span><span class="sxs-lookup"><span data-stu-id="dcd6a-p110">An Office Add-in runs in a web browser control that is hosted in an add-in runtime environment separate from the Office host application. This design provides both security and performance isolation from the host application.</span></span>

  - <span data-ttu-id="dcd6a-168">Выполнение в элементе управления браузера позволяет надстройке совершать практически любые операции, доступные обычной странице в браузере, и в то же время принуждает ее соблюдать политику единого домена для обеспечения изоляции доменов и зон безопасности.</span><span class="sxs-lookup"><span data-stu-id="dcd6a-168">Running in a web browser control allows the add-in to do almost anything a regular web page running in a browser can do but, at the same time, restricts the add-in to observe the same-origin policy for domain isolation and security zones.</span></span>

<span data-ttu-id="dcd6a-p111">Надстройки Outlook позволяют использовать дополнительные функции обеспечения безопасности и производительности. Для этого отслеживается потребление определенных ресурсов надстройками Outlook. Дополнительные сведения см. в разделе [Конфиденциальность, разрешения и безопасность для надстроек Outlook](/outlook/add-ins/privacy-and-security).</span><span class="sxs-lookup"><span data-stu-id="dcd6a-p111">Outlook add-ins provide additional security and performance features through Outlook add-in specific resource usage monitoring. For more information, see [Privacy, permissions, and security for Outlook add-ins](/outlook/add-ins/privacy-and-security).</span></span>

### <a name="developer-guidelines-to-handle-pii"></a><span data-ttu-id="dcd6a-171">Рекомендации разработчикам по обработке персональных данных</span><span class="sxs-lookup"><span data-stu-id="dcd6a-171">Developer guidelines to handle PII</span></span>

<span data-ttu-id="dcd6a-172">Ниже приведено несколько особых рекомендаций по защите персональных данных при разработке надстроек Office.</span><span class="sxs-lookup"><span data-stu-id="dcd6a-172">The following lists some specific PII protection guidelines for you as a developer of Office Add-ins:</span></span>

- <span data-ttu-id="dcd6a-p112">Объект [Settings](/javascript/api/office/office.settings) предназначен для хранения данных о параметрах и состоянии контентных надстроек и надстроек области задач между сеансами. Не следует хранить в объекте **Settings** пароли и другие конфиденциальные личные сведения. Данные в объекте **Settings** невидимы для пользователей, но хранятся в документе в легкодоступном формате. Следует ограничить надстройке доступ к личным сведениям и хранить такие сведения, необходимые для работы надстройки, на сервере, на котором размещена надстройка, в виде защищенного от пользователей ресурса.</span><span class="sxs-lookup"><span data-stu-id="dcd6a-p112">The [Settings](/javascript/api/office/office.settings) object is intended for persisting add-in settings and state data across sessions for a content or task pane add-in, but don't store passwords and other sensitive PII in the **Settings** object. The data in the **Settings** object isn't visible to end users, but it is stored as part of the document's file format which is readily accessible. You should limit your add-in's use of PII and store any PII required by your add-in on the server hosting your add-in as a user-secured resource.</span></span>

- <span data-ttu-id="dcd6a-p113">При использовании некоторых надстроек могут быть раскрыты личные сведения. Поэтому необходимо хранить данные удостоверений, сведения о расположениях и времени доступа, а также прочие учетные данные пользователей в безопасном расположении, недоступном другим пользователям надстройки.</span><span class="sxs-lookup"><span data-stu-id="dcd6a-p113">Using some applications can reveal PII. Make sure that you securely store data for your users' identity, location, access times, and any other credentials so that data won't become available to other users of the add-in.</span></span>

- <span data-ttu-id="dcd6a-p114">Если надстройка доступна в AppSource, требование AppSource протокола HTTPS защищает личные сведения, передаваемые между веб-сервером и клиентским компьютером или устройством. Однако если вы передаете данные на другие серверы, убедитесь, что обеспечивается такой же уровень защиты.</span><span class="sxs-lookup"><span data-stu-id="dcd6a-p114">If your add-in is available in AppSource, the AppSource requirement for HTTPS protects PII transmitted between your web server and the client computer or device. However, if you re-transmit that data to other servers, make sure you observe the same level of protection.</span></span>

- <span data-ttu-id="dcd6a-p115">Если вы храните личные сведения пользователей, обязательно сообщите об этом и предоставьте пользователям возможность по своему выбору проверять и удалять их. Если надстройка отправляется в AppSource, можно указать собираемые данные и их использование в заявлении о конфиденциальности.</span><span class="sxs-lookup"><span data-stu-id="dcd6a-p115">If you store users' PII, make sure you reveal that fact, and provide a way for users to inspect and delete it. If you submit your add-in to AppSource, you can outline the data you collect and how it's used in the privacy statement.</span></span>

## <a name="developers-permission-choices-and-security-practices"></a><span data-ttu-id="dcd6a-182">Варианты реализации разрешений и методики обеспечения безопасности для разработчиков</span><span class="sxs-lookup"><span data-stu-id="dcd6a-182">Developers' permission choices and security practices</span></span>

<span data-ttu-id="dcd6a-183">Чтобы обеспечить поддержку модели безопасности, используемой в надстройках Office, и находить дополнительные сведения для каждого типа надстроек, следуйте приведенным ниже общим указаниям.</span><span class="sxs-lookup"><span data-stu-id="dcd6a-183">Follow these general guidelines to support the security model of Office Add-ins, and drill down on more details for each add-in type.</span></span>

### <a name="permissions-choices"></a><span data-ttu-id="dcd6a-184">Варианты разрешений</span><span class="sxs-lookup"><span data-stu-id="dcd6a-184">Permissions choices</span></span>

<span data-ttu-id="dcd6a-185">Платформа надстроек предоставляет модель разрешений, с помощью которой надстройка объявляет уровень доступа к данным пользователя, необходимый для выполнения ее функций.</span><span class="sxs-lookup"><span data-stu-id="dcd6a-185">The add-in platform provides a permissions model that your add-in uses to declare the level of access to a user's data that it requires for its features.</span></span> <span data-ttu-id="dcd6a-186">Каждый уровень разрешений соответствует подмножеству API JavaScript для Office, которое вашей надстройке разрешено использовать для выполнения своих функций.</span><span class="sxs-lookup"><span data-stu-id="dcd6a-186">Each permission level corresponds to the subset of the JavaScript API for Office your add-in is allowed to use for its features.</span></span> <span data-ttu-id="dcd6a-187">Например, разрешение **WriteDocument** для контентных надстроек и надстроек области задач предоставляет доступ к методу [Document.setSelectedDataAsync](/javascript/api/office/office.document), который позволяет надстройке записывать данные в документ пользователя, но не разрешает доступ к каким-либо методам для чтения данных из документа.</span><span class="sxs-lookup"><span data-stu-id="dcd6a-187">For example, the  **WriteDocument** permission for content and task pane add-ins allows access to the [Document.setSelectedDataAsync](/javascript/api/office/office.document) method that lets an add-in write to the user's document, but doesn't allow access to any of the methods for reading data from the document.</span></span> <span data-ttu-id="dcd6a-188">Такой уровень разрешений целесообразно использовать для надстроек, которым необходимо только записывать данные в документ, например для надстроек, в которых пользователь может запрашивать вставку данных в свой документ.</span><span class="sxs-lookup"><span data-stu-id="dcd6a-188">This permission level makes sense for add-ins that only need to write to a document, such as an add-in where the user can query for data to insert into their document.</span></span>

<span data-ttu-id="dcd6a-p117">Рекомендуется запрашивать разрешения по принципу _минимальной привилегии_. Другими словами, следует запрашивать разрешения для доступа только к минимальному подмножеству API, необходимому для правильной работы надстройки. Например, если надстройке требуется только считывать данные из документа пользователя, то максимальное разрешение, которое вам следует запросить, — **ReadDocument**. (Имейте в виду, что если запросить недостаточно разрешений, платформа надстроек запретит надстройке использовать некоторые API, что приведет к ошибке во время выполнения.)</span><span class="sxs-lookup"><span data-stu-id="dcd6a-p117">As a best practice, you should request permissions based on the principle of  _least privilege_. That is, you should request permission to access only the minimum subset of the API that your add-in requires to function correctly. For example, if your add-in needs only to read data in a user's document for its features, you should request no more than the **ReadDocument** permission. (But, keep in mind that requesting insufficient permissions will result in the add-in platform blocking your add-in's use of some APIs and will generate errors at run time.)</span></span>

<span data-ttu-id="dcd6a-p118">Вы можете указать требуемые разрешения в манифесте надстройки, как показано в примере ниже в этом разделе. Перед установкой или первой активацией надстройки пользователи смогут просмотреть сведения о запрашиваемом уровне разрешений. Кроме того, для установки надстроек Outlook, запрашивающих разрешение **ReadWriteMailbox**, требуются явные права администратора.</span><span class="sxs-lookup"><span data-stu-id="dcd6a-p118">You specify permissions in the manifest of your add-in, as shown in the example in this section below, and end users can see the requested permission level of an add-in before they decide to install or activate the add-in for the first time. Additionally, Outlook add-ins that request the  **ReadWriteMailbox** permission require explicit administrator privilege to install.</span></span>

<span data-ttu-id="dcd6a-p119">В примере ниже в манифесте надстройки области задач указано разрешение **ReadDocument**. Чтобы сконцентрировать внимание на разрешениях, другие элементы в манифесте не отображены.</span><span class="sxs-lookup"><span data-stu-id="dcd6a-p119">The following example shows how a task pane add-in specifies the  **ReadDocument** permission in its manifest. To keep permissions as the focus, other elements in the manifest aren't displayed.</span></span>

```xml
<?xml version="1.0" encoding="utf-8"?>
<OfficeApp xmlns="http://schemas.microsoft.com/office/appforoffice/1.0"
           xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
           xmlns:ver="http://schemas.microsoft.com/office/appforoffice/1.0"
           xsi:type="TaskPaneApp">

... <!-- To keep permissions as the focus, not displaying other elements. -->
  <Permissions>ReadDocument</Permissions>
...
</OfficeApp>
```

<span data-ttu-id="dcd6a-197">Дополнительные сведения о разрешениях для надстроек области задач и контентных надстроек см. в статье [Запрос разрешений на использование API в надстройках](/office/dev/add-ins/develop/requesting-permissions-for-api-use-in-content-and-task-pane-add-ins).</span><span class="sxs-lookup"><span data-stu-id="dcd6a-197">For more information about permissions for task pane and content add-ins, see [Requesting permissions for API use in add-ins](/office/dev/add-ins/develop/requesting-permissions-for-api-use-in-content-and-task-pane-add-ins).</span></span>

<span data-ttu-id="dcd6a-198">Дополнительные сведения о разрешениях для надстроек Outlook см. в следующих статьях:</span><span class="sxs-lookup"><span data-stu-id="dcd6a-198">For more information about permissions for Outlook add-ins, see the following topics:</span></span>

- [<span data-ttu-id="dcd6a-199">Конфиденциальность, разрешения и безопасность для надстроек Outlook</span><span class="sxs-lookup"><span data-stu-id="dcd6a-199">Privacy, permissions, and security for Outlook add-ins</span></span>](/outlook/add-ins/privacy-and-security)

- [<span data-ttu-id="dcd6a-200">Общие сведения о разрешениях для надстройки Outlook</span><span class="sxs-lookup"><span data-stu-id="dcd6a-200">Understanding Outlook add-in permissions</span></span>](/outlook/add-ins/understanding-outlook-add-in-permissions)

### <a name="same-origin-policy"></a><span data-ttu-id="dcd6a-201">Политика единого домена</span><span class="sxs-lookup"><span data-stu-id="dcd6a-201">Same origin policy</span></span>

<span data-ttu-id="dcd6a-202">Так как надстройки Office представляют собой веб-страницы, выполняемые в элементе управления веб-браузера, они должны соответствовать политике единого домена, применяемой браузером: по умолчанию веб-страница, расположенная в одном домене, не может выполнять запросы [XmlHttpRequest](https://www.w3.org/TR/XMLHttpRequest/) веб-службы к домену, отличному от домена, в котором она размещена.</span><span class="sxs-lookup"><span data-stu-id="dcd6a-202">Because Office Add-ins are webpages that run in a web browser control, they must follow the same-origin policy enforced by the browser: by default, a webpage in one domain can't make [XmlHttpRequest](https://www.w3.org/TR/XMLHttpRequest/) web service calls to another domain other than the one where it is hosted.</span></span>

<span data-ttu-id="dcd6a-p120">Один из способов обойти это ограничение — использовать JSON/P, то есть предоставить прокси-сервер веб-службе. Для этого необходимо включить тег **script** с атрибутом **src**, который указывает на какой-либо сценарий, размещенный в другом домене. Вы можете программно создавать теги **script**, динамически формируя URL-адрес, на который указывает атрибут **src**, и передавая параметры на URL-адрес через параметры запроса URI. Поставщики веб-служб создают и размещают код JavaScript по определенным URL-адресам и возвращают различные сценарии в зависимости от параметров запроса URI. После этого такие сценарии выполняются в месте их вставки и работают правильно.</span><span class="sxs-lookup"><span data-stu-id="dcd6a-p120">One way to overcome this limitation is to use JSON/P -- provide a proxy for the web service by including a  **script** tag with a **src** attribute that points to some script hosted on another domain. You can programmatically create the **script** tags, dynamically creating the URL to which to point the **src** attribute, and passing parameters to the URL via URI query parameters. Web service providers create and host JavaScript code at specific URLs, and return different scripts depending on the URI query parameters. These scripts then execute where they are inserted and work as expected.</span></span>

<span data-ttu-id="dcd6a-207">Ниже приведен пример JSON/P в образце надстройки Outlook.</span><span class="sxs-lookup"><span data-stu-id="dcd6a-207">The following is an example of JSON/P in the Outlook add-in example.</span></span> 

```js
// Dynamically create an HTML SCRIPT element that obtains the details for the specified video.
function loadVideoDetails(videoIndex) {
    // Dynamically create a new HTML SCRIPT element in the webpage.
    var script = document.createElement("script");
    // Specify the URL to retrieve the indicated video from a feed of a current list of videos,
    // as the value of the src attribute of the SCRIPT element. 
    script.setAttribute("src", "https://gdata.youtube.com/feeds/api/videos/" + 
        videos[videoIndex].Id + "?alt=json-in-script&amp;callback=videoDetailsLoaded");
    // Insert the SCRIPT element at the end of the HEAD section.
    document.getElementsByTagName('head')[0].appendChild(script);
}
```

<span data-ttu-id="dcd6a-p121">Exchange и SharePoint предоставляют прокси-серверы на стороне клиента, чтобы обеспечить междоменный доступ. В общем случае в интрасетях действуют более мягкие политики единого домена, чем в Интернете. Дополнительные сведения см. в статьях [Политика единого домена. Часть 1: без просмотра](/archive/blogs/ieinternals/same-origin-policy-part-1-no-peeking) и [Решение вопросов, которые связаны с ограничениями, накладываемыми политикой единого домена, в надстройках Office](../develop/addressing-same-origin-policy-limitations.md).</span><span class="sxs-lookup"><span data-stu-id="dcd6a-p121">Exchange and SharePoint provide client-side proxies to enable cross-domain access. In general, same origin policy on an intranet isn't as strict as on the Internet. For more information, see [Same Origin Policy Part 1: No Peeking](/archive/blogs/ieinternals/same-origin-policy-part-1-no-peeking) and [Addressing same-origin policy limitations in Office Add-ins](../develop/addressing-same-origin-policy-limitations.md).</span></span>

### <a name="tips-to-prevent-malicious-cross-site-scripting"></a><span data-ttu-id="dcd6a-211">Советы по предотвращению вредоносных межсайтовых сценариев</span><span class="sxs-lookup"><span data-stu-id="dcd6a-211">Tips to prevent malicious cross-site scripting</span></span>

<span data-ttu-id="dcd6a-212">Злонамеренный пользователь может атаковать базовую структуру надстройки, вводя вредоносный сценарий через документ или поля в надстройке.</span><span class="sxs-lookup"><span data-stu-id="dcd6a-212">An ill-intentioned user could attack the origin of an add-in by entering malicious script through the document or fields in the add-in.</span></span> <span data-ttu-id="dcd6a-213">Разработчик должен соответствующим образом обрабатывать вводимые пользователем данные, чтобы избежать выполнения кода JavaScript злоумышленника в его домене.</span><span class="sxs-lookup"><span data-stu-id="dcd6a-213">A developer should process user input to avoid executing a malicious user's JavaScript within their domain.</span></span> <span data-ttu-id="dcd6a-214">Ниже приводятся некоторые рекомендации по обработке вводимых пользователем данных из документа, сообщения или полей надстройки:</span><span class="sxs-lookup"><span data-stu-id="dcd6a-214">The following are some good practices to follow to handle user input from a document or mail message, or via fields in an add-in:</span></span>


- <span data-ttu-id="dcd6a-p123">Вместо свойства DOM [innerHTML](https://developer.mozilla.org/docs/Web/API/Element/innerHTML) используйте свойства [innerText](https://developer.mozilla.org/docs/Web/API/Node/innerText) и [textContent](https://developer.mozilla.org/docs/DOM/Node.textContent), где это возможно. Для обеспечения поддержки Internet Explorer и Firefox используйте указанную ниже строку кода:</span><span class="sxs-lookup"><span data-stu-id="dcd6a-p123">Instead of the DOM property [innerHTML](https://developer.mozilla.org/docs/Web/API/Element/innerHTML), use the [innerText](https://developer.mozilla.org/docs/Web/API/Node/innerText) and [textContent](https://developer.mozilla.org/docs/DOM/Node.textContent) properties where appropriate. Do the following for Internet Explorer and Firefox cross-browser support:</span></span>

    ```js
     var text = x.innerText || x.textContent
    ```

    <span data-ttu-id="dcd6a-p124">Дополнительные сведения о различиях между свойствами **innerText** и **textContent** см. в разделе [Node.textContent](https://developer.mozilla.org/docs/DOM/Node.textContent). Дополнительные сведения о совместимости DOM в распространенных браузерах см. в разделе [Совместимость DOM W3C: HTML](https://www.quirksmode.org/dom/w3c_html.html#t07).</span><span class="sxs-lookup"><span data-stu-id="dcd6a-p124">For information about the differences between  **innerText** and **textContent**, see [Node.textContent](https://developer.mozilla.org/docs/DOM/Node.textContent). For more information about DOM compatibility across common browsers, see [W3C DOM Compatibility - HTML](https://www.quirksmode.org/dom/w3c_html.html#t07).</span></span>

- <span data-ttu-id="dcd6a-p125">Если вам необходимо использовать свойство **innerHTML**, перед отправкой вводимых пользователем данных в свойство **innerHTML** проверьте, что они не содержат вредоносного контента. Дополнительные сведения и пример безопасного использования свойства **innerHTML** см. в разделе [innerHTML](https://developer.mozilla.org/docs/Web/API/Element/innerHTML).</span><span class="sxs-lookup"><span data-stu-id="dcd6a-p125">If you must use  **innerHTML**, make sure the user's input doesn't contain malicious content before passing it to  **innerHTML**. For more information and an example of how to use  **innerHTML** safely, see [innerHTML](https://developer.mozilla.org/docs/Web/API/Element/innerHTML) property.</span></span>

- <span data-ttu-id="dcd6a-221">Если вы используете jQuery, то вместо метода [.html()](https://api.jquery.com/text/) воспользуйтесь методом [.text()](https://api.jquery.com/html/).</span><span class="sxs-lookup"><span data-stu-id="dcd6a-221">If you are using jQuery, use the [.text()](https://api.jquery.com/text/) method instead of the [.html()](https://api.jquery.com/html/) method.</span></span>

- <span data-ttu-id="dcd6a-222">С помощью метода [toStaticHTML](https://developer.mozilla.org/en-US/docs/Web/HTML/Reference) перед отправкой введенных пользователем данных в свойство **innerHTML** можно удалить из них любые динамические элементы и атрибуты HTML.</span><span class="sxs-lookup"><span data-stu-id="dcd6a-222">Use the [toStaticHTML](https://developer.mozilla.org/en-US/docs/Web/HTML/Reference) method to remove any dynamic HTML elements and attributes in users' input before passing it to **innerHTML**.</span></span>

- <span data-ttu-id="dcd6a-223">С помощью функции [encodeURIComponent](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/encodeuricomponent) или [encodeURI](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/encodeuri) можно закодировать текст, который будет использоваться в качестве URL-адреса, введенного пользователем или содержащего введенные пользователем данные.</span><span class="sxs-lookup"><span data-stu-id="dcd6a-223">Use the [encodeURIComponent](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/encodeuricomponent) or [encodeURI](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/encodeuri) function to encode text that is intended to be a URL that comes from or contains user input.</span></span>

- <span data-ttu-id="dcd6a-224">Дополнительные рекомендации по созданию безопасных веб-решений см. в разделе [Разработка безопасных надстроек](/previous-versions/windows/apps/hh849625(v=win.10)).</span><span class="sxs-lookup"><span data-stu-id="dcd6a-224">See [Developing secure add-ins](/previous-versions/windows/apps/hh849625(v=win.10)) for more best practices to create more secure web solutions.</span></span>

### <a name="tips-to-prevent-clickjacking"></a><span data-ttu-id="dcd6a-225">Советы для предотвращения атак типа кликджекинг (clickjacking)</span><span class="sxs-lookup"><span data-stu-id="dcd6a-225">Tips to prevent "Clickjacking"</span></span>

<span data-ttu-id="dcd6a-226">Так как при использовании ведущих приложений Office надстройки Office выполняются в браузере и отображаются в элементе iframe, следуйте указанным ниже советам, чтобы снизить риск атак типа [кликджекинг](https://en.wikipedia.org/wiki/Clickjacking) — методики, используемой злоумышленниками для кражи конфиденциальной информации у пользователей.</span><span class="sxs-lookup"><span data-stu-id="dcd6a-226">Because Office Add-ins are rendered in an iframe when running in a browser with Office host applications, use the following tips to minimize the risk of [clickjacking](https://en.wikipedia.org/wiki/Clickjacking) -- a technique used by hackers to fool users into revealing confidential information.</span></span>

<span data-ttu-id="dcd6a-p126">Во-первых, определите критичные действия, которые может выполнять надстройка. К ним относятся все действия, которые может использовать злоумышленник, например проведение финансовой транзакции или публикация конфиденциальных данных. Например, надстройка может позволять пользователю отправлять платеж указанному получателю.</span><span class="sxs-lookup"><span data-stu-id="dcd6a-p126">First, identify sensitive actions that your add-in can perform. These include any actions that an unauthorized user could use with malicious intent, such as initiating a financial transaction or publishing sensitive data. For example, your add-in might let the user send a payment to a user-defined recipient.</span></span>

<span data-ttu-id="dcd6a-p127">Во-вторых, перед выполнением критичных действий надстройка должна запрашивать у пользователя подтверждение. Соответствующее сообщение должно содержать подробное описание последствий выполняемого действия. В нем также должно быть указано, как при необходимости пользователь может предотвратить действие: нажать специальную кнопку "Не разрешать" или проигнорировать подтверждение.</span><span class="sxs-lookup"><span data-stu-id="dcd6a-p127">Second, for sensitive actions, your add-in should confirm with the user before it executes the action. This confirmation should detail what effect the action will have. It should also detail how the user can prevent the action, if necessary, whether by choosing a specific button marked "Don't Allow" or by ignoring the confirmation.</span></span>

<span data-ttu-id="dcd6a-233">В-третьих, чтобы не позволить потенциальным хакерам скрыть или замаскировать подтверждение, необходимо показывать его вне контекста надстройки (т. е. не в диалоговом окне HTML).</span><span class="sxs-lookup"><span data-stu-id="dcd6a-233">Third, to ensure that no potential attacker can hide or mask the confirmation, you should display it outside the context of the add-in (that is, not in an HTML dialog box).</span></span>

<span data-ttu-id="dcd6a-234">Вот некоторые примеры получения подтверждения.</span><span class="sxs-lookup"><span data-stu-id="dcd6a-234">Here are some examples of how you could get confirmation:</span></span>

- <span data-ttu-id="dcd6a-235">Отправьте пользователю сообщение электронной почты, которое содержит ссылку для подтверждения.</span><span class="sxs-lookup"><span data-stu-id="dcd6a-235">Send an email to the user that contains a confirmation link.</span></span>

- <span data-ttu-id="dcd6a-236">Отправьте пользователю SMS-сообщение, содержащее код подтверждения, который можно ввести в надстройке.</span><span class="sxs-lookup"><span data-stu-id="dcd6a-236">Send a text message to the user that includes a confirmation code that the user can enter in the add-in.</span></span>

- <span data-ttu-id="dcd6a-p128">Откройте диалоговое окно подтверждения в новом окне браузера на странице, на которой невозможно использовать элемент iframe. Обычно это шаблон, который используется страницами входа. Создайте новое диалоговое окно с помощью [Dialog API](../develop/dialog-api-in-office-add-ins.md).</span><span class="sxs-lookup"><span data-stu-id="dcd6a-p128">Open a confirmation dialog in a new browser window to a page that cannot be iframed. This is typically the pattern that is used by login pages. Use the [dialog api](../develop/dialog-api-in-office-add-ins.md) to create a new dialog.</span></span>

<span data-ttu-id="dcd6a-p129">Кроме того, убедитесь, что адрес, используемый для связи с пользователем, не может применяться потенциальным злоумышленником. Например, для подтверждения оплаты используйте зарегистрированный адрес авторизованной учетной записи пользователя.</span><span class="sxs-lookup"><span data-stu-id="dcd6a-p129">Also, ensure that the address you use for contacting the user couldn't have been provided by a potential attacker. For example, for payment confirmations use the address on file for the authorized user's account.</span></span>

### <a name="other-security-practices"></a><span data-ttu-id="dcd6a-242">Другие методики обеспечения безопасности</span><span class="sxs-lookup"><span data-stu-id="dcd6a-242">Other security practices</span></span>

<span data-ttu-id="dcd6a-243">Разработчики также должны учитывать следующие методики обеспечения безопасности:</span><span class="sxs-lookup"><span data-stu-id="dcd6a-243">Developers should also take note of the following security practices:</span></span>


- <span data-ttu-id="dcd6a-244">Разработчикам не следует использовать в надстройках Office элементы ActiveX, так как последние не поддерживают кроссплатформенные возможности платформы надстроек.</span><span class="sxs-lookup"><span data-stu-id="dcd6a-244">Developers shouldn't use ActiveX controls in Office Add-ins as ActiveX controls don't support the cross-platform nature of the add-in platform.</span></span>

- <span data-ttu-id="dcd6a-p130">Для надстроек содержимого и надстроек области задач применяются те же параметры SSL, которые используются по умолчанию в браузере и обеспечивают предоставление основной части содержимого исключительно с использованием SSL. Надстройки Outlook требуют предоставления всего содержимого с помощью SSL. Разработчикам необходимо указывать в элементе **SourceLocation** манифеста надстройки URL-адрес с использованием протокола HTTPS, чтобы определить расположение HTML-файла для надстройки.</span><span class="sxs-lookup"><span data-stu-id="dcd6a-p130">Content and task pane add-ins assume the same SSL settings that the browser uses by default, and allows most content to be delivered only by SSL. Outlook add-ins require all content to be delivered by SSL. Developers must specify in the **SourceLocation** element of the add-in manifest a URL that uses HTTPS, to identify the location of the HTML file for the add-in.</span></span>

    <span data-ttu-id="dcd6a-248">Чтобы гарантировать, что надстройки не предоставляют содержимое с использованием HTTP, при тестировании надстроек разработчикам следует убедиться, что в разделе **Свойства браузера** на **панели управления** выбраны следующие параметры, а в тестовых сценариях отсутствуют предупреждения системы безопасности:</span><span class="sxs-lookup"><span data-stu-id="dcd6a-248">To make sure add-ins aren't delivering content by using HTTP, when testing add-ins, developers should make sure the following settings are selected in **Internet Options** in **Control Panel** and no security warnings appear in their test scenarios:</span></span>

    - <span data-ttu-id="dcd6a-p131">Убедитесь что для параметра безопасности **Отображение разнородного содержимого** для зоны **Интернет** выбрано значение **Предлагать**. Для этого настройте параметры в разделе **Свойства браузера** следующим образом: на вкладке **Безопасность** выберите зону **Интернет**, нажмите кнопку **Другой**, прокрутите содержимое окна до элемента **Отображение разнородного содержимого** и выберите значение **Предлагать**, если оно еще не выбрано.</span><span class="sxs-lookup"><span data-stu-id="dcd6a-p131">Make sure the security setting,  **Display mixed content**, for the  **Internet** zone is set to **Prompt**. You can do that by selecting the following in **Internet Options**: on the  **Security** tab, select the **Internet** zone, select **Custom level**, scroll to look for  **Display mixed content**, and select  **Prompt** if it isn't already selected.</span></span>

    - <span data-ttu-id="dcd6a-251">Убедитесь, что выбран параметр **Предупреждать о переключении режима безопасности** на вкладке **Дополнительно** диалогового окна **Свойства браузера**.</span><span class="sxs-lookup"><span data-stu-id="dcd6a-251">Make sure **Warn if Changing between Secure and not secure mode** is selected in the **Advanced** tab of the **Internet Options** dialog box.</span></span>

- <span data-ttu-id="dcd6a-p132">Чтобы убедиться, что надстройки не превышают допустимый уровень использования ЦП или памяти и не вызывают отказ в обслуживании на клиентском компьютере, платформа надстроек устанавливает пределы использования ресурсов. В рамках тестирования разработчикам следует убедиться, что надстройка соблюдает данные пределы.</span><span class="sxs-lookup"><span data-stu-id="dcd6a-p132">To make sure that add-ins don't use excessive CPU core or memory resources and cause any denial of service on a client computer, the add-in platform establishes resource usage limits. As part of testing, developers should verify whether an add-in performs within the resource usage limits.</span></span>

- <span data-ttu-id="dcd6a-254">Перед публикацией надстройки разработчикам следует убедиться, что любые личные сведения, указываемые ими в файлах надстройки, защищены.</span><span class="sxs-lookup"><span data-stu-id="dcd6a-254">Before publishing an add-in, developers should make sure that any personal identifiable information that they expose in their add-in files is secure.</span></span>

- <span data-ttu-id="dcd6a-p133">Разработчикам не следует внедрять ключи, которые они используют для доступа к сторонним API или службам (например, Bing, Google или Facebook) непосредственно в HTML-страницы своей надстройки. Вместо этого им следует создать настраиваемую веб-службу или хранить ключи в другом надежном веб-хранилище, к которому они затем смогут отправить вызов, чтобы передать значение ключа в надстройку.</span><span class="sxs-lookup"><span data-stu-id="dcd6a-p133">Developers shouldn't embed keys that they use to access third-party APIs or services (such as Bing, Google, or Facebook) directly in the HTML pages of their add-in. Instead, they should create a custom web service or store the keys in some other form of secure web storage that they can then call to pass the key value to their add-in.</span></span>

- <span data-ttu-id="dcd6a-257">При отправке надстройки в AppSource разработчикам следует:</span><span class="sxs-lookup"><span data-stu-id="dcd6a-257">Developers should do the following when submitting an add-in to AppSource:</span></span>

  - <span data-ttu-id="dcd6a-258">разместить отправляемую надстройку на веб-сервере, поддерживающем SSL;</span><span class="sxs-lookup"><span data-stu-id="dcd6a-258">Host the add-in they are submitting on a web server that supports SSL.</span></span>
  - <span data-ttu-id="dcd6a-259">создать заявление, прописывающее соответствующую требованиям политику конфиденциальности;</span><span class="sxs-lookup"><span data-stu-id="dcd6a-259">Produce a statement outlining a compliant privacy policy.</span></span>
  - <span data-ttu-id="dcd6a-260">подготовиться к подписанию контрактного соглашения при отправке надстройки.</span><span class="sxs-lookup"><span data-stu-id="dcd6a-260">Be ready to sign a contractual agreement upon submitting the add-in.</span></span>

<span data-ttu-id="dcd6a-p134">Помимо соблюдения правил использования ресурсов разработчики надстроек Outlook должны проверять, что их надстройки соблюдают ограничения по заданию правил активации и использованию API JavaScript. Дополнительные сведения см. в статье [Ограничения для активации и API JavaScript для надстроек Outlook](/outlook/add-ins/limits-for-activation-and-javascript-api-for-outlook-add-ins).</span><span class="sxs-lookup"><span data-stu-id="dcd6a-p134">Other than resource usage rules, developers for Outlook add-ins should also make sure their add-ins observe limits for specifying activation rules and using the JavaScript API. For more information, see [Limits for activation and JavaScript API for Outlook add-ins](/outlook/add-ins/limits-for-activation-and-javascript-api-for-outlook-add-ins).</span></span>

## <a name="it-administrators-control"></a><span data-ttu-id="dcd6a-263">Полномочия ИТ-администраторов</span><span class="sxs-lookup"><span data-stu-id="dcd6a-263">IT administrators' control</span></span>

<span data-ttu-id="dcd6a-264">В корпоративной среде ИТ-администраторы обладают высшими полномочиями в том, что касается предоставления или запрета доступа к AppSource и каким-либо частным каталогам.</span><span class="sxs-lookup"><span data-stu-id="dcd6a-264">In a corporate setting, IT administrators have ultimate authority over enabling or disabling access to AppSource and any private catalogs.</span></span>

<span data-ttu-id="dcd6a-265">Управление параметрами Office и их внедрение выполняется с помощью параметров групповой политики.</span><span class="sxs-lookup"><span data-stu-id="dcd6a-265">The management and enforcement of Office settings is done with group policy settings.</span></span> <span data-ttu-id="dcd6a-266">Указанные ниже параметры настраиваются с помощью [средства развертывания Office](/deployoffice/overview-of-the-office-2016-deployment-tool) совместно с [центром развертывания Office](/deployoffice/overview-of-the-office-customization-tool-for-click-to-run).</span><span class="sxs-lookup"><span data-stu-id="dcd6a-266">These are configurable through the [Office Deployment Tool](/deployoffice/overview-of-the-office-2016-deployment-tool), in conjunction with the [Office Customization Tool](/deployoffice/overview-of-the-office-customization-tool-for-click-to-run).</span></span>

| <span data-ttu-id="dcd6a-267">Имя параметра</span><span class="sxs-lookup"><span data-stu-id="dcd6a-267">Setting name</span></span> | <span data-ttu-id="dcd6a-268">Описание</span><span class="sxs-lookup"><span data-stu-id="dcd6a-268">Description</span></span> |
|--------------|-------------|
| <span data-ttu-id="dcd6a-269">Разрешить небезопасные веб-надстройки и каталоги</span><span class="sxs-lookup"><span data-stu-id="dcd6a-269">Allow Unsecure web add-ins and Catalogs</span></span> | <span data-ttu-id="dcd6a-270">Разрешает пользователям запускать небезопасные надстройки. Это надстройки с расположениями на веб-страницах или в каталоге без SSL-шифрования (https://), не находящиеся в зонах Интернета пользователей.</span><span class="sxs-lookup"><span data-stu-id="dcd6a-270">Allows users to run non-secure add-ins, which are add-ins that have webpage or catalog locations that are not SSL-secured (https://) and are not in users' Internet zones.</span></span> |
| <span data-ttu-id="dcd6a-271">Блокировать веб-надстройки</span><span class="sxs-lookup"><span data-stu-id="dcd6a-271">Block Web Add-ins</span></span> | <span data-ttu-id="dcd6a-272">Позволяет запрещать пользователям применение веб-надстроек.</span><span class="sxs-lookup"><span data-stu-id="dcd6a-272">Allows you to prevent users from using web add-ins.</span></span> |
| <span data-ttu-id="dcd6a-273">Заблокировать Магазин Office</span><span class="sxs-lookup"><span data-stu-id="dcd6a-273">Block the Office Store</span></span> |  <span data-ttu-id="dcd6a-274">Позволяет запрещать пользователям применение или вставку веб-настроек из Магазина Office.</span><span class="sxs-lookup"><span data-stu-id="dcd6a-274">Allows you to prevent users from using or inserting web add-ins that come from the Office Store.</span></span> |

> [!IMPORTANT]
> <span data-ttu-id="dcd6a-275">Если в рабочих группах используется несколько выпусков Office, для каждого выпуска нужно настроить параметры групповой политики.</span><span class="sxs-lookup"><span data-stu-id="dcd6a-275">If your working groups are using multiple releases of Office, group policy settings must be configured for each release.</span></span> <span data-ttu-id="dcd6a-276">Подробные сведения о параметрах групповой политики для Office 2013 см. в разделе [Использование групповой политики для управления возможностью установки и использования пользователями приложений для Office](/previous-versions/office/office-2013-resource-kit/jj219429(v=office.15)#using-group-policy-to-manage-how-users-can-install-and-use-apps-for-office) статьи [Обзор приложений для Office 2013](/previous-versions/office/office-2013-resource-kit/jj219429(v%3doffice.15))</span><span class="sxs-lookup"><span data-stu-id="dcd6a-276">Please refer to the [Using Group Policy to manage how users can install and use apps for Office](/previous-versions/office/office-2013-resource-kit/jj219429(v=office.15)#using-group-policy-to-manage-how-users-can-install-and-use-apps-for-office) of the [Overview of apps for Office 2013](/previous-versions/office/office-2013-resource-kit/jj219429(v%3doffice.15)) article for details on group policy settings for Office 2013.</span></span>

## <a name="see-also"></a><span data-ttu-id="dcd6a-277">См. также</span><span class="sxs-lookup"><span data-stu-id="dcd6a-277">See also</span></span>

- [<span data-ttu-id="dcd6a-278">Запрос разрешений на использование API в надстройках</span><span class="sxs-lookup"><span data-stu-id="dcd6a-278">Requesting permissions for API use in add-ins</span></span>](/office/dev/add-ins/develop/requesting-permissions-for-api-use-in-content-and-task-pane-add-ins)
- [<span data-ttu-id="dcd6a-279">Конфиденциальность, разрешения и безопасность для надстроек Outlook</span><span class="sxs-lookup"><span data-stu-id="dcd6a-279">Privacy, permissions, and security for Outlook add-ins</span></span>](/outlook/add-ins/privacy-and-security)
- [<span data-ttu-id="dcd6a-280">Общие сведения о разрешениях для надстройки Outlook</span><span class="sxs-lookup"><span data-stu-id="dcd6a-280">Understanding Outlook add-in permissions</span></span>](/outlook/add-ins/understanding-outlook-add-in-permissions)
- [<span data-ttu-id="dcd6a-281">Ограничения активации и API JavaScript для надстроек Outlook</span><span class="sxs-lookup"><span data-stu-id="dcd6a-281">Limits for activation and JavaScript API for Outlook add-ins</span></span>](/outlook/add-ins/limits-for-activation-and-javascript-api-for-outlook-add-ins)
- [<span data-ttu-id="dcd6a-282">Работа с ограничениями по принципу одинакового источника в надстройках Office</span><span class="sxs-lookup"><span data-stu-id="dcd6a-282">Addressing same-origin policy limitations in Office Add-ins</span></span>](/office/dev/add-ins/develop/addressing-same-origin-policy-limitations)
- [<span data-ttu-id="dcd6a-283">Принцип одинакового источника</span><span class="sxs-lookup"><span data-stu-id="dcd6a-283">Same Origin Policy</span></span>](https://www.w3.org/Security/wiki/Same_Origin_Policy)
- [<span data-ttu-id="dcd6a-284">Принцип одинакового источника. Часть 1. Без просмотра</span><span class="sxs-lookup"><span data-stu-id="dcd6a-284">Same Origin Policy Part 1: No Peeking</span></span>](/archive/blogs/ieinternals/same-origin-policy-part-1-no-peeking)
- [<span data-ttu-id="dcd6a-285">Принцип одинакового источника для JavaScript</span><span class="sxs-lookup"><span data-stu-id="dcd6a-285">Same origin policy for JavaScript</span></span>](https://developer.mozilla.org/docs/Web/Security/Same-origin_policy)
- [<span data-ttu-id="dcd6a-286">Защищенный режим Internet Explorer</span><span class="sxs-lookup"><span data-stu-id="dcd6a-286">IE Protect Mode</span></span>](https://support.microsoft.com/help/2761180/apps-for-office-don-t-start-if-you-disable-protected-mode-for-the-restricted-sites-zone-in-internet-explorer)
