---
title: Конфиденциальность и безопасность надстроек Office
description: Узнайте об аспектах конфиденциальности и безопасности платформы Office надстройки.
ms.date: 03/19/2021
localization_priority: Normal
ms.openlocfilehash: de33e0031a8deef8632cb82baaf3ac9aa2e95c90
ms.sourcegitcommit: ee9e92a968e4ad23f1e371f00d4888e4203ab772
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/23/2021
ms.locfileid: "53076191"
---
# <a name="privacy-and-security-for-office-add-ins"></a><span data-ttu-id="0487a-103">Конфиденциальность и безопасность надстроек Office</span><span class="sxs-lookup"><span data-stu-id="0487a-103">Privacy and security for Office Add-ins</span></span>

## <a name="understanding-the-add-in-runtime"></a><span data-ttu-id="0487a-104">Общие сведения о среде выполнения надстроек</span><span class="sxs-lookup"><span data-stu-id="0487a-104">Understanding the add-in runtime</span></span>

<span data-ttu-id="0487a-105">Надстройки Office защищены средой выполнения надстроек (многоуровневой моделью разрешений) и регуляторами производительности.</span><span class="sxs-lookup"><span data-stu-id="0487a-105">Office Add-ins are secured by an add-in runtime environment, a multiple-tier permissions model, and performance governors.</span></span> <span data-ttu-id="0487a-106">Эта структура защищает пользовательский опыт следующими способами.</span><span class="sxs-lookup"><span data-stu-id="0487a-106">This framework protects the user's experience in the following ways.</span></span>

- <span data-ttu-id="0487a-107">Доступ к Office пользовательского интерфейса клиентского приложения управляется.</span><span class="sxs-lookup"><span data-stu-id="0487a-107">Access to the Office client application's UI frame is managed.</span></span>

- <span data-ttu-id="0487a-108">Разрешен только косвенный доступ Office пользовательского интерфейса клиентского приложения.</span><span class="sxs-lookup"><span data-stu-id="0487a-108">Only indirect access to the Office client application's UI thread is allowed.</span></span>

- <span data-ttu-id="0487a-109">Не разрешено взаимодействие с модальными модулями , например вызовы в JavaScript, а функции не разрешены, так как `alert` `confirm` они являются `prompt` модальными.</span><span class="sxs-lookup"><span data-stu-id="0487a-109">Modal interactions aren't allowed - for example, calls to JavaScript `alert`, `confirm`, and `prompt` functions aren't allowed because they're modal.</span></span>

<span data-ttu-id="0487a-110">Кроме того, в рамках среды запуска предусмотрены следующие преимущества, которые гарантируют, что надстройка Office не может повредить среду пользователя.</span><span class="sxs-lookup"><span data-stu-id="0487a-110">Further, the runtime framework provides the following benefits to ensure that an Office Add-in can't damage the user's environment.</span></span>

- <span data-ttu-id="0487a-111">изолирует процесс, в котором работает надстройка;</span><span class="sxs-lookup"><span data-stu-id="0487a-111">Isolates the process the add-in runs in.</span></span>

- <span data-ttu-id="0487a-112">не требует замены DLL- или EXE-файлов, а также компонентов ActiveX;</span><span class="sxs-lookup"><span data-stu-id="0487a-112">Doesn't require .dll or .exe replacement or ActiveX components.</span></span>

- <span data-ttu-id="0487a-113">упрощает установку и удаление надстроек.</span><span class="sxs-lookup"><span data-stu-id="0487a-113">Makes add-ins easy to install and uninstall.</span></span>

<span data-ttu-id="0487a-114">Кроме того, вы можете управлять тем, как надстройки Office используют память, ЦП и сетевые ресурсы. Это позволяет поддерживать надлежащую производительность и надежность.</span><span class="sxs-lookup"><span data-stu-id="0487a-114">Also, the use of memory, CPU, and network resources by Office Add-ins is governable to ensure that good performance and reliability are maintained.</span></span>

<span data-ttu-id="0487a-115">В следующих разделах кратко описано, как архитектура времени запуска поддерживает запуск надстройок в Office клиентах на Windows устройствах, на устройствах Mac OS X и в веб-браузерах.</span><span class="sxs-lookup"><span data-stu-id="0487a-115">The following sections briefly describe how the runtime architecture supports running add-ins in Office clients on Windows-based devices, on Mac OS X devices, and in web browsers.</span></span>

### <a name="clients-on-windows-and-os-x-devices"></a><span data-ttu-id="0487a-116">Клиенты на устройствах с Windows и OS X</span><span class="sxs-lookup"><span data-stu-id="0487a-116">Clients on Windows and OS X devices</span></span>

<span data-ttu-id="0487a-p102">В поддерживаемых клиентах для настольных компьютеров и планшетов, например в Excel для Windows и Outlook для Windows и Mac, надстройки Office поддерживаются путем интеграции внутрипроцессного компонента — среды выполнения надстроек Office, которая управляет жизненным циклом надстройки и позволяет ей взаимодействовать с клиентским приложением. Сама веб-страница надстройки размещена вне процесса. Как показано на рис. 1, на настольном компьютере или планшете с ОС Windows [веб-страница надстройки размещена внутри элемента управления Internet Explorer](browsers-used-by-office-web-add-ins.md), который, в свою очередь, размещен внутри процесса среды выполнения надстройки, обеспечивающего безопасность и изоляцию работы.</span><span class="sxs-lookup"><span data-stu-id="0487a-p102">In supported clients for desktop and tablet devices, such as Excel on Windows, and Outlook on Windows and Mac, Office Add-ins are supported by integrating an in-process component, the Office Add-ins runtime, which manages the add-in lifecycle and enables interoperability between the add-in and the client application. The add-in webpage itself is hosted out-of-process. As shown in figure 1, on a Windows desktop or tablet device, [the add-in webpage is hosted inside an Internet Explorer or Microsoft Edge control](browsers-used-by-office-web-add-ins.md) which, in turn, is hosted inside an add-in runtime process that provides security and performance isolation.</span></span>

<span data-ttu-id="0487a-p103">На компьютерах с Windows в Internet Explorer для зоны "Опасные сайты" должен быть включен защищенный режим. Обычно этот режим включен по умолчанию. Если он отключен, при запуске надстройки [возникнет ошибка](https://support.microsoft.com/help/2761180/apps-for-office-don-t-start-if-you-disable-protected-mode-for-the-restricted-sites-zone-in-internet-explorer).</span><span class="sxs-lookup"><span data-stu-id="0487a-p103">On Windows desktops, Protected Mode in Internet Explorer must be enabled for the Restricted Site Zone. This is typically enabled by default. If it is disabled, an [error will occur](https://support.microsoft.com/help/2761180/apps-for-office-don-t-start-if-you-disable-protected-mode-for-the-restricted-sites-zone-in-internet-explorer) when you try to launch an add-in.</span></span>

<span data-ttu-id="0487a-123">*Рис. 1. Среда выполнения надстроек для Office в клиентах для настольных компьютеров и планшетов под управлением ОС Windows*</span><span class="sxs-lookup"><span data-stu-id="0487a-123">*Figure 1. Office Add-ins runtime environment in Windows-based desktop and tablet clients*</span></span>

![Схема, показывающая инфраструктуру с богатым клиентом.](../images/dk2-agave-overview-02.png)

<span data-ttu-id="0487a-125">Как показано на следующем рисунке, на рабочем столе Mac OS X веб-страница надстройки находится в песочнице процесса выполнения WebKit, который обеспечивает аналогичный уровень безопасности и защиты производительности.</span><span class="sxs-lookup"><span data-stu-id="0487a-125">As shown in the following figure, on a Mac OS X desktop, the add-in web page is hosted inside a sandboxed WebKit runtime host process which helps provide similar level of security and performance protection.</span></span>

<span data-ttu-id="0487a-126">*Рис. 2. Office Среда запуска надстройки в клиентах Mac OS X*</span><span class="sxs-lookup"><span data-stu-id="0487a-126">*Figure 2. Office Add-ins runtime environment in Mac OS X clients*</span></span>

![Схема, показывающая приложения для Office среды запуска на Mac OS X.](../images/dk2-agave-overview-mac-02.png)

<span data-ttu-id="0487a-128">Среда выполнения надстроек Office управляет взаимодействием процессов, преобразованием вызовов и событий API JavaScript в собственные вызовы и события, а также обеспечивает удаленную поддержку пользовательского интерфейса для отображения надстройки внутри документа, в области задач или рядом с электронным письмом, приглашением на собрание или встречей.</span><span class="sxs-lookup"><span data-stu-id="0487a-128">The Office Add-ins runtime manages interprocess communication, the translation of JavaScript API calls and events into native ones, as well as UI remoting support to enable the add-in to be rendered inside the document, in a task pane, or adjacent to an email message, meeting request, or appointment.</span></span>

### <a name="web-clients"></a><span data-ttu-id="0487a-129">Веб-клиенты</span><span class="sxs-lookup"><span data-stu-id="0487a-129">Web clients</span></span>

<span data-ttu-id="0487a-130">В поддерживаемых веб-Office надстройки находятся в **iframe,** который выполняется с помощью атрибута **песочницы** HTML5.</span><span class="sxs-lookup"><span data-stu-id="0487a-130">In supported web clients, Office Add-ins are hosted in an **iframe** that runs using the HTML5 **sandbox** attribute.</span></span> <span data-ttu-id="0487a-131">Компоненты ActiveX и навигация по главной странице веб-клиента запрещены.</span><span class="sxs-lookup"><span data-stu-id="0487a-131">ActiveX components or navigating the main page of the web client are not allowed.</span></span> <span data-ttu-id="0487a-132">Поддержка надстроек Office в веб-клиентах возможна благодаря интеграции API JavaScript для Office.</span><span class="sxs-lookup"><span data-stu-id="0487a-132">Office Add-ins support is enabled in the web clients by the integration of the JavaScript API for Office.</span></span> <span data-ttu-id="0487a-133">API JavaScript управляет жизненным циклом надстройки и взаимодействием между надстройкой и веб-клиентом аналогично клиентским приложениям на компьютерах.</span><span class="sxs-lookup"><span data-stu-id="0487a-133">In a similar way to the desktop client applications, the JavaScript API manages the add-in lifecycle and interoperability between the add-in and the web client.</span></span> <span data-ttu-id="0487a-134">Это взаимодействие реализуется с помощью специальной инфраструктуры отправки сообщений между фреймами.</span><span class="sxs-lookup"><span data-stu-id="0487a-134">This interoperability is implemented by using a special cross-frame post message communication infrastructure.</span></span> <span data-ttu-id="0487a-135">Для взаимодействия с веб-клиентом доступна та же библиотека JavaScript (Office.js), которая используется на клиентах на компьютерах.</span><span class="sxs-lookup"><span data-stu-id="0487a-135">The same JavaScript library (Office.js) that is used on desktop clients is available to interact with the web client.</span></span> <span data-ttu-id="0487a-136">На следующем рисунке показана инфраструктура, которая поддерживает надстройки в Office, запущенных в браузере, и соответствующие компоненты (веб-клиент, **iframe,** Office время запуска надстройки и API JavaScript для Office), необходимые для их поддержки.</span><span class="sxs-lookup"><span data-stu-id="0487a-136">The following figure shows the infrastructure that supports add-ins in Office running in the browser, and the relevant components (the web client, **iframe**, Office Add-ins runtime, and JavaScript API for Office) that are required to support them.</span></span>

<span data-ttu-id="0487a-137">*Рис. 3. Инфраструктура, поддерживающая надстройки Office в веб-клиентах Office*</span><span class="sxs-lookup"><span data-stu-id="0487a-137">*Figure 3. Infrastructure that supports Office Add-ins in Office web clients*</span></span>

![Схема, показывающая инфраструктуру веб-клиента.](../images/dk2-agave-overview-03.png)

## <a name="add-in-integrity-in-appsource"></a><span data-ttu-id="0487a-139">Целостность надстроек в AppSource</span><span class="sxs-lookup"><span data-stu-id="0487a-139">Add-in integrity in AppSource</span></span>

<span data-ttu-id="0487a-140">Вы можете публиковать свои надстройки Office в AppSource.</span><span class="sxs-lookup"><span data-stu-id="0487a-140">You can make your Office Add-ins available to the public by publishing them to AppSource.</span></span> <span data-ttu-id="0487a-141">AppSource применяет следующие меры для поддержания целостности надстройки.</span><span class="sxs-lookup"><span data-stu-id="0487a-141">AppSource enforces the following measures to maintain the integrity of add-ins.</span></span>

- <span data-ttu-id="0487a-142">При обмене данными хост-сервер надстройки Office всегда должен использовать SSL.</span><span class="sxs-lookup"><span data-stu-id="0487a-142">Requires the host server of an Office Add-in to always use Secure Sockets Layer (SSL) to communicate.</span></span>

- <span data-ttu-id="0487a-143">Разработчику требуется предоставить доказательство подлинности, контрактное соглашение и соответствующую требованиям политику конфиденциальности для отправки надстроек.</span><span class="sxs-lookup"><span data-stu-id="0487a-143">Requires a developer to provide proof of identity, a contractual agreement, and a compliant privacy policy to submit add-ins.</span></span>

- <span data-ttu-id="0487a-144">Поддерживается система рецензий пользователей для доступных надстроек, чтобы стимулировать формирование саморегулирующегося сообщества.</span><span class="sxs-lookup"><span data-stu-id="0487a-144">Supports a user-review system for available add-ins to promote a self-policing community.</span></span>

## <a name="optional-connected-experiences"></a><span data-ttu-id="0487a-145">Необязательные сетевые функции.</span><span class="sxs-lookup"><span data-stu-id="0487a-145">Optional connected experiences</span></span>

<span data-ttu-id="0487a-146">Конечные пользователи и ИТ-администраторы могут отключать [дополнительные возможности подключения в Office](/deployoffice/privacy/optional-connected-experiences) для клиентов рабочего стола и мобильных клиентов.</span><span class="sxs-lookup"><span data-stu-id="0487a-146">End users and IT admins can turn off [optional connected experiences in Office](/deployoffice/privacy/optional-connected-experiences) desktop and mobile clients.</span></span> <span data-ttu-id="0487a-147">Для Office надстройки последствия отключения параметра  необязательных подключенных подключенных параметров связаны с тем, что пользователи больше не могут получать доступ к надстройки или магазину Office через этих клиентов.</span><span class="sxs-lookup"><span data-stu-id="0487a-147">For Office Add-ins, the impact of disabling the **Optional connected experiences** setting is that users can no longer access add-ins or the Office Store through these clients.</span></span> <span data-ttu-id="0487a-148">Однако некоторые надстройки Майкрософт, которые считаются важными или критически важными для бизнеса, и [](../publish/centralized-deployment.md) надстройки, развернутые ИТ-администратором организации с помощью централизированного развертывания, по-прежнему будут доступны.</span><span class="sxs-lookup"><span data-stu-id="0487a-148">However, certain Microsoft add-ins that are considered essential or business-critical, and add-ins deployed by an organization's IT admin through [Centralized Deployment](../publish/centralized-deployment.md) will still be available.</span></span> <span data-ttu-id="0487a-149">Кроме того, надстройки и магазин остаются доступными в Outlook в Интернете, независимо от состояния параметра.</span><span class="sxs-lookup"><span data-stu-id="0487a-149">Additionally, add-ins and the Store remain available in Outlook on the web, regardless of the status of the setting.</span></span>

<span data-ttu-id="0487a-150">Дополнительные данные о Outlook,см. в этой Outlook конфиденциальности, разрешений и [безопасности.](../outlook/privacy-and-security.md#optional-connected-experiences)</span><span class="sxs-lookup"><span data-stu-id="0487a-150">For more about Outlook-specific behavior, see [Privacy, permissions, and security for Outlook add-ins](../outlook/privacy-and-security.md#optional-connected-experiences).</span></span>

<span data-ttu-id="0487a-151">Обратите внимание, что если ИТ-администратор отключает использование подключенных [Office,](/deployoffice/privacy/manage-privacy-controls#policy-setting-for-most-connected-experiences)он оказывает такое же влияние на надстройки, как и отключение просто необязательных подключенных интерфейсов.</span><span class="sxs-lookup"><span data-stu-id="0487a-151">Note that if an IT admin disables the [use of connected experiences in Office](/deployoffice/privacy/manage-privacy-controls#policy-setting-for-most-connected-experiences), it has the same effect on add-ins as turning off just optional connected experiences.</span></span>

## <a name="addressing-end-users-privacy-concerns"></a><span data-ttu-id="0487a-152">Решение вопросов, связанных с конфиденциальностью пользователей</span><span class="sxs-lookup"><span data-stu-id="0487a-152">Addressing end users' privacy concerns</span></span>

<span data-ttu-id="0487a-153">В этом разделе описывается защита, обеспечиваемая платформой надстроек Office, с точки зрения клиента (конечного пользователя), а также приводятся рекомендации по безопасной работе с персональными данными пользователей.</span><span class="sxs-lookup"><span data-stu-id="0487a-153">This section describes the protection offered by the Office Add-ins platform from the customer's (end user's) perspective, and provides guidelines for how to support users' expectations and how to securely handle users' personally identifiable information (PII).</span></span>

### <a name="end-users-perspective"></a><span data-ttu-id="0487a-154">Точка зрения пользователей</span><span class="sxs-lookup"><span data-stu-id="0487a-154">End users' perspective</span></span>

<span data-ttu-id="0487a-p107">При создании надстроек Office используются веб-технологии, работающие в элементе управления браузера или **iframe**. Из-за этого процесс работы с надстройками похож на просмотр веб-сайтов в Интернете или в интрасети. По отношению к организации надстройки могут быть внешними (если вы приобрели надстройку в AppSource) или внутренними (если надстройка получена из каталога надстроек Exchange Server, каталога приложений SharePoint либо на файловом ресурсе в сети организации). Надстройкам предоставляется ограниченный доступ к сети и большинство из них могут считывать данные из активного документа или почтового элемента, а также записывать в них данные. До того как пользователь или администратор установит или запустит надстройку, платформа надстроек применяет определенные ограничения. Но, как и при использовании любой модели расширений, при запуске незнакомых надстроек пользователю следует предпринимать определенные меры предосторожности.</span><span class="sxs-lookup"><span data-stu-id="0487a-p107">Office Add-ins are built using web technologies that run in a browser control or **iframe**. Because of this, using add-ins is similar to browsing to web sites on the Internet or intranet. Add-ins can be external to an organization (if you acquire the add-in from AppSource) or internal (if you acquire the add-in from an Exchange Server add-in catalog, SharePoint app catalog, or file share on an organization's network). Add-ins have limited access to the network and most add-ins can read or write to the active document or mail item. The add-in platform applies certain constraints before a user or administrator installs or starts an add-in. But as with any extensibility model, users should be cautious before starting an unknown add-in.</span></span>

> [!NOTE]
> <span data-ttu-id="0487a-161">Пользователи могут видеть запрос безопасности, чтобы доверять домену при первой загрузке надстройки.</span><span class="sxs-lookup"><span data-stu-id="0487a-161">Users may see a security prompt to trust the domain the first time an add-in is loaded.</span></span> <span data-ttu-id="0487a-162">Это произойдет, если хост домена надстройки находится за пределами домена Exchange локального или Office Online Server.</span><span class="sxs-lookup"><span data-stu-id="0487a-162">This will happen if the add-in's domain host is outside of the domain of Exchange on-premise or Office Online Server.</span></span>

<span data-ttu-id="0487a-163">Платформа надстройки решает проблемы конфиденциальности конечных пользователей следующим образом.</span><span class="sxs-lookup"><span data-stu-id="0487a-163">The add-in platform addresses end users' privacy concerns in the following ways.</span></span>

- <span data-ttu-id="0487a-164">Данные, обмен которыми выполняет тот веб-сервер, на котором размещена контентная надстройка, надстройка Outlook или надстройка области задач, а также данные при взаимодействии между надстройкой и всеми веб-службами, которые она использует, всегда должны быть зашифрованы в соответствии с требованиями протокола SSL.</span><span class="sxs-lookup"><span data-stu-id="0487a-164">Data communicated with the web server that hosts a content, Outlook or task pane add-in as well as communication between the add-in and any web services it uses must be encrypted using the Secure Socket Layer (SSL) protocol.</span></span>

- <span data-ttu-id="0487a-p109">Перед установкой надстройки из AppSource пользователь может просмотреть политику конфиденциальности и требования, которые ее касаются. Кроме того, надстройки Outlook, взаимодействующие с почтовыми ящиками пользователей, указывают необходимые им разрешения. Таким образом, перед установкой надстройки Outlook пользователь может просмотреть условия использования, требуемые разрешения и политику конфиденциальности.</span><span class="sxs-lookup"><span data-stu-id="0487a-p109">Before a user installs an add-in from AppSource, the user can view the privacy policy and requirements of that add-in. In addition, Outlook add-ins that interact with users' mailboxes surface the specific permissions that they require; the user can review the terms of use, requested permissions and privacy policy before installing an Outlook add-in.</span></span>

- <span data-ttu-id="0487a-167">При общем доступе к документу пользователи также совместно используют вставленные в него или связанные с ним надстройки.</span><span class="sxs-lookup"><span data-stu-id="0487a-167">When sharing a document, users also share add-ins that have been inserted in or associated with that document.</span></span> <span data-ttu-id="0487a-168">Если пользователь открывает документ, содержащий надстройку, которую пользователь не использовал ранее, Office клиентского приложения предлагает пользователю предоставить разрешение на запуск надстройки в документе.</span><span class="sxs-lookup"><span data-stu-id="0487a-168">If a user opens a document that contains an add-in that the user hasn't used before, the Office client application prompts the user to grant permission for the add-in to run in the document.</span></span> <span data-ttu-id="0487a-169">В организационной среде клиентская Office также подсказывая пользователю, если документ поступает из внешнего источника.</span><span class="sxs-lookup"><span data-stu-id="0487a-169">In an organizational environment, the Office client application also prompts the user if the document comes from an external source.</span></span>

- <span data-ttu-id="0487a-170">Пользователи могут включить или отключить доступ к AppSource.</span><span class="sxs-lookup"><span data-stu-id="0487a-170">Users can enable or disable the access to AppSource.</span></span> <span data-ttu-id="0487a-171">Для надстройок контента и области задач пользователи управляют доступом к  доверенным надстройки и каталогам из Центра доверия на клиенте хост-Office (открыт в Центре доверия к файлам параметры Параметры Доверенные каталоги надстройки).  >    >    >    >  </span><span class="sxs-lookup"><span data-stu-id="0487a-171">For content and task pane add-ins, users manage access to trusted add-ins and catalogs from the **Trust Center** on the host Office client (opened from **File** > **Options** > **Trust Center** > **Trust Center Settings** > **Trusted Add-in Catalogs**).</span></span> <span data-ttu-id="0487a-172">Для Outlook надстройки, использует может управлять надстройки, выбрав кнопку Управление надстройки: в Outlook на Windows, выберите **файл управления** надстройки   >  . В Outlook Mac выберите кнопку **Управление** надстройки на панели надстройки.</span><span class="sxs-lookup"><span data-stu-id="0487a-172">For Outlook add-ins, uses can manage add-ins by choosing the **Manage Add-ins** button: in Outlook on Windows, choose **File** > **Manage Add-ins**. In Outlook on Mac, choose the **Manage Add-ins** button on the add-in bar.</span></span> <span data-ttu-id="0487a-173">В Outlook в Интернете выберите меню **Параметры** (значок шестеренки) > **Управление надстройками**. Администраторы также могут управлять доступом [с помощью групповой политики](/previous-versions/office/office-2013-resource-kit/jj219429(v=office.15)#using-group-policy-to-manage-how-users-can-install-and-use-apps-for-office).</span><span class="sxs-lookup"><span data-stu-id="0487a-173">In Outlook on the web, choose the **Settings** menu (gear icon) > **Manage add-ins**. Administrators can also manage this access [by using group policy](/previous-versions/office/office-2013-resource-kit/jj219429(v=office.15)#using-group-policy-to-manage-how-users-can-install-and-use-apps-for-office).</span></span>

- <span data-ttu-id="0487a-174">Конструкция платформы надстройки обеспечивает безопасность и производительность для конечных пользователей следующими способами.</span><span class="sxs-lookup"><span data-stu-id="0487a-174">The design of the add-in platform provides security and performance for end users in the following ways.</span></span>

  - <span data-ttu-id="0487a-175">Надстройка Office в области управления веб-браузером, которая находится в среде среды запуска надстройки, отдельной от Office клиентского приложения.</span><span class="sxs-lookup"><span data-stu-id="0487a-175">An Office Add-in runs in a web browser control that is hosted in an add-in runtime environment separate from the Office client application.</span></span> <span data-ttu-id="0487a-176">Эта конструкция обеспечивает безопасность и изоляцию производительности от клиентского приложения.</span><span class="sxs-lookup"><span data-stu-id="0487a-176">This design provides both security and performance isolation from the client application.</span></span>

  - <span data-ttu-id="0487a-177">Выполнение в элементе управления браузера позволяет надстройке совершать практически любые операции, доступные обычной странице в браузере, и в то же время принуждает ее соблюдать политику единого домена для обеспечения изоляции доменов и зон безопасности.</span><span class="sxs-lookup"><span data-stu-id="0487a-177">Running in a web browser control allows the add-in to do almost anything a regular web page running in a browser can do but, at the same time, restricts the add-in to observe the same-origin policy for domain isolation and security zones.</span></span>

<span data-ttu-id="0487a-p113">Надстройки Outlook позволяют использовать дополнительные функции обеспечения безопасности и производительности. Для этого отслеживается потребление определенных ресурсов надстройками Outlook. Дополнительные сведения см. в разделе [Конфиденциальность, разрешения и безопасность для надстроек Outlook](../outlook/privacy-and-security.md).</span><span class="sxs-lookup"><span data-stu-id="0487a-p113">Outlook add-ins provide additional security and performance features through Outlook add-in specific resource usage monitoring. For more information, see [Privacy, permissions, and security for Outlook add-ins](../outlook/privacy-and-security.md).</span></span>

### <a name="developer-guidelines-to-handle-pii"></a><span data-ttu-id="0487a-180">Рекомендации разработчикам по обработке персональных данных</span><span class="sxs-lookup"><span data-stu-id="0487a-180">Developer guidelines to handle PII</span></span>

<span data-ttu-id="0487a-181">Ниже перечислены некоторые конкретные рекомендации по защите PII для вас как разработчика Office надстройки.</span><span class="sxs-lookup"><span data-stu-id="0487a-181">The following lists some specific PII protection guidelines for you as a developer of Office Add-ins.</span></span>

- <span data-ttu-id="0487a-p114">Объект [Settings](/javascript/api/office/office.settings) предназначен для хранения данных о параметрах и состоянии контентных надстроек и надстроек области задач между сеансами. Не следует хранить в объекте **Settings** пароли и другие конфиденциальные личные сведения. Данные в объекте **Settings** невидимы для пользователей, но хранятся в документе в легкодоступном формате. Следует ограничить надстройке доступ к личным сведениям и хранить такие сведения, необходимые для работы надстройки, на сервере, на котором размещена надстройка, в виде защищенного от пользователей ресурса.</span><span class="sxs-lookup"><span data-stu-id="0487a-p114">The [Settings](/javascript/api/office/office.settings) object is intended for persisting add-in settings and state data across sessions for a content or task pane add-in, but don't store passwords and other sensitive PII in the **Settings** object. The data in the **Settings** object isn't visible to end users, but it is stored as part of the document's file format which is readily accessible. You should limit your add-in's use of PII and store any PII required by your add-in on the server hosting your add-in as a user-secured resource.</span></span>

- <span data-ttu-id="0487a-p115">При использовании некоторых надстроек могут быть раскрыты личные сведения. Поэтому необходимо хранить данные удостоверений, сведения о расположениях и времени доступа, а также прочие учетные данные пользователей в безопасном расположении, недоступном другим пользователям надстройки.</span><span class="sxs-lookup"><span data-stu-id="0487a-p115">Using some applications can reveal PII. Make sure that you securely store data for your users' identity, location, access times, and any other credentials so that data won't become available to other users of the add-in.</span></span>

- <span data-ttu-id="0487a-p116">Если надстройка доступна в AppSource, требование AppSource протокола HTTPS защищает личные сведения, передаваемые между веб-сервером и клиентским компьютером или устройством. Однако если вы передаете данные на другие серверы, убедитесь, что обеспечивается такой же уровень защиты.</span><span class="sxs-lookup"><span data-stu-id="0487a-p116">If your add-in is available in AppSource, the AppSource requirement for HTTPS protects PII transmitted between your web server and the client computer or device. However, if you re-transmit that data to other servers, make sure you observe the same level of protection.</span></span>

- <span data-ttu-id="0487a-p117">Если вы храните личные сведения пользователей, обязательно сообщите об этом и предоставьте пользователям возможность по своему выбору проверять и удалять их. Если надстройка отправляется в AppSource, можно указать собираемые данные и их использование в заявлении о конфиденциальности.</span><span class="sxs-lookup"><span data-stu-id="0487a-p117">If you store users' PII, make sure you reveal that fact, and provide a way for users to inspect and delete it. If you submit your add-in to AppSource, you can outline the data you collect and how it's used in the privacy statement.</span></span>

## <a name="developers-permission-choices-and-security-practices"></a><span data-ttu-id="0487a-191">Варианты реализации разрешений и методики обеспечения безопасности для разработчиков</span><span class="sxs-lookup"><span data-stu-id="0487a-191">Developers' permission choices and security practices</span></span>

<span data-ttu-id="0487a-192">Чтобы обеспечить поддержку модели безопасности, используемой в надстройках Office, и находить дополнительные сведения для каждого типа надстроек, следуйте приведенным ниже общим указаниям.</span><span class="sxs-lookup"><span data-stu-id="0487a-192">Follow these general guidelines to support the security model of Office Add-ins, and drill down on more details for each add-in type.</span></span>

### <a name="permissions-choices"></a><span data-ttu-id="0487a-193">Варианты разрешений</span><span class="sxs-lookup"><span data-stu-id="0487a-193">Permissions choices</span></span>

<span data-ttu-id="0487a-194">Платформа надстроек предоставляет модель разрешений, с помощью которой надстройка объявляет уровень доступа к данным пользователя, необходимый для выполнения ее функций.</span><span class="sxs-lookup"><span data-stu-id="0487a-194">The add-in platform provides a permissions model that your add-in uses to declare the level of access to a user's data that it requires for its features.</span></span> <span data-ttu-id="0487a-195">Каждый уровень разрешений соответствует подмножеству API JavaScript для Office, которое вашей надстройке разрешено использовать для выполнения своих функций.</span><span class="sxs-lookup"><span data-stu-id="0487a-195">Each permission level corresponds to the subset of the JavaScript API for Office your add-in is allowed to use for its features.</span></span> <span data-ttu-id="0487a-196">Например, разрешение **WriteDocument** для надстроек контента и области задач позволяет получить доступ к методу [Document.setSelectedDataAsync,](/javascript/api/office/office.document) который позволяет надстройке записываться в документ пользователя, но не разрешает доступ ни к какому из методов чтения данных из документа.</span><span class="sxs-lookup"><span data-stu-id="0487a-196">For example, the **WriteDocument** permission for content and task pane add-ins allows access to the [Document.setSelectedDataAsync](/javascript/api/office/office.document) method that lets an add-in write to the user's document, but doesn't allow access to any of the methods for reading data from the document.</span></span> <span data-ttu-id="0487a-197">Такой уровень разрешений целесообразно использовать для надстроек, которым необходимо только записывать данные в документ, например для надстроек, в которых пользователь может запрашивать вставку данных в свой документ.</span><span class="sxs-lookup"><span data-stu-id="0487a-197">This permission level makes sense for add-ins that only need to write to a document, such as an add-in where the user can query for data to insert into their document.</span></span>

<span data-ttu-id="0487a-p119">Рекомендуется запрашивать разрешения по принципу _минимальной привилегии_. Другими словами, следует запрашивать разрешения для доступа только к минимальному подмножеству API, необходимому для правильной работы надстройки. Например, если надстройке требуется только считывать данные из документа пользователя, то максимальное разрешение, которое вам следует запросить, — **ReadDocument**. (Имейте в виду, что если запросить недостаточно разрешений, платформа надстроек запретит надстройке использовать некоторые API, что приведет к ошибке во время выполнения.)</span><span class="sxs-lookup"><span data-stu-id="0487a-p119">As a best practice, you should request permissions based on the principle of  _least privilege_. That is, you should request permission to access only the minimum subset of the API that your add-in requires to function correctly. For example, if your add-in needs only to read data in a user's document for its features, you should request no more than the **ReadDocument** permission. (But, keep in mind that requesting insufficient permissions will result in the add-in platform blocking your add-in's use of some APIs and will generate errors at run time.)</span></span>

<span data-ttu-id="0487a-202">Разрешения указываются в манифесте надстройки, как показано в примере ниже из этого раздела, а пользователи могут просматривать требуемый уровень разрешений перед принятием решения об установке или активации такой надстройки в первый раз.</span><span class="sxs-lookup"><span data-stu-id="0487a-202">You specify permissions in the manifest of your add-in, as shown in the example in this section below, and end users can see the requested permission level of an add-in before they decide to install or activate the add-in for the first time.</span></span> <span data-ttu-id="0487a-203">Кроме того, для установки надстроек Outlook, запрашивающих разрешение **ReadWriteMailbox**, требуются явные права администратора.</span><span class="sxs-lookup"><span data-stu-id="0487a-203">Additionally, Outlook add-ins that request the **ReadWriteMailbox** permission require explicit administrator privilege to install.</span></span>

<span data-ttu-id="0487a-204">В следующем примере показано, как надстройка области задач указывает разрешение **ReadDocument** в манифесте.</span><span class="sxs-lookup"><span data-stu-id="0487a-204">The following example shows how a task pane add-in specifies the **ReadDocument** permission in its manifest.</span></span> <span data-ttu-id="0487a-205">Чтобы сконцентрировать внимание на разрешениях, другие элементы в манифесте не отображены.</span><span class="sxs-lookup"><span data-stu-id="0487a-205">To keep permissions as the focus, other elements in the manifest aren't displayed.</span></span>

```xml
<?xml version="1.0" encoding="utf-8"?>
<OfficeApp xmlns="http://schemas.microsoft.com/office/appforoffice/1.0"
           xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
           xmlns:ver="http://schemas.microsoft.com/office/appforoffice/1.0"
           xsi:type="TaskPaneApp">

... <!-- To keep permissions as the focus, not displaying other elements. -->
  <Permissions>ReadDocument</Permissions>
...
</OfficeApp>
```

<span data-ttu-id="0487a-206">Дополнительные сведения о разрешениях для надстроек области задач и контентных надстроек см. в статье [Запрос разрешений на использование API в надстройках](../develop/requesting-permissions-for-api-use-in-content-and-task-pane-add-ins.md).</span><span class="sxs-lookup"><span data-stu-id="0487a-206">For more information about permissions for task pane and content add-ins, see [Requesting permissions for API use in add-ins](../develop/requesting-permissions-for-api-use-in-content-and-task-pane-add-ins.md).</span></span>

<span data-ttu-id="0487a-207">Дополнительные сведения о разрешениях для Outlook надстройки см. в следующих темах.</span><span class="sxs-lookup"><span data-stu-id="0487a-207">For more information about permissions for Outlook add-ins, see the following topics.</span></span>

- [<span data-ttu-id="0487a-208">Конфиденциальность, разрешения и безопасность для надстроек Outlook</span><span class="sxs-lookup"><span data-stu-id="0487a-208">Privacy, permissions, and security for Outlook add-ins</span></span>](../outlook/privacy-and-security.md)

- [<span data-ttu-id="0487a-209">Общие сведения о разрешениях для надстройки Outlook</span><span class="sxs-lookup"><span data-stu-id="0487a-209">Understanding Outlook add-in permissions</span></span>](../outlook/understanding-outlook-add-in-permissions.md)

### <a name="same-origin-policy"></a><span data-ttu-id="0487a-210">Политика единого домена</span><span class="sxs-lookup"><span data-stu-id="0487a-210">Same origin policy</span></span>

<span data-ttu-id="0487a-211">Так Office надстройки — это веб-страницы, которые работают в веб-браузере, они должны следовать политике одного и того же происхождения, которую выполняет браузер.</span><span class="sxs-lookup"><span data-stu-id="0487a-211">Because Office Add-ins are webpages that run in a web browser control, they must follow the same-origin policy enforced by the browser.</span></span> <span data-ttu-id="0487a-212">По умолчанию веб-страницы в одном домене не могут сделать вызовы [веб-службы XmlHttpRequest](https://www.w3.org/TR/XMLHttpRequest/) в другой домен, кроме домена, в котором он находится.</span><span class="sxs-lookup"><span data-stu-id="0487a-212">By default, a webpage in one domain can't make [XmlHttpRequest](https://www.w3.org/TR/XMLHttpRequest/) web service calls to another domain other than the one where it is hosted.</span></span>

<span data-ttu-id="0487a-213">Одним из способов преодоления этого ограничения является использование JSON/P —  предоставление прокси-сервера веб-службы, включив тег скрипта с атрибутом **SRC,** который указывает на какой-то скрипт, который находится на другом домене.</span><span class="sxs-lookup"><span data-stu-id="0487a-213">One way to overcome this limitation is to use JSON/P -- provide a proxy for the web service by including a **script** tag with a **src** attribute that points to some script hosted on another domain.</span></span> <span data-ttu-id="0487a-214">Вы можете программно создавать теги **script**, динамически формируя URL-адрес, на который указывает атрибут **src**, и передавая параметры на URL-адрес через параметры запроса URI.</span><span class="sxs-lookup"><span data-stu-id="0487a-214">You can programmatically create the **script** tags, dynamically creating the URL to which to point the **src** attribute, and passing parameters to the URL via URI query parameters.</span></span> <span data-ttu-id="0487a-215">Поставщики веб-служб создают и размещают код JavaScript с использованием определенных URL-адресов и возвращают разные сценарии в зависимости от параметров запроса URI.</span><span class="sxs-lookup"><span data-stu-id="0487a-215">Web service providers create and host JavaScript code at specific URLs, and return different scripts depending on the URI query parameters.</span></span> <span data-ttu-id="0487a-216">Затем эти сценарии выполняются в точке вставки и работают надлежащим образом.</span><span class="sxs-lookup"><span data-stu-id="0487a-216">These scripts then execute where they are inserted and work as expected.</span></span>

<span data-ttu-id="0487a-217">Ниже приведен пример JSON/P в образце надстройки Outlook.</span><span class="sxs-lookup"><span data-stu-id="0487a-217">The following is an example of JSON/P in the Outlook add-in example.</span></span> 

```js
// Dynamically create an HTML SCRIPT element that obtains the details for the specified video.
function loadVideoDetails(videoIndex) {
    // Dynamically create a new HTML SCRIPT element in the webpage.
    var script = document.createElement("script");
    // Specify the URL to retrieve the indicated video from a feed of a current list of videos,
    // as the value of the src attribute of the SCRIPT element. 
    script.setAttribute("src", "https://gdata.youtube.com/feeds/api/videos/" + 
        videos[videoIndex].Id + "?alt=json-in-script&amp;callback=videoDetailsLoaded");
    // Insert the SCRIPT element at the end of the HEAD section.
    document.getElementsByTagName('head')[0].appendChild(script);
}
```

<span data-ttu-id="0487a-p124">Exchange и SharePoint предоставляют прокси-серверы на стороне клиента, чтобы обеспечить междоменный доступ. В общем случае в интрасетях действуют более мягкие политики единого домена, чем в Интернете. Дополнительные сведения см. в статьях [Политика единого домена. Часть 1: без просмотра](/archive/blogs/ieinternals/same-origin-policy-part-1-no-peeking) и [Решение вопросов, которые связаны с ограничениями, накладываемыми политикой единого домена, в надстройках Office](../develop/addressing-same-origin-policy-limitations.md).</span><span class="sxs-lookup"><span data-stu-id="0487a-p124">Exchange and SharePoint provide client-side proxies to enable cross-domain access. In general, same origin policy on an intranet isn't as strict as on the Internet. For more information, see [Same Origin Policy Part 1: No Peeking](/archive/blogs/ieinternals/same-origin-policy-part-1-no-peeking) and [Addressing same-origin policy limitations in Office Add-ins](../develop/addressing-same-origin-policy-limitations.md).</span></span>

### <a name="tips-to-prevent-malicious-cross-site-scripting"></a><span data-ttu-id="0487a-221">Советы по предотвращению вредоносных межсайтовых сценариев</span><span class="sxs-lookup"><span data-stu-id="0487a-221">Tips to prevent malicious cross-site scripting</span></span>

<span data-ttu-id="0487a-222">Злонамеренный пользователь может атаковать базовую структуру надстройки, вводя вредоносный сценарий через документ или поля в надстройке.</span><span class="sxs-lookup"><span data-stu-id="0487a-222">An ill-intentioned user could attack the origin of an add-in by entering malicious script through the document or fields in the add-in.</span></span> <span data-ttu-id="0487a-223">Разработчик должен соответствующим образом обрабатывать вводимые пользователем данные, чтобы избежать выполнения кода JavaScript злоумышленника в его домене.</span><span class="sxs-lookup"><span data-stu-id="0487a-223">A developer should process user input to avoid executing a malicious user's JavaScript within their domain.</span></span> <span data-ttu-id="0487a-224">Ниже следуют некоторые методы обработки входных данных пользователей из документа или сообщения электронной почты или с помощью полей в надстройки.</span><span class="sxs-lookup"><span data-stu-id="0487a-224">The following are some good practices to follow to handle user input from a document or mail message, or via fields in an add-in.</span></span>

- <span data-ttu-id="0487a-225">Вместо свойства DOM [innerHTML](https://developer.mozilla.org/docs/Web/API/Element/innerHTML) используйте свойства [innerText](https://developer.mozilla.org/docs/Web/API/Node/innerText) и [textContent](https://developer.mozilla.org/docs/DOM/Node.textContent), где это возможно.</span><span class="sxs-lookup"><span data-stu-id="0487a-225">Instead of the DOM property [innerHTML](https://developer.mozilla.org/docs/Web/API/Element/innerHTML), use the [innerText](https://developer.mozilla.org/docs/Web/API/Node/innerText) and [textContent](https://developer.mozilla.org/docs/DOM/Node.textContent) properties where appropriate.</span></span> <span data-ttu-id="0487a-226">Сделайте следующее для поддержки кросс-браузера Internet Explorer и Firefox.</span><span class="sxs-lookup"><span data-stu-id="0487a-226">Do the following for Internet Explorer and Firefox cross-browser support.</span></span>

    ```js
     var text = x.innerText || x.textContent
    ```

    <span data-ttu-id="0487a-227">Сведения о различиях **между innerText** и **textContent** см. в [документе Node.textContent.](https://developer.mozilla.org/docs/DOM/Node.textContent)</span><span class="sxs-lookup"><span data-stu-id="0487a-227">For information about the differences between **innerText** and **textContent**, see [Node.textContent](https://developer.mozilla.org/docs/DOM/Node.textContent).</span></span> <span data-ttu-id="0487a-228">Дополнительные сведения о совместимости DOM в обычных браузерах см. в [w3C DOM Compatibility - HTML.](https://www.quirksmode.org/dom/w3c_html.html#t07)</span><span class="sxs-lookup"><span data-stu-id="0487a-228">For more information about DOM compatibility across common browsers, see [W3C DOM Compatibility - HTML](https://www.quirksmode.org/dom/w3c_html.html#t07).</span></span>

- <span data-ttu-id="0487a-229">Если необходимо использовать **внутреннийHTML,** убедитесь, что вход пользователя не содержит вредоносного контента перед передачей его **во внутреннийHTML.**</span><span class="sxs-lookup"><span data-stu-id="0487a-229">If you must use **innerHTML**, make sure the user's input doesn't contain malicious content before passing it to **innerHTML**.</span></span> <span data-ttu-id="0487a-230">Дополнительные сведения и пример безопасного использования свойства **innerHTML** см. в разделе [innerHTML](https://developer.mozilla.org/docs/Web/API/Element/innerHTML).</span><span class="sxs-lookup"><span data-stu-id="0487a-230">For more information and an example of how to use **innerHTML** safely, see [innerHTML](https://developer.mozilla.org/docs/Web/API/Element/innerHTML) property.</span></span>

- <span data-ttu-id="0487a-231">Если вы используете jQuery, то вместо метода [.html()](https://api.jquery.com/text/) воспользуйтесь методом [.text()](https://api.jquery.com/html/).</span><span class="sxs-lookup"><span data-stu-id="0487a-231">If you are using jQuery, use the [.text()](https://api.jquery.com/text/) method instead of the [.html()](https://api.jquery.com/html/) method.</span></span>

- <span data-ttu-id="0487a-232">С помощью метода [toStaticHTML](https://developer.mozilla.org/en-US/docs/Web/HTML/Reference) перед отправкой введенных пользователем данных в свойство **innerHTML** можно удалить из них любые динамические элементы и атрибуты HTML.</span><span class="sxs-lookup"><span data-stu-id="0487a-232">Use the [toStaticHTML](https://developer.mozilla.org/en-US/docs/Web/HTML/Reference) method to remove any dynamic HTML elements and attributes in users' input before passing it to **innerHTML**.</span></span>

- <span data-ttu-id="0487a-233">С помощью функции [encodeURIComponent](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/encodeuricomponent) или [encodeURI](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/encodeuri) можно закодировать текст, который будет использоваться в качестве URL-адреса, введенного пользователем или содержащего введенные пользователем данные.</span><span class="sxs-lookup"><span data-stu-id="0487a-233">Use the [encodeURIComponent](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/encodeuricomponent) or [encodeURI](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/encodeuri) function to encode text that is intended to be a URL that comes from or contains user input.</span></span>

- <span data-ttu-id="0487a-234">Дополнительные рекомендации по созданию безопасных веб-решений см. в разделе [Разработка безопасных надстроек](/previous-versions/windows/apps/hh849625(v=win.10)).</span><span class="sxs-lookup"><span data-stu-id="0487a-234">See [Developing secure add-ins](/previous-versions/windows/apps/hh849625(v=win.10)) for more best practices to create more secure web solutions.</span></span>

### <a name="tips-to-prevent-clickjacking"></a><span data-ttu-id="0487a-235">Советы для предотвращения атак типа кликджекинг (clickjacking)</span><span class="sxs-lookup"><span data-stu-id="0487a-235">Tips to prevent "Clickjacking"</span></span>

<span data-ttu-id="0487a-236">Поскольку Office надстройки отрисовываны в iframe при работе в браузере с Office клиентских приложений, [](https://en.wikipedia.org/wiki/Clickjacking) используйте следующие советы, чтобы свести к минимуму риск кражи кликов — метод, используемый хакерами для обмана пользователей в раскрытии конфиденциальной информации.</span><span class="sxs-lookup"><span data-stu-id="0487a-236">Because Office Add-ins are rendered in an iframe when running in a browser with Office client applications, use the following tips to minimize the risk of [clickjacking](https://en.wikipedia.org/wiki/Clickjacking) -- a technique used by hackers to fool users into revealing confidential information.</span></span>

<span data-ttu-id="0487a-p129">Во-первых, определите критичные действия, которые может выполнять надстройка. К ним относятся все действия, которые может использовать злоумышленник, например проведение финансовой транзакции или публикация конфиденциальных данных. Например, надстройка может позволять пользователю отправлять платеж указанному получателю.</span><span class="sxs-lookup"><span data-stu-id="0487a-p129">First, identify sensitive actions that your add-in can perform. These include any actions that an unauthorized user could use with malicious intent, such as initiating a financial transaction or publishing sensitive data. For example, your add-in might let the user send a payment to a user-defined recipient.</span></span>

<span data-ttu-id="0487a-p130">Во-вторых, перед выполнением критичных действий надстройка должна запрашивать у пользователя подтверждение. Соответствующее сообщение должно содержать подробное описание последствий выполняемого действия. В нем также должно быть указано, как при необходимости пользователь может предотвратить действие: нажать специальную кнопку "Не разрешать" или проигнорировать подтверждение.</span><span class="sxs-lookup"><span data-stu-id="0487a-p130">Second, for sensitive actions, your add-in should confirm with the user before it executes the action. This confirmation should detail what effect the action will have. It should also detail how the user can prevent the action, if necessary, whether by choosing a specific button marked "Don't Allow" or by ignoring the confirmation.</span></span>

<span data-ttu-id="0487a-243">В-третьих, чтобы не позволить потенциальным хакерам скрыть или замаскировать подтверждение, необходимо показывать его вне контекста надстройки (т. е. не в диалоговом окне HTML).</span><span class="sxs-lookup"><span data-stu-id="0487a-243">Third, to ensure that no potential attacker can hide or mask the confirmation, you should display it outside the context of the add-in (that is, not in an HTML dialog box).</span></span>

<span data-ttu-id="0487a-244">Ниже приводится несколько примеров того, как можно получить подтверждение.</span><span class="sxs-lookup"><span data-stu-id="0487a-244">The following are some examples of how you could get confirmation.</span></span>

- <span data-ttu-id="0487a-245">Отправьте пользователю сообщение электронной почты, которое содержит ссылку для подтверждения.</span><span class="sxs-lookup"><span data-stu-id="0487a-245">Send an email to the user that contains a confirmation link.</span></span>

- <span data-ttu-id="0487a-246">Отправьте пользователю SMS-сообщение, содержащее код подтверждения, который можно ввести в надстройке.</span><span class="sxs-lookup"><span data-stu-id="0487a-246">Send a text message to the user that includes a confirmation code that the user can enter in the add-in.</span></span>

- <span data-ttu-id="0487a-p131">Откройте диалоговое окно подтверждения в новом окне браузера на странице, на которой невозможно использовать элемент iframe. Обычно это шаблон, который используется страницами входа. Создайте новое диалоговое окно с помощью [Dialog API](../develop/dialog-api-in-office-add-ins.md).</span><span class="sxs-lookup"><span data-stu-id="0487a-p131">Open a confirmation dialog in a new browser window to a page that cannot be iframed. This is typically the pattern that is used by login pages. Use the [dialog api](../develop/dialog-api-in-office-add-ins.md) to create a new dialog.</span></span>

<span data-ttu-id="0487a-p132">Кроме того, убедитесь, что адрес, используемый для связи с пользователем, не может применяться потенциальным злоумышленником. Например, для подтверждения оплаты используйте зарегистрированный адрес авторизованной учетной записи пользователя.</span><span class="sxs-lookup"><span data-stu-id="0487a-p132">Also, ensure that the address you use for contacting the user couldn't have been provided by a potential attacker. For example, for payment confirmations use the address on file for the authorized user's account.</span></span>

### <a name="other-security-practices"></a><span data-ttu-id="0487a-252">Другие методики обеспечения безопасности</span><span class="sxs-lookup"><span data-stu-id="0487a-252">Other security practices</span></span>

<span data-ttu-id="0487a-253">Разработчики также должны принять к сведению следующие методы безопасности.</span><span class="sxs-lookup"><span data-stu-id="0487a-253">Developers should also take note of the following security practices.</span></span>

- <span data-ttu-id="0487a-254">Разработчикам не следует использовать в надстройках Office элементы ActiveX, так как последние не поддерживают кроссплатформенные возможности платформы надстроек.</span><span class="sxs-lookup"><span data-stu-id="0487a-254">Developers shouldn't use ActiveX controls in Office Add-ins as ActiveX controls don't support the cross-platform nature of the add-in platform.</span></span>

- <span data-ttu-id="0487a-p133">Для надстроек содержимого и надстроек области задач применяются те же параметры SSL, которые используются по умолчанию в браузере и обеспечивают предоставление основной части содержимого исключительно с использованием SSL. Надстройки Outlook требуют предоставления всего содержимого с помощью SSL. Разработчикам необходимо указывать в элементе **SourceLocation** манифеста надстройки URL-адрес с использованием протокола HTTPS, чтобы определить расположение HTML-файла для надстройки.</span><span class="sxs-lookup"><span data-stu-id="0487a-p133">Content and task pane add-ins assume the same SSL settings that the browser uses by default, and allows most content to be delivered only by SSL. Outlook add-ins require all content to be delivered by SSL. Developers must specify in the **SourceLocation** element of the add-in manifest a URL that uses HTTPS, to identify the location of the HTML file for the add-in.</span></span>

  <span data-ttu-id="0487a-258">Чтобы убедиться, что надстройки не доставляют контент с помощью HTTP, при тестировании надстройки  разработчики  должны убедиться, что в панели управления параметры Интернета выбраны следующие параметры, а в тестовых сценариях не отображаются предупреждения о безопасности.</span><span class="sxs-lookup"><span data-stu-id="0487a-258">To make sure add-ins aren't delivering content by using HTTP, when testing add-ins, developers should make sure the following settings are selected in **Internet Options** in **Control Panel** and no security warnings appear in their test scenarios.</span></span>

  - <span data-ttu-id="0487a-259">Убедитесь, что для параметра **Отображение разнородного содержимого** для зоны **Интернет** установлено значение **Предлагать**.</span><span class="sxs-lookup"><span data-stu-id="0487a-259">Make sure the security setting, **Display mixed content**, for the **Internet** zone is set to **Prompt**.</span></span> <span data-ttu-id="0487a-260">Вы можете сделать это, выбрав следующие параметры  в **Интернете:** на вкладке Безопасность, выберите зону Интернета, выберите настраиваемый  **уровень,** прокрутите для отображения смешанного контента и выберите **Запрос,** если он еще не выбран.</span><span class="sxs-lookup"><span data-stu-id="0487a-260">You can do that by selecting the following in **Internet Options**: on the **Security** tab, select the **Internet** zone, select **Custom level**, scroll to look for **Display mixed content**, and select **Prompt** if it isn't already selected.</span></span>

  - <span data-ttu-id="0487a-261">Убедитесь, что выбран параметр **Предупреждать о переключении режима безопасности** на вкладке **Дополнительно** диалогового окна **Свойства браузера**.</span><span class="sxs-lookup"><span data-stu-id="0487a-261">Make sure **Warn if Changing between Secure and not secure mode** is selected in the **Advanced** tab of the **Internet Options** dialog box.</span></span>

- <span data-ttu-id="0487a-p135">Чтобы убедиться, что надстройки не превышают допустимый уровень использования ЦП или памяти и не вызывают отказ в обслуживании на клиентском компьютере, платформа надстроек устанавливает пределы использования ресурсов. В рамках тестирования разработчикам следует убедиться, что надстройка соблюдает данные пределы.</span><span class="sxs-lookup"><span data-stu-id="0487a-p135">To make sure that add-ins don't use excessive CPU core or memory resources and cause any denial of service on a client computer, the add-in platform establishes resource usage limits. As part of testing, developers should verify whether an add-in performs within the resource usage limits.</span></span>

- <span data-ttu-id="0487a-264">Перед публикацией надстройки разработчикам следует убедиться, что любые личные сведения, указываемые ими в файлах надстройки, защищены.</span><span class="sxs-lookup"><span data-stu-id="0487a-264">Before publishing an add-in, developers should make sure that any personal identifiable information that they expose in their add-in files is secure.</span></span>

- <span data-ttu-id="0487a-p136">Разработчикам не следует внедрять ключи, которые они используют для доступа к сторонним API или службам (например, Bing, Google или Facebook) непосредственно в HTML-страницы своей надстройки. Вместо этого им следует создать настраиваемую веб-службу или хранить ключи в другом надежном веб-хранилище, к которому они затем смогут отправить вызов, чтобы передать значение ключа в надстройку.</span><span class="sxs-lookup"><span data-stu-id="0487a-p136">Developers shouldn't embed keys that they use to access third-party APIs or services (such as Bing, Google, or Facebook) directly in the HTML pages of their add-in. Instead, they should create a custom web service or store the keys in some other form of secure web storage that they can then call to pass the key value to their add-in.</span></span>

- <span data-ttu-id="0487a-267">Разработчики должны сделать следующее при отправке надстройки в AppSource.</span><span class="sxs-lookup"><span data-stu-id="0487a-267">Developers should do the following when submitting an add-in to AppSource.</span></span>

  - <span data-ttu-id="0487a-268">разместить отправляемую надстройку на веб-сервере, поддерживающем SSL;</span><span class="sxs-lookup"><span data-stu-id="0487a-268">Host the add-in they are submitting on a web server that supports SSL.</span></span>
  - <span data-ttu-id="0487a-269">создать заявление, прописывающее соответствующую требованиям политику конфиденциальности;</span><span class="sxs-lookup"><span data-stu-id="0487a-269">Produce a statement outlining a compliant privacy policy.</span></span>
  - <span data-ttu-id="0487a-270">подготовиться к подписанию контрактного соглашения при отправке надстройки.</span><span class="sxs-lookup"><span data-stu-id="0487a-270">Be ready to sign a contractual agreement upon submitting the add-in.</span></span>

<span data-ttu-id="0487a-p137">Помимо соблюдения правил использования ресурсов разработчики надстроек Outlook должны проверять, что их надстройки соблюдают ограничения по заданию правил активации и использованию API JavaScript. Дополнительные сведения см. в статье [Ограничения для активации и API JavaScript для надстроек Outlook](../outlook/limits-for-activation-and-javascript-api-for-outlook-add-ins.md).</span><span class="sxs-lookup"><span data-stu-id="0487a-p137">Other than resource usage rules, developers for Outlook add-ins should also make sure their add-ins observe limits for specifying activation rules and using the JavaScript API. For more information, see [Limits for activation and JavaScript API for Outlook add-ins](../outlook/limits-for-activation-and-javascript-api-for-outlook-add-ins.md).</span></span>

## <a name="it-administrators-control"></a><span data-ttu-id="0487a-273">Полномочия ИТ-администраторов</span><span class="sxs-lookup"><span data-stu-id="0487a-273">IT administrators' control</span></span>

<span data-ttu-id="0487a-274">В корпоративной среде ИТ-администраторы обладают высшими полномочиями в том, что касается предоставления или запрета доступа к AppSource и каким-либо частным каталогам.</span><span class="sxs-lookup"><span data-stu-id="0487a-274">In a corporate setting, IT administrators have ultimate authority over enabling or disabling access to AppSource and any private catalogs.</span></span>

<span data-ttu-id="0487a-275">Управление параметрами Office и их внедрение выполняется с помощью параметров групповой политики.</span><span class="sxs-lookup"><span data-stu-id="0487a-275">The management and enforcement of Office settings is done with group policy settings.</span></span> <span data-ttu-id="0487a-276">Указанные ниже параметры настраиваются с помощью [средства развертывания Office](/deployoffice/overview-of-the-office-2016-deployment-tool) совместно с [центром развертывания Office](/deployoffice/overview-of-the-office-customization-tool-for-click-to-run).</span><span class="sxs-lookup"><span data-stu-id="0487a-276">These are configurable through the [Office Deployment Tool](/deployoffice/overview-of-the-office-2016-deployment-tool), in conjunction with the [Office Customization Tool](/deployoffice/overview-of-the-office-customization-tool-for-click-to-run).</span></span>

| <span data-ttu-id="0487a-277">Имя параметра</span><span class="sxs-lookup"><span data-stu-id="0487a-277">Setting name</span></span> | <span data-ttu-id="0487a-278">Описание</span><span class="sxs-lookup"><span data-stu-id="0487a-278">Description</span></span> |
|--------------|-------------|
| <span data-ttu-id="0487a-279">Разрешить небезопасные веб-надстройки и каталоги</span><span class="sxs-lookup"><span data-stu-id="0487a-279">Allow Unsecure web add-ins and Catalogs</span></span> | <span data-ttu-id="0487a-280">Разрешает пользователям запускать небезопасные надстройки. Это надстройки с расположениями на веб-страницах или в каталоге без SSL-шифрования (https://), не находящиеся в зонах Интернета пользователей.</span><span class="sxs-lookup"><span data-stu-id="0487a-280">Allows users to run non-secure add-ins, which are add-ins that have webpage or catalog locations that are not SSL-secured (https://) and are not in users' Internet zones.</span></span> |
| <span data-ttu-id="0487a-281">Блокировать веб-надстройки</span><span class="sxs-lookup"><span data-stu-id="0487a-281">Block Web Add-ins</span></span> | <span data-ttu-id="0487a-282">Позволяет запрещать пользователям применение веб-надстроек.</span><span class="sxs-lookup"><span data-stu-id="0487a-282">Allows you to prevent users from using web add-ins.</span></span> |
| <span data-ttu-id="0487a-283">Заблокировать Магазин Office</span><span class="sxs-lookup"><span data-stu-id="0487a-283">Block the Office Store</span></span> |  <span data-ttu-id="0487a-284">Позволяет запрещать пользователям применение или вставку веб-настроек из Магазина Office.</span><span class="sxs-lookup"><span data-stu-id="0487a-284">Allows you to prevent users from using or inserting web add-ins that come from the Office Store.</span></span> |

> [!IMPORTANT]
> <span data-ttu-id="0487a-285">Если в рабочих группах используется несколько выпусков Office, для каждого выпуска нужно настроить параметры групповой политики.</span><span class="sxs-lookup"><span data-stu-id="0487a-285">If your working groups are using multiple releases of Office, group policy settings must be configured for each release.</span></span> <span data-ttu-id="0487a-286">Подробные сведения о параметрах групповой политики для Office 2013 см. в разделе [Использование групповой политики для управления возможностью установки и использования пользователями приложений для Office](/previous-versions/office/office-2013-resource-kit/jj219429(v=office.15)#using-group-policy-to-manage-how-users-can-install-and-use-apps-for-office) статьи [Обзор приложений для Office 2013](/previous-versions/office/office-2013-resource-kit/jj219429(v%3doffice.15))</span><span class="sxs-lookup"><span data-stu-id="0487a-286">Please refer to the [Using Group Policy to manage how users can install and use apps for Office](/previous-versions/office/office-2013-resource-kit/jj219429(v=office.15)#using-group-policy-to-manage-how-users-can-install-and-use-apps-for-office) of the [Overview of apps for Office 2013](/previous-versions/office/office-2013-resource-kit/jj219429(v%3doffice.15)) article for details on group policy settings for Office 2013.</span></span>

## <a name="see-also"></a><span data-ttu-id="0487a-287">См. также</span><span class="sxs-lookup"><span data-stu-id="0487a-287">See also</span></span>

- [<span data-ttu-id="0487a-288">Запрос разрешений на использование API в надстройках</span><span class="sxs-lookup"><span data-stu-id="0487a-288">Requesting permissions for API use in add-ins</span></span>](../develop/requesting-permissions-for-api-use-in-content-and-task-pane-add-ins.md)
- [<span data-ttu-id="0487a-289">Конфиденциальность, разрешения и безопасность для надстроек Outlook</span><span class="sxs-lookup"><span data-stu-id="0487a-289">Privacy, permissions, and security for Outlook add-ins</span></span>](../outlook/privacy-and-security.md)
- [<span data-ttu-id="0487a-290">Общие сведения о разрешениях для надстройки Outlook</span><span class="sxs-lookup"><span data-stu-id="0487a-290">Understanding Outlook add-in permissions</span></span>](../outlook/understanding-outlook-add-in-permissions.md)
- [<span data-ttu-id="0487a-291">Ограничения активации и API JavaScript для надстроек Outlook</span><span class="sxs-lookup"><span data-stu-id="0487a-291">Limits for activation and JavaScript API for Outlook add-ins</span></span>](../outlook/limits-for-activation-and-javascript-api-for-outlook-add-ins.md)
- [<span data-ttu-id="0487a-292">Работа с ограничениями по принципу одинакового источника в надстройках Office</span><span class="sxs-lookup"><span data-stu-id="0487a-292">Addressing same-origin policy limitations in Office Add-ins</span></span>](../develop/addressing-same-origin-policy-limitations.md)
- [<span data-ttu-id="0487a-293">Принцип одинакового источника</span><span class="sxs-lookup"><span data-stu-id="0487a-293">Same Origin Policy</span></span>](https://www.w3.org/Security/wiki/Same_Origin_Policy)
- [<span data-ttu-id="0487a-294">Принцип одинакового источника. Часть 1. Без просмотра</span><span class="sxs-lookup"><span data-stu-id="0487a-294">Same Origin Policy Part 1: No Peeking</span></span>](/archive/blogs/ieinternals/same-origin-policy-part-1-no-peeking)
- [<span data-ttu-id="0487a-295">Принцип одинакового источника для JavaScript</span><span class="sxs-lookup"><span data-stu-id="0487a-295">Same origin policy for JavaScript</span></span>](https://developer.mozilla.org/docs/Web/Security/Same-origin_policy)
- [<span data-ttu-id="0487a-296">Защищенный режим Internet Explorer</span><span class="sxs-lookup"><span data-stu-id="0487a-296">IE Protect Mode</span></span>](https://support.microsoft.com/help/2761180/apps-for-office-don-t-start-if-you-disable-protected-mode-for-the-restricted-sites-zone-in-internet-explorer)
- [<span data-ttu-id="0487a-297">Элементы управления конфиденциальностью для приложений Microsoft 365</span><span class="sxs-lookup"><span data-stu-id="0487a-297">Privacy controls for Microsoft 365 Apps</span></span>](/deployoffice/privacy/overview-privacy-controls)
