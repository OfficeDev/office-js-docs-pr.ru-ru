---
title: Размещение надстройки Office в Microsoft Azure | Microsoft Docs
description: Узнайте о том, как развертывать веб-приложение надстройки в Azure и загружать неопубликованную надстройку для тестирования в клиентском приложении Office.
ms.date: 01/25/2018
ms.openlocfilehash: 32560fdd0655fbba937140152f16cc91c2185411
ms.sourcegitcommit: eb74e94d3e1bc1930a9c6582a0a99355d0da34f2
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/25/2018
ms.locfileid: "25005003"
---
# <a name="host-an-office-add-in-on-microsoft-azure"></a>Размещение надстройки Office в Microsoft Azure

Самая простая надстройка Office состоит из XML-файла манифеста и HTML-страницы. В XML-файле манифеста описаны характеристики надстройки, например ее имя, сведения о том, в каких клиентах Office можно запускать надстройку, а также URL-адрес HTML-страницы надстройки. HTML-страница содержится в веб-приложении, с которым пользователь взаимодействует, когда устанавливает и запускает надстройку в клиентском приложении Office. Вы можете разместить веб-приложение надстройки Office на любой платформе веб-хостинга, включая Azure.

В этой статье описано, как развернуть веб-приложение надстройки в Azure и [загрузить неопубликованную надстройку](../testing/create-a-network-shared-folder-catalog-for-task-pane-and-content-add-ins.md) для тестирования в клиентском приложении Office.

## <a name="prerequisites"></a>Необходимые компоненты 

1. Установите [Visual Studio 2017](https://www.visualstudio.com/downloads) и не забудьте включить рабочую нагрузку **Разработка для Azure**.

    > [!NOTE]
    > Если Visual Studio 2017 уже установлен, убедитесь, что рабочая нагрузка **Разработка для Azure** установлена, [используя установщик Visual Studio](https://docs.microsoft.com/visualstudio/install/modify-visual-studio). 

2. Установите Office 
    
    > [!NOTE]
    > Если у вас еще нет Office, вы можете [оформить бесплатную пробную подписку на 1 месяц](https://products.office.com/en-US/try?legRedir=true&WT.intid1=ODC_ENUS_FX101785584_XT104056786&CorrelationId=64c762de-7a97-4dd1-bb96-e231d7485735).

3.  Оформите подписку на Azure.
    
    > [!NOTE]
    > Если у вас еще нет подписки на Azure, вы можете [получить ее в рамках своей подписки на Visual Studio](https://azure.microsoft.com/en-us/pricing/member-offers/visual-studio-subscriptions/) или [зарегистрироваться для работы с бесплатной пробной версией](https://azure.microsoft.com/pricing/free-trial). 

## <a name="step-1-create-a-shared-folder-to-host-your-add-in-xml-manifest-file"></a>Шаг 1. Создание общей папки для размещения XML-файла манифеста надстройки

1. Откройте проводник на своем компьютере разработчика.
    
2. Щелкните диск C: правой кнопкой мыши и выберите пункты **Создать** > **Папку**.
    
3. Назовите новую папку AddinManifests.
    
4. Щелкните папку AddinManifests правой кнопкой мыши и выберите пункты **Общий доступ** > **Конкретные пользователи...**.
    
5. В окне **Общий доступ к файлам** щелкните стрелку раскрывающегося списка и выберите **Все** > **Добавить** > **Общий доступ**.
    
> [!NOTE]
> В этом руководстве для хранения XML-файла манифеста надстройки используется общая локальная папка. Для решения практических задач вы можете [развернуть XML-файл манифеста в каталоге SharePoint](../publish/publish-task-pane-and-content-add-ins-to-an-add-in-catalog.md) или [опубликовать надстройку в AppSource](https://docs.microsoft.com/office/dev/store/submit-to-the-office-store).

## <a name="step-2-add-the-file-share-to-the-trusted-add-ins-catalog"></a>Шаг 2. Добавление общей папки в доверенный каталог надстроек

1.  Запустите Word и создайте документ.

    > [!NOTE]
    > Несмотря на то, что в данном примере используется Word, вы можете использовать любое приложение Office, поддерживающее надстройки Office, например, Excel, Outlook, PowerPoint или Project.
    
2.  Щелкните **Файл**  >  **Параметры**.
    
3.  В диалоговом окне **Параметры Word** щелкните **Центр управления безопасностью**, а затем — **Параметры центра управления безопасностью**. 
    
4.  В диалоговом окне **Trust Center** выберите **Доверенные каталоги надстроек**. Введите UNC-путь для файлового ресурса, который вы создали ранее, в виде **URL-адреса каталога** (например, \\\YourMachineName\AddinManifests), а затем щелкните **Добавить каталог**. 
    
5. Установите флажок **Показывать в меню**. 

    > [!NOTE]
    > Когда XML-файл манифеста надстройки хранится в доверенном каталоге веб-надстроек, надстройка отображается в разделе **Общая папка** в диалоговом окне **Надстройки Office** (**Вставка** > **Мои надстройки**).

6. Закройте Word.

## <a name="step-3-create-a-web-app-in-azure"></a>Шаг 3. Создание веб-приложение в Azure

Создайте пустое веб-приложение в Azure, используя [Visual Studio 2017](../publish/host-an-office-add-in-on-microsoft-azure.md#using-visual-studio-2017) или [портал Azure](../publish/host-an-office-add-in-on-microsoft-azure.md#using-the-azure-portal).

### <a name="using-visual-studio-2017"></a>Использование Visual Studio 2017

Чтобы создать веб-приложение с помощью Visual Studio 2017, выполните указанные ниже действия.

1. В Visual Studio в меню **Вид** меню выберите **обозреватель серверов**. Щелкните правой кнопкой мыши **Azure** и выберите пункт **Подключиться к подписке Microsoft Azure**. Чтобы подключиться к своей подписке Azure, выполните указанные ниже действия.
    
2. В Visual Studio в **обозревателе серверов** разверните пункт **Azure**, щелкните правой кнопкой мыши **Служба приложений** и выберите пункт **Создать службу приложений**.
    
3. В диалоговом окне **Создание службы приложений** укажите перечисленные ниже сведения.
    
      - Введите уникальное **имя веб-приложения** для своего сайта. Azure проверит уникальность имени сайта в домене azurewebsites.net.

      - Выберите **подписку**, которую необходимо использовать для создания сайта.

      - Выберите **группу ресурсов** для своего сайта. Если вы создадите группу, вам потребуется присвоить ей имя.
    
      - Выберите **план службы приложений**, который необходимо использовать для создания сайта. Если вы создадите план, вам потребуется присвоить ему имя.
       
      - Нажмите кнопку **Создать**.

    Новое веб-приложение появится в **обозревателе серверов** в разделе **Azure** >> **Служба приложений** >> (выбранная группа ресурсов).
    
4. Щелкните правой кнопкой мыши новое веб-приложение и выберите пункт **Открыть в браузере**. Откроется браузер, и в нем отобразится веб-страница с сообщением "Ваша служба приложений создана".
    
5. В адресной строке браузера измените URL-адрес веб-приложения так, чтобы он начинался со слова HTTPS, и нажмите клавишу **ВВОД**, чтобы убедиться, что протокол HTTPS включен. 

    > [!IMPORTANT]
    > [!include[HTTPS guidance](../includes/https-guidance.md)] Веб-сайты Azure автоматически предоставляют конечную точку HTTPS.
    
### <a name="using-the-azure-portal"></a>Использование портала Azure

Чтобы создать веб-приложение с помощью портала Azure, выполните указанные ниже действия.

1. Войдите в систему на [портале Azure](https://portal.azure.com/), используя свои учетные данные Azure.
    
2. Щелкните **Создать** > **Интернет и мобильные устройства** > **Веб-приложение**. 

3. В диалоговом окне **Создание веб-приложения** укажите перечисленные ниже сведения.
    
      - Введите уникальное **имя приложения** для своего сайта. Azure проверит уникальность имени сайта в домене azureweb apps.net.

      - Выберите **подписку**, которую необходимо использовать для создания сайта.

      - Выберите **группу ресурсов** для своего сайта. Если вы создадите группу, вам потребуется присвоить ей имя.

      - Выберите **операционную систему** для своего сайта.
    
      - Выберите **план службы приложений**, который необходимо использовать для создания этого сайта. Если вы создадите план, вам потребуется присвоить ему имя.
       
      - Нажмите кнопку **Создать**.

4. Щелкните **Уведомления** (значок с изображением колокольчика, расположенный у верхнего края окна портала Azure) и выберите уведомление **Развертывания успешно выполнены**. Откроется страница **обзора** на портале Azure.

    > [!NOTE]
    > После развертывания сайта уведомление **Выполняется развертывание** сменится уведомлением **Успешные развертывания**.

5. В разделе **Основное** на странице **обзора** сайта на портале Azure выберите URL-адрес, отображаемый в поле **URL-адрес**. Откроется браузер, и в нем отобразится веб-страница с сообщением "Ваша служба приложений создана". 
    
6. В адресной строке браузера измените URL-адрес веб-приложения так, чтобы он начинался со слова HTTPS, и нажмите клавишу **ВВОД**, чтобы убедиться, что протокол HTTPS включен. 

    > [!IMPORTANT]
    > [!include[HTTPS guidance](../includes/https-guidance.md)] Веб-сайты Azure автоматически предоставляют конечную точку HTTPS.

## <a name="step-4-create-an-office-add-in-in-visual-studio"></a>Шаг 4. Создайте надстройку Office в Visual Studio

1. Запустите Visual Studio от имени администратора.
    
2. Щелкните **Файл** > **Создать** > **Проект**.
    
3. В разделе **Шаблоны** разверните пункт **Visual C#** (или **Visual Basic**), затем пункт **Office/SharePoint** и выберите пункт **Надстройки**.
    
4. Выберите пункт **Веб-надстройка Word**, а затем нажмите кнопку **OK**, чтобы принять параметры, используемые по умолчанию.
       
Visual Studio создаст базовую надстройку Word, которую вы можете опубликовать в том виде, в котором она есть, не внося изменений в ее веб-проект.

## <a name="step-5-publish-your-office-add-in-web-app-to-azure"></a>Шаг 5. Публикация веб-приложения надстройки Office в Azure

1. Не закрывая проект вашей надстройки в Visual Studio, разверните узел решения в **обозревателе решений**, чтобы отображались оба проекта для решения.
    
2. Щелкните правой кнопкой мыши веб-проект и выберите пункт **Опубликовать**. Веб-проект содержит файлы веб-приложения надстройки Office, так что это именно тот проект, который вы публикуете в Azure.
    
3. На вкладке **Публикация** выполните указанные ниже действия.

      - Выберите пункт **Служба приложений Microsoft Azure**.
      
      - Щелкните **Выбрать существующую**.

      - Щелкните **Опубликовать**. 

6. В диалоговом окне **Служба приложений** найдите и выберите веб-приложение, которое вы создали на [шаге 3](../publish/host-an-office-add-in-on-microsoft-azure.md#step-3-create-a-web-app-in-azure) и нажмите кнопку **ОК**. 

    Visual Studio опубликует веб-проект надстройки Office в вашем веб-приложении Azure. Когда Visual Studio завершит публикацию веб-проекта, откроется браузер, в котором отобразится веб-страница с текстом "Приложение службы приложений создано". Это текущая страница, используемая по умолчанию, для веб-приложения.

7. Чтобы просмотреть веб-страницу надстройки, измените URL-адрес так, чтобы он использовал HTTPS и задавал путь к HTML-странице надстройки (например: https://YourDomain.azurewebsites.net/Home.html). Этим подтверждается то, что веб-приложение надстройки теперь размещено в Azure. Скопируйте корневой URL-адрес (например, https://YourDomain.azurewebsites.net)). Он потребуется при редактировании файла манифеста надстройки, которое рассматривается далее в этой статье.
    
## <a name="step-6-edit-and-deploy-the-add-in-xml-manifest-file"></a>Шаг 6. Редактирование и развертывание XML-файла манифеста надстройки

1. В Visual Studio (с примером надстройки Office, открытом в **обозревателе решений**) разверните решение так, чтобы отображались оба проекта.
    
2. Разверните проект надстройки Office (например, WordWebAddIn), щелкните правой кнопкой мыши на папке манифеста, а затем нажмите на кнопку **Открыть**. Откроется XML-файл манифеста надстройки.
    
3. В XML-файле манифеста найдите и замените все экземпляры «~remoteAppUrl» корневым URL-адресом веб-приложения надстройки в Azure. Это URL-адрес, который вы скопировали ранее после публикации веб-приложения надстройки в Azure (например, https://YourDomain.azurewebsites.net)). 
    
4. Выберите опцию **Файл**, а затем – **Сохранить все**. Закройте XML-файл манифеста надстройки.
    
5. Вернитесь в **обозреватель решений**, щелкните правой кнопкой мыши папку манифеста и выберите пункт **Открыть папку в проводнике**.
    
6. Скопируйте XML-файл манифеста надстройки (например, WordWebAddIn.xml). 
    
7. Откройте сетевой файловый ресурс, который вы создали в [действии 1 "Создание общей папки"](../publish/host-an-office-add-in-on-microsoft-azure.md#step-1-create-a-shared-folder-to-host-your-add-in-xml-manifest-file) и вставьте файл манифеста в папку.

## <a name="step-7-insert-and-run-the-add-in-in-the-office-client-application"></a>Шаг 7. Вставка и запуск надстройки в клиентском приложении Office

1. Запустите Word и создайте документ.
    
2. На ленте щелкните **Вставка** > **Мои надстройки**. 
    
3. В диалоговом окне **Надстройки Office** выберите **ОБЩАЯ ПАПКА**. Word выполнит сканирование папки, которую вы указали в качестве надежного каталога надстроек (в [действии 2 "Добавление файлового ресурса в надежный каталог надстроек"](../publish/host-an-office-add-in-on-microsoft-azure.md#step-2-add-the-file-share-to-the-trusted-add-ins-catalog)) и отобразит надстройки в диалоговом окне. Должен отобразиться значок для вашего примера надстройки.
    
4. Щелкните значок своей надстройки и нажмите кнопку **Добавить**. На ленту будет добавлена кнопка **Показать область задач** для вашей надстройки. 

5. На ленте вкладки **Главная** нажмите кнопку **Показать область задач**. Надстройка откроется в области задач справа от текущего документа.
    
6. Убедитесь, что надстройка работает, выбрав любой текст в документе и нажав кнопку **Highlight!** (Выделить!) в области задач. 

## <a name="see-also"></a>См. также

- [Публикация надстройки Office](../publish/publish.md)
- [Упаковка надстройки с помощью Visual Studio для публикации](../publish/package-your-add-in-using-visual-studio.md)
    
