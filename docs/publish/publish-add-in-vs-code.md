---
title: Публикация надстройки с Visual Studio Code Azure
description: Публикация надстройки с помощью Visual Studio Code и Azure Active Directory
ms.date: 02/22/2022
ms.localizationpriority: medium
ms.openlocfilehash: 1559c74493a511bb964fd43159069c1e9e78365e
ms.sourcegitcommit: 8f7d84c33c61c9f724f956740ced01a83f62ddc6
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/01/2022
ms.locfileid: "64605523"
---
# <a name="publish-an-add-in-developed-with-visual-studio-code"></a>Публикация надстройки, разработанной с помощью Visual Studio Code

В этой статье описано, как опубликовать надстройку Office, созданную с помощью генератора Yeoman и разработанную в [Visual Studio Code (VS Code)](https://code.visualstudio.com) или любом другом редакторе.

> [!NOTE]
> Сведения о публикации надстройки Office, созданной с помощью Visual Studio, см. в статье [Публикация надстройки с помощью Visual Studio](package-your-add-in-using-visual-studio.md).

## <a name="publishing-an-add-in-for-other-users-to-access"></a>Публикация надстройки для доступа других пользователей

Надстройка Office состоит из веб-приложения и файла манифеста. Веб-приложение определяет пользовательский интерфейс и функции надстройки, а манифест указывает расположение веб-приложения и определяет параметры и возможности надстройки.

Пока вы разрабатываете, надстройку можно запустить на локальном веб-сервере (`localhost`). Когда вы будете готовы опубликовать его для доступа других пользователей, вам потребуется развернуть веб-приложение и обновить манифест, чтобы указать URL-адрес развернутого приложения.

Если надстройка работает в нужном случае, ее можно опубликовать непосредственно Visual Studio Code с помощью служба хранилища Azure расширения.

## <a name="using-visual-studio-code-to-publish"></a>Использование Visual Studio Code для публикации

>[!NOTE]
> Эти действия работают только для проектов, созданных с генератором Yeoman.

1. Откройте проект из корневой папки в Visual Studio Code (VS Code).
2. В представлении Extensions в VS Code поиск расширения служба хранилища Azure и установите его.
3. После установки значок Azure добавляется в планку действий. Выберите его для доступа к расширению. Если ваш план действий скрыт, вы не сможете получить доступ к расширению. Покажите планку действий, выбрав **> Внешний вид > Show Activity Bar**.
4. Во время расширения впишитесь в свою учетную запись Azure, выбрав **вход в Azure**. Вы также можете создать учетную запись Azure, если ее еще нет, выбрав **создать бесплатную учетную запись Azure**. Выполните предусмотренные действия по настройкам учетной записи.
5. После того как вы зайду на учетную запись Azure, вы увидите, как в расширении отображаются учетные записи хранилища Azure. Если у вас еще нет учетной записи хранилища, создайте ее с помощью параметра **Create служба хранилища учетной** записи в палитре команд. Назови свою учетную запись хранилища уникальным глобально, используя только "a-z" и "0-9". Обратите внимание, что по умолчанию это создает учетную запись хранилища и группу ресурсов с тем же именем. Он автоматически помещает учетную запись хранилища в западной части США. Это можно отрегулировать в Интернете с [помощью учетной записи Azure](https://portal.azure.com/).
6. Выберите и удерживайте (правой кнопкой мыши) учетную запись хранилища, выбрав **настраиваемый статичный веб-сайт**. Вам будет предложено ввести имя документа индекса и имя документа 404. Измените имя документа индекса с по умолчанию `index.html` на **`taskpane.html`**. Вы также можете изменить имя документа 404, но не требуется.
7. Выберите и удерживайте (правой кнопкой мыши) хранилище снова, на этот раз выбрав **Обзор статического веб-сайта**. Скопируйте URL-адрес веб-сайта из открываемого окна браузера.
8. В VS Code откройте файл манифеста проекта (`manifest.xml`) и измените ссылки на url-адрес localhost (`https://localhost:3000`например) на скопированные URL-адреса. Эта конечная точка — это статичный URL-адрес веб-сайта для вновь созданной учетной записи хранилища. Сохраните изменения в файле манифеста.
9. Откройте строку командной строки и перейдите в корневой каталог проекта надстройки. Затем запустите следующую команду, чтобы подготовить все файлы для развертывания производства.

    ```command&nbsp;line
    npm run build
    ```

    После завершения сборки папка **dist** в корневом каталоге проекта надстройки будет содержать файлы, разворачиваемые на следующих этапах.

10. Чтобы развернуть, выберите проводник файлов, выберите и удерживайте (правой кнопкой мыши) папку **dist** и выберите Развертывание на статическом **веб-сайте служба хранилища Azure**. При запросе выберите созданную ранее учетную запись хранилища.

    ![Развертывание на статичном веб-сайте.](../images/deploy-to-static-website.png)

11. Когда развертывание завершено, появляется сообщение **"Просмотр** веб-сайта", которое можно выбрать для открытия основной конечной точки развернутого кода приложения.

## <a name="deploy-custom-functions-for-excel"></a>Развертывание настраиваемой функции для Excel

Если у вашей надстройки есть настраиваемые функции, для их добавления в учетную запись служба хранилища Azure действий. Сначала необходимо включить CORS, чтобы Office доступ к файлу functions.json.

1. Щелкните правой кнопкой мыши учетную запись хранилища Azure и выберите **Открыть на портале**.
1. В группе Параметры выберите **общий доступ к ресурсам (CORS)**. Вы также можете использовать поле поиска, чтобы найти это.
1. Создайте новое правило CORS с помощью следующих параметров.

    |Свойство        |Значение                        |
    |----------------|-----------------------------|
    |Разрешенные истоки | \*                          |
    |Разрешенные методы | GET                         |
    |Разрешенные заглавные | \*                          |
    |Открытые заглавные | Access-Control-Allow-Origin |
    |Max age         | 200                         |

1. Выберите **Сохранить**.

> [!CAUTION]
> Эта конфигурация CORS предполагает, что все файлы на сервере общедоступны для всех доменов.  

Далее необходимо добавить тип MIME для JSON-файлов.

1. Создание нового файла в папке /src с **именемweb.config**.
1. Вставьте следующий XML и сохраните файл.

    ```xml
    <?xml version="1.0"?>
    <configuration>
      <system.webServer>
        <staticContent>
          <mimeMap fileExtension=".json" mimeType="application/json" />
        </staticContent>
      </system.webServer>
    </configuration> 
    ```

1. Откройте файл **webpack.config.js**.
1. Добавьте следующий код в список копирования `plugins` web.config в пакет при запуске сборки.

    ```javascript
    new CopyWebpackPlugin({
      patterns: [
      {
        from: "src/web.config",
        to: "src/web.config",
      },
     ],
    }),
    ```

1. Откройте строку командной строки и перейдите в корневой каталог проекта надстройки. Затем запустите следующую команду, чтобы подготовить все файлы к развертыванию.

    ```command&nbsp;line
    npm run build
    ```

    После завершения сборки папка **dist** в корневом каталоге проекта надстройки будет содержать развернутые файлы.

1. Чтобы развернуть, выберите проводник файлов, выберите и удерживайте (правой кнопкой мыши) папку **dist** и выберите Развертывание на статическом **веб-сайте служба хранилища Azure**. При запросе выберите созданную ранее учетную запись хранилища. Если вы уже развернули папку **dist** , вам будет предложено переписать файлы в хранилище Azure с последними изменениями.

## <a name="see-also"></a>См. также

- [Разработка надстроек Office с помощью Visual Studio Code](../develop/develop-add-ins-vscode.md)
- [Развертывание и публикация надстройки Office](../publish/publish.md)
- [Поддержка совместного использования ресурсов (CORS) для служба хранилища Azure](/rest/api/storageservices/cross-origin-resource-sharing--cors--support-for-the-azure-storage-services)
