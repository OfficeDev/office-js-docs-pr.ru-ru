---
title: Публикация надстройки с помощью Visual Studio Code Azure
description: Публикация надстройки с помощью Visual Studio Code Azure Active Directory
ms.date: 08/19/2022
ms.custom: vscode-azure-extension-update-completed
ms.localizationpriority: medium
ms.openlocfilehash: 1c82d62e9f92453839084179d7ef9e0a8e2c8ca3
ms.sourcegitcommit: eef2064d7966db91f8401372dd255a32d76168c2
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/31/2022
ms.locfileid: "67464789"
---
# <a name="publish-an-add-in-developed-with-visual-studio-code"></a>Публикация надстройки, разработанной с помощью Visual Studio Code

В этой статье описано, как опубликовать надстройку Office, созданную с помощью генератора Yeoman и разработанную в [Visual Studio Code (VS Code)](https://code.visualstudio.com) или любом другом редакторе.

> [!NOTE]
> Сведения о публикации надстройки Office, созданной с помощью Visual Studio, см. в статье [Публикация надстройки с помощью Visual Studio](package-your-add-in-using-visual-studio.md).

## <a name="publishing-an-add-in-for-other-users-to-access"></a>Публикация надстройки для доступа других пользователей

Надстройка Office состоит из веб-приложения и файла манифеста. Веб-приложение определяет пользовательский интерфейс и функции надстройки, а манифест указывает расположение веб-приложения и определяет параметры и возможности надстройки.

Во время разработки вы можете запустить надстройку на локальном веб-сервере ().`localhost` Когда вы будете готовы опубликовать его для доступа других пользователей, необходимо развернуть веб-приложение и обновить манифест, указав URL-адрес развернутого приложения.

Если надстройка работает должным образом, ее можно опубликовать непосредственно через Visual Studio Code с помощью расширения службы хранилища Azure.

## <a name="using-visual-studio-code-to-publish"></a>Использование Visual Studio Code для публикации

>[!NOTE]
> Эти действия работают только для проектов, созданных с помощью генератора Yeoman.

1. Откройте проект из корневой папки в Visual Studio Code (VS Code).
2. В представлении "Расширения" в VS Code найдите расширение службы хранилища Azure и установите его.
3. После установки на панель действий добавляется значок Azure. Выберите его, чтобы получить доступ к расширению. Если панель действий скрыта, вы не сможете получить доступ к расширению. Чтобы отобразить панель действий, выберите "> **", > панели действий**.
4. Запустите расширение и выберите **"Войти в Azure"** , чтобы войти в учетную запись Azure. Если у вас еще нет учетной записи Azure, создайте ее, выбрав **"Создать учетную запись Azure"**. Выполните указанные действия, чтобы настроить учетную запись.
5. После входа вы увидите, что учетные записи хранения Azure отображаются в расширении. Если у вас еще нет учетной записи хранения, создайте ее с помощью параметра **"** Создать учетную запись хранения" в палитре команд. Приведите учетной записи хранения глобально уникальное имя, используя только "a-z" и "0-9". Обратите внимание, что по умолчанию создается учетная запись хранения и группа ресурсов с тем же именем. Учетная запись хранения автоматически помещается в регион "Западная часть США". Это можно настроить в интернете с [помощью учетной записи Azure](https://portal.azure.com/).
6. Выберите и удерживайте (щелкните правой кнопкой мыши) учетную запись хранения и выберите **"Настроить статический веб-сайт"**. Вам будет предложено ввести имя документа индекса и имя документа 404. Измените имя документа индекса с имени по умолчанию на `index.html` **`taskpane.html`**.. Вы также можете изменить имя документа 404, но это не обязательно.
7. Снова выберите и удерживайте (щелкните правой кнопкой мыши) хранилище, и на этот раз выберите " **Обзор статического веб-сайта"**. В открываемом окне браузера скопируйте URL-адрес веб-сайта.
8. В VS Code откройте файл манифеста проекта (`manifest.xml`) и измените любую ссылку на URL-адрес localhost ( `https://localhost:3000`например) на скопированный URL-адрес. Эта конечная точка является URL-адресом статического веб-сайта для созданной учетной записи хранения. Сохраните изменения в файле манифеста.
9. Откройте командную строку и перейдите в корневой каталог проекта надстройки. Затем выполните следующую команду, чтобы подготовить все файлы к рабочему развертыванию.

    ```command&nbsp;line
    npm run build
    ```

    После завершения сборки папка **dist** в корневом каталоге проекта надстройки будет содержать файлы, разворачиваемые на следующих этапах.

10. Для развертывания выберите проводник, выберите и удерживайте (щелкните правой кнопкой мыши) папку **dist** и выберите "Развернуть на статический веб-сайт **" через службу хранилища Azure**. При появлении запроса выберите учетную запись хранения, созданную ранее.

    :::image type="content" source="../images/deploy-to-static-website.png" alt-text="Выберите папку dist, щелкните правой кнопкой мыши и выберите пункт &quot;Развернуть на статический веб-сайт&quot; через службу хранилища Azure.":::

11. После завершения развертывания щелкните правой кнопкой мыши созданную ранее учетную запись хранения и выберите пункт **"Обзор статического веб-сайта"**. Откроется статический веб-сайт и отобразится область задач.

## <a name="deploy-custom-functions-for-excel"></a>Развертывание пользовательских функций для Excel

Если у надстройки есть пользовательские функции, выполните еще несколько действий, чтобы включить их в учетной записи хранения Azure. Сначала включите CORS, чтобы Office могли получить доступ к файлу functions.json.

1. Щелкните правой кнопкой мыши учетную запись хранения Azure и выберите команду **"Открыть на портале"**.
1. В группе "Параметры" выберите " **Общий доступ к ресурсам (CORS)"**. Вы также можете найти его с помощью поля поиска.
1. Создайте правило CORS со следующими параметрами.

    |Свойство        |Значение                        |
    |----------------|-----------------------------|
    |Разрешенные исходные объекты | \*                          |
    |Допустимые методы | GET                         |
    |Разрешенные заголовки | \*                          |
    |Предоставленные заголовки | Access-Control-Allow-Origin |
    |Максимальный возраст         | 200                         |

1. Выберите **Сохранить**.

> [!CAUTION]
> В этой конфигурации CORS предполагается, что все файлы на сервере общедоступны для всех доменов.  

Затем добавьте тип MIME для JSON-файлов.

1. Создайте файл в папке /src с **именемweb.config**.
1. Вставьте следующий XML-код и сохраните файл.

    ```xml
    <?xml version="1.0"?>
    <configuration>
      <system.webServer>
        <staticContent>
          <mimeMap fileExtension=".json" mimeType="application/json" />
        </staticContent>
      </system.webServer>
    </configuration> 
    ```

1. Откройте файл **webpack.config.js**.
1. Добавьте следующий код в список, чтобы `plugins` скопировать web.config в пакет при выполнении сборки.

    ```javascript
    new CopyWebpackPlugin({
      patterns: [
      {
        from: "src/web.config",
        to: "src/web.config",
      },
     ],
    }),
    ```

1. Откройте командную строку и перейдите в корневой каталог проекта надстройки. Затем выполните следующую команду, чтобы подготовить все файлы к развертыванию.

    ```command&nbsp;line
    npm run build
    ```

    После завершения сборки папка **dist** в корневом каталоге проекта надстройки будет содержать развернутые файлы.

1. Для развертывания в проводник выберите и **удерживайте** (или щелкните правой кнопкой мыши) папку **dist** и выберите команду "Развернуть на статический веб-сайт" с помощью **службы хранилища Azure**. При появлении запроса выберите учетную запись хранения, созданную ранее. Если вы уже развернули папку **dist** , вам будет предложено перезаписать файлы в службе хранилища Azure последними изменениями.

## <a name="see-also"></a>См. также

- [Разработка надстроек Office с помощью Visual Studio Code](../develop/develop-add-ins-vscode.md)
- [Развертывание и публикация надстройки Office](../publish/publish.md)
- [Поддержка общего доступа к ресурсам независимо от источника (CORS) для службы хранилища Azure](/rest/api/storageservices/cross-origin-resource-sharing--cors--support-for-the-azure-storage-services)
