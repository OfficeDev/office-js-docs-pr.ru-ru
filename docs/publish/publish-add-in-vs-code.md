---
title: Публикация надстройки с Visual Studio Code Azure
description: Публикация надстройки с помощью Visual Studio Code Azure Active Directory
ms.date: 08/12/2020
localization_priority: Normal
ms.openlocfilehash: ab8daf3dfb87c809cd812da45246ce2d5ca9e743
ms.sourcegitcommit: ee9e92a968e4ad23f1e371f00d4888e4203ab772
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/23/2021
ms.locfileid: "53076940"
---
# <a name="publish-an-add-in-developed-with-visual-studio-code"></a><span data-ttu-id="3f862-103">Публикация надстройки, разработанной с помощью Visual Studio Code</span><span class="sxs-lookup"><span data-stu-id="3f862-103">Publish an add-in developed with Visual Studio Code</span></span>

<span data-ttu-id="3f862-104">В этой статье описано, как опубликовать надстройку Office, созданную с помощью генератора Yeoman и разработанную в [Visual Studio Code (VS Code)](https://code.visualstudio.com) или любом другом редакторе.</span><span class="sxs-lookup"><span data-stu-id="3f862-104">This article describes how to publish an Office Add-in that you created using the Yeoman generator and developed with [Visual Studio Code (VS Code)](https://code.visualstudio.com) or any other editor.</span></span>

> [!NOTE]
> <span data-ttu-id="3f862-105">Сведения о публикации надстройки Office, созданной с помощью Visual Studio, см. в статье [Публикация надстройки с помощью Visual Studio](package-your-add-in-using-visual-studio.md).</span><span class="sxs-lookup"><span data-stu-id="3f862-105">For information about publishing an Office Add-in that you created using Visual Studio, see [Publish your add-in using Visual Studio](package-your-add-in-using-visual-studio.md).</span></span>

## <a name="publishing-an-add-in-for-other-users-to-access"></a><span data-ttu-id="3f862-106">Публикация надстройки для доступа других пользователей</span><span class="sxs-lookup"><span data-stu-id="3f862-106">Publishing an add-in for other users to access</span></span>

<span data-ttu-id="3f862-107">Надстройка Office состоит из веб-приложения и файла манифеста.</span><span class="sxs-lookup"><span data-stu-id="3f862-107">An Office Add-in consists of a web application and a manifest file.</span></span> <span data-ttu-id="3f862-108">Веб-приложение определяет пользовательский интерфейс и функции надстройки, а манифест указывает расположение веб-приложения и определяет параметры и возможности надстройки.</span><span class="sxs-lookup"><span data-stu-id="3f862-108">The web application defines the add-in's user interface and functionality, while the manifest specifies the location of the web application and defines settings and capabilities of the add-in.</span></span>

<span data-ttu-id="3f862-109">Пока вы разрабатываете, надстройку можно запустить на локальном веб-сервере ( `localhost` ).</span><span class="sxs-lookup"><span data-stu-id="3f862-109">While you're developing, you can run the add-in on your local web server (`localhost`).</span></span> <span data-ttu-id="3f862-110">Когда вы будете готовы опубликовать его для доступа других пользователей, вам потребуется развернуть веб-приложение и обновить манифест, чтобы указать URL-адрес развернутого приложения.</span><span class="sxs-lookup"><span data-stu-id="3f862-110">When you're ready to publish it for other users to access, you'll need to deploy the web application and update the manifest to specify the URL of the deployed application.</span></span>

<span data-ttu-id="3f862-111">Если надстройка работает по желанию, ее можно опубликовать непосредственно Visual Studio Code с помощью служба хранилища Azure расширения.</span><span class="sxs-lookup"><span data-stu-id="3f862-111">When your add-in is working as desired, you can publish it directly through Visual Studio Code using the Azure Storage extension.</span></span>

## <a name="using-visual-studio-code-to-publish"></a><span data-ttu-id="3f862-112">Использование Visual Studio Code для публикации</span><span class="sxs-lookup"><span data-stu-id="3f862-112">Using Visual Studio Code to publish</span></span>

>[!NOTE]
> <span data-ttu-id="3f862-113">Эти действия работают только для проектов, созданных с генератором Yeoman.</span><span class="sxs-lookup"><span data-stu-id="3f862-113">These steps only work for projects created with the Yeoman generator.</span></span>

1. <span data-ttu-id="3f862-114">Откройте проект из корневой папки в Visual Studio Code (VS Code).</span><span class="sxs-lookup"><span data-stu-id="3f862-114">Open your project from its root folder in Visual Studio Code (VS Code).</span></span>
2. <span data-ttu-id="3f862-115">В представлении Extensions в VS Code поиск расширения служба хранилища Azure и установите его.</span><span class="sxs-lookup"><span data-stu-id="3f862-115">From the Extensions view in VS Code, search for the Azure Storage extension and install it.</span></span>
3. <span data-ttu-id="3f862-116">После установки значок Azure добавляется в планку действий.</span><span class="sxs-lookup"><span data-stu-id="3f862-116">Once installed, an Azure icon is added to the Activity Bar.</span></span> <span data-ttu-id="3f862-117">Выберите его для доступа к расширению.</span><span class="sxs-lookup"><span data-stu-id="3f862-117">Select it to access the extension.</span></span> <span data-ttu-id="3f862-118">Если ваш план действий скрыт, вы не сможете получить доступ к расширению.</span><span class="sxs-lookup"><span data-stu-id="3f862-118">If your Activity Bar is hidden, you won't be able to access the extension.</span></span> <span data-ttu-id="3f862-119">Покажите планку действий, выбрав > **Appearance > Show Activity Bar**.</span><span class="sxs-lookup"><span data-stu-id="3f862-119">Show the Activity Bar by selecting **View > Appearance > Show Activity Bar**.</span></span>
4. <span data-ttu-id="3f862-120">Во время расширения впишитесь в свою учетную запись Azure, выбрав **вход в Azure.**</span><span class="sxs-lookup"><span data-stu-id="3f862-120">When in the extension, sign in to your Azure account by selecting **Sign in to Azure**.</span></span> <span data-ttu-id="3f862-121">Вы также можете создать учетную запись Azure, если у вас еще нет ее, выбрав **создать бесплатную учетную** запись Azure.</span><span class="sxs-lookup"><span data-stu-id="3f862-121">You can also create an Azure account if you don't already have one by selecting **Create a free Azure account**.</span></span> <span data-ttu-id="3f862-122">Выполните предусмотренные действия по настройкам учетной записи.</span><span class="sxs-lookup"><span data-stu-id="3f862-122">Follow the provided steps to set up your account.</span></span>
5. <span data-ttu-id="3f862-123">После того как вы зайду на учетную запись Azure, вы увидите, как в расширении отображаются учетные записи хранилища Azure.</span><span class="sxs-lookup"><span data-stu-id="3f862-123">Once you have signed in to your Azure account, you'll see your Azure storage accounts appear in the extension.</span></span> <span data-ttu-id="3f862-124">Если у вас еще нет учетной записи хранилища, необходимо создать ее с помощью параметра **Создать новую учетную запись** хранилища.</span><span class="sxs-lookup"><span data-stu-id="3f862-124">If you don't already have a storage account, you'll need to create one using the **Create new storage account** option.</span></span> <span data-ttu-id="3f862-125">Назови свою учетную запись хранилища уникальным глобально, используя только "a-z" и "0-9".</span><span class="sxs-lookup"><span data-stu-id="3f862-125">Name your storage account a globally unique name, using only 'a-z' and '0-9'.</span></span> <span data-ttu-id="3f862-126">Обратите внимание, что по умолчанию это создает учетную запись хранилища и группу ресурсов с тем же именем.</span><span class="sxs-lookup"><span data-stu-id="3f862-126">Note that by default, this creates a storage account and a resource group with the same name.</span></span> <span data-ttu-id="3f862-127">Он автоматически помещает учетную запись хранилища в западной части США.</span><span class="sxs-lookup"><span data-stu-id="3f862-127">It automatically puts the storage account in West US.</span></span> <span data-ttu-id="3f862-128">Это может быть скорректировано в Интернете с [помощью учетной записи Azure.](https://portal.azure.com/)</span><span class="sxs-lookup"><span data-stu-id="3f862-128">This can be adjusted online through [your Azure account](https://portal.azure.com/).</span></span>
6. <span data-ttu-id="3f862-129">Выберите и удерживайте (правой кнопкой мыши) учетную запись хранилища, выбрав **статичный веб-сайт Configure.**</span><span class="sxs-lookup"><span data-stu-id="3f862-129">Select and hold (right-click) your storage account, choosing **Configure static website**.</span></span> <span data-ttu-id="3f862-130">Вам будет предложено ввести имя документа индекса и имя документа 404.</span><span class="sxs-lookup"><span data-stu-id="3f862-130">You'll be asked to enter the index document name and the 404 document name.</span></span> <span data-ttu-id="3f862-131">Измените имя документа индекса с по умолчанию `index.html` на **`taskpane.html`** .</span><span class="sxs-lookup"><span data-stu-id="3f862-131">Change the index document name from the default `index.html` to **`taskpane.html`**.</span></span> <span data-ttu-id="3f862-132">Вы также можете изменить имя документа 404, но этого не требуется.</span><span class="sxs-lookup"><span data-stu-id="3f862-132">You may decide to also change the 404 document name but are not required to.</span></span>
7. <span data-ttu-id="3f862-133">Выберите и удерживайте (правой кнопкой мыши) хранилище снова, на этот раз выбрав **статический веб-сайт Просмотр**.</span><span class="sxs-lookup"><span data-stu-id="3f862-133">Select and hold (right-click) your storage again, this time choosing **Browse static website**.</span></span> <span data-ttu-id="3f862-134">В открываемом окне браузера скопируйте URL-адрес веб-сайта.</span><span class="sxs-lookup"><span data-stu-id="3f862-134">From the browser window that opens, copy the website URL.</span></span>
8. <span data-ttu-id="3f862-135">В VS Code откройте файл манифеста проекта () и измените ссылки на url-адрес localhost (например) на скопированные `manifest.xml` `https://localhost:3000` URL-адреса.</span><span class="sxs-lookup"><span data-stu-id="3f862-135">In VS Code, open your project's manifest file (`manifest.xml`) and change any reference to your localhost URL (such as `https://localhost:3000`) to the URL you've copied.</span></span> <span data-ttu-id="3f862-136">Эта конечная точка — это статичный URL-адрес веб-сайта для вновь созданной учетной записи хранилища.</span><span class="sxs-lookup"><span data-stu-id="3f862-136">This endpoint is the static website URL for your newly created storage account.</span></span> <span data-ttu-id="3f862-137">Сохраните изменения в файле манифеста.</span><span class="sxs-lookup"><span data-stu-id="3f862-137">Save the changes to your manifest file.</span></span>
9. <span data-ttu-id="3f862-138">Откройте строку командной строки и перейдите в корневой каталог проекта надстройки.</span><span class="sxs-lookup"><span data-stu-id="3f862-138">Open a command line prompt and navigate to the root directory of your add-in project.</span></span> <span data-ttu-id="3f862-139">Затем запустите следующую команду, чтобы подготовить все файлы для развертывания производства.</span><span class="sxs-lookup"><span data-stu-id="3f862-139">Then run the following command to prepare all files for production deployment.</span></span>

    ```command&nbsp;line
    npm run build
    ```

    <span data-ttu-id="3f862-140">После завершения сборки папка **dist** в корневом каталоге проекта надстройки будет содержать файлы, разворачиваемые на следующих этапах.</span><span class="sxs-lookup"><span data-stu-id="3f862-140">When the build completes, the **dist** folder in the root directory of your add-in project will contain the files that you'll deploy in subsequent steps.</span></span>

10. <span data-ttu-id="3f862-141">Чтобы развернуть, выберите проводник файлов, выберите и удерживайте (правой кнопкой мыши) папку **dist** и выберите **Развертывание на статическом веб-сайте.**</span><span class="sxs-lookup"><span data-stu-id="3f862-141">To deploy, select the Files explorer, select and hold (right-click) your **dist** folder, and choose **Deploy to Static Website**.</span></span> <span data-ttu-id="3f862-142">При запросе выберите созданную ранее учетную запись хранилища.</span><span class="sxs-lookup"><span data-stu-id="3f862-142">When prompted, select the storage account you created previously.</span></span>

![Развертывание на статичном веб-сайте.](../images/deploy-to-static-website.png)

11. <span data-ttu-id="3f862-144">Когда развертывание завершено, появляется сообщение **"Просмотр** веб-сайта", которое можно выбрать для открытия основной конечной точки развернутого кода приложения.</span><span class="sxs-lookup"><span data-stu-id="3f862-144">When deployment is complete, a **Browse to website** message appears which you can select to open the primary endpoint of the deployed app code.</span></span>

## <a name="see-also"></a><span data-ttu-id="3f862-145">См. также</span><span class="sxs-lookup"><span data-stu-id="3f862-145">See also</span></span>

- [<span data-ttu-id="3f862-146">Разработка надстроек Office с помощью Visual Studio Code</span><span class="sxs-lookup"><span data-stu-id="3f862-146">Develop Office Add-ins with Visual Studio Code</span></span>](../develop/develop-add-ins-vscode.md)
- [<span data-ttu-id="3f862-147">Развертывание и публикация надстройки Office</span><span class="sxs-lookup"><span data-stu-id="3f862-147">Deploy and publish your Office Add-in</span></span>](../publish/publish.md)
