---
title: Публикация надстроек Office с помощью централизованного развертывания с помощью центра администрирования Microsoft 365
description: Узнайте, как с помощью централизованного развертывания развертывать внутренние надстройки, а также надстройки, предоставляемые поставщиками программного обеспечения.
ms.date: 07/07/2020
localization_priority: Normal
ms.openlocfilehash: e3f0bca5605d48d7b6c2ead49591546561dadffe
ms.sourcegitcommit: 4a03d8b3f676ee2d91114813cb81bce5da3c8d6b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/22/2020
ms.locfileid: "48175558"
---
# <a name="publish-office-add-ins-using-centralized-deployment-via-the-microsoft-365-admin-center"></a>Публикация надстроек Office с помощью централизованного развертывания с помощью центра администрирования Microsoft 365

Центр администрирования Microsoft 365 позволяет администратору развертывать надстройки Office для пользователей и групп в своей организации. При развертывании с помощью Центра администрирования надстройки становятся доступны в приложениях Office немедленно. Настраивать клиенты не требуется. Используя централизованное развертывание, можно распространять как внутренние надстройки, так и те, что предоставляются независимыми поставщиками программного обеспечения (ISV).

В настоящее время центр администрирования Microsoft 365 поддерживает следующие сценарии.

- Централизованное развертывание новых и обновленных надстроек для отдельных пользователей, групп или организации.
- Развертывание на нескольких клиентских платформах, в том числе Windows, Mac и Интернет. Для Outlook также поддерживается развертывание в iOS и Android. (Тем **не** менее, при установке надстроек Excel, Outlook, Word и PowerPoint на iPad не поддерживается централизованное развертывание для iPad.)
- Развертывание на клиентах на английском и других языках.
- Развертывание надстроек, размещаемых в облаке.
- Развертывание надстроек, размещаемых в брандмауэре.
- Развертывание надстроек AppSource.
- Автоматическая установка надстройки для пользователей при запуске приложения Office.
- Автоматическое удаление надстройки для пользователей, если администратор отключит или удалит ее либо пользователь будет удален из службы Azure Active Directory или группы, в которой была развернута надстройка.

Централизованное развертывание — это рекомендуемый способ развертывания надстроек Office в Организации администратором Microsoft 365 при условии, что организация отвечает всем требованиям для использования централизованного развертывания. Сведения о том, как определить, может ли Организация использовать централизованное развертывание, можно узнать [в статье определение того, работает ли централизованное развертывание надстроек для вашей организации Microsoft 365](/office365/admin/manage/centralized-deployment-of-add-ins).

> [!NOTE]
> В локальной среде без подключения к Microsoft 365, а также для развертывания надстроек SharePoint или надстроек Office, предназначенных для Office 2013, используйте [Каталог приложений SharePoint](publish-task-pane-and-content-add-ins-to-an-add-in-catalog.md). Для развертывания надстроек COM и VSTO используйте ClickOnce или установщик Windows, как описано в статье [Развертывание решения Office](/visualstudio/vsto/deploying-an-office-solution).

## <a name="recommended-approach-for-deploying-office-add-ins"></a>Рекомендуемый подход к развертыванию надстроек Office

Вы можете развертывать надстройки Office поэтапно, чтобы предотвратить возникновение проблем. Рекомендуем такой план:

1. Разверните надстройку для небольшой группы заинтересованных лиц и сотрудников ИТ-отдела. Если развертывание прошло успешно, переходите к этапу 2.

2. Разверните надстройку для большей группы пользователей в предприятии, которые будут работать с надстройкой. Если развертывание прошло успешно, переходите к этапу 3.

3. Разверните надстройку для всех пользователей, которые будут работать с надстройкой.

В зависимости от размера целевой аудитории может потребоваться добавить или убрать этапы этой процедуры.

## <a name="publish-an-office-add-in-via-centralized-deployment"></a>Публикация надстройки Office путем централизованного развертывания

Прежде чем приступать к работе, убедитесь, что ваша организация отвечает всем требованиям для использования централизованного развертывания, как описано в разделе [Определение того, работает ли централизованное развертывание надстроек для вашей организации Microsoft 365](/microsoft-365/admin/manage/centralized-deployment-of-add-ins).

Если организация отвечает всем требованиям, выполните указанные ниже действия, чтобы опубликовать надстройку Office путем централизованного развертывания.

1. Войдите в Microsoft 365 с помощью рабочей или учебной учетной записи.
2. В левом верхнем углу щелкните значок средства запуска приложений и выберите **Администратор**.
3. В меню навигации нажмите **Больше**, а затем выберите **Параметры** > **Службы и надстройки**.
4. Если в верхней части страницы отображается сообщение с сообщением о новом центре администрирования Microsoft 365, выберите сообщение, которое нужно перейти к предварительной версии центра администрирования (см. раздел [о центре администрирования microsoft 365](/microsoft-365/admin/admin-overview/about-the-admin-center)).
5. В верхней части страницы выберите **Развернуть надстройку**.
6. Просмотрев требования, нажмите кнопку **Далее**.
7. На странице **Централизованное развертывание** выберите один из следующих вариантов:

    - **Я хочу добавить надстройку из Магазина Office**.
    - **У меня есть файл манифеста (.xml) на данном устройстве.** Если выбран этот вариант, нажмите кнопку **Обзор**, чтобы найти нужный файл манифеста (XML).
    - **У меня есть URL-адрес для файла манифеста.** Если выбран этот вариант, укажите URL-адрес манифеста в предоставленном поле.

    ![Диалоговое окно создания надстройки в центре администрирования Microsoft 365](../images/new-add-in.png)

8. Если добавляется надстройка из Магазина Office, выберите ее. Вы можете просматривать доступные надстройки по категориям **Рекомендуемое**, **Оценка** и **Имя**. Из Магазина Office можно добавлять только бесплатные надстройки. Добавление платных надстроек сейчас не поддерживается.

    > [!NOTE]
    > Если выбран вариант с Магазином Office, то обновления и улучшения надстройки автоматически предоставляются пользователям без вашего участия.

    ![Выбор диалогового окна надстройки в центре администрирования Microsoft 365](../images/select-an-add-in.png)

9. Нажмите кнопку **Continue (продолжить** ) после просмотра сведений о надстройках, политики конфиденциальности и условий лицензионного соглашения.

    ![Выбранная страница надстройки в центре администрирования Microsoft 365](../images/selected-add-in-admin-center.png)

10. На странице **Назначение пользователей** выберите **все**, **конкретные пользователи/группы**или **только я**. С помощью поля поиска найдите пользователей и группы, для которых нужно развернуть надстройку. Для надстроек Outlook также можно выбрать метод развертывания **fixed**, **Available**или **Optional**.

    ![Управление пользователями, у которых есть метод доступа и развертывания в центре администрирования Microsoft 365](../images/manage-users-deployment-admin-center.png)

    > [!NOTE]
    > Надстройки, использующие [единый вход в систему (SSO)](../develop/sso-in-office-add-ins.md) , будут запрашивать разрешение администратора на действия, указанные в манифесте надстройки.  Если одна и та же служба резервного копирования используется в нескольких надстройках (для единого входа в разных надстройках используется один и тот же идентификатор приложения Azure), то для каждой надстройки будет предлагаться согласие с каждым развертыванием. На этой странице также будет отображаться список разрешений, необходимых для надстройки.

11. По завершении нажмите кнопку **развернуть**. Этот процесс может занять до трех минут. Затем нажмите кнопку **Далее**, чтобы завершить выполнение пошаговых инструкций. Теперь надстройка будет отображаться вместе с другими приложениями в Office 365.

    > [!NOTE]
    > Когда администратор выбирает **развертывание**, согласие предоставляется всем пользователям.

    ![Список приложений в центре администрирования Microsoft 365](../images/citations.png)

> [!TIP]
> При развертывании новой надстройки для пользователей и/или групп в организации рекомендуем отправлять им электронные сообщения с указаниями по использованию надстройки и ссылками на соответствующие разделы справки, часто задаваемые вопросы и другие вспомогательные ресурсы.

## <a name="considerations-when-granting-access-to-an-add-in"></a>Рекомендации по предоставлению доступа к надстройке

Администраторы могут назначить надстройку всем или только определенным пользователям и/или группам в организации. В приведенном ниже списке описываются последствия выбора каждого из вариантов.

- **Все.** Как следует из названия, этот вариант позволяет назначить надстройку всем пользователям в клиенте. Используйте этот вариант с осторожностью и только для надстроек, которые являются действительно универсальными для вашей организации.

- **Пользователи**. Если назначить надстройку отдельным пользователям, вам придется обновлять параметры централизованного развертывания надстройки каждый раз, когда нужно назначить ее дополнительным пользователям. Параметры централизованного развертывания придется обновлять каждый раз, когда нужно запретить пользователю доступ к надстройке.

- **Группы**. Если назначить надстройку группе, члены этой группы автоматически получат доступ к ней. При удалении пользователя из группы он автоматически теряет доступ к надстройке. В любом случае никаких дополнительных действий от администратора Microsoft 365 не нужно.

В общем случае для простоты обслуживания рекомендуем по мере возможности назначать надстройки группам. Однако в тех случаях, когда надстройка должна быть доступна узкому кругу пользователей, может быть практичнее назначить ее определенным пользователям.

## <a name="add-in-states"></a>Состояния надстроек

В приведенной ниже таблице описываются различные состояния надстройки.

|Состояние|Причины|Влияние|
|-----|--------------------|------|
|**Активна**|Администратор отправил надстройку и назначил ее пользователям и/или группам.|Надстройка видна назначенным пользователям и/или группам в соответствующих клиентах Office.|
|**Отключена**|Администратор отключил надстройку.|Надстройка недоступна назначенным пользователям и/или группам. Если состояние **Отключена** надстройки поменялось на **Активна**, то она снова доступна пользователям и группам.|
|**Deleted**|Администратор удалил надстройку.|Надстройка недоступна назначенным пользователям и/или группам.|

## <a name="updating-office-add-ins-that-are-published-via-centralized-deployment"></a>Обновление надстроек Office, опубликованных с использованием централизованного развертывания

После публикации надстройки Office путем централизованного развертывания все изменения, внесенные в веб-приложение надстройки, автоматически становятся доступны всем пользователям сразу после их реализации в веб-приложении. Изменения, внесенные в [XML-файл манифеста](../develop/add-in-manifests.md) надстройки (например, обновление значка, текста или команд надстройки), выполняются следующим образом:

- **Бизнес-надстройка**: если администратор явно отправил файл манифеста при реализации централизованного развертывания с помощью центра администрирования Microsoft 365, администратор должен отправить новый файл манифеста, который содержит нужные изменения. После отправки обновленного файла манифеста надстройка обновится при следующем запуске соответствующего приложения Office.

  > [!NOTE]
  > Администратору не нужно удалять бизнес-надстройку, чтобы выполнить обновление. В разделе надстройки администратор может просто выбрать бизнес-надстройку и вызвать эту функцию, нажав кнопку **обновить надстройку** в правом нижнем углу.
  > 
  > ![На снимке экрана отображается диалоговое окно обновления надстройки в центре администрирования Microsoft 365](../images/update-add-in-admin-center.png)

- **Надстройка магазина Office**: если администратор выбрал надстройку в магазине Office при реализации централизованного развертывания с помощью центра администрирования Microsoft 365 и обновления надстройки в магазине Office, надстройка будет обновлена позже с помощью централизованного развертывания. Надстройка обновится при следующем запуске соответствующего приложения Office.

## <a name="end-user-experience-with-add-ins"></a>Работа пользователей с надстройками

После публикации надстройки с применением централизованного развертывания пользователи могут приступить к работе с ней на любой платформе, которую поддерживает надстройка.

Если в надстройке предусмотрена поддержка команд надстройки, они отображаются на ленте приложения Office для всех пользователей, для которых развернута эта надстройка. В приведенном ниже примере команда **Search Citation** (Поиск ссылки) отображается на ленте для надстройки **Citations** (Ссылки).

![Снимок экрана, на котором показан раздел ленты приложения Office с выделенной в надстройке "ссылки" командой "Поиск ссылок"](../images/search-citation.png)

Если команды надстройки не поддерживаются, пользователи могут добавить надстройку в свое приложение Office, сделав вот что:

1. В Word 2016, Excel 2016 или PowerPoint 2016 либо более поздних версий выберите **Вставка** > **Мои надстройки**.
2. В окне надстройки перейдите на вкладку **Управляемые администратором**.
3. Выберите нужную надстройку и нажмите **Добавить**.

    ![Снимок экрана со вкладкой "Управляемые администратором" на странице "Надстройки Office" в приложении Office. На вкладке показана надстройка Citations (Ссылки).](../images/office-add-ins-admin-managed.png)

Однако в Outlook 2016 или более поздних версий можно сделать вот что:

1. В Outlook выберите **Главная** > **Магазин**.
2. На вкладке надстройки выберите элемент **Управляемые администратором**.
3. Выберите нужную надстройку и нажмите **Добавить**.

    ![Снимок экрана с областью "Управляемые администратором" страницы "Магазин" в приложении Outlook.](../images/outlook-add-ins-admin-managed.png)

## <a name="see-also"></a>См. также

- [Определение работы централизованного развертывания надстроек для вашей организации Microsoft 365](/office365/admin/manage/centralized-deployment-of-add-ins)
