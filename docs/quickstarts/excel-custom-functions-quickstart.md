---
ms.date: 03/06/2019
description: Разработка настраиваемых функций в кратком руководстве по Excel.
title: Краткое руководство по настраиваемым функциям (Предварительная версия)
ms.prod: excel
localization_priority: Normal
ms.openlocfilehash: 80c500e1e30e8751a7d969d33cd7e13b7943b1b5
ms.sourcegitcommit: 9e7b4daa8d76c710b9d9dd4ae2e3c45e8fe07127
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/24/2019
ms.locfileid: "32450843"
---
# <a name="get-started-developing-excel-custom-functions"></a>Приступая к разработке пользовательских функций Excel

С помощью пользовательских функций разработчики могут добавлять новые функции в Excel, определяя их в JavaScript или typescript как часть надстройки. Пользователи Excel могут получить доступ к пользовательским функциям так же, как и к любой собственной `SUM()`функции в Excel, например.

## <a name="prerequisites"></a>Предварительные требования

[!include[Excel custom functions note](../includes/excel-custom-functions-note.md)]

Для создания пользовательских функций потребуются следующие средства и связанные ресурсы.

- [Node.js](https://nodejs.org/en/) (версия 8.0.0 или более поздняя)

- [Git Bash](https://git-scm.com/downloads) (или другой клиент Git)

- Последняя версия [Yeoman](https://yeoman.io/) и [генератора Yeoman для надстроек Office](https://www.npmjs.com/package/generator-office). Выполните в командной строке указанную ниже команду, чтобы установить эти инструменты глобально.

    ```
    npm install -g yo generator-office
    ```

    > [!NOTE]
    > Даже если вы ранее установили генератор Yeoman, рекомендуем обновить его до последней версии из NPM.

## <a name="build-your-first-custom-functions-project"></a>Создание проекта пользовательских функций

Чтобы начать работу, создайте проект пользовательских функций с помощью генератора Yeoman. Это позволит настроить для проекта правильную структуру папок, исходные файлы и зависимости, чтобы начать написание кода пользовательских функций.

1. Выполните указанную ниже команду и ответьте на вопросы, как показано ниже.

    ```
    yo office
    ```

    - Выберите тип проекта: `Excel Custom Functions Add-in project (...)`

    - Выберите тип сценария: `JavaScript`

    - Как вы хотите назвать свою надстройку? `stock-ticker`

    ![Генератор Yeoman для надстройки Office, приглашающий к созданию пользовательских функций](../images/12-10-fork-cf-pic.jpg)

    Генератор Yeoman создаст файлы проекта и установит вспомогательные компоненты Node.

2. Перейдите к только что созданной папке проекта.

    ```
    cd stock-ticker
    ```

3. Доверяете самозаверяющий сертификату, который требуется для запуска этого проекта. Подробные инструкции для Windows или Mac см. в статье [Добавление самозаверяющих сертификатов в качестве доверенных корневых сертификатов](https://github.com/OfficeDev/generator-office/blob/master/src/docs/ssl.md).  

4. Выполните сборку проекта.

    ```
    npm run build
    ```

5. Запустите локальный веб-сервер, работающий на Node.js.

    - Если вы используете Excel для Windows для тестирования пользовательских функций, выполните следующую команду для запуска локального веб-сервера, запуска Excel и Загрузка неопубликованных надстройки:

        ```
         npm run start
        ```
        После выполнения этой команды в командной строки будут отображаться сведения о запуске веб-сервера. Excel начнет работу с загруженной надстройкой. Если надстройка не загружается, проверьте правильность выполнения шага 3.

    - Если вы используете Excel Online для тестирования пользовательских функций, выполните следующую команду для запуска локального веб-сервера:

        ```
        npm run start-web
        ```

         После выполнения этой команды в командной строки будут отображаться сведения о запуске веб-сервера. Чтобы использовать функции, откройте новую книгу в Excel Online. В этой книге вам потребуется загрузить надстройку. 

        Для этого перейдите на вкладку **Вставка** на ленте и выберите **получить надстройки**. В открывшемся новом окне убедитесь, что вы используете вкладку **Мои надстройки** . Затем выберите **Управление моими надстройкАми _Гт_ отправить мою надстройку**. Найдите файл манифеста и отправьте его. Если надстройка не загружается, проверьте правильность выполнения шага 3.

## <a name="try-out-the-prebuilt-custom-functions"></a>Опробуйте готовые пользовательские функции

Проект пользовательских функций, созданный с помощью генератора Yeoman, содержит некоторые готовые пользовательские функции, определенные в файле **src/customfunctions.js**. Файл **manifest.xml** в корневом каталоге проекта указывает, что все пользовательские функции принадлежат пространству имен `CONTOSO`.

В книге Excel проверьте `ADD` пользовательскую функцию, выполнив следующие действия:

1. Выберите ячейку и введите текст `=CONTOSO`. Обратите внимание на то, что в меню автозаполнения содержится список всех функций в пространстве имен `CONTOSO`.

2. Выполните `CONTOSO.ADD` функцию, используя числа `10` и `200` входные параметры, введя значение `=CONTOSO.ADD(10,200)` в ячейке и нажав клавишу ВВОД.

Пользовательская функция `ADD` вычисляет сумму двух чисел, которые вы указываете в качестве входных параметров. При вводе `=CONTOSO.ADD(10,200)` в ячейке должен отобразиться результат **210** после нажатия клавиши ВВОД.

## <a name="next-steps"></a>Дальнейшие действия

Поздравляем, вы успешно создали пользовательскую функцию в надстройке Excel! Затем создайте более сложную надстройку с возможностью потоковой передачи данных. Следующая ссылка поможет вам выполнить следующие действия в руководстве надстройки Excel с пользовательскими функциями.

> [!div class="nextstepaction"]
> [Руководство по надстройкам Excel для пользовательских функций](../tutorials/excel-tutorial-create-custom-functions.md#create-a-custom-function-that-requests-data-from-the-web
)

## <a name="see-also"></a>См. также

* [Обзор пользовательских функций](../excel/custom-functions-overview.md)
* [Метаданные пользовательских функций](../excel/custom-functions-json.md)
* [Среда выполнения для пользовательских функций Excel](../excel/custom-functions-runtime.md)
* [Рекомендации по пользовательским функциям](../excel/custom-functions-best-practices.md)
