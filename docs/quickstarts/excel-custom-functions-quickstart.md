---
ms.date: 06/20/2019
description: Разработка настраиваемых функций в кратком руководстве по Excel.
title: Краткое руководство по настраиваемым функциям
ms.prod: excel
localization_priority: Normal
ms.openlocfilehash: 8e7fbf247df04a12c38ad24d9ba6335a7f7bdaf8
ms.sourcegitcommit: 382e2735a1295da914f2bfc38883e518070cec61
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/21/2019
ms.locfileid: "35128582"
---
# <a name="get-started-developing-excel-custom-functions"></a>Приступая к разработке пользовательских функций Excel

С помощью пользовательских функций разработчики могут добавлять новые функции в Excel, определяя их в JavaScript или typescript как часть надстройки. Пользователи Excel могут получить доступ к пользовательским функциям так же, как и к любой собственной `SUM()`функции в Excel, например.

## <a name="prerequisites"></a>Необходимые условия

[!include[Yeoman generator prerequisites](../includes/quickstart-yo-prerequisites.md)]

* Excel в Windows (версия 1904 или более поздняя версия, подключенная к подписке на Office 365) или Excel в Интернете
* Пользовательские функции Excel поддерживаются в Office в Mac (подключены к подписке Office 365), а обновление для этого учебника выполняется.

>[!NOTE]
>Пользовательские функции Excel не поддерживаются в Office 2019 (одноразовая покупка).

## <a name="build-your-first-custom-functions-project"></a>Создание проекта пользовательских функций

Чтобы начать работу, создайте проект пользовательских функций с помощью генератора Yeoman. Это позволит настроить для проекта правильную структуру папок, исходные файлы и зависимости, чтобы начать написание кода пользовательских функций.

1. В выбранной папке выполните следующую команду, а затем ответьте на приглашение следующим образом.

    ```command&nbsp;line
    yo office
    ```

    - **Выберите тип проекта:** `Excel Custom Functions Add-in project`
    - **Выберите тип сценария:** `JavaScript`
    - **Как вы хотите назвать надстройку?** `stock-ticker`

    ![Генератор Yeoman для надстройки Office, приглашающий к созданию пользовательских функций](../images/UpdatedYoOfficePrompt.png)

    Генератор Yeoman создаст файлы проекта и установит вспомогательные компоненты Node.

2. Генератор Yeoman предоставит вам некоторые инструкции в командной строке о том, что делать с проектом, но проигнорируя их и продолжите выполнение дальнейших действий. Перейдите к корневой папке проекта.

    ```command&nbsp;line
    cd stock-ticker
    ```

3. Выполните построение проекта. 

    ```command&nbsp;line
    npm run build
    ```

    > [!NOTE]
    > Надстройки Office должны использовать HTTPS, а не HTTP, даже в случае разработки. Если вам будет предложено установить сертификат после того, как вы запустите `npm run build`, примите предложение установить сертификат от генератора Yeoman.

4. Запустите локальный веб-сервер, работающий на Node.js. Вы можете испытать надстройку настраиваемой функции в Excel в Интернете или в Windows. Вам может быть предложено открыть область задач надстройки, хотя это необязательный параметр. Вы можете по-прежнему запускать пользовательские функции, не открывая область задач надстройки.

# <a name="excel-on-windowstabexcel-windows"></a>[Excel в Windows](#tab/excel-windows)

Чтобы протестировать надстройку в Excel в Windows, выполните следующую команду. При выполнении этой команды запустится локальный веб-сервер, и откроется приложение Excel с загруженной надстройкой.

```command&nbsp;line
npm run start:desktop
```

# <a name="excel-on-the-webtabexcel-online"></a>[Excel в Интернете](#tab/excel-online)

Чтобы протестировать надстройку в Excel в Интернете, выполните следующую команду. После выполнения этой команды запустится локальный веб-сервер.

```command&nbsp;line
npm run start:web
```

Чтобы использовать надстройку с пользовательскими функциями, откройте новую книгу в Excel в браузере. В этой книге выполните следующие действия, чтобы Загрузка неопубликованных надстройку.

1. В Excel перейдите на вкладку **Вставка** , а затем выберите **** пункт надстройки.

   ![Вставка ленты в Excel в Интернете с выделенным значком "Мои надстройки"](../images/excel-cf-online-register-add-in-1.png)
   
2. Выберите пункт **Управление моими надстройками**, а затем выберите **Отправить мою надстройку**.

3. Выберите **Обзор... ** и откройте корневой каталог проекта, созданный генератором Yeoman.

4. Выберите файл **manifest.xml** и нажмите кнопку **Открыть**, затем нажмите кнопку **Отправить**.

---

## <a name="try-out-a-prebuilt-custom-function"></a>Проверка работы готовой пользовательской функции

Проект пользовательских функций, созданный с помощью генератора Yeoman, содержит некоторые предварительно созданные пользовательские функции, определенные в файле **./СРК/функтионс/функтионс.ЖС** . Файл **./манифест.ксмл** в корневом каталоге проекта указывает, что все пользовательские функции принадлежат `CONTOSO` пространству имен.

В книге Excel проверьте `ADD` пользовательскую функцию, выполнив следующие действия:

1. Выберите ячейку и введите текст `=CONTOSO`. Обратите внимание на то, что в меню автозаполнения содержится список всех функций в пространстве имен `CONTOSO`.

2. Выполните `CONTOSO.ADD` функцию, используя числа `10` и `200` входные параметры, введя значение `=CONTOSO.ADD(10,200)` в ячейке и нажав клавишу ВВОД.

Пользовательская функция `ADD` вычисляет сумму двух чисел, которые вы указываете в качестве входных параметров. При вводе `=CONTOSO.ADD(10,200)` в ячейке должен отобразиться результат **210** после нажатия клавиши ВВОД.

## <a name="next-steps"></a>Дальнейшие действия

Поздравляем, вы успешно создали пользовательскую функцию в надстройке Excel! Затем создайте более сложную надстройку с возможностью потоковой передачи данных. Следующая ссылка поможет вам выполнить следующие действия в руководстве надстройки Excel с пользовательскими функциями.

> [!div class="nextstepaction"]
> [Руководство по надстройкам Excel для пользовательских функций](../tutorials/excel-tutorial-create-custom-functions.md#create-a-custom-function-that-requests-data-from-the-web
)

## <a name="see-also"></a>См. также

* [Обзор настраиваемых функций](../excel/custom-functions-overview.md)
* [Метаданные пользовательских функций](../excel/custom-functions-json.md)
* [Среда выполнения для пользовательских функций Excel](../excel/custom-functions-runtime.md)
* [Рекомендации по пользовательским функциям](../excel/custom-functions-best-practices.md)
