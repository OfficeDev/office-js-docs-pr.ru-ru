---
title: Пустые значения и значения NULL в надстройках Excel
description: Узнайте, как работать с пустыми значениями null в Excel и свойствах объектной модели.
ms.date: 09/03/2020
ms.localizationpriority: medium
ms.openlocfilehash: ca231e367219eb381ab33d159f8afc0ed3e1594a
ms.sourcegitcommit: 1306faba8694dea203373972b6ff2e852429a119
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/12/2021
ms.locfileid: "59151437"
---
# <a name="blank-and-null-values-in-excel-add-ins"></a>Пустые значения и значения NULL в надстройках Excel

Значения `null` и пустые строки имеют специальные применения в API JavaScript для Excel. Они используются для представления пустых ячеек, отсутствия форматирования или значений по умолчанию. В этом разделе описано использование значения `null` и пустой строки при получении и настройке свойств.

## <a name="null-input-in-2-d-array"></a>Входное значение null в двумерном массиве

В Excel диапазон представлен двумерным массивом, в котором первое измерение — это строки, а второе — столбцы. Чтобы задать значения, формат чисел или формулу только для определенных ячеек в диапазоне, укажите значения, формат чисел или формулу для этих ячеек в двумерном массиве, а для всех остальных ячеек в этом массиве укажите значение `null`.

Например, чтобы изменить формат чисел только для одной ячейки в диапазоне и сохранить существующий формат чисел для всех остальных ячеек в диапазоне, укажите новый формат чисел для ячейки, которую необходимо изменить, а для всех остальных ячеек укажите значение `null`. Во фрагменте кода ниже показано, как задать новый формат чисел для четвертой ячейки в диапазоне, при этом формат чисел для первых трех ячеек в диапазоне останется неизменным.

```js
range.values = [['Eurasia', '29.96', '0.25', '15-Feb' ]];
range.numberFormat = [[null, null, null, 'm/d/yyyy;@']];
```

## <a name="null-input-for-a-property"></a>Входное значение null для свойства

`null` не является допустимым входным значением для одного свойства. Например, указанный ниже фрагмент кода не является допустимым, так как свойство `values` диапазона не должно иметь значение `null`.

```js
range.values = null; // This is not a valid snippet. 
```

Аналогично, указанный ниже фрагмент кода не является допустимым, так как `null` — недопустимое значение для свойства `color`.

```js
range.format.fill.color =  null;  // This is not a valid snippet. 
```

## <a name="null-property-values-in-the-response"></a>Значения свойств null в ответе

Если в указанном диапазоне имеются другие значения, свойства форматирования, например `size` и `color` будут содержать значения `null` в ответе. Например, если вы получаете диапазон и загружаете его свойство `format.font.color`:

* Если у всех ячеек в диапазоне один и тот же цвет шрифта, свойство `range.format.font.color` указывает этот цвет.
* Если в диапазоне используется несколько цветов шрифтов, свойство `range.format.font.color` имеет значение `null`.

## <a name="blank-input-for-a-property"></a>Пустое входное значение для свойства

Когда вы указываете пустое значение для свойства (то есть две кавычки подряд без других знаков между `''`), это будет интерпретировано как инструкция по очистке или сбросу свойства. Например:

* Если вы укажете пустое значение для свойства `values` диапазона, содержимое диапазона будет очищено.
* Если вы укажете пустое значение для свойства `numberFormat`, формат чисел будет "сброшен" до формата `General`.
* Если вы укажете пустое значение для свойств `formula` и `formulaLocale`, значения формул будут очищены.

## <a name="blank-property-values-in-the-response"></a>Значения пустых свойств в ответе

Для операций чтения пустое значение свойства в ответе (то есть две кавычки подряд без других знаков между `''`) указывает, что ячейка не содержит данных или значения. В первом примере ниже первая и последняя ячейки в диапазоне не содержат данных. Во втором примере две первые ячейки в диапазоне не содержат формул.

```js
range.values = [['', 'some', 'data', 'in', 'other', 'cells', '']];
```

```js
range.formula = [['', '', '=Rand()']];
```
