---
title: Обзор типов данных в надстройках Excel
description: Типы данных в API JavaScript для Excel позволяют разработчикам надстроек Office работать с отформатированными значениями чисел, веб-изображениями, значениями сущностей, массивами в значениях сущностей и расширенными ошибками в качестве типов.
ms.date: 12/27/2021
ms.topic: conceptual
ms.prod: excel
ms.custom: scenarios:getting-started
ms.localizationpriority: high
ms.openlocfilehash: b498d445f53441cd5db97aa71f4dee36cac45a06
ms.sourcegitcommit: 45f7482d5adcb779a9672669360ca4d8d5c85207
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/19/2022
ms.locfileid: "62074303"
---
# <a name="overview-of-data-types-in-excel-add-ins-preview"></a>Обзор типов данных в надстройках Excel (предварительная версия)

> [!NOTE]
> API типов данных в настоящее время можно использовать только в общедоступной предварительной версии. API предварительной версии могут быть изменены и не предназначены для использования в рабочей среде. Рекомендуется использовать их только в тестовой среде и среде разработки. Не используйте API предварительной версии в рабочей среде или в важных деловых документах.
>
> Чтобы использовать API предварительной версии:
>
> - Необходимо ссылаться на **бета-версию** библиотеки в сети доставки содержимого (CDN) (https://appsforoffice.microsoft.com/lib/beta/hosted/office.js). [Файл определения типа](https://appsforoffice.microsoft.com/lib/beta/hosted/office.d.ts) для компиляции TypeScript и IntelliSense находится в сети CDN и имеет тип [DefinitelyTyped](https://raw.githubusercontent.com/DefinitelyTyped/DefinitelyTyped/master/types/office-js-preview/index.d.ts). Эти типы можно установить с помощью `npm install --save-dev @types/office-js-preview`. Дополнительные сведения см. в файле сведений пакета NPM [@microsoft/office-js](https://www.npmjs.com/package/@microsoft/office-js).
> - Возможно, вам потребуется присоединиться к [программе предварительной оценки Office](https://insider.office.com), чтобы получить доступ к более поздним сборкам Office.
>
> Чтобы попробовать типы данных в Office для Windows, номер вашей сборки Excel должен быть не ниже 16.0.14626.10000. Чтобы попробовать типы данных в Office для Mac, номер вашей сборки Excel должен быть не ниже 16.55.21102600.

Типы данных в API JavaScript для Excel позволяют разработчикам надстроек организовывать сложные структуры данных в качестве объектов, таких как отформатированные значения чисел, веб-изображения и значения сущностей.

До добавления типов данных в API JavaScript для Excel поддерживались строки, числа логические значения и ошибки. На уровне форматирования в пользовательском интерфейсе Excel в ячейки можно добавлять форматы валюты, даты и других видов на базе четырех исходных типов данных, но этот уровень контролирует только отображение исходных типов данных в пользовательском интерфейсе Excel. Значение числа не меняется, даже если ячейка в пользовательском интерфейсе Excel имеет формат валюты или даты. Такой разрыв между значением и форматом его отображения в пользовательском интерфейсе Excel может вести к путанице и ошибкам при вычислениях в надстройках. Решением этой проблемы являются настраиваемые типы данных.

Концепция типов данных дополняет исходные четыре типа API JavaScript в Excel (строка, число, логическое значение и ошибка) такими вариантами, как веб-изображения, отформатированные значения чисел, значения сущностей, массивы в значениях сущностей и улучшенные типы данных ошибок в виде гибких структур. Эти типы, на которых основаны различные [связанные типы данных](https://support.microsoft.com/office/what-linked-data-types-are-available-in-excel-6510ab58-52f6-4368-ba0f-6a76c0190772), делают вычисления в надстройках Excel точнее и проще и расширяют их потенциал за пределы двухмерной таблицы.

## <a name="data-types-and-custom-functions"></a>Типы данных и пользовательские функции

[!include[Custom functions and data types availability note](../includes/excel-custom-functions-data-types-note.md)]

Типы данных делают пользовательские функции полезнее. Пользовательские функции принимают различные типы данных на вход и используют их на выходе; кроме того, в них применяется та же схема JSON для типов данных, что и в API JavaScript для Excel. На этой схеме JSON типов данных основаны все расчеты и вычисления пользовательских функций. Чтобы узнать больше об интеграции типов данных с пользовательскими функциями, см. [Пользовательские функции и типы данных](custom-functions-data-types-concepts.md).

## <a name="see-also"></a>См. также

- [Ключевые понятия типов данных в Excel](excel-data-types-concepts.md)
- [Справочник по API JavaScript для Excel](../reference/overview/excel-add-ins-reference-overview.md)
- [Пользовательские функции и типы данных](custom-functions-data-types-concepts.md)