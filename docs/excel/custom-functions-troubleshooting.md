---
ms.date: 04/18/2019
description: Устранение распространенных проблем в пользовательских функциях Excel.
title: Устранение проблем в пользовательских функциях (предварительная версия)
localization_priority: Priority
ms.openlocfilehash: cf54aa3b719b7893799df5d1c5206c6fb904be69
ms.sourcegitcommit: 9e7b4daa8d76c710b9d9dd4ae2e3c45e8fe07127
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/24/2019
ms.locfileid: "32449220"
---
# <a name="troubleshoot-custom-functions"></a>Устранение проблем в пользовательских функциях

При разработке пользовательских функций могут возникать ошибки в продукте при создании и тестировании функций.

Для устранения проблем можно [включить ведение журнала в среде выполнения для регистрации ошибок](#enable-runtime-logging) и ознакомиться с [собственными сообщениями об ошибках Excel](#check-for-excel-error-messages). Также проверьте наличие распространенных ошибок, например отсутствие надлежащей [проверки SSL-сертификатов](#my-add-in-wont-load-verify-certificates), [оставление неразрешенных обещаний](#ensure-promises-return) и отсутствие [связывания функций](#my-functions-wont-load-associate-functions).

## <a name="enable-runtime-logging"></a>Включение ведения журнала в среде выполнения

Если вы тестируете надстройку в Office для Windows, следует [включить ведение журнала в среде выполнения](/office/dev/add-ins/testing/troubleshoot-manifest#use-runtime-logging-to-debug-your-add-in). Ведение журнала в среде выполнения отправляет операторы `console.log` в отдельный файл журнала, созданный для выявления проблем. Операторы охватывают разнообразные ошибки, включая относящиеся к XML-файлу манифеста надстройки, условиям среды выполнения или установке пользовательских функций.  Дополнительные сведения о ведении журнала в среде выполнения см. в статье [Отладка надстройки с помощью журнала среды выполнения](/office/dev/add-ins/testing/troubleshoot-manifest#use-runtime-logging-to-debug-your-add-in).  

### <a name="check-for-excel-error-messages"></a>Проверка наличия сообщений об ошибках Excel

В Excel есть несколько встроенных сообщений об ошибках, возвращаемых в ячейку при возникновении ошибки вычислений. Для пользовательских функций используются только следующие сообщения об ошибках: `#NULL!`, `#DIV/0!`, `#VALUE!`, `#REF!`, `#NAME?`, `#NUM!`, `#N/A` и `#BUSY!`.

## <a name="common-issues"></a>Распространенные проблемы

### <a name="my-add-in-wont-load-verify-certificates"></a>Моя надстройка не загружается: проверьте сертификаты

Если не удается установить надстройку, проверьте, что SSL-сертификаты правильно настроены для веб-сервера, на котором размещается ваша надстройка. Обычно при наличии проблемы с SSL-сертификатами отображается сообщение об ошибке в Excel, предупреждающее, что надстройку не удалось правильно установить. Дополнительные сведения см. в статье [Добавление самозаверяющих сертификатов в качестве доверенных корневых сертификатов](https://github.com/OfficeDev/generator-office/blob/master/src/docs/ssl.md).

### <a name="my-functions-wont-load-associate-functions"></a>Мои функции не загружаются: свяжите функции

В файле скрипта пользовательских функций необходимо связать каждую пользовательскую функцию с ее идентификатором, указанным в [файле метаданных JSON](custom-functions-json.md). Это выполняется с помощью метода `CustomFunctions.associate()`. Обычно вызов этого метода выполняется после каждой функции или в конце файла скрипта. Если пользовательская функция не связана, она не будет работать.

В примере ниже показана функция добавления, за которой следует имя функции `add`, связанное с соответствующим идентификатором JSON `ADD`.

```js
function add(first, second){
  return first + second;
}

CustomFunctions.associate("ADD", add);
```

Дополнительные сведения об этом процессе см. в статье [Сопоставление имен функций с метаданными JSON](/office/dev/add-ins/excel/custom-functions-best-practices#associating-function-names-with-json-metadata).

### <a name="cant-open-add-in-from-localhost-use-a-local-loopback-exception"></a>Не удается открыть надстройку из узла localhost: используйте исключение локального замыкания на себя

Если отображается ошибка "Не удается открыть эту надстройку из localhost", необходимо включить исключение локального замыкания на себя. Подробные сведения о том, как это сделать, см. в [этой статье службы поддержки Майкрософт](https://support.microsoft.com/ru-RU/help/4490419/local-loopback-exemption-does-not-work).

### <a name="ensure-promises-return"></a>Проверка возвращения обещаний

Если Excel ожидает завершения выполнения пользовательской функции, выводится сообщение #BUSY! в ячейке. Если код пользовательской функции возвращает обещание, но это обещание не возвращает результат, Excel продолжит отображать сообщение #BUSY!. Проверьте свои функции, чтобы убедиться, что все обещания правильно возвращают результат в ячейку.

## <a name="reporting-feedback"></a>Отправка отзывов

Если у вас возникают проблемы, не описанные в этой статье, сообщите нам. Сообщить о проблемах можно двумя способами.

### <a name="in-excel-on-windows-or-mac"></a>В Excel для Windows или Mac

При использовании Excel для Windows или Mac можно отправить отзыв группе расширяемости Office непосредственно из Excel. Для этого выберите **Файл -> Отзыв -> Отправить нахмуренный смайлик**. Отправка нахмуренного смайлика предоставит необходимые журналы для понимания проблемы, на которую вы указываете.

### <a name="in-github"></a>В GitHub

Вы можете сообщить о возникшей проблеме либо с помощью функции отзыва о содержимом внизу любой страницы с документацией или [сообщить о новой проблеме непосредственно в репозитории пользовательских функций](https://github.com/OfficeDev/Excel-Custom-Functions/issues).

## <a name="see-also"></a>См. также

* [Метаданные пользовательских функций](custom-functions-json.md)
* [Среда выполнения для пользовательских функций Excel](custom-functions-runtime.md)
* [Рекомендации по пользовательским функциям](custom-functions-best-practices.md)
* [Журнал изменений пользовательских функций](custom-functions-changelog.md)
* [Руководство по настраиваемым функциям в Excel](../tutorials/excel-tutorial-create-custom-functions.md)
