---
title: Совместное редактирование в надстройках Excel
description: Сведения для совместного редактирования книги Excel, хранящейся в OneDrive, OneDrive для бизнеса или SharePoint Online.
ms.date: 06/20/2019
localization_priority: Normal
ms.openlocfilehash: b70db9c6a0f1f9582288f1078561277b395d3815
ms.sourcegitcommit: be23b68eb661015508797333915b44381dd29bdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/08/2020
ms.locfileid: "44609354"
---
# <a name="coauthoring-in-excel-add-ins"></a><span data-ttu-id="8844f-103">Совместное редактирование в надстройках Excel</span><span class="sxs-lookup"><span data-stu-id="8844f-103">Coauthoring in Excel add-ins</span></span>  

<span data-ttu-id="8844f-p101">Благодаря функции [совместного редактирования](https://support.office.com/article/Collaborate-on-Excel-workbooks-at-the-same-time-with-co-authoring-7152aa8b-b791-414c-a3bb-3024e46fb104) несколько человек могут работать вместе и редактировать одну и ту же книгу Excel одновременно. Все соавторы книги могут видеть изменения, внесенные и сохраненные другими соавторами. Чтобы книги Excel можно было совместно редактировать, они должны храниться в OneDrive, OneDrive для бизнеса или SharePoint Online.</span><span class="sxs-lookup"><span data-stu-id="8844f-p101">With [coauthoring](https://support.office.com/article/Collaborate-on-Excel-workbooks-at-the-same-time-with-co-authoring-7152aa8b-b791-414c-a3bb-3024e46fb104), multiple people can work together and edit the same Excel workbook simultaneously. All coauthors of a workbook can see another coauthor's changes as soon as that coauthor saves the workbook. To coauthor an Excel workbook, the workbook must be stored in OneDrive, OneDrive for Business, or SharePoint Online.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="8844f-107">В Excel для Office 365 в левом верхнем углу можно заметить надпись "Автосохранение".</span><span class="sxs-lookup"><span data-stu-id="8844f-107">In Excel for Office 365, you will notice AutoSave in the upper-left corner.</span></span> <span data-ttu-id="8844f-108">Если автосохранение включено, соавторы видят внесенные вами изменения в режиме реального времени.</span><span class="sxs-lookup"><span data-stu-id="8844f-108">When AutoSave is turned on, coauthors see your changes in real time.</span></span> <span data-ttu-id="8844f-109">Учтите влияние такого поведения на макет вашей надстройки Excel.</span><span class="sxs-lookup"><span data-stu-id="8844f-109">Consider the impact of this behavior on the design of your Excel add-in.</span></span> <span data-ttu-id="8844f-110">Пользователи могут выключить автосохранение с помощью переключателя в левом верхнем углу окна Excel.</span><span class="sxs-lookup"><span data-stu-id="8844f-110">Users can turn off AutoSave via the switch in the upper left of the Excel window.</span></span>

## <a name="coauthoring-overview"></a><span data-ttu-id="8844f-111">Общие сведения о совместном редактировании</span><span class="sxs-lookup"><span data-stu-id="8844f-111">Coauthoring overview</span></span>

<span data-ttu-id="8844f-112">Когда вы меняете содержимое книги, Excel автоматически синхронизирует эти изменения для всех соавторов.</span><span class="sxs-lookup"><span data-stu-id="8844f-112">When you change a workbook's content, Excel automatically synchronizes those changes across all coauthors.</span></span> <span data-ttu-id="8844f-113">Вносить изменения в содержимое книги могут не только соавторы, но и код в надстройке Excel.</span><span class="sxs-lookup"><span data-stu-id="8844f-113">Coauthors can change the content of a workbook, but so can code running within an Excel add-in.</span></span> <span data-ttu-id="8844f-114">Например, для диапазона задается значение "Contoso", когда в надстройке Office выполняется следующий код JavaScript:</span><span class="sxs-lookup"><span data-stu-id="8844f-114">For example, when the following JavaScript code runs in an Office Add-in, the value of a range is set to Contoso:</span></span>

```js
range.values = [['Contoso']];
```
<span data-ttu-id="8844f-115">После того как книга со значением "Contoso" синхронизируется для всех соавторов, новое значение диапазона будет доступно всем пользователям и надстройкам, выполняемым в той же книге.</span><span class="sxs-lookup"><span data-stu-id="8844f-115">After 'Contoso' synchronizes across all coauthors, any user or add-in running in the same workbook will see the new value of the range.</span></span>

<span data-ttu-id="8844f-p104">Функция совместного редактирования синхронизирует содержимое только общей книги. Значения, скопированные из книги в переменные JavaScript в надстройке Excel, не синхронизируются. Например, если надстройка хранит значение ячейки (например, "Contoso") в переменной JavaScript, а соавтор заменяет его на "Пример", после синхронизации все соавторы увидят в ячейке значение "Пример". Но для ячейки в переменной JavaScript по-прежнему будет задано значение "Contoso". Кроме того, когда несколько соавторов используют одну и ту же надстройку, у каждого соавтора есть своя, не синхронизированная с остальными, копия переменной. Перед работой с переменными, использующими содержимое книги, убедитесь, что все значения в книге обновлены.</span><span class="sxs-lookup"><span data-stu-id="8844f-p104">Coauthoring only synchronizes the content within the shared workbook. Values copied from the workbook to JavaScript variables in an Excel add-in are not synchronized. For example, if your add-in stores the value of a cell (such as 'Contoso') in a JavaScript variable, and then a coauthor changes the value of the cell to 'Example', after synchronization all coauthors see 'Example' in the cell. However, the value of the JavaScript variable is still set to 'Contoso'. Furthermore, when multiple coauthors use the same add-in, each coauthor has their own copy of the variable, which is not synchronized. When you use variables that use workbook content, be sure you check for updated values in the workbook before you use the variable.</span></span>

## <a name="use-events-to-manage-the-in-memory-state-of-your-add-in"></a><span data-ttu-id="8844f-122">Использование событий для управления состоянием надстройки в памяти</span><span class="sxs-lookup"><span data-stu-id="8844f-122">Use events to manage the in-memory state of your add-in</span></span>

<span data-ttu-id="8844f-p105">Надстройки Excel могут читать содержимое книги (из скрытых листов и объекта параметра), а затем хранить его в таких структурах данных как переменные. После того как исходные значения скопированы в любую из структур данных, соавторы могут обновить исходное содержание книги. Это означает, что теперь скопированные значения в структурах данных не синхронизируются с содержимым книги. При создании надстроек необходимо учитывать это разделение содержания книги и значений, хранящихся в структурах данных.</span><span class="sxs-lookup"><span data-stu-id="8844f-p105">Excel add-ins can read workbook content (from hidden worksheets and a setting object), and then store it in data structures such as variables. After the original values are copied into any of these data structures, coauthors can update the original workbook content. This means that the copied values in the data structures are now out of sync with the workbook content. When you build your add-ins, be sure to account for this separation of workbook content and values stored in data structures.</span></span>

<span data-ttu-id="8844f-p106">Например, вы можете создать надстройку контента, которая отображает пользовательские визуализации. Состояние ваших пользовательских визуализаций может быть сохранено в скрытом листе. Когда соавторы используют одну и ту же книгу, может возникнуть следующая ситуация:</span><span class="sxs-lookup"><span data-stu-id="8844f-p106">For example, you might build a content add-in that displays custom visualizations. The state of your custom visualizations might be saved in a hidden worksheet. When coauthors use the same workbook, the following scenario can occur:</span></span>

- <span data-ttu-id="8844f-p107">Пользователь A открывает документ, и пользовательские визуализации отображаются в книге. Пользовательские визуализации читают данные из скрытого листа (например, задан синий цвет визуализации).</span><span class="sxs-lookup"><span data-stu-id="8844f-p107">User A opens the document and the custom visualizations are shown in the workbook. The custom visualizations read data from a hidden worksheet (for example, the color of the visualizations is set to blue).</span></span>
- <span data-ttu-id="8844f-p108">Пользователь Б открывает тот же документ, начинает изменять пользовательские визуализации и в качестве цвета для них задает оранжевый. Оранжевый цвет сохраняется в скрытом листе.</span><span class="sxs-lookup"><span data-stu-id="8844f-p108">User B opens the same document, and starts modifying the custom visualizations. User B sets the color of the custom visualizations to orange. Orange is saved to the hidden worksheet.</span></span>
- <span data-ttu-id="8844f-135">Скрытый лист пользователя А обновляется с учетом оранжевого цвета.</span><span class="sxs-lookup"><span data-stu-id="8844f-135">User A's hidden worksheet is updated with the new value of orange.</span></span>
- <span data-ttu-id="8844f-136">Специальные элементы визуализации пользователя А по-прежнему синие.</span><span class="sxs-lookup"><span data-stu-id="8844f-136">User A's custom visualizations are still blue.</span></span>

<span data-ttu-id="8844f-p109">Чтобы специальные элементы визуализации пользователя А соответствовали изменениям, внесенным соавторами на скрытом листе, используйте событие [BindingDataChanged](/javascript/api/office/office.bindingdatachangedeventargs). Это обеспечит отражение изменений, внесенных соавторами в содержимое книги, в вашей надстройке.</span><span class="sxs-lookup"><span data-stu-id="8844f-p109">If you want User A's custom visualizations to respond to changes made by coauthors on the hidden worksheet, use the [BindingDataChanged](/javascript/api/office/office.bindingdatachangedeventargs) event. This ensures that changes to workbook content made by coauthors is reflected in the state of your add-in.</span></span>

## <a name="caveats-to-using-events-with-coauthoring"></a><span data-ttu-id="8844f-139">Предостережения, касающиеся использования событий для совместного редактирования</span><span class="sxs-lookup"><span data-stu-id="8844f-139">Caveats to using events with coauthoring</span></span>

<span data-ttu-id="8844f-p110">Как описано выше, в некоторых сценариях применение  триггеров события для всех соавторов обеспечивает улучшенное взаимодействие с пользователем. Однако, имейте ввиду, что в ряде сценариев такое поведение может привести к неудобствам в работе пользователей.</span><span class="sxs-lookup"><span data-stu-id="8844f-p110">As described earlier, in some scenarios, triggering events for all coauthors provides an improved user experience. However, be aware that in some scenarios this behavior can produce poor user experiences.</span></span> 

<span data-ttu-id="8844f-142">Например, обычно в сценариях проверки данных пользовательский интерфейс отображается в ответ на события.</span><span class="sxs-lookup"><span data-stu-id="8844f-142">For example, in data validation scenarios, it is common to display UI in response to events.</span></span> <span data-ttu-id="8844f-143">Событие [BindingDataChanged](/javascript/api/office/office.bindingdatachangedeventargs), описанное в предыдущем разделе, выполняется когда локальный пользователь или соавтор (удаленный) изменяет содержимое книги в пределах привязки.</span><span class="sxs-lookup"><span data-stu-id="8844f-143">The [BindingDataChanged](/javascript/api/office/office.bindingdatachangedeventargs) event described in the previous section runs when either a local user or coauthor (remote) changes the workbook content within the binding.</span></span> <span data-ttu-id="8844f-144">Если обработчик события `BindingDataChanged` отображает пользовательский интерфейс, пользователи увидят пользовательский интерфейс, который не связан с изменениями, над которыми они работали в книге, что приводит к плохому взаимодействию с пользователем.</span><span class="sxs-lookup"><span data-stu-id="8844f-144">If the event handler of the `BindingDataChanged` event displays UI, users will see UI that is unrelated to changes they were working on in the workbook, leading to a poor user experience.</span></span> <span data-ttu-id="8844f-145">Избегайте отображения пользовательского интерфейса при использовании событий в вашей надстройке.</span><span class="sxs-lookup"><span data-stu-id="8844f-145">Avoid displaying UI when using events in your add-in.</span></span>

## <a name="see-also"></a><span data-ttu-id="8844f-146">См. также</span><span class="sxs-lookup"><span data-stu-id="8844f-146">See also</span></span>

- [<span data-ttu-id="8844f-147">О совместном редактировании в Excel (VBA)</span><span class="sxs-lookup"><span data-stu-id="8844f-147">About coauthoring in Excel (VBA)</span></span>](/office/vba/excel/concepts/about-coauthoring-in-excel)
- [<span data-ttu-id="8844f-148">Как автосохранение влияет на надстройки и макросы (VBA)</span><span class="sxs-lookup"><span data-stu-id="8844f-148">How AutoSave impacts add-ins and macros (VBA)</span></span>](/office/vba/library-reference/concepts/how-autosave-impacts-addins-and-macros)
