---
ms.date: 08/13/2020
description: Узнайте, как запускать пользовательские функции, кнопки ленты и код области задач в одной и той же среде выполнения JavaScript для координации сценариев в вашей надстройке.
title: Запуск кода надстройки в общей среде выполнения JavaScript
localization_priority: Priority
ms.openlocfilehash: 70d13372dbe3ef40d527c781d0fd55dc0b1eb7ed
ms.sourcegitcommit: 5bfd1e9956485c140179dfcc9d210c4c5a49a789
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/13/2020
ms.locfileid: "49071630"
---
# <a name="overview-run-your-add-in-code-in-a-shared-javascript-runtime"></a>Обзор: запуск кода надстройки в общей среде выполнения JavaScript

[!include[Excel custom functions note](../includes/excel-custom-functions-note.md)]

При запуске Excel на компьютере с Windows или на Mac надстройка запустит код для кнопок ленты, пользовательских функций и области задач в отдельных средах выполнения JavaScript. Из-за этого возникают ограничения, например невозможность удобно предоставлять общий доступ к глобальным данным и отсутствие доступа ко всей функциональности CORS для пользовательской функции.

Тем не менее, можно настроить надстройку Excel так, чтобы обеспечить общий доступ к коду в одной и той же среде выполнения JavaScript (то есть в общей среде выполнения). За счет этого повышается скоординированность работы надстройки и упрощается доступ к DOM панели задач и CORS из всех компонентов надстройки.

При настройке общей среды выполнения становятся возможными следующие сценарии:

- У вашей настройки будет общая модель DOM, доступная для ленты, области задач и пользовательских функций.
- У ваших пользовательских функций будет полная поддержка CORS.
- Пользовательские функции могут вызывать API Office.js для чтения данных из электронной таблицы.
- Надстройка может выполнять код сразу после открытия документа.
- Надстройка может продолжать выполнять код после закрытия области задач.

При запуске пользовательских функций в общей среде выполнения с областью задач ваша надстройка будет выполняться в экземпляре браузера Microsoft Internet Explorer 11, как описано в статье [Браузеры, используемые надстройками Office](../concepts/browsers-used-by-office-web-add-ins.md). Кроме того, все кнопки, отображаемые вашей надстройкой Excel на ленте, будут работать в этой же общей среде выполнения. На следующем рисунке показано, как пользовательские функции, пользовательский интерфейс ленты и код области задач будут запускаться в одной и той же среде выполнения JavaScript.

![Пользовательские функции, работающие в общей среде выполнения вместе с кнопками ленты и областью задач в Excel](../images/custom-functions-in-browser-runtime.png)

## <a name="set-up-a-shared-runtime"></a>Использование общей среды выполнения

Инструкции по настройке собственных функций для использования в общей среде выполнения см. [статью "Настройка общей среды выполнения"](configure-your-add-in-to-use-a-shared-runtime.md).

### <a name="debugging"></a>Отладка

В настоящее время при использовании общей среды выполнения невозможно использовать Visual Studio Code для отладки пользовательских функций в Excel под управлением Windows. Вместо этого потребуется использовать средства разработчика. Дополнительные сведения см. в статье [Отладка надстроек с помощью средств разработчика в Windows 10](../testing/debug-add-ins-using-f12-developer-tools-on-windows-10.md).

## <a name="give-us-feedback"></a>Напишите нам свой отзыв

Мы будем рады услышать ваши отзывы об этой функции. Если вы обнаружите какие-либо ошибки или проблемы, если у вас есть запросы относительно этой функции, сообщите нам, создав проблему GitHub в [репозитории office-js](https://github.com/OfficeDev/office-js).

## <a name="see-also"></a>См. также

- [Учебное руководство. Обмен данными и событиями между пользовательскими функциями Excel и областью задач](../tutorials/share-data-and-events-between-custom-functions-and-the-task-pane-tutorial.md)
- [Вызов API Excel из пользовательской функции](call-excel-apis-from-custom-function.md)
