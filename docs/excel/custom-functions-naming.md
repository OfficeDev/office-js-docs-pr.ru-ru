---
title: Рекомендации по найму пользовательских функций в Excel
description: Узнайте требования к именам Excel настраиваемые функции и избежать распространенных ошибок именования.
ms.date: 07/08/2021
ms.localizationpriority: medium
ms.openlocfilehash: 09216a2a98f6c37b17a413042804946bff4e6caa
ms.sourcegitcommit: 1306faba8694dea203373972b6ff2e852429a119
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/12/2021
ms.locfileid: "59151263"
---
# <a name="custom-functions-naming-guidelines"></a>Правила именования пользовательских функций

Настраиваемая функция идентифицирована свойством и `id` `name` свойством в файле метаданных JSON.

- Функция используется `id` для уникальной идентификации пользовательских функций в коде JavaScript.
- Функция используется в качестве имени отображения, которое отображается `name` пользователю в Excel.

[!include[Excel custom functions note](../includes/excel-custom-functions-note.md)]

Функция может `name` отличаться от функции, `id` например для целей локализации. В общем, функция должна оставаться такой же, как если `name` нет причин для них `id` отличаться.

Функция и общие `name` `id` требования.

- Функция может использовать только символы A через Z, числа от нуля до `id` девяти, подчеркивает и периоды.

- Функция может использовать любые алфавитные символы `name` Юникод, подчеркивая и периоды.

- Обе `name` функции `id` должны начинаться с буквы и иметь минимальное ограничение в три символа.

Excel использует верхние буквы для встроенных имен функций `SUM` (например). Используйте верхние буквы для настраиваемой функции `name` и `id` в качестве наилучшей практики.

Функция не должна быть такой `name` же, как:

- Любые ячейки между A1 и XFD1048576 или любые ячейки между R1C1 и R1048576C16384.

- Любая Excel 4.0 Macro Function `RUN` (например, , `ECHO` ).  Полный список этих функций см. в этом документе Excel [Macro Functions Reference document.](https://d13ot9o61jdzpp.cloudfront.net/files/Excel%204.0%20Macro%20Functions%20Reference.pdf)

## <a name="naming-conflicts"></a>Конфликты именования

Если ваша функция является той же функцией в надстройки, которая уже `name` `name` **существует, #REF!** ошибка появится в вашей книге.

Чтобы устранить конфликт имен, измените надстройку и `name` снова попробуйте функцию. Можно также удалить надстройку с противоречивым именем. Или, если вы тестируете надстройки в разных средах, попробуйте использовать другое пространство имен для дифференцировать функцию `NAMESPACE_NAMEOFFUNCTION` (например).

## <a name="best-practices"></a>Рекомендованные методики

- Следует добавить несколько аргументов в функцию, а не создавать несколько функций с одинаковыми или похожими именами.
- Избегайте двусмысленных сокращений в именах функций. Ясность важнее краткости. Выберите имя, `=INCREASETIME` как, а не `=INC` .
- Имена функций должны указывать действие функции, например =GETZIPCODE вместо ZIPCODE.
- Последовательно используйте те же глаголы для функций, которые выполняют аналогичные действия. Например, используйте `=DELETEZIPCODE` и , а не и `=DELETEADDRESS` `=DELETEZIPCODE` `=REMOVEADDRESS` .
- При наименовке функции потоковой передачи рассмотрите возможность добавления заметки к этому эффекту в описании функции или добавления в конец `STREAM` имени функции.

[!include[manifest guidance](../includes/manifest-guidance.md)]

## <a name="localizing-function-names"></a>Локализация имен функций

Можно локализовать имена функций для разных языков с помощью отдельных JSON-файлов и переопределения значений в манифестном файле надстройки. Избегайте предоставления функций встроенной или встроенной Excel на другом языке, так как это может привести к конфликту `id` `name` с локализованными функциями.

Полные сведения о локализации см. в тексте [Локализовать настраиваемые функции](custom-functions-localize.md)

## <a name="next-steps"></a>Следующие шаги

Узнайте о [лучших практиках обработки ошибок.](custom-functions-errors.md)

## <a name="see-also"></a>Дополнительные материалы

* [Вручную создайте метаданные JSON для пользовательских функций](custom-functions-json.md)
* [Руководство по пользовательским функциям в Excel](../tutorials/excel-tutorial-create-custom-functions.md)
