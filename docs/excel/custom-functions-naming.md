---
ms.date: 05/17/2020
description: Узнайте о требованиях к именам пользовательских функций Excel и Избегайте распространенных ловушек именования.
title: Рекомендации по именованию пользовательских функций в Excel
localization_priority: Normal
ms.openlocfilehash: ac0d824f49d359e574a0dc5caae8ef2f903dd4a1
ms.sourcegitcommit: be23b68eb661015508797333915b44381dd29bdb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/08/2020
ms.locfileid: "44609291"
---
# <a name="naming-guidelines"></a>Рекомендации по именованию

Пользовательская функция определяется `id` `name` свойством и в файле метаданных JSON.

- Функция `id` используется для уникальной идентификации пользовательских функций в коде JavaScript.
- Функция `name` используется в качестве отображаемого имени, которое отображается для пользователя в Excel.

[!include[Excel custom functions note](../includes/excel-custom-functions-note.md)]

Функция `name` может отличаться от функции `id` , например в целях локализации. В общем случае функция `name` должна оставаться такой же, как и в `id` случае, если нет причин различать их.

Функции `name` и `id` совместно используют некоторые общие требования:

- Функции `id` могут использовать только буквы от A до Z, цифры от 0 до девяти, подчеркивания и точки.

- Функция `name` может использовать любые алфавитные символы Юникода, подчеркивания и точки.

- Обе функции `name` и `id` должны начинаться с буквы и иметь не менее трех символов.

Excel использует прописные буквы для встроенных имен функций (например, `SUM` ). Используйте прописные буквы для пользовательских функций `name` и `id` в качестве рекомендаций.

Функция `name` не должна быть такой же, как:

- Для ячеек между a1 и XFD1048576 или ячейками между ними между R1048576C16384.

- Любая функция макроса Excel 4,0 (например `RUN` , `ECHO` ).  Полный список этих функций представлен в статье [справочный документ по функциям макросов Excel](https://d13ot9o61jdzpp.cloudfront.net/files/Excel%204.0%20Macro%20Functions%20Reference.pdf).

## <a name="naming-conflicts"></a>Конфликты имен

Если функция аналогична `name` функции `name` в уже существующей надстройке, **#REF!** в книге появится сообщение об ошибке.

Чтобы устранить конфликт имен, измените его `name` в надстройке и повторите функцию. Вы также можете удалить надстройку с конфликтующим именем. Если вы тестируете надстройку в различных средах, попробуйте использовать другое пространство имен, чтобы отличать функцию (например, `NAMESPACE_NAMEOFFUNCTION` ).

## <a name="best-practices"></a>Рекомендации

- Рекомендуется добавить в функцию несколько аргументов, а не создавать несколько функций с одинаковыми или похожими именами.
- Избегайте неоднозначных сокращений в именах функций. Ясности важнее, чем кратко. Выберите имя, `=INCREASETIME` а не `=INC` .
- Имена функций должны указывать на действие функции, например = ЖЕТЗИПКОДЕ, а не индекс.
- Согласованно используйте одни и те же команды для функций, которые выполняют похожие действия. Например, используйте `=DELETEZIPCODE` и `=DELETEADDRESS` , а не `=DELETEZIPCODE` и `=REMOVEADDRESS` .
- При указании имени потоковой функции рекомендуется добавить заметку к этому результату в описании функции или добавить ее `STREAM` в конец имени функции.

[!include[manifest guidance](../includes/manifest-guidance.md)]

## <a name="localizing-function-names"></a>Локализация имен функций

Вы можете локализовать имена функций для разных языков с помощью отдельных файлов JSON и переопределить значения в файле манифеста надстройки. Не выполняйте функции с `id` помощью `name` встроенной функции Excel на другом языке, так как это может конфликтовать с локализованными функциями.

Полную информацию о локализации можно найти в разделе [Localize Custom functions](custom-functions-localize.md) .

## <a name="next-steps"></a>Дальнейшие действия
Ознакомьтесь с рекомендациями по [обработке ошибок](custom-functions-errors.md).

## <a name="see-also"></a>См. также

* [Метаданные пользовательских функций](custom-functions-json.md)
* [Руководство по пользовательским функциям в Excel](../tutorials/excel-tutorial-create-custom-functions.md)
