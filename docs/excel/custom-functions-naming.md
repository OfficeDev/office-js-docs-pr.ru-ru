---
title: Рекомендации по найму пользовательских функций в Excel
description: Узнайте требования к именам Excel пользовательских функций и избежать распространенных ошибок с именами.
ms.date: 07/08/2021
ms.localizationpriority: medium
ms.openlocfilehash: 629ed7000046a2cf543e0ac9e398c349666a67c1
ms.sourcegitcommit: 968d637defe816449a797aefd930872229214898
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/23/2022
ms.locfileid: "63744513"
---
# <a name="custom-functions-naming-guidelines"></a>Правила именования пользовательских функций

Настраиваемая функция идентифицирована свойством `id` и свойством `name` в файле метаданных JSON.

- Функция используется `id` для уникальной идентификации пользовательских функций в коде JavaScript.
- Функция используется `name` как имя отображения, которое отображается пользователю в Excel.

[!include[Excel custom functions note](../includes/excel-custom-functions-note.md)]

Функция может `name` отличаться от функции `id`, например для целей локализации. В общем, функция должна оставаться `name` `id` такой же, как если нет причин для них отличаться.

Функция и общие `name` `id` требования.

- Функция может использовать только `id` символы A через Z, числа от нуля до девяти, подчеркивает и периоды.

- Функция может использовать `name` любые алфавитные символы Юникод, подчеркивая и периоды.

- Обе функции `name` должны `id` начинаться с буквы и иметь минимальное ограничение в три символа.

Excel использует буквы верхнего шкафа для встроенных имен функций (например`SUM`). Используйте верхние буквы для настраиваемой функции и `name` `id` в качестве наилучшей практики.

Функция не `name` должна быть такой же, как:

- Любые ячейки между A1 и XFD1048576 или любые ячейки между R1C1 и R1048576C16384.

- Любой Excel 4.0 Macro Function (например`RUN`, , ). `ECHO`  Полный список этих функций см. в этом документе [Excel Macro Functions Reference](https://d13ot9o61jdzpp.cloudfront.net/files/Excel%204.0%20Macro%20Functions%20Reference.pdf) document.

## <a name="naming-conflicts"></a>Конфликты именования

Если ваша функция `name` является той же функцией `name` в надстройки, которая уже существует, #REF **!** ошибка появится в вашей книге.

Чтобы устранить конфликт имен, `name` измените надстройку и снова попробуйте функцию. Можно также удалить надстройку с противоречивым именем. Или, если вы тестируете надстройки в разных средах, попробуйте использовать другое пространство имен для дифференцировать функцию (например `NAMESPACE_NAMEOFFUNCTION`).

## <a name="best-practices"></a>Рекомендации

- Следует добавить несколько аргументов в функцию, а не создавать несколько функций с одинаковыми или похожими именами.
- Избегайте двусмысленных сокращений в именах функций. Ясность важнее краткости. Выберите имя, как, `=INCREASETIME` а не `=INC`.
- Имена функций должны указывать действие функции, например =GETZIPCODE вместо ZIPCODE.
- Последовательно используйте те же глаголы для функций, которые выполняют аналогичные действия. Например, используйте и `=DELETEZIPCODE` `=DELETEADDRESS`, а не и `=DELETEZIPCODE` `=REMOVEADDRESS`.
- При наименовке `STREAM` функции потоковой передачи рассмотрите возможность добавления заметки к этому эффекту в описании функции или добавления в конец имени функции.

[!include[manifest guidance](../includes/manifest-guidance.md)]

## <a name="localizing-function-names"></a>Локализация имен функций

Можно локализовать имена функций для разных языков с помощью отдельных JSON-файлов и переопределения значений в манифестном файле надстройки. Избегайте предоставления функций `id` `name` встроенной или встроенной Excel на другом языке, так как это может привести к конфликту с локализованными функциями.

Полные сведения о локализации см. в тексте [Локализовать настраиваемые функции](custom-functions-localize.md)

## <a name="next-steps"></a>Дальнейшие действия

Узнайте о [лучших практиках обработки ошибок](custom-functions-errors.md).

## <a name="see-also"></a>См. также

* [Вручную создайте метаданные JSON для пользовательских функций](custom-functions-json.md)
* [Руководство по пользовательским функциям в Excel](../tutorials/excel-tutorial-create-custom-functions.md)
