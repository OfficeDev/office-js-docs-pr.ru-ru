---
title: Расширение пользовательских функций с помощью функций, определенных пользователем XLL
description: Включить совместимость с определенными пользователями функциями Excel XLL, которые имеют эквивалентные функциональные возможности для настраиваемой функции
ms.date: 03/09/2021
localization_priority: Normal
ms.openlocfilehash: 32146e7eebb963e8d800b619ef052457e40f2ac6
ms.sourcegitcommit: c0c61fe84f3c5de88bd7eac29120056bb1224fc8
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/17/2021
ms.locfileid: "50836818"
---
# <a name="extend-custom-functions-with-xll-user-defined-functions"></a><span data-ttu-id="a263d-103">Расширение пользовательских функций с помощью функций, определенных пользователем XLL</span><span class="sxs-lookup"><span data-stu-id="a263d-103">Extend custom functions with XLL user-defined functions</span></span>

<span data-ttu-id="a263d-104">Если у вас есть существующие XLLs Excel, вы можете создать эквивалентные пользовательские функции в надстройки Excel, чтобы распространить функции решения на другие платформы, такие как online или на Mac.</span><span class="sxs-lookup"><span data-stu-id="a263d-104">If you have existing Excel XLLs, you can build equivalent custom functions in an Excel add-in to extend your solution features to other platforms such as online or on a Mac.</span></span> <span data-ttu-id="a263d-105">Однако надстройки Excel не имеют всех функциональных возможностей, доступных в XLLs.</span><span class="sxs-lookup"><span data-stu-id="a263d-105">However, Excel add-ins don't have all of the functionality available in XLLs.</span></span> <span data-ttu-id="a263d-106">В зависимости от функциональных возможностей, которые использует ваше решение, XLL может предоставлять больше возможностей, чем пользовательские функции надстройки Excel в Excel в Windows.</span><span class="sxs-lookup"><span data-stu-id="a263d-106">Depending on the functionality your solution uses, the XLL may provide a better experience than the Excel add-in custom functions in Excel on Windows.</span></span>

> [!NOTE]
> <span data-ttu-id="a263d-107">Совместимость надстройки COM и XLL UDF поддерживается следующими платформами при подстройки Microsoft 365:</span><span class="sxs-lookup"><span data-stu-id="a263d-107">COM add-in and XLL UDF compatibility is supported by the following platforms, when connected to a Microsoft 365 subscription:</span></span>
>
> - <span data-ttu-id="a263d-108">Excel в Интернете</span><span class="sxs-lookup"><span data-stu-id="a263d-108">Excel on the web</span></span>
> - <span data-ttu-id="a263d-109">Excel на Windows (версия 1904 или более поздней версии)</span><span class="sxs-lookup"><span data-stu-id="a263d-109">Excel on Windows (version 1904 or later)</span></span>
> - <span data-ttu-id="a263d-110">Excel на Mac (версия 13.329 или более поздней версии)</span><span class="sxs-lookup"><span data-stu-id="a263d-110">Excel on Mac (version 13.329 or later)</span></span>
>
> <span data-ttu-id="a263d-111">Чтобы использовать com-надстройку и совместимость XLL UDF в Excel в Интернете, войдите в систему с помощью подписки Microsoft 365 или [учетной записи Microsoft.](https://account.microsoft.com/account)</span><span class="sxs-lookup"><span data-stu-id="a263d-111">To use COM add-in and XLL UDF compatibility within Excel on the web, login by using either your Microsoft 365 subscription or a [Microsoft account](https://account.microsoft.com/account).</span></span> <span data-ttu-id="a263d-112">Если у вас еще нет подписки Microsoft 365, вы можете получить бесплатную 90-дневную подписку на Microsoft 365, присоединившись к программе разработчика [Microsoft 365.](https://developer.microsoft.com/office/dev-program)</span><span class="sxs-lookup"><span data-stu-id="a263d-112">If you don't already have a Microsoft 365 subscription, you can a free, 90-day renewable Microsoft 365 subscription by joining the [Microsoft 365 developer program](https://developer.microsoft.com/office/dev-program).</span></span>

## <a name="specify-equivalent-xll-in-the-manifest"></a><span data-ttu-id="a263d-113">Укажите эквивалентный XLL в манифесте</span><span class="sxs-lookup"><span data-stu-id="a263d-113">Specify equivalent XLL in the manifest</span></span>

<span data-ttu-id="a263d-114">Чтобы обеспечить совместимость с существующей XLL, определите эквивалент XLL в манифесте вашей надстройки Excel.</span><span class="sxs-lookup"><span data-stu-id="a263d-114">To enable compatibility with an existing XLL, identify the equivalent XLL in the manifest of your Excel add-in.</span></span> <span data-ttu-id="a263d-115">Затем Excel будет использовать функции XLL вместо пользовательских функций надстройки Excel при работе с Windows.</span><span class="sxs-lookup"><span data-stu-id="a263d-115">Excel will then use the XLL's functions instead of your Excel add-in custom functions when running on Windows.</span></span>

<span data-ttu-id="a263d-116">Чтобы задать эквивалентную XLL для настраиваемой функции, укажите `FileName` XLL.</span><span class="sxs-lookup"><span data-stu-id="a263d-116">To set the equivalent XLL for your custom functions, specify the `FileName` of the XLL.</span></span> <span data-ttu-id="a263d-117">Когда пользователь открывает книгу с функциями из XLL, Excel преобразует функции в совместимые функции.</span><span class="sxs-lookup"><span data-stu-id="a263d-117">When the user opens a workbook with functions from the XLL, Excel converts the functions to compatible functions.</span></span> <span data-ttu-id="a263d-118">Затем в книге используется XLL, открываемая в Excel на Windows, и она будет использовать настраиваемые функции из надстройки Excel, когда она открывается в Интернете или на Mac.</span><span class="sxs-lookup"><span data-stu-id="a263d-118">The workbook then uses the XLL when opened in Excel on Windows, and it will use custom functions from your Excel add-in when opened online or on a Mac.</span></span>

<span data-ttu-id="a263d-119">В следующем примере показано, как указать как надстройки COM, так и XLL в качестве эквивалента.</span><span class="sxs-lookup"><span data-stu-id="a263d-119">The following example shows how to specify both a COM add-in and an XLL as equivalent.</span></span> <span data-ttu-id="a263d-120">Часто указывается и то, и другое.</span><span class="sxs-lookup"><span data-stu-id="a263d-120">Often you will specify both.</span></span> <span data-ttu-id="a263d-121">Для полноты в этом примере показаны оба контекста.</span><span class="sxs-lookup"><span data-stu-id="a263d-121">For completeness, this example shows both in context.</span></span> <span data-ttu-id="a263d-122">Они идентифицированы по их `ProgId` и `FileName` соответственно.</span><span class="sxs-lookup"><span data-stu-id="a263d-122">They are identified by their `ProgId` and `FileName` respectively.</span></span> <span data-ttu-id="a263d-123">Элемент `EquivalentAddins` должен быть позиционировали непосредственно перед закрытием `VersionOverrides` тега.</span><span class="sxs-lookup"><span data-stu-id="a263d-123">The `EquivalentAddins` element must be positioned immediately before the closing `VersionOverrides` tag.</span></span> <span data-ttu-id="a263d-124">Дополнительные сведения о совместимости надстройки COM см. в статью Сделать надстройку Office совместимой с существующей [надстройки COM.](../develop/make-office-add-in-compatible-with-existing-com-add-in.md)</span><span class="sxs-lookup"><span data-stu-id="a263d-124">For more information on COM add-in compatibility, see [Make your Office Add-in compatible with an existing COM add-in](../develop/make-office-add-in-compatible-with-existing-com-add-in.md).</span></span>

```xml
<VersionOverrides>
  ...
  <EquivalentAddins>
    <EquivalentAddin>
      <ProgId>ContosoCOMAddin</ProgId>
      <Type>COM</Type>
    </EquivalentAddin>

    <EquivalentAddin>
      <FileName>contosofunctions.xll</FileName>
      <Type>XLL</Type>
    </EquivalentAddin>
  </EquivalentAddins>
</VersionOverrides>
```

> [!NOTE]
> <span data-ttu-id="a263d-125">Если надстройка объявляет свои настраиваемые функции совместимыми с XLL, изменение манифеста в более позднее время может нарушить работу пользователя, так как изменит формат файла.</span><span class="sxs-lookup"><span data-stu-id="a263d-125">If an add-in declares its custom functions to be XLL compatible, changing the manifest at a later time could break a user's workbook because it will change the file format.</span></span>

## <a name="custom-function-behavior-for-xll-compatible-functions"></a><span data-ttu-id="a263d-126">Настраиваемое поведение функций для совместимых функций XLL</span><span class="sxs-lookup"><span data-stu-id="a263d-126">Custom function behavior for XLL compatible functions</span></span>

<span data-ttu-id="a263d-127">Функции XLL надстройки преобразуются в пользовательские функции, совместимые с XLL, когда открыта таблица и имеется эквивалентная надстройка.</span><span class="sxs-lookup"><span data-stu-id="a263d-127">An add-in's XLL functions are converted to XLL compatible custom functions when a spreadsheet is opened and there is an equivalent add-in available.</span></span> <span data-ttu-id="a263d-128">При следующем сохранения функции XLL записаны в файл в режиме совместимости, чтобы они работали как с пользовательскими функциями надстройки XLL и Excel (когда на других платформах).</span><span class="sxs-lookup"><span data-stu-id="a263d-128">On the next save, the XLL functions are written to the file in a compatible mode so that they work with both the XLL and Excel add-in custom functions (when on other platforms).</span></span>

<span data-ttu-id="a263d-129">В следующей таблице сравниваются функции, определяемые пользователем XLL, пользовательские функции, совместимые с XLL, и настраиваемые функции надстройки Excel.</span><span class="sxs-lookup"><span data-stu-id="a263d-129">The following table compares features across XLL user-defined functions, XLL compatible custom functions, and Excel add-in custom functions.</span></span>

|         |<span data-ttu-id="a263d-130">Функция, определяемая пользователем XLL</span><span class="sxs-lookup"><span data-stu-id="a263d-130">XLL user-defined function</span></span> |<span data-ttu-id="a263d-131">Пользовательские функции, совместимые с XLL</span><span class="sxs-lookup"><span data-stu-id="a263d-131">XLL compatible custom functions</span></span> |<span data-ttu-id="a263d-132">Настраиваемая функция надстройки Excel</span><span class="sxs-lookup"><span data-stu-id="a263d-132">Excel add-in custom function</span></span> |
|---------|---------|---------|---------|
| <span data-ttu-id="a263d-133">**Поддерживаемые платформы**</span><span class="sxs-lookup"><span data-stu-id="a263d-133">**Supported platforms**</span></span> | <span data-ttu-id="a263d-134">Windows</span><span class="sxs-lookup"><span data-stu-id="a263d-134">Windows</span></span> | <span data-ttu-id="a263d-135">Windows, macOS, веб-браузер</span><span class="sxs-lookup"><span data-stu-id="a263d-135">Windows, macOS, web browser</span></span> | <span data-ttu-id="a263d-136">Windows, macOS, веб-браузер</span><span class="sxs-lookup"><span data-stu-id="a263d-136">Windows, macOS, web browser</span></span> |
| <span data-ttu-id="a263d-137">**Поддерживаемые форматы файлов**</span><span class="sxs-lookup"><span data-stu-id="a263d-137">**Supported file formats**</span></span> | <span data-ttu-id="a263d-138">XLSX, XLSB, XLSM, XLS</span><span class="sxs-lookup"><span data-stu-id="a263d-138">XLSX, XLSB, XLSM, XLS</span></span> | <span data-ttu-id="a263d-139">XLSX, XLSB, XLSM</span><span class="sxs-lookup"><span data-stu-id="a263d-139">XLSX, XLSB, XLSM</span></span> | <span data-ttu-id="a263d-140">XLSX, XLSB, XLSM</span><span class="sxs-lookup"><span data-stu-id="a263d-140">XLSX, XLSB, XLSM</span></span> |
| <span data-ttu-id="a263d-141">**Автокомплект Формулы**</span><span class="sxs-lookup"><span data-stu-id="a263d-141">**Formula autocomplete**</span></span> | <span data-ttu-id="a263d-142">Нет</span><span class="sxs-lookup"><span data-stu-id="a263d-142">No</span></span> | <span data-ttu-id="a263d-143">Да</span><span class="sxs-lookup"><span data-stu-id="a263d-143">Yes</span></span> | <span data-ttu-id="a263d-144">Да</span><span class="sxs-lookup"><span data-stu-id="a263d-144">Yes</span></span> |
| <span data-ttu-id="a263d-145">**Подписка с потоковой передачей**</span><span class="sxs-lookup"><span data-stu-id="a263d-145">**Streaming**</span></span> | <span data-ttu-id="a263d-146">Возможно с помощью вызова xlfRTD и XLL.</span><span class="sxs-lookup"><span data-stu-id="a263d-146">Possible via xlfRTD and XLL callback.</span></span> | <span data-ttu-id="a263d-147">Да</span><span class="sxs-lookup"><span data-stu-id="a263d-147">Yes</span></span> | <span data-ttu-id="a263d-148">Да</span><span class="sxs-lookup"><span data-stu-id="a263d-148">Yes</span></span> |
| <span data-ttu-id="a263d-149">**Локализация функций**</span><span class="sxs-lookup"><span data-stu-id="a263d-149">**Localization of functions**</span></span> | <span data-ttu-id="a263d-150">Нет</span><span class="sxs-lookup"><span data-stu-id="a263d-150">No</span></span> | <span data-ttu-id="a263d-151">Нет.</span><span class="sxs-lookup"><span data-stu-id="a263d-151">No.</span></span> <span data-ttu-id="a263d-152">Имя и ID должны соответствовать существующим функциям XLL.</span><span class="sxs-lookup"><span data-stu-id="a263d-152">The Name and ID must match the existing XLL's functions.</span></span> | <span data-ttu-id="a263d-153">Да</span><span class="sxs-lookup"><span data-stu-id="a263d-153">Yes</span></span> |
| <span data-ttu-id="a263d-154">**Переменные функции**</span><span class="sxs-lookup"><span data-stu-id="a263d-154">**Volatile functions**</span></span> | <span data-ttu-id="a263d-155">Да</span><span class="sxs-lookup"><span data-stu-id="a263d-155">Yes</span></span> | <span data-ttu-id="a263d-156">Да</span><span class="sxs-lookup"><span data-stu-id="a263d-156">Yes</span></span> | <span data-ttu-id="a263d-157">Да</span><span class="sxs-lookup"><span data-stu-id="a263d-157">Yes</span></span> |
| <span data-ttu-id="a263d-158">**Поддержка перерасчета с несколькими потоками**</span><span class="sxs-lookup"><span data-stu-id="a263d-158">**Multi-threaded recalculation support**</span></span> | <span data-ttu-id="a263d-159">Да</span><span class="sxs-lookup"><span data-stu-id="a263d-159">Yes</span></span> | <span data-ttu-id="a263d-160">Да</span><span class="sxs-lookup"><span data-stu-id="a263d-160">Yes</span></span> | <span data-ttu-id="a263d-161">Да</span><span class="sxs-lookup"><span data-stu-id="a263d-161">Yes</span></span> |
| <span data-ttu-id="a263d-162">**Режим вычислений**</span><span class="sxs-lookup"><span data-stu-id="a263d-162">**Calculation behavior**</span></span> | <span data-ttu-id="a263d-163">Нет пользовательского интерфейса.</span><span class="sxs-lookup"><span data-stu-id="a263d-163">No UI.</span></span> <span data-ttu-id="a263d-164">Excel может быть безответным при вычислении.</span><span class="sxs-lookup"><span data-stu-id="a263d-164">Excel can be unresponsive during calculation.</span></span> | <span data-ttu-id="a263d-165">Пользователи увидят #BUSY!</span><span class="sxs-lookup"><span data-stu-id="a263d-165">Users will see #BUSY!</span></span> <span data-ttu-id="a263d-166">пока результат не будет возвращен.</span><span class="sxs-lookup"><span data-stu-id="a263d-166">until a result is returned.</span></span> | <span data-ttu-id="a263d-167">Пользователи увидят #BUSY!</span><span class="sxs-lookup"><span data-stu-id="a263d-167">Users will see #BUSY!</span></span> <span data-ttu-id="a263d-168">пока результат не будет возвращен.</span><span class="sxs-lookup"><span data-stu-id="a263d-168">until a result is returned.</span></span> |
| <span data-ttu-id="a263d-169">**Наборы требований**</span><span class="sxs-lookup"><span data-stu-id="a263d-169">**Requirement sets**</span></span> | <span data-ttu-id="a263d-170">Недоступно</span><span class="sxs-lookup"><span data-stu-id="a263d-170">N/A</span></span> | <span data-ttu-id="a263d-171">CustomFunctions 1.1 и более поздней</span><span class="sxs-lookup"><span data-stu-id="a263d-171">CustomFunctions 1.1 and later</span></span> | <span data-ttu-id="a263d-172">CustomFunctions 1.1 и более поздней</span><span class="sxs-lookup"><span data-stu-id="a263d-172">CustomFunctions 1.1 and later</span></span> |

## <a name="see-also"></a><span data-ttu-id="a263d-173">См. также</span><span class="sxs-lookup"><span data-stu-id="a263d-173">See also</span></span>

- [<span data-ttu-id="a263d-174">Убедитесь, что надстройка Office совместима с существующей надстройкой COM</span><span class="sxs-lookup"><span data-stu-id="a263d-174">Make your Office Add-in compatible with an existing COM add-in</span></span>](../develop/make-office-add-in-compatible-with-existing-com-add-in.md)
- [<span data-ttu-id="a263d-175">Руководство по пользовательским функциям в Excel</span><span class="sxs-lookup"><span data-stu-id="a263d-175">Excel custom functions tutorial</span></span>](../tutorials/excel-tutorial-create-custom-functions.md)
