---
title: Обеспечение совместимости пользовательских функций с пользовательскими функциями XLL
description: Обеспечение совместимости с пользовательскими функциями XLL в Excel, которые имеют эквивалентные функциональные возможности для пользовательских функций
ms.date: 04/22/2019
localization_priority: Normal
ms.openlocfilehash: 09914e040c1721dd8b9e91952e5814e7a6b914e5
ms.sourcegitcommit: 7462409209264dc7f8f89f3808a7a6249fcd739e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/26/2019
ms.locfileid: "33356913"
---
# <a name="make-your-custom-functions-compatible-with-xll-user-defined-functions"></a><span data-ttu-id="4fdae-103">Обеспечение совместимости пользовательских функций с пользовательскими функциями XLL</span><span class="sxs-lookup"><span data-stu-id="4fdae-103">Make your custom functions compatible with XLL user-defined functions</span></span>

<span data-ttu-id="4fdae-104">Если у вас есть XLL-модули Excel, вы можете создавать эквивалентные пользовательские функции в надстройке Office, чтобы расширить функциональные возможности решения на другие платформы, такие как Online или macOS.</span><span class="sxs-lookup"><span data-stu-id="4fdae-104">If you have existing Excel XLLs, you can build equivalent custom functions in an Office Add-in to extend your solution features to other platforms such as online or macOS.</span></span> <span data-ttu-id="4fdae-105">Однако у надстроек Office не все функции, доступные в XLL.</span><span class="sxs-lookup"><span data-stu-id="4fdae-105">However, Office Add-ins don't have all of the functionality available in XLLs.</span></span> <span data-ttu-id="4fdae-106">В зависимости от того, какие функции использует ваше решение, XLL может оказаться более эффективным, чем пользовательские функции надстроек Office в Excel для Windows.</span><span class="sxs-lookup"><span data-stu-id="4fdae-106">Depending on the functionality your solution uses, the XLL may provide a better experience than the Office Add-in custom functions on Excel for Windows.</span></span>

<span data-ttu-id="4fdae-107">Вы можете настроить надстройку Office, чтобы если на компьютере пользователя уже установлен эквивалентный XLL-модуль, Excel запускает XLL, а не пользовательские функции надстройки Office.</span><span class="sxs-lookup"><span data-stu-id="4fdae-107">You can configure your Office Add-in so that when an equivalent XLL is already installed on the user's computer, Excel runs the XLL instead of your Office Add-in custom functions.</span></span> <span data-ttu-id="4fdae-108">XLL называется эквивалентным, так как Excel будет беспрепятственно переходить между XLL и пользовательскими функциями надстройки Office в зависимости от того, какая из них установлена в Windows.</span><span class="sxs-lookup"><span data-stu-id="4fdae-108">The XLL is called equivalent because Excel will seamlessly transition between the XLL and the Office Add-in custom functions depending on which is installed on Windows.</span></span>

[!include[Excel custom functions note](../includes/excel-custom-functions-note.md)]

## <a name="specify-equivalent-xll-in-the-manifest"></a><span data-ttu-id="4fdae-109">Указание эквивалентного XLL в манифесте</span><span class="sxs-lookup"><span data-stu-id="4fdae-109">Specify equivalent XLL in the manifest</span></span>

<span data-ttu-id="4fdae-110">Чтобы обеспечить совместимость с существующим XLL, определите эквивалентный XLL в манифесте надстройки Office.</span><span class="sxs-lookup"><span data-stu-id="4fdae-110">To enable compatibility with an existing XLL, identify the equivalent XLL in the manifest of your Office Add-in.</span></span> <span data-ttu-id="4fdae-111">После этого Excel будет использовать функции XLL, а не пользовательские функции надстроек Office при работе в Windows.</span><span class="sxs-lookup"><span data-stu-id="4fdae-111">Then Excel will use the XLL's functions instead of your Office Add-in custom functions when running on Windows.</span></span>

<span data-ttu-id="4fdae-112">Чтобы задать для настраиваемых функций эквивалентный XLL, укажите значение `FileName` XLL.</span><span class="sxs-lookup"><span data-stu-id="4fdae-112">To set the equivalent XLL for your custom functions, specify the `FileName` of the XLL.</span></span> <span data-ttu-id="4fdae-113">Когда пользователь открывает книгу с функциями XLL, Excel преобразует функции в совместимые функции.</span><span class="sxs-lookup"><span data-stu-id="4fdae-113">When the user opens a workbook with functions from the XLL, Excel converts the functions to compatible functions.</span></span> <span data-ttu-id="4fdae-114">Затем книга использует XLL при открытии в Excel для Windows, и она будет использовать пользовательские функции из надстройки Office при открытии в Интернете или в macOS.</span><span class="sxs-lookup"><span data-stu-id="4fdae-114">The workbook then uses the XLL when opened in Excel on Windows, and it will use custom functions from your Office Add-in when opened online or on macOS.</span></span>

<span data-ttu-id="4fdae-115">В приведенном ниже примере показано, как указать как надстройку COM, так и XLL в качестве эквивалента.</span><span class="sxs-lookup"><span data-stu-id="4fdae-115">The following example shows how to specify both a COM add-in and an XLL as equivalent.</span></span> <span data-ttu-id="4fdae-116">Как правило, для полноты указывается и то, и другое, в этом примере показана как в контексте.</span><span class="sxs-lookup"><span data-stu-id="4fdae-116">Often you will specify both so for completeness this example shows both in context.</span></span> <span data-ttu-id="4fdae-117">Они определяются по их `ProgID` и `FileName` соответственно.</span><span class="sxs-lookup"><span data-stu-id="4fdae-117">They are identified by their `ProgID` and `FileName` respectively.</span></span> <span data-ttu-id="4fdae-118">Более подробную информацию о совместимости надстроек COM можно узнать в статье [Создание надстройки Office, совместимой с существующей надстройкОЙ com](../develop/make-office-add-in-compatible-with-existing-com-add-in.md).</span><span class="sxs-lookup"><span data-stu-id="4fdae-118">For more information on COM add-in compatibility, see [Make your Office Add-in compatible with an existing COM add-in](../develop/make-office-add-in-compatible-with-existing-com-add-in.md).</span></span>

```xml
<VersionOverrides>
...
<EquivalentAddins>
  <EquivalentAddin>
    <ProgID>ContosoCOMAddin</ProgID>
    <Type>COM</Type>
  </EquivalentAddin>

  <EquivalentAddin>
    <FileName>contosofunctions.xll</FileName>
    <Type>XLL</Type>
  </EquivalentAddin>
<EquivalentAddins>
...
</VersionOverrides>
```

> [!NOTE]
> <span data-ttu-id="4fdae-119">Если надстройка объявляет свои собственные функции поддерживаемыми XLL-МОДУЛЯми, изменение манифеста в дальнейшем может привести к повреждению книги пользователя, так как он изменит формат файла.</span><span class="sxs-lookup"><span data-stu-id="4fdae-119">If an add-in declares its custom functions to be XLL compatible, changing the manifest at a later time could break a user’s workbook because it will change the file format.</span></span>

## <a name="office-add-in-updates"></a><span data-ttu-id="4fdae-120">Обновления для надстроек Office</span><span class="sxs-lookup"><span data-stu-id="4fdae-120">Office Add-in updates</span></span>

<span data-ttu-id="4fdae-121">Когда вы укажете эквивалентный XLL для надстройки Office, Excel прекратит обработку обновлений для надстройки Office.</span><span class="sxs-lookup"><span data-stu-id="4fdae-121">Once you specify an equivalent XLL for your Office Add-in, Excel stops processing updates for your Office Add-in.</span></span> <span data-ttu-id="4fdae-122">Пользователь должен удалить XLL, чтобы получить последние обновления для надстройки Office.</span><span class="sxs-lookup"><span data-stu-id="4fdae-122">The user must uninstall the XLL in order to get the latest updates for the Office Add-in.</span></span>

## <a name="custom-function-behavior-for-xll-compatible-functions"></a><span data-ttu-id="4fdae-123">Поведение настраиваемой функции для функций, совместимых с XLL</span><span class="sxs-lookup"><span data-stu-id="4fdae-123">Custom function behavior for XLL compatible functions</span></span>

<span data-ttu-id="4fdae-124">При открытии электронной таблицы, содержащей функции XLL, для которых также есть эквивалентная надстройка, функции XLL преобразуются в настраиваемые функции, совместимые с XLL-МОДУЛЯми.</span><span class="sxs-lookup"><span data-stu-id="4fdae-124">When a spreadsheet is opened that contains XLL functions for which there is also an equivalent add-in, the XLL's functions are converted to XLL compatible custom functions.</span></span> <span data-ttu-id="4fdae-125">При следующем сохранении они записываются в файл в совместимом режиме, чтобы они работали с пользовательскими функциями XLL и Office (если на других платформах).</span><span class="sxs-lookup"><span data-stu-id="4fdae-125">On the next save, they are written to the file in a compatible mode so that they work with both the XLL and Office Add-in custom functions (when on other platforms).</span></span>

<span data-ttu-id="4fdae-126">В следующей таблице сравниваются функции в пользовательских функциях XLL, пользовательских функциях, совместимых с XLL, и пользовательских функциях надстроек Office.</span><span class="sxs-lookup"><span data-stu-id="4fdae-126">The following table compares features across XLL user-defined functions, XLL compatible custom functions, and Office Add-in custom functions.</span></span>

|         |<span data-ttu-id="4fdae-127">Определяемая пользователем функция XLL</span><span class="sxs-lookup"><span data-stu-id="4fdae-127">XLL user-defined function</span></span> |<span data-ttu-id="4fdae-128">Настраиваемые функции, совместимые с XLL</span><span class="sxs-lookup"><span data-stu-id="4fdae-128">XLL compatible custom functions</span></span> |<span data-ttu-id="4fdae-129">Пользовательская функция надстройки Office</span><span class="sxs-lookup"><span data-stu-id="4fdae-129">Office Add-in custom function</span></span> |
|---------|---------|---------|---------|
| <span data-ttu-id="4fdae-130">Поддерживаемые платформы</span><span class="sxs-lookup"><span data-stu-id="4fdae-130">Supported platforms</span></span> | <span data-ttu-id="4fdae-131">Windows</span><span class="sxs-lookup"><span data-stu-id="4fdae-131">Windows</span></span> | <span data-ttu-id="4fdae-132">Windows, macOS, Excel Online</span><span class="sxs-lookup"><span data-stu-id="4fdae-132">Windows, macOS, Excel online</span></span> | <span data-ttu-id="4fdae-133">Windows, macOS, Excel Online</span><span class="sxs-lookup"><span data-stu-id="4fdae-133">Windows, macOS, Excel online</span></span> |
| <span data-ttu-id="4fdae-134">Поддерживаемые форматы файлов</span><span class="sxs-lookup"><span data-stu-id="4fdae-134">Supported file formats</span></span> | <span data-ttu-id="4fdae-135">XLSX, XLSB, XLSM, XLS</span><span class="sxs-lookup"><span data-stu-id="4fdae-135">XLSX, XLSB, XLSM, XLS</span></span> | <span data-ttu-id="4fdae-136">XLSX, XLSB, XLSM</span><span class="sxs-lookup"><span data-stu-id="4fdae-136">XLSX, XLSB, XLSM</span></span> | <span data-ttu-id="4fdae-137">XLSX, XLSB, XLSM</span><span class="sxs-lookup"><span data-stu-id="4fdae-137">XLSX, XLSB, XLSM</span></span> |
| <span data-ttu-id="4fdae-138">Автозаполнение формул</span><span class="sxs-lookup"><span data-stu-id="4fdae-138">Formula autocomplete</span></span> | <span data-ttu-id="4fdae-139">Нет</span><span class="sxs-lookup"><span data-stu-id="4fdae-139">No</span></span> | <span data-ttu-id="4fdae-140">Да</span><span class="sxs-lookup"><span data-stu-id="4fdae-140">Yes</span></span> | <span data-ttu-id="4fdae-141">Да</span><span class="sxs-lookup"><span data-stu-id="4fdae-141">Yes</span></span> |
| <span data-ttu-id="4fdae-142">Подписка с потоковой передачей</span><span class="sxs-lookup"><span data-stu-id="4fdae-142">Streaming</span></span> | <span data-ttu-id="4fdae-143">Возможно, с помощью обратного вызова Кслфртд и XLL.</span><span class="sxs-lookup"><span data-stu-id="4fdae-143">Possible via xlfRTD and XLL callback.</span></span> | <span data-ttu-id="4fdae-144">Да</span><span class="sxs-lookup"><span data-stu-id="4fdae-144">Yes</span></span> | <span data-ttu-id="4fdae-145">Да</span><span class="sxs-lookup"><span data-stu-id="4fdae-145">Yes</span></span> |
| <span data-ttu-id="4fdae-146">Локализация функций</span><span class="sxs-lookup"><span data-stu-id="4fdae-146">Localization of functions</span></span> | <span data-ttu-id="4fdae-147">Нет</span><span class="sxs-lookup"><span data-stu-id="4fdae-147">No</span></span> | <span data-ttu-id="4fdae-148">Нет.</span><span class="sxs-lookup"><span data-stu-id="4fdae-148">No.</span></span> <span data-ttu-id="4fdae-149">Имя и идентификатор должны быть согласованы с имеющимися функциями XLL.</span><span class="sxs-lookup"><span data-stu-id="4fdae-149">The Name and ID must match the existing XLL's functions.</span></span> | <span data-ttu-id="4fdae-150">Да</span><span class="sxs-lookup"><span data-stu-id="4fdae-150">Yes</span></span> |
| <span data-ttu-id="4fdae-151">Переменные функции</span><span class="sxs-lookup"><span data-stu-id="4fdae-151">Volatile functions</span></span> | <span data-ttu-id="4fdae-152">Да</span><span class="sxs-lookup"><span data-stu-id="4fdae-152">Yes</span></span> | <span data-ttu-id="4fdae-153">Да</span><span class="sxs-lookup"><span data-stu-id="4fdae-153">Yes</span></span> | <span data-ttu-id="4fdae-154">Да</span><span class="sxs-lookup"><span data-stu-id="4fdae-154">Yes</span></span> |
| <span data-ttu-id="4fdae-155">Поддержка многопоточного пересчета</span><span class="sxs-lookup"><span data-stu-id="4fdae-155">Multi-threaded recalculation support</span></span> | <span data-ttu-id="4fdae-156">Да</span><span class="sxs-lookup"><span data-stu-id="4fdae-156">Yes</span></span> | <span data-ttu-id="4fdae-157">Да</span><span class="sxs-lookup"><span data-stu-id="4fdae-157">Yes</span></span> | <span data-ttu-id="4fdae-158">Да</span><span class="sxs-lookup"><span data-stu-id="4fdae-158">Yes</span></span> |
| <span data-ttu-id="4fdae-159">Поведение расчетов</span><span class="sxs-lookup"><span data-stu-id="4fdae-159">Calculation behavior</span></span> | <span data-ttu-id="4fdae-160">Нет ПОЛЬЗОВАТЕЛЬСКОГО интерфейса.</span><span class="sxs-lookup"><span data-stu-id="4fdae-160">No UI.</span></span> <span data-ttu-id="4fdae-161">В процессе вычисления Excel может не отвечать.</span><span class="sxs-lookup"><span data-stu-id="4fdae-161">Excel can be unresponsive during calculation.</span></span> | <span data-ttu-id="4fdae-162">Пользователи увидят #BUSY!</span><span class="sxs-lookup"><span data-stu-id="4fdae-162">Users will see #BUSY!</span></span> <span data-ttu-id="4fdae-163">до тех пор, пока не будет возвращен результат.</span><span class="sxs-lookup"><span data-stu-id="4fdae-163">until a result is returned.</span></span> | <span data-ttu-id="4fdae-164">Пользователи увидят #BUSY!</span><span class="sxs-lookup"><span data-stu-id="4fdae-164">Users will see #BUSY!</span></span> <span data-ttu-id="4fdae-165">до тех пор, пока не будет возвращен результат.</span><span class="sxs-lookup"><span data-stu-id="4fdae-165">until a result is returned.</span></span> |
| <span data-ttu-id="4fdae-166">Наборы требований</span><span class="sxs-lookup"><span data-stu-id="4fdae-166">Requirement sets</span></span> | <span data-ttu-id="4fdae-167">Недоступно</span><span class="sxs-lookup"><span data-stu-id="4fdae-167">N/A</span></span> | <span data-ttu-id="4fdae-168">Только CustomFunctions 1,1</span><span class="sxs-lookup"><span data-stu-id="4fdae-168">CustomFunctions 1.1 only</span></span> | <span data-ttu-id="4fdae-169">CustomFunctions 1,1 и более поздние версии</span><span class="sxs-lookup"><span data-stu-id="4fdae-169">CustomFunctions 1.1 and later</span></span> |

## <a name="see-also"></a><span data-ttu-id="4fdae-170">См. также</span><span class="sxs-lookup"><span data-stu-id="4fdae-170">See also</span></span>

- [<span data-ttu-id="4fdae-171">Обеспечение совместимости надстройки Office с существующей надстройкой COM</span><span class="sxs-lookup"><span data-stu-id="4fdae-171">Make your Office Add-in compatible with an existing COM add-in</span></span>](../develop/make-office-add-in-compatible-with-existing-com-add-in.md)
- [<span data-ttu-id="4fdae-172">Рекомендации по пользовательским функциям</span><span class="sxs-lookup"><span data-stu-id="4fdae-172">Custom functions best practices</span></span>](custom-functions-best-practices.md)
- [<span data-ttu-id="4fdae-173">Журнал изменений пользовательских функций</span><span class="sxs-lookup"><span data-stu-id="4fdae-173">Custom functions changelog</span></span>](custom-functions-changelog.md)
- [<span data-ttu-id="4fdae-174">Руководство по настраиваемым функциям в Excel</span><span class="sxs-lookup"><span data-stu-id="4fdae-174">Excel custom functions tutorial</span></span>](../tutorials/excel-tutorial-create-custom-functions.md)