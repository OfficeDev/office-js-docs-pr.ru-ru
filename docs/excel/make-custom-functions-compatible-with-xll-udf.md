---
title: Расширение пользовательских функций с помощью пользовательских функций XLL
description: Обеспечение совместимости с пользовательскими функциями XLL в Excel, которые имеют эквивалентные функциональные возможности для пользовательских функций
ms.date: 04/29/2020
localization_priority: Normal
ms.openlocfilehash: 82f4dba3bd82743efd84a2fe88c893042c061461
ms.sourcegitcommit: 54e2892c0c26b9ad1e4dba8aba48fea39f853b6c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/18/2020
ms.locfileid: "44275772"
---
# <a name="extend-custom-functions-with-xll-user-defined-functions"></a><span data-ttu-id="1411c-103">Расширение пользовательских функций с помощью пользовательских функций XLL</span><span class="sxs-lookup"><span data-stu-id="1411c-103">Extend custom functions with XLL user-defined functions</span></span>

<span data-ttu-id="1411c-104">Если у вас есть XLL-модули Excel, вы можете создавать эквивалентные пользовательские функции в надстройке Excel, чтобы расширить возможности решения до других платформ, таких как Online или Mac.</span><span class="sxs-lookup"><span data-stu-id="1411c-104">If you have existing Excel XLLs, you can build equivalent custom functions in an Excel add-in to extend your solution features to other platforms such as online or on a Mac.</span></span> <span data-ttu-id="1411c-105">Тем не менее, надстройки Excel не обладают всеми функциями, доступными в XLL.</span><span class="sxs-lookup"><span data-stu-id="1411c-105">However, Excel add-ins don't have all of the functionality available in XLLs.</span></span> <span data-ttu-id="1411c-106">В зависимости от того, какие функции использует ваше решение, XLL может оказаться более эффективным, чем пользовательские функции надстроек Excel в Excel для Windows.</span><span class="sxs-lookup"><span data-stu-id="1411c-106">Depending on the functionality your solution uses, the XLL may provide a better experience than the Excel add-in custom functions in Excel on Windows.</span></span>

> [!NOTE]
> <span data-ttu-id="1411c-107">Совместимость надстроек COM и XLL UDF поддерживается на следующих платформах при подключении к подписке Office 365:</span><span class="sxs-lookup"><span data-stu-id="1411c-107">COM add-in and XLL UDF compatibility is supported by the following platforms, when connected to an Office 365 subscription:</span></span>
> - <span data-ttu-id="1411c-108">Excel в Интернете</span><span class="sxs-lookup"><span data-stu-id="1411c-108">Excel on the web</span></span>
> - <span data-ttu-id="1411c-109">Excel в Windows (версия 1904 или более поздняя)</span><span class="sxs-lookup"><span data-stu-id="1411c-109">Excel on Windows (version 1904 or later)</span></span>
> - <span data-ttu-id="1411c-110">Excel на Mac (версия 13,329 или более поздняя)</span><span class="sxs-lookup"><span data-stu-id="1411c-110">Excel on Mac (version 13.329 or later)</span></span>
> 
> <span data-ttu-id="1411c-111">Чтобы использовать надстройку COM и совместимость UDF для XLL в Excel в Интернете, войдите в систему с помощью подписки на Office 365 или [учетной записи Майкрософт](https://account.microsoft.com/account).</span><span class="sxs-lookup"><span data-stu-id="1411c-111">To use COM add-in and XLL UDF compatibility within Excel on the web, login by using either your Office 365 subscription or a [Microsoft account](https://account.microsoft.com/account).</span></span> <span data-ttu-id="1411c-112">Если у вас еще нет подписки на Office 365, вы можете 90 бесплатно ознакомиться с реневабленой подпиской на Office 365, дополнив присоединение к [программе для разработчиков office 365](https://developer.microsoft.com/office/dev-program).</span><span class="sxs-lookup"><span data-stu-id="1411c-112">If you don't already have an Office 365 subscription, you can a free, 90-day renewable Office 365 subscription by joining the [Office 365 Developer Program](https://developer.microsoft.com/office/dev-program).</span></span>

## <a name="specify-equivalent-xll-in-the-manifest"></a><span data-ttu-id="1411c-113">Указание эквивалентного XLL в манифесте</span><span class="sxs-lookup"><span data-stu-id="1411c-113">Specify equivalent XLL in the manifest</span></span>

<span data-ttu-id="1411c-114">Чтобы обеспечить совместимость с существующим XLL, определите эквивалентный XLL в манифесте надстройки Excel.</span><span class="sxs-lookup"><span data-stu-id="1411c-114">To enable compatibility with an existing XLL, identify the equivalent XLL in the manifest of your Excel add-in.</span></span> <span data-ttu-id="1411c-115">После этого Excel будет использовать функции XLL, а не пользовательские функции надстройки Excel при работе в Windows.</span><span class="sxs-lookup"><span data-stu-id="1411c-115">Excel will then use the XLL's functions instead of your Excel add-in custom functions when running on Windows.</span></span>

<span data-ttu-id="1411c-116">Чтобы задать для настраиваемых функций эквивалентный XLL, укажите значение `FileName` XLL.</span><span class="sxs-lookup"><span data-stu-id="1411c-116">To set the equivalent XLL for your custom functions, specify the `FileName` of the XLL.</span></span> <span data-ttu-id="1411c-117">Когда пользователь открывает книгу с функциями XLL, Excel преобразует функции в совместимые функции.</span><span class="sxs-lookup"><span data-stu-id="1411c-117">When the user opens a workbook with functions from the XLL, Excel converts the functions to compatible functions.</span></span> <span data-ttu-id="1411c-118">Затем книга использует XLL при открытии в Excel для Windows, и она будет использовать пользовательские функции надстройки Excel при открытии в Интернете или на компьютере Mac.</span><span class="sxs-lookup"><span data-stu-id="1411c-118">The workbook then uses the XLL when opened in Excel on Windows, and it will use custom functions from your Excel add-in when opened online or on a Mac.</span></span>

<span data-ttu-id="1411c-119">В приведенном ниже примере показано, как указать как надстройку COM, так и XLL в качестве эквивалента.</span><span class="sxs-lookup"><span data-stu-id="1411c-119">The following example shows how to specify both a COM add-in and an XLL as equivalent.</span></span> <span data-ttu-id="1411c-120">Часто вы задаете и то, и другое.</span><span class="sxs-lookup"><span data-stu-id="1411c-120">Often you will specify both.</span></span> <span data-ttu-id="1411c-121">Для полноты в этом примере отображаются как в контексте, так и в.</span><span class="sxs-lookup"><span data-stu-id="1411c-121">For completeness, this example shows both in context.</span></span> <span data-ttu-id="1411c-122">Они определяются по их `ProgId` и `FileName` соответственно.</span><span class="sxs-lookup"><span data-stu-id="1411c-122">They are identified by their `ProgId` and `FileName` respectively.</span></span> <span data-ttu-id="1411c-123">`EquivalentAddins`Элемент должен быть расположен сразу перед закрывающим `VersionOverrides` тегом.</span><span class="sxs-lookup"><span data-stu-id="1411c-123">The `EquivalentAddins` element must be positioned immediately before the closing `VersionOverrides` tag.</span></span> <span data-ttu-id="1411c-124">Более подробную информацию о совместимости надстроек COM можно узнать в статье [Создание надстройки Excel, совместимой с существующей надстройкой COM](../develop/make-office-add-in-compatible-with-existing-com-add-in.md).</span><span class="sxs-lookup"><span data-stu-id="1411c-124">For more information on COM add-in compatibility, see [Make your Excel add-in compatible with an existing COM add-in](../develop/make-office-add-in-compatible-with-existing-com-add-in.md).</span></span>

```xml
<VersionOverrides>
  ...
  <EquivalentAddins>
    <EquivalentAddin>
      <ProgId>ContosoCOMAddin</ProgId>
      <Type>COM</Type>
    </EquivalentAddin>

    <EquivalentAddin>
      <FileName>contosofunctions.xll</FileName>
      <Type>XLL</Type>
    </EquivalentAddin>
  <EquivalentAddins>
</VersionOverrides>
```

> [!NOTE]
> <span data-ttu-id="1411c-125">Если надстройка объявляет свои собственные функции поддерживаемыми XLL-модулями, изменение манифеста в дальнейшем может привести к повреждению книги пользователя, так как он изменит формат файла.</span><span class="sxs-lookup"><span data-stu-id="1411c-125">If an add-in declares its custom functions to be XLL compatible, changing the manifest at a later time could break a user's workbook because it will change the file format.</span></span>

## <a name="custom-function-behavior-for-xll-compatible-functions"></a><span data-ttu-id="1411c-126">Поведение настраиваемой функции для функций, совместимых с XLL</span><span class="sxs-lookup"><span data-stu-id="1411c-126">Custom function behavior for XLL compatible functions</span></span>

<span data-ttu-id="1411c-127">Функции XLL для надстройки преобразуются в настраиваемые функции, совместимые с XLL, при открытии электронной таблицы и наличии эквивалентной надстройки.</span><span class="sxs-lookup"><span data-stu-id="1411c-127">An add-in's XLL functions are converted to XLL compatible custom functions when a spreadsheet is opened and there is an equivalent add-in available.</span></span> <span data-ttu-id="1411c-128">При следующем сохранении функции XLL записываются в файл в совместимом режиме, чтобы они работали с настраиваемыми функциями XLL и Excel (если на других платформах).</span><span class="sxs-lookup"><span data-stu-id="1411c-128">On the next save, the XLL functions are written to the file in a compatible mode so that they work with both the XLL and Excel add-in custom functions (when on other platforms).</span></span>

<span data-ttu-id="1411c-129">В следующей таблице сравниваются функции в пользовательских функциях XLL, пользовательских функциях, совместимых с XLL, и пользовательские функции надстройки Excel.</span><span class="sxs-lookup"><span data-stu-id="1411c-129">The following table compares features across XLL user-defined functions, XLL compatible custom functions, and Excel add-in custom functions.</span></span>

|         |<span data-ttu-id="1411c-130">Определяемая пользователем функция XLL</span><span class="sxs-lookup"><span data-stu-id="1411c-130">XLL user-defined function</span></span> |<span data-ttu-id="1411c-131">Настраиваемые функции, совместимые с XLL</span><span class="sxs-lookup"><span data-stu-id="1411c-131">XLL compatible custom functions</span></span> |<span data-ttu-id="1411c-132">Пользовательская функция надстройки Excel</span><span class="sxs-lookup"><span data-stu-id="1411c-132">Excel add-in custom function</span></span> |
|---------|---------|---------|---------|
| <span data-ttu-id="1411c-133">Поддерживаемые платформы</span><span class="sxs-lookup"><span data-stu-id="1411c-133">Supported platforms</span></span> | <span data-ttu-id="1411c-134">Windows</span><span class="sxs-lookup"><span data-stu-id="1411c-134">Windows</span></span> | <span data-ttu-id="1411c-135">Windows, macOS, веб-браузер</span><span class="sxs-lookup"><span data-stu-id="1411c-135">Windows, macOS, web browser</span></span> | <span data-ttu-id="1411c-136">Windows, macOS, веб-браузер</span><span class="sxs-lookup"><span data-stu-id="1411c-136">Windows, macOS, web browser</span></span> |
| <span data-ttu-id="1411c-137">Поддерживаемые форматы файлов</span><span class="sxs-lookup"><span data-stu-id="1411c-137">Supported file formats</span></span> | <span data-ttu-id="1411c-138">XLSX, XLSB, XLSM, XLS</span><span class="sxs-lookup"><span data-stu-id="1411c-138">XLSX, XLSB, XLSM, XLS</span></span> | <span data-ttu-id="1411c-139">XLSX, XLSB, XLSM</span><span class="sxs-lookup"><span data-stu-id="1411c-139">XLSX, XLSB, XLSM</span></span> | <span data-ttu-id="1411c-140">XLSX, XLSB, XLSM</span><span class="sxs-lookup"><span data-stu-id="1411c-140">XLSX, XLSB, XLSM</span></span> |
| <span data-ttu-id="1411c-141">Автозаполнение формул</span><span class="sxs-lookup"><span data-stu-id="1411c-141">Formula autocomplete</span></span> | <span data-ttu-id="1411c-142">Нет</span><span class="sxs-lookup"><span data-stu-id="1411c-142">No</span></span> | <span data-ttu-id="1411c-143">Да</span><span class="sxs-lookup"><span data-stu-id="1411c-143">Yes</span></span> | <span data-ttu-id="1411c-144">Да</span><span class="sxs-lookup"><span data-stu-id="1411c-144">Yes</span></span> |
| <span data-ttu-id="1411c-145">Подписка с потоковой передачей</span><span class="sxs-lookup"><span data-stu-id="1411c-145">Streaming</span></span> | <span data-ttu-id="1411c-146">Возможно, с помощью обратного вызова Кслфртд и XLL.</span><span class="sxs-lookup"><span data-stu-id="1411c-146">Possible via xlfRTD and XLL callback.</span></span> | <span data-ttu-id="1411c-147">Нет</span><span class="sxs-lookup"><span data-stu-id="1411c-147">No</span></span> | <span data-ttu-id="1411c-148">Да</span><span class="sxs-lookup"><span data-stu-id="1411c-148">Yes</span></span> |
| <span data-ttu-id="1411c-149">Локализация функций</span><span class="sxs-lookup"><span data-stu-id="1411c-149">Localization of functions</span></span> | <span data-ttu-id="1411c-150">Нет</span><span class="sxs-lookup"><span data-stu-id="1411c-150">No</span></span> | <span data-ttu-id="1411c-151">Нет.</span><span class="sxs-lookup"><span data-stu-id="1411c-151">No.</span></span> <span data-ttu-id="1411c-152">Имя и идентификатор должны быть согласованы с имеющимися функциями XLL.</span><span class="sxs-lookup"><span data-stu-id="1411c-152">The Name and ID must match the existing XLL's functions.</span></span> | <span data-ttu-id="1411c-153">Да</span><span class="sxs-lookup"><span data-stu-id="1411c-153">Yes</span></span> |
| <span data-ttu-id="1411c-154">Переменные функции</span><span class="sxs-lookup"><span data-stu-id="1411c-154">Volatile functions</span></span> | <span data-ttu-id="1411c-155">Да</span><span class="sxs-lookup"><span data-stu-id="1411c-155">Yes</span></span> | <span data-ttu-id="1411c-156">Да</span><span class="sxs-lookup"><span data-stu-id="1411c-156">Yes</span></span> | <span data-ttu-id="1411c-157">Да</span><span class="sxs-lookup"><span data-stu-id="1411c-157">Yes</span></span> |
| <span data-ttu-id="1411c-158">Поддержка многопоточного пересчета</span><span class="sxs-lookup"><span data-stu-id="1411c-158">Multi-threaded recalculation support</span></span> | <span data-ttu-id="1411c-159">Да</span><span class="sxs-lookup"><span data-stu-id="1411c-159">Yes</span></span> | <span data-ttu-id="1411c-160">Да</span><span class="sxs-lookup"><span data-stu-id="1411c-160">Yes</span></span> | <span data-ttu-id="1411c-161">Да</span><span class="sxs-lookup"><span data-stu-id="1411c-161">Yes</span></span> |
| <span data-ttu-id="1411c-162">Поведение расчетов</span><span class="sxs-lookup"><span data-stu-id="1411c-162">Calculation behavior</span></span> | <span data-ttu-id="1411c-163">Нет пользовательского интерфейса.</span><span class="sxs-lookup"><span data-stu-id="1411c-163">No UI.</span></span> <span data-ttu-id="1411c-164">В процессе вычисления Excel может не отвечать.</span><span class="sxs-lookup"><span data-stu-id="1411c-164">Excel can be unresponsive during calculation.</span></span> | <span data-ttu-id="1411c-165">Пользователи увидят #BUSY!</span><span class="sxs-lookup"><span data-stu-id="1411c-165">Users will see #BUSY!</span></span> <span data-ttu-id="1411c-166">до тех пор, пока не будет возвращен результат.</span><span class="sxs-lookup"><span data-stu-id="1411c-166">until a result is returned.</span></span> | <span data-ttu-id="1411c-167">Пользователи увидят #BUSY!</span><span class="sxs-lookup"><span data-stu-id="1411c-167">Users will see #BUSY!</span></span> <span data-ttu-id="1411c-168">до тех пор, пока не будет возвращен результат.</span><span class="sxs-lookup"><span data-stu-id="1411c-168">until a result is returned.</span></span> |
| <span data-ttu-id="1411c-169">Наборы обязательных элементов</span><span class="sxs-lookup"><span data-stu-id="1411c-169">Requirement sets</span></span> | <span data-ttu-id="1411c-170">Н/Д</span><span class="sxs-lookup"><span data-stu-id="1411c-170">N/A</span></span> | <span data-ttu-id="1411c-171">CustomFunctions 1,1 и более поздние версии</span><span class="sxs-lookup"><span data-stu-id="1411c-171">CustomFunctions 1.1 and later</span></span> | <span data-ttu-id="1411c-172">CustomFunctions 1,1 и более поздние версии</span><span class="sxs-lookup"><span data-stu-id="1411c-172">CustomFunctions 1.1 and later</span></span> |

## <a name="see-also"></a><span data-ttu-id="1411c-173">См. также</span><span class="sxs-lookup"><span data-stu-id="1411c-173">See also</span></span>

- [<span data-ttu-id="1411c-174">Обеспечение совместимости надстройки Excel с существующей надстройкой COM</span><span class="sxs-lookup"><span data-stu-id="1411c-174">Make your Excel add-in compatible with an existing COM add-in</span></span>](../develop/make-office-add-in-compatible-with-existing-com-add-in.md)
- [<span data-ttu-id="1411c-175">Руководство по пользовательским функциям в Excel</span><span class="sxs-lookup"><span data-stu-id="1411c-175">Excel custom functions tutorial</span></span>](../tutorials/excel-tutorial-create-custom-functions.md)
