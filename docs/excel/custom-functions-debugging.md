---
ms.date: 07/10/2020
description: Узнайте, как отлагировать настраиваемые функции Excel, которые не используют области задач.
title: Отладка пользовательских функций без пользовательского интерфейса
localization_priority: Normal
ms.openlocfilehash: 00065a465a22f83891dfb207943102b079e96a0f
ms.sourcegitcommit: 7482ab6bc258d98acb9ba9b35c7dd3b5cc5bed21
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/24/2021
ms.locfileid: "51178078"
---
# <a name="ui-less-custom-functions-debugging"></a>Отладка пользовательских функций без пользовательского интерфейса

Отладка настраиваемой функции, не использующей области задач или другие элементы пользовательского интерфейса (пользовательские функции без пользовательского интерфейса), может быть выполнена несколькими средствами в зависимости от используемой платформы.

[!include[Excel custom functions note](../includes/excel-custom-functions-note.md)]

[!include[Shared runtime note](../includes/shared-runtime-note.md)]

В Windows:
- [Отладка Visual Studio и кода Excel](#use-the-vs-code-debugger-for-excel-desktop)
- [Excel в Интернете и отладка кода VS](#use-the-vs-code-debugger-for-excel-in-microsoft-edge)
- [Excel в веб-средствах и средствах браузера](#use-the-browser-developer-tools-to-debug-custom-functions-in-excel-on-the-web)
- [Командная строка](#use-the-command-line-tools-to-debug)

На Mac:
- [Excel в веб-средствах и средствах браузера](#use-the-browser-developer-tools-to-debug-custom-functions-in-excel-on-the-web)
- [Командная строка](#use-the-command-line-tools-to-debug)

> [!NOTE]
> Для простоты в этой статье показана отладка в контексте использования Visual Studio кода для редактирования, выполнения задач и в некоторых случаях использования представления отладки. При использовании другого средства редактора или [](#commands-for-building-and-running-your-add-in) командной строки см. инструкции по командной строке в конце этой статьи.

## <a name="requirements"></a>Требования

Перед отлагиванием необходимо использовать генератор [Yeoman](https://github.com/OfficeDev/generator-office) для надстроек Office для создания настраиваемого проекта функций. Руководство по созданию настраиваемой функции см. в руководстве [по пользовательским функциям.](../tutorials/excel-tutorial-create-custom-functions.md)

## <a name="use-the-vs-code-debugger-for-excel-desktop"></a>Использование отладки кода VS для настольных компьютеров Excel

Вы можете использовать VS Code для отлаговки пользовательских функций без пользовательского интерфейса в Office Excel на рабочем столе.

> [!NOTE]
> Отладка рабочего стола для Mac недоступна, но может быть достигнута с помощью средств браузера и командной строки для отладки [Excel в Интернете).](#use-the-command-line-tools-to-debug)

### <a name="run-your-add-in-from-vs-code"></a>Запуск надстройки из VS Code

1. Откройте настраиваемую папку корневого проекта функций [в VS Code.](https://code.visualstudio.com/)
2. Выберите **терминал > выполнить задачу и** введите или выберите **Часы**. Это позволит отслеживать и восстанавливать любые изменения файлов.
3. Выберите **терминальный > выполнить задачу и** введите или выберите **Сервер разработчиков**.

### <a name="start-the-vs-code-debugger"></a>Запуск отладки кода VS

4. Выберите **просмотр > выполнить** или ввести **Ctrl+Shift+D,** чтобы перейти на отлагивание представления.
5. Из выпадаемого меню Run выберите **Excel Desktop (Edge Chromium).**
6. Чтобы начать отладку, выберите **F5** **(или > запустить** отладку из меню). Новая книга Excel откроется с уже загруженной и готовой к использованию надстройке.

### <a name="start-debugging"></a>Начало отладки

1. В vs Code откройте исходный файл скрипта кода **(functions.js** **или functions.ts).**
2. [Установите точку разрыва в](https://code.visualstudio.com/Docs/editor/debugging#_breakpoints) пользовательском коде источника функции.
3. В книге Excel введите формулу, использующую настраиваемую функцию.

На этом этапе выполнение остановится на строке кода, где установлена точка разрыва. Теперь вы можете пройти через код, установить часы и использовать все необходимые функции отладки кода VS.

## <a name="use-the-vs-code-debugger-for-excel-in-microsoft-edge"></a>Использование отладки кода VS для Excel в Microsoft Edge

Вы можете использовать VS Code для отлаговки пользовательских функций в Excel в браузере Microsoft Edge. Чтобы использовать vs Code с Microsoft Edge, необходимо установить расширение [Debugger для Microsoft Edge.](https://marketplace.visualstudio.com/items?itemName=msjsdiag.debugger-for-edge)

### <a name="run-your-add-in-from-vs-code"></a>Запуск надстройки из VS Code

1. Откройте настраиваемую папку корневого проекта функций [в VS Code.](https://code.visualstudio.com/)
2. Выберите **терминал > выполнить задачу и** введите или выберите **Часы**. Это позволит отслеживать и восстанавливать любые изменения файлов.
3. Выберите **терминальный > выполнить задачу и** введите или выберите **Сервер разработчиков**.

### <a name="start-the-vs-code-debugger"></a>Запуск отладки кода VS

4. Выберите **просмотр > выполнить** или ввести **Ctrl+Shift+D,** чтобы перейти на отлагивание представления.
5. Из параметров отладки выберите **Office Online (Edge Chromium).**
6. Откройте Excel в браузере Microsoft Edge и создайте новую книгу.
7. Выберите **Share** в ленте и скопируйте ссылку на URL-адрес этой новой книги.
8. Чтобы начать отладку, выберите **F5** (> **запустить** отладку из меню). Появится запрос, в котором будет указан URL-адрес документа.
9. Введите URL-адрес книги и нажмите кнопку Ввод.

### <a name="sideload-your-add-in"></a>Загрузка неопубликованной надстройки

1. Выберите **вкладку Insert** на ленте и в разделе Надстройки, выберите  **надстройки Office.**
2. В **диалоговом** окантовке Надстройки Office выберите вкладку **MY ADD-INS,** выберите **Управление** надстройками, а затем загрузите мои **надстройки.**
    
    ![Диалоговое окно "Надстройки Office" с раскрывающимся меню в правом верхнем углу, в котором выделен пункт "Управление моими надстройками", а под ним — раскрывающийся список с пунктом "Отправить надстройку"](../images/office-add-ins-my-account.png)

3. **Просмотрите** файл манифеста надстройки и выберите **Upload**.
    
    ![Диалоговое окно отправки надстройки с кнопками "Обзор", "Отправить" и "Отмена"](../images/upload-add-in.png)


### <a name="set-breakpoints"></a>Настройка точек разрыва
1. В vs Code откройте исходный файл скрипта кода **(functions.js** **или functions.ts).**
2. [Установите точку разрыва в](https://code.visualstudio.com/Docs/editor/debugging#_breakpoints) пользовательском коде источника функции.
3. В книге Excel введите формулу, использующую настраиваемую функцию.

## <a name="use-the-browser-developer-tools-to-debug-custom-functions-in-excel-on-the-web"></a>Использование средств разработчика браузера для отлаговки пользовательских функций в Excel в Интернете

Средства разработчика браузера можно использовать для отлаговки пользовательских функций в Excel в Интернете. Следующие действия работают как для Windows, так и для macOS.

### <a name="run-your-add-in-from-visual-studio-code"></a>Запустите надстройку из Visual Studio Code

1. Откройте настраиваемую папку корневого проекта [функций в Visual Studio Code (VS Code).](https://code.visualstudio.com/)
2. Выберите **терминал > выполнить задачу и** введите или выберите **Часы**. Это позволит отслеживать и восстанавливать любые изменения файлов.
3. Выберите **терминальный > выполнить задачу и** введите или выберите **Сервер разработчиков**.

### <a name="sideload-your-add-in"></a>Загрузка неопубликованной надстройки

1. Откройте [Office в Интернете.](https://office.live.com/)
2. Откройте новую книгу Excel.
3. Откройте **вкладку Insert** на ленте и в разделе **Надстройки** выберите **надстройки Office.**
4. В **диалоговом** окантовке Надстройки Office выберите вкладку **MY ADD-INS,** выберите **Управление** надстройками, а затем загрузите мои **надстройки.**
    
    ![Диалоговое окно "Надстройки Office" с раскрывающимся меню в правом верхнем углу, в котором выделен пункт "Управление моими надстройками", а под ним — раскрывающийся список с пунктом "Отправить надстройку"](../images/office-add-ins-my-account.png)

5. **Найдите** файл манифеста надстройки и выберите **Отправить**.
    
    ![Диалоговое окно отправки надстройки с кнопками "Обзор", "Отправить" и "Отмена"](../images/upload-add-in.png)

> [!NOTE]
> После загрузки в документ он будет оставаться в стороне при каждом открываемом документе.

### <a name="start-debugging"></a>Начало отладки

1. Откройте средства разработчика в браузере. Для Chrome и большинства браузеров F12 откроет средства разработчика.
2. В средствах разработчика откройте исходный файл скрипта кода с помощью **Cmd+P** или **Ctrl+P** **(functions.js** **или functions.ts).**
3. [Установите точку разрыва в](https://code.visualstudio.com/Docs/editor/debugging#_breakpoints) пользовательском коде источника функции. 

Если вам нужно изменить код, вы можете внести изменения в VS Code и сохранить изменения. Обновите браузер, чтобы увидеть загруженные изменения.

## <a name="use-the-command-line-tools-to-debug"></a>Отламывка с помощью средств командной строки

Если вы не используете VS Code, для запуска надстройки можно использовать командную строку (например, bash или PowerShell). Для отлаговки кода в Excel в Интернете необходимо использовать средства разработчика браузера. Отламывка настольной версии Excel с помощью командной строки не удается.

1. Из командной строки запустите, чтобы следить за изменениями кода и восстанавливать `npm run watch` их.
2. Откройте второе окно командной строки (первое будет заблокировано во время запуска часов.)

3. Если вы хотите запустить надстройку в настольной версии Excel, запустите следующую команду
    
    `npm run start:desktop`
    
    Или если вы предпочитаете запускать надстройку в Excel в Интернете, запустите следующую команду
    
    `npm run start:web`
    
    Для Excel в Интернете также необходимо побокзагружать надстройку. Выполните действия [в Sideload надстройки,](#sideload-your-add-in) чтобы побокзагрузить надстройку. Затем продолжайте отладку в следующем разделе.
    
4. Откройте средства разработчика в браузере. Для Chrome и большинства браузеров F12 откроет средства разработчика.
5. В средствах разработчика откройте исходный файл скрипта кода **(functions.js** **или functions.ts).** Пользовательский код функций может быть расположен в конце файла.
6. В пользовательском коде источника функции нанесите точку разрыва, выбрав строку кода.

Если вам нужно изменить код, вы можете внести изменения в Visual Studio и сохранить изменения. Обновите браузер, чтобы увидеть загруженные изменения.

### <a name="commands-for-building-and-running-your-add-in"></a>Команды для создания и запуска надстройки

Существует несколько задач сборки:
- `npm run watch`: сборки для разработки и автоматическое восстановление при сэкономлении исходных файлов
- `npm run build-dev`: сборки для разработки один раз
- `npm run build`: сборки для производства
- `npm run dev-server`: запускает веб-сервер, используемый для разработки

Вы можете использовать следующие задачи для начала отладки на рабочем столе или в Интернете.
- `npm run start:desktop`: Запускает Excel на рабочем столе и заряжает надстройку.
- `npm run start:web`: Запускает Excel в Интернете и перегружает надстройку.
- `npm run stop`: Останавливает Excel и отладку.

## <a name="next-steps"></a>Дальнейшие действия
Узнайте о [практике проверки подлинности для пользовательских функций без пользовательского интерфейса.](custom-functions-authentication.md)

## <a name="see-also"></a>См. также

* [Устранение неполадок пользовательских функций](custom-functions-troubleshooting.md)
* [Обработка ошибок в пользовательских функциях Excel](custom-functions-errors.md)
* [Создание пользовательских функций в Excel](custom-functions-overview.md)
