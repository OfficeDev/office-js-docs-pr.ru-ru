---
title: Создание надстроек Office
description: Общие сведения о разработке надстроек Office.
ms.date: 02/19/2020
localization_priority: Priority
ms.openlocfilehash: 95a930f89c3ce6c2c4fc894c61bd4337851a8614
ms.sourcegitcommit: a3ddfdb8a95477850148c4177e20e56a8673517c
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/20/2020
ms.locfileid: "42163873"
---
# <a name="building-office-add-ins"></a>Создание надстроек Office

> [!TIP]
> Перед прочтением этой статьи ознакомьтесь с [обзором платформы надстроек Office](office-add-ins.md).

Надстройки Office расширяют пользовательский интерфейс и функции приложений Office и взаимодействуют с содержимым документов Office. Вы сможете использовать привычные веб-технологии для создания надстроек Office для взаимодействия с Word, Excel, PowerPoint, OneNote, Project и Outlook, а также для расширения возможностей этих приложений. Создаваемые надстройки можно запускать в Office на разных платформах, включая Windows, Mac, iPad, и в браузере. В этой статье представлены общие сведения о разработке надстроек Office.

## <a name="creating-an-office-add-in"></a>Создание надстройки Office 

Надстройку Office можно создать с помощью генератора Yeoman для надстроек Office или Visual Studio.

### <a name="yeoman-generator-for-office-add-ins"></a>Генератор Yeoman для надстроек Office

[Генератор Yeoman для надстроек Office](https://github.com/officedev/generator-office) можно использовать для создания проекта надстройки Office Node.js, которым можно управлять с помощью Visual Studio Code или любого другого редактора. В генераторе можно создавать надстройки Office для любой из следующих целей.

- Excel
- OneNote
- Outlook
- PowerPoint
- Project
- Word
- Пользовательские функции Excel

Проект можно создать с помощью HTML, CSS и JavaScript или с помощью Angular или React. Для любой платформы можно также выбирать между JavaScript и Typescript. Дополнительные сведения о создании надстроек с помощью генератора Yeoman см. в статье [Разработка надстроек Office с помощью Visual Studio Code](../develop/develop-add-ins-vscode.md).

### <a name="visual-studio"></a>Visual Studio

С помощью Visual Studio можно создавать надстройки Office для Excel, Outlook, Word и PowerPoint. Проект надстройки Office создается в рамках решения Visual Studio и использует HTML, CSS и JavaScript. Дополнительные сведения о создании надстроек с помощью Visual Studio см. в статье [Разработка надстроек Office с помощью Visual Studio](../develop/develop-add-ins-visual-studio.md).

[!include[Yeoman vs Visual Studio comparision](../includes/yeoman-generator-recommendation.md)]

## <a name="exploring-apis-with-script-lab"></a>Изучение API с помощью Script Lab

Script Lab — это надстройка, позволяющая изучать API JavaScript для Office и выполнять фрагменты кода при работе в программах Office, таких как Excel или Word. Она доступна бесплатно в [AppSource](https://appsource.microsoft.com/product/office/WA104380862) и является полезным инструментом для добавления в набор средств разработки при создании прототипов и проверке нужных функций в надстройке. В Script Lab можно получить доступ к библиотеке встроенных примеров, чтобы быстро испытать API или использовать пример в качестве отправной точки для собственного кода. 

В следующем 1-минутном видео показана надстройка Script Lab в действии.

[![Ознакомительное видео, демонстрирующее работу Script Lab в Excel, Word и PowerPoint.](../images/screenshot-wide-youtube.png 'Ознакомительное видео о Script Lab')](https://aka.ms/scriptlabvideo)

Дополнительные сведения о Script Lab см. в статье [Изучение API JavaScript для Office с помощью Script Lab](../overview/explore-with-script-lab.md).

## <a name="extending-the-office-ui"></a>Расширение пользовательского интерфейса Office

Надстройка Office может расширить пользовательский интерфейс Office с помощью команд надстройки и контейнеров HTML, таких как области задач, контентные надстройки и диалоговые окна.

- [Команды надстроек](../design/add-in-commands.md) можно использовать для добавления настраиваемых вкладок, кнопок и меню на стандартную ленту в Office или для расширения стандартного контекстного меню, отображающегося при щелчке правой кнопкой мыши по тексту в документе Office или объекту в Excel. Когда пользователи выбирают команду надстройки, они запускают задачу, определяемую этой командой надстройки, например выполнение кода JavaScript, открытие области задач или запуск диалогового окна.

- Контейнеры HTML, такие как [области задач](../design/task-pane-add-ins.md), [контентные надстройки](../design/content-add-ins.md) и [диалоговые окна](../design/dialog-boxes.md) можно использовать для отображения настраиваемого пользовательского интерфейса и предоставления дополнительных функций в приложении Office. Содержимое и функции каждой области задач, контентной надстройки или диалогового окна зависят от указанной вами веб-страницы. Эти веб-страницы могут использовать API JavaScript для Office с целью взаимодействия с содержимым в документе Office, в котором запущена надстройка, а также могут выполнять другие типовые действия веб-страниц, например вызовы внешних веб-служб, упрощение проверки подлинности пользователей и т. д.

На следующем изображении показана команда надстройки на ленте, область задач справа от документа, диалоговое окно или контентная надстройка поверх документа.

![Изображение с командами надстроек на ленте, областью задач и диалоговым окном в документе Office](../images/add-in-ui-elements.png)

Дополнительные сведения о расширении пользовательского интерфейса Office см. в статье [Элементы пользовательского интерфейса Office для надстроек Office](../design/interface-elements.md).

## <a name="core-development-concepts"></a>Основные понятия разработки 

Надстройка Office состоит из двух частей:

- Манифест надстройки (XML-файл), определяющий параметры и возможности надстройки.

- Веб-приложение, определяющее пользовательский интерфейс и функции компонентов надстройки, таких как области задач, контентные надстройки и диалоговые окна.

Веб-приложение использует API JavaScript для Office, чтобы взаимодействовать с содержимым документа Office, в котором запущена надстройка. Надстройка также может выполнять другие типовые действия веб-приложений, например вызовы внешних веб-служб, упрощение проверки подлинности пользователей и т. д.

### <a name="defining-an-add-ins-settings-and-capabilities"></a>Определение параметров и возможностей надстройки

Манифест надстройки Office (XML-файл), определяющий параметры и возможности надстройки. Вы можете настроить манифест, чтобы указать следующие элементы:

- метаданные, описывающие надстройку (например, ИД, версия, описание, отображаемое имя, региональные параметры по умолчанию);
- приложения Office, в которых будет запускаться надстройка;
- разрешения, требующиеся для надстройки;
- способ интеграции надстройки с Office, включая создаваемые ею элементы пользовательского интерфейса (например, настраиваемые вкладки и кнопки на ленте);
- расположение изображений, используемых надстройкой для фирменной символики и значков команд;
- размеры надстройки (например, размеры для контентных надстроек, запрошенная высота для надстроек Outlook);
- правила, определяющие, когда надстройка активируется в контексте сообщения или встречи (только для надстроек Outlook).

Дополнительные сведения о манифесте см. в статье [XML-манифест надстроек Office](add-in-manifests.md).

### <a name="interacting-with-content-in-an-office-document"></a>Взаимодействие с содержимым в документе Office

Надстройка Office может использовать API JavaScript для Office, чтобы взаимодействовать с содержимым документа Office, в котором запущена надстройка. 

#### <a name="accessing-the-office-javascript-library"></a>Доступ к библиотеке JavaScript для Office

Доступ к библиотеке JavaScript для Office можно получить через сеть доставки содержимого (CDN) Office JS по адресу `https://appsforoffice.microsoft.com/lib/1/hosted/Office.js`. Чтобы использовать API JavaScript для Office на любой из веб-страниц надстройки, требуется указать ссылку на CDN в теге `<script>` тега `<head>` страницы.

```html
<head>
    ...
    <script src="https://appsforoffice.microsoft.com/lib/1/hosted/Office.js" type="text/javascript"></script>
</head>
```

> [!NOTE]
> Чтобы использовать API предварительных версий, требуется указать ссылку на предварительную версию библиотеки JavaScript для Office в сети CDN: https://appsforoffice.microsoft.com/lib/beta/hosted/office.js.

Дополнительные сведения о доступе к библиотеке JavaScript для Office, в том числе о способе получения функции IntelliSense, см. в статье [Добавление ссылок на библиотеку API JavaScript для Office из сети доставки содержимого (CDN)](../develop/referencing-the-javascript-api-for-office-library-from-its-cdn.md).

#### <a name="api-models"></a>Модели API

API JavaScript для Office включают две различные модели:

- **Зависящие от ведущего приложения** API предоставляют объекты со строгой типизацией, которые можно использовать для взаимодействия с собственными объектами определенных приложений Office. Например, вы можете использовать API JavaScript для Excel с целью доступа к листам, диапазонам, таблицам, диаграммам и т. д. API, зависящие от ведущего приложения, в настоящее время доступны для [Excel](../reference/overview/excel-add-ins-reference-overview.md), [Word](../reference/overview/word-add-ins-reference-overview.md) и [OneNote](../reference/overview/onenote-add-ins-javascript-reference.md). Эта модель API использует [обещания](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Promise) и позволяет указывать несколько операций в каждом запросе, отправляемом на узел Office. Подобные пакетные операции могут значительно повысить производительность надстройки в Office для веб-приложений. API, зависящие от ведущего приложения, появились в Office 2016, и их нельзя использовать для работы с Office 2013.

- **Общие** API можно использовать для доступа к таким компонентам, как пользовательский интерфейс, диалоговые окна и параметры клиентов, общие для нескольких типов приложений Office. Эта модель API использует [обратные вызовы](https://developer.mozilla.org/docs/Glossary/Callback_function), в которых можно указать только одну операцию в каждом запросе, отправляемом на узел Office. Общие API появились в Office 2013, и их нельзя использовать для работы с Office 2013 или более поздними версиями. Подробные сведения об объектной модели общих API, включающей API для взаимодействия с Outlook и PowerPoint, см. в статье [Общая объектная модель API JavaScript](../develop/office-javascript-api-object-model.md).

> [!NOTE]
> Пользовательские функции Excel работают в уникальной среде выполнения, приоритетом которой является осуществление вычислений, поэтому в ней используется немного другая модель программирования. Подробные сведения см. в статье [Архитектура пользовательских функций](../excel/custom-functions-architecture.md).

Дополнительные сведения об API JavaScript для Office см. в статье [Общие сведения об API JavaScript для Office](../develop/understanding-the-javascript-api-for-office.md).

#### <a name="api-requirement-sets"></a>Наборы обязательных элементов API

[Наборы обязательных элементов](../develop/office-versions-and-requirement-sets.md) — это именованные группы элементов API. Наборы обязательных элементов могут относиться к конкретному ведущему приложению Office, например набор обязательных элементов `ExcelApi 1.7` (набор API, который можно использовать только в Excel), или быть общими для нескольких ведущих приложений, например набор обязательных элементов `DialogApi 1.1` (набор API, который можно использовать в любом приложение Office, поддерживающем API диалоговых окон).

Используя наборы обязательных элементов, надстройка может определять, поддерживает ли ведущее приложение Office необходимые элементы API. Дополнительные сведения об этом см. в статье [Указание ведущих приложений Office и обязательных элементов API](../develop/specify-office-hosts-and-api-requirements.md).

Поддержка набора обязательных элементов зависит от ведущего приложения Office, версии и платформы. Подробные сведения о платформах, наборах обязательных элементов и общих API, поддерживаемых каждым приложением Office, см. в статье [Доступность ведущих приложений и платформ для надстроек Office](office-add-in-availability.md).

## <a name="testing-and-debugging-an-office-add-in"></a>Тестирование и отладка надстройки Office

При разработке надстройки ее можно протестировать локально, используя метод, называемый _загрузка неопубликованной надстройки_. Процедура отличается для разных платформ, а в некоторых случаях и для разных продуктов. Процедура отладки надстроек также может отличаться в зависимости от платформы и продукта. Дополнительные сведения о тестировании и отладке см. в статье [Тестирование и отладка надстроек Office](../testing/test-debug-office-add-ins.md).

## <a name="publishing-an-office-add-in"></a>Публикация надстройки Office

Когда вы будете готовы поделиться своей надстройкой с другими пользователями, это можно будет сделать с помощью метода развертывания, наиболее подходящего для ваших целей. Например, чтобы развернуть надстройку для пользователей в организации, можно воспользоваться централизованным развертыванием или опубликовать надстройку в каталоге приложений SharePoint. Если вы хотите предоставить общий доступ к надстройке любому пользователю, можно опубликовать надстройку в AppSource. Дополнительные сведения о публикации см. в статье [Развертывание и публикация надстроек Office](../publish/publish.md).

## <a name="next-steps"></a>Дальнейшие действия

В этой статье рассмотрены различные способы создания надстроек Office, представлен инструмент Script Lab, полезный при изучении API JavaScript для Office и создании прототипов функций надстроек, а также описаны важные понятия разработки, тестирования и публикации надстроек Office. После изучения этих ознакомительных сведений рекомендуется продолжить исследование надстроек Office по следующим путям.

### <a name="create-an-office-add-in"></a>Создание надстройки Office

Вы можете быстро создать простую надстройку для Excel, OneNote, Outlook, PowerPoint, Project или Word с помощью [5-минутного краткого руководства по началу работы](../index.md). Если вы уже ознакомились с кратким руководством и хотите создать более сложную надстройку, воспользуйтесь [учебником](../index.md).

### <a name="explore-the-apis-with-script-lab"></a>Изучение API с помощью Script Lab

Изучите библиотеку встроенных примеров в [Script Lab](explore-with-script-lab.md), чтобы ознакомиться с возможностями API JavaScript для Office.

### <a name="learn-more"></a>Дополнительные сведения

Ознакомьтесь с этой документацией, чтобы узнать больше о разработке, тестировании и публикации надстроек Office.

> [!TIP]
> При создании любой надстройки вы можете использовать информацию из раздела [Основные принципы](core-concepts-office-add-ins.md) этой документации, а также сведения из разделов для определенных ведущих приложений, соответствующих типу создаваемой надстройки (например, [Excel](../excel/index.md)).
>
> ![Изображение оглавления](../images/top-level-toc.png)

## <a name="see-also"></a>См. также 

- [Обзор платформы надстроек Office](office-add-ins.md)
- [Основные принципы надстроек Office](../overview/core-concepts-office-add-ins.md)
- [Разработка надстроек Office](../develop/develop-overview.md)
- [Разработка надстроек Office с помощью Visual Studio Code](../develop/develop-add-ins-vscode.md)
- [Разработка надстроек Office с помощью Visual Studio](../develop/develop-add-ins-visual-studio.md)
- [Проектирование надстроек Office](../design/add-in-design.md)
- [Тестирование и отладка надстроек Office](../testing/test-debug-office-add-ins.md)
- [Публикация надстроек Office](../publish/publish.md)