---
title: Интеграция встроенных кнопок Office в группы и вкладки пользовательских элементов управления
description: Узнайте, как включать встроенные кнопки Office в настраиваемые группы команд и вкладки ленты Office.
ms.date: 11/01/2020
localization_priority: Normal
ms.openlocfilehash: e04107893b3c0dd453c84d38fdd5623e308b70e3
ms.sourcegitcommit: 3189c4bd62dbe5950b19f28ac2c1314b6d304dca
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/17/2020
ms.locfileid: "49088177"
---
# <a name="integrate-built-in-office-buttons-into-custom-control-groups-and-tabs-preview"></a>Интеграция встроенных кнопок Office в группы и вкладки пользовательских элементов управления (Предварительная версия)

Встроенные кнопки Office можно вставлять в пользовательские группы элементов управления на ленте Office с помощью разметки в манифесте надстройки. (Вы не можете вставить свои команды надстройки во встроенную группу Office.) Вы также можете вставить все встроенные группы элементов управления Office в пользовательские вкладки ленты.

> [!NOTE]
> В этой статье предполагается, что вы знакомы с [основными понятиями, изложенными в](add-in-commands.md)статьях, посвященных командам надстроек. Изучите его, если это не было сделано недавно.

> [!IMPORTANT]
>
> - Функция надстройки и разметка, описанные в этой статье, *доступны только в PowerPoint в Интернете*. Мы рекомендуем испытать разметку только в средах тестирования и разработки. Не используйте разметку предварительного просмотра в рабочей среде или в критически важных для бизнеса документах.
> - Разметка, описанная в этой статье, работает только на платформах, поддерживающих набор требований **аддинкоммандс 1,3**. Ознакомьтесь с разделом [поведение неподдерживаемых платформ](#behavior-on-unsupported-platforms).

## <a name="insert-a-built-in-control-group-into-a-custom-tab"></a>Вставка встроенной группы управления на настраиваемую вкладку

Чтобы вставить встроенную группу управления Office на вкладку, добавьте элемент [оффицеграуп](../reference/manifest/customtab.md#officegroup) в качестве дочернего элемента в родительском `<CustomTab>` элементе. `id` `<OfficeGroup>` Для атрибута элемента задается идентификатор встроенной группы. Узнайте [, как найти идентификаторы элементов управления и групп элементов управления](#find-the-ids-of-controls-and-control-groups).

В следующем примере разметки группа элементов управления абзаца Office добавляется на настраиваемую вкладку и помещается сразу после настраиваемой группы.

```xml
<ExtensionPoint xsi:type="ContosoRibbonTab">
  <CustomTab id="TabCustom1">
    <Group id="myCustomTab.group1">
       <!-- additional markup omitted -->
    </Group>
    <OfficeGroup id="Paragraph" />
    <Label resid="customTabLabel1" />
  </CustomTab>
</ExtensionPoint>
```

## <a name="insert-a-built-in-control-into-a-custom-group"></a>Вставка встроенного элемента управления в пользовательскую группу

Чтобы вставить встроенный элемент управления Office в настраиваемую группу, добавьте элемент [оффицеконтрол](../reference/manifest/group.md#officecontrol) в качестве дочернего элемента в родительском `<Group>` элементе. `id` `<OfficeControl>` Для атрибута элемента задается Идентификатор встроенного элемента управления. Узнайте [, как найти идентификаторы элементов управления и групп элементов управления](#find-the-ids-of-controls-and-control-groups).

В приведенном ниже примере разметки элемент управления "верхний скрипт Office" добавляется в пользовательскую группу и помещается сразу после настраиваемой кнопки.

```xml
<ExtensionPoint xsi:type="ContosoRibbonTab">
  <CustomTab id="TabCustom1">
    <Group id="myCustomTab.grp1">
        <Label resid="residCustomTabGroupLabel"/>
        <Icon>
            <bt:Image size="16" resid="blue-icon-16" />
            <bt:Image size="32" resid="blue-icon-32" />
            <bt:Image size="80" resid="blue-icon-80" />
        </Icon>
        <Control xsi:type="Button" id="Button2">
            <!-- information on the control omitted -->
        </Control>
        <OfficeControl id="Superscript" />
        <!-- other controls, as needed -->
    </Group>
    <Label resid="customTabLabel1" />
  </CustomTab>
</ExtensionPoint>
```

> [!NOTE]
> Пользователи могут настраивать ленту в приложении Office. Все пользовательские настройки будут переопределять параметры манифеста. Например, пользователь может удалить кнопку из любой группы и удалить любую группу из вкладки.

## <a name="find-the-ids-of-controls-and-control-groups"></a>Поиск идентификаторов элементов управления и групп элементов управления

Идентификаторы для поддерживаемых элементов управления и групп элементов управления находятся в файлах в [идентификаторах элементов управления для Организации](https://github.com/OfficeDev/office-control-ids)в репозитории. Следуйте инструкциям в файле ReadMe в этом репозитории.

## <a name="behavior-on-unsupported-platforms"></a>Поведение на неподдерживаемых платформах

Если ваша надстройка установлена на платформе, которая не поддерживает [набор требований аддинкоммандс 1,3](../reference/requirement-sets/add-in-commands-requirement-sets.md), разметка, описанная в этой статье, игнорируется, и встроенные элементы управления и группы Office не будут отображаться в настраиваемых группах и вкладках. Чтобы запретить установку надстройки на платформах, которые не поддерживают разметку, добавьте ссылку на набор требований в `<Requirements>` разделе манифеста. Инструкции см в разделе [set the требований element в манифесте](../develop/specify-office-hosts-and-api-requirements.md#set-the-requirements-element-in-the-manifest). Кроме того, вы можете создать альтернативный интерфейс для надстройки, когда **аддинкоммандс 1,3** не поддерживается, как описано в статье [Использование проверок среды выполнения в коде JavaScript](../develop/specify-office-hosts-and-api-requirements.md#use-runtime-checks-in-your-javascript-code). Например, если ваша надстройка содержит инструкции, которые предполагают, что встроенные кнопки находятся в настраиваемых группах, можно использовать альтернативную версию, которая предполагает, что встроенные кнопки находятся только в их обычных местах.
