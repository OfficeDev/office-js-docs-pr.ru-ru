---
title: Размещение настраиваемой вкладки на ленте
description: Узнайте, как управлять размещением настраиваемой вкладки на ленте Office и наличием фокуса по умолчанию.
ms.date: 11/01/2020
localization_priority: Normal
ms.openlocfilehash: 2c1e2ae66805212e78868cf7c07a0e5c14cd4025
ms.sourcegitcommit: 3189c4bd62dbe5950b19f28ac2c1314b6d304dca
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/17/2020
ms.locfileid: "49088180"
---
# <a name="position-a-custom-tab-on-the-ribbon-preview"></a><span data-ttu-id="30e78-103">Размещение настраиваемой вкладки на ленте (Предварительная версия)</span><span class="sxs-lookup"><span data-stu-id="30e78-103">Position a custom tab on the ribbon (preview)</span></span>

<span data-ttu-id="30e78-104">Вы можете указать, где должна отображаться настраиваемая вкладка надстройки на ленте приложения Office, используя разметку в манифесте надстройки.</span><span class="sxs-lookup"><span data-stu-id="30e78-104">You can specify where you want your add-in's custom tab to appear on the Office application's ribbon by using markup in the add-in's manifest.</span></span>

> [!NOTE]
> <span data-ttu-id="30e78-105">В этой статье предполагается, что вы знакомы с [основными понятиями, изложенными в](add-in-commands.md)статьях, посвященных командам надстроек.</span><span class="sxs-lookup"><span data-stu-id="30e78-105">This article assumes that you are familiar with the article [Basic concepts for add-in commands](add-in-commands.md).</span></span> <span data-ttu-id="30e78-106">Изучите его, если это не было сделано недавно.</span><span class="sxs-lookup"><span data-stu-id="30e78-106">Please review it if you have not done so recently.</span></span>

> [!IMPORTANT]
>
> - <span data-ttu-id="30e78-107">Функция надстройки и разметка, описанные в этой статье, *доступны только в PowerPoint в Интернете*.</span><span class="sxs-lookup"><span data-stu-id="30e78-107">The add-in feature and markup described in this article is in preview and is *only available in PowerPoint on the web*.</span></span> <span data-ttu-id="30e78-108">Мы рекомендуем испытать разметку только в средах тестирования и разработки.</span><span class="sxs-lookup"><span data-stu-id="30e78-108">We recommend that you try out the markup in test and development environments only.</span></span> <span data-ttu-id="30e78-109">Не используйте разметку предварительного просмотра в рабочей среде или в критически важных для бизнеса документах.</span><span class="sxs-lookup"><span data-stu-id="30e78-109">Do not use preview markup in a production environment or within business-critical documents.</span></span>
> - <span data-ttu-id="30e78-110">Разметка, описанная в этой статье, работает только на платформах, поддерживающих набор требований **аддинкоммандс 1,3**.</span><span class="sxs-lookup"><span data-stu-id="30e78-110">The markup described in this article only works on platforms that support requirement set **AddinCommands 1.3**.</span></span> <span data-ttu-id="30e78-111">Просмотр [поведения на неподдерживаемых платформах](#behavior-on-unsupported-platforms) .</span><span class="sxs-lookup"><span data-stu-id="30e78-111">See [Behavior on unsupported platforms](#behavior-on-unsupported-platforms) below.</span></span>

<span data-ttu-id="30e78-112">Укажите, где должна отображаться настраиваемая вкладка, указав, на какую из встроенных вкладок Office она должна располагаться, и укажите, будет ли она находиться в левой или правой части встроенной вкладки. Сделайте эти спецификации, включив элемент [InsertBefore](../reference/manifest/customtab.md#insertbefore) (Left) или [InsertAfter](../reference/manifest/customtab.md#insertafter) (Right) в элемент [CustomTab](../reference/manifest/customtab.md) манифеста надстройки.</span><span class="sxs-lookup"><span data-stu-id="30e78-112">Specify where you want a custom tab to appear by identifying which built-in Office tab you want it to be next to and specifying whether it should be on the left or right side of the built-in tab. Make these specifications by including either an [InsertBefore](../reference/manifest/customtab.md#insertbefore) (left) or an [InsertAfter](../reference/manifest/customtab.md#insertafter) (right) element in the [CustomTab](../reference/manifest/customtab.md) element of your add-in's manifest.</span></span> <span data-ttu-id="30e78-113">(Не допускается наличие обоих элементов.)</span><span class="sxs-lookup"><span data-stu-id="30e78-113">(You cannot have both elements.)</span></span>

<span data-ttu-id="30e78-114">В следующем примере настраиваемая вкладка отображается *сразу после* вкладки " **Рецензирование** ". Обратите внимание, что значением `<InsertAfter>` элемента является идентификатор встроенной вкладки Office.</span><span class="sxs-lookup"><span data-stu-id="30e78-114">In the following example, the custom tab is configured to appear *just after* the **Review** tab. Note that the value of the `<InsertAfter>` element is the ID of the built-in Office tab.</span></span> 

```xml
<ExtensionPoint xsi:type="ContosoRibbonTab">
  <CustomTab id="TabCustom1">
    <Group id="myCustomTab.group1">
       <!-- additional markup omitted -->
    </Group>
    <Label resid="customTabLabel1" />
    <InsertAfter>TabReview</InsertAfter>
  </CustomTab>
</ExtensionPoint>
```

<span data-ttu-id="30e78-115">Учитывайте следующие моменты.</span><span class="sxs-lookup"><span data-stu-id="30e78-115">Keep the following points in mind.</span></span>

- <span data-ttu-id="30e78-116">`<InsertBefore>`Элементы и `<InsertAfter>` являются необязательными.</span><span class="sxs-lookup"><span data-stu-id="30e78-116">The  `<InsertBefore>` and  `<InsertAfter>` elements are optional.</span></span> <span data-ttu-id="30e78-117">Если вы не используете ни один из них, настраиваемая вкладка появится в виде крайней правой вкладки на ленте.</span><span class="sxs-lookup"><span data-stu-id="30e78-117">If you use neither, then your custom tab will appear as the rightmost tab on the ribbon.</span></span>
- <span data-ttu-id="30e78-118">`<InsertBefore>`Элементы и являются взаимоисключающими `<InsertAfter>` .</span><span class="sxs-lookup"><span data-stu-id="30e78-118">The  `<InsertBefore>` and  `<InsertAfter>` elements are mutually exclusive.</span></span> <span data-ttu-id="30e78-119">Вы не можете использовать оба варианта.</span><span class="sxs-lookup"><span data-stu-id="30e78-119">You cannot use both.</span></span>
- <span data-ttu-id="30e78-120">Если пользователь устанавливает несколько надстроек, настраиваемая вкладка которых настроена для одного и того же места, скажите после вкладки **Рецензирование** , и вкладка для последней установленной надстройки будет размещена в этой позиции.</span><span class="sxs-lookup"><span data-stu-id="30e78-120">If the user installs more than one add-in whose custom tab is configured for the same place, say after the **Review** tab, then the tab for the most recently installed add-in will be located in that place.</span></span> <span data-ttu-id="30e78-121">Вкладки ранее установленных надстроек будут перемещены в одном месте.</span><span class="sxs-lookup"><span data-stu-id="30e78-121">The tabs of the previously installed add-ins will be moved over one place.</span></span> <span data-ttu-id="30e78-122">Например, пользователь устанавливает надстройки A, B и C в этом порядке и все они настраиваются для вставки вкладки после вкладки " **Рецензирование** ", после чего вкладки отображаются в следующем порядке: **Проверка**, **аддинктаб**, **аддинбтаб**, **аддинатаб**.</span><span class="sxs-lookup"><span data-stu-id="30e78-122">For example, the user installs add-ins A, B, and C in that order and all are configured to insert a tab after the **Review** tab, then the tabs will appear in this order: **Review**, **AddinCTab**, **AddinBTab**, **AddinATab**.</span></span>
- <span data-ttu-id="30e78-123">Пользователи могут настраивать ленту в приложении Office.</span><span class="sxs-lookup"><span data-stu-id="30e78-123">Users can customize the ribbon in the Office application.</span></span> <span data-ttu-id="30e78-124">Например, пользователь может переместить или скрыть вкладку надстройки. Вы не можете предотвратить это или определить, что это произошло.</span><span class="sxs-lookup"><span data-stu-id="30e78-124">For example, a user can move or hide your add-in's tab. You cannot prevent this or detect that it has happened.</span></span>
- <span data-ttu-id="30e78-125">Если пользователь переместит одну из встроенных вкладок, Office интерпретирует `<InsertBefore>`  `<InsertAfter>` элементы и в терминах *расположения по умолчанию встроенной вкладки*. Например, если пользователь переместит вкладку " **Рецензирование** " в правый конец ленты, Office будет интерпретировать разметку в примере выше, как это означает "помещать настраиваемую вкладку справа от того, *где будет отображаться вкладка" **Рецензирование** "по умолчанию*."</span><span class="sxs-lookup"><span data-stu-id="30e78-125">If a user moves one of the built-in tabs, then Office interprets the `<InsertBefore>` and  `<InsertAfter>` elements in terms of *the default location of the built-in tab*. For example, if the user moves the **Review** tab to the right end of the ribbon, Office will interpret the markup in the example above as meaning "put the custom tab just to the right of *where the **Review** tab would be by default*."</span></span>

## <a name="specifying-which-tab-has-focus-when-the-document-opens"></a><span data-ttu-id="30e78-126">Указание фокуса на вкладке при открытии документа</span><span class="sxs-lookup"><span data-stu-id="30e78-126">Specifying which tab has focus when the document opens</span></span>

<span data-ttu-id="30e78-127">Office всегда предоставляет фокус по умолчанию на вкладку, находящийся непосредственно справа от вкладки **файл** . По умолчанию это вкладка **Главная** . Если вы настроили пользовательскую вкладку до вкладки **Главная** , на `<InsertBefore>TabHome</InsertBefore>` настраиваемой вкладке будет отображаться фокус при открытии документа.</span><span class="sxs-lookup"><span data-stu-id="30e78-127">Office always gives default focus to the tab that is immediately to the right of the **File** tab. By default this is the **Home** tab. If you configure your custom tab to be before the **Home** tab, with `<InsertBefore>TabHome</InsertBefore>`, then your custom tab will have focus when the document opens.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="30e78-128">Чрезмерное выразительное удобство надстроек и аннойс пользователей и администраторов.</span><span class="sxs-lookup"><span data-stu-id="30e78-128">Giving excessive prominence to your add-in inconveniences and annoys users and administrators.</span></span> <span data-ttu-id="30e78-129">Не разместите настраиваемую вкладку перед вкладкой " **Главная** ", если ваша надстройка не будет основным способом взаимодействия пользователей с документом.</span><span class="sxs-lookup"><span data-stu-id="30e78-129">Do not position a custom tab before the **Home** tab unless your add-in is the primary way users will interact with the document.</span></span>

## <a name="behavior-on-unsupported-platforms"></a><span data-ttu-id="30e78-130">Поведение на неподдерживаемых платформах</span><span class="sxs-lookup"><span data-stu-id="30e78-130">Behavior on unsupported platforms</span></span>

<span data-ttu-id="30e78-131">Если ваша надстройка установлена на платформе, которая не поддерживает [набор требований аддинкоммандс 1,3](../reference/requirement-sets/add-in-commands-requirement-sets.md), разметка, описанная в этой статье, игнорируется, а настраиваемая вкладка отображается в виде крайней правой вкладки на ленте.</span><span class="sxs-lookup"><span data-stu-id="30e78-131">If your add-in is installed on a platform that doesn't support [requirement set AddinCommands 1.3](../reference/requirement-sets/add-in-commands-requirement-sets.md), then the markup described in this article is ignored and your custom tab will appear as the rightmost tab on the ribbon.</span></span> <span data-ttu-id="30e78-132">Чтобы запретить установку надстройки на платформах, которые не поддерживают разметку, добавьте ссылку на набор требований в `<Requirements>` разделе манифеста.</span><span class="sxs-lookup"><span data-stu-id="30e78-132">To prevent your add-in from being installed on platforms that don't support the markup, add a reference to the requirement set in the `<Requirements>` section of the manifest.</span></span> <span data-ttu-id="30e78-133">Инструкции см в разделе [set the требований element в манифесте](../develop/specify-office-hosts-and-api-requirements.md#set-the-requirements-element-in-the-manifest).</span><span class="sxs-lookup"><span data-stu-id="30e78-133">For instructions, see [Set the Requirements element in the manifest](../develop/specify-office-hosts-and-api-requirements.md#set-the-requirements-element-in-the-manifest).</span></span> <span data-ttu-id="30e78-134">Кроме того, вы можете создать альтернативный интерфейс для надстройки, когда **аддинкоммандс 1,3** не поддерживается, как описано в статье [Использование проверок среды выполнения в коде JavaScript](../develop/specify-office-hosts-and-api-requirements.md#use-runtime-checks-in-your-javascript-code).</span><span class="sxs-lookup"><span data-stu-id="30e78-134">Alternatively, you can design your add-in to have an alternate experience when **AddinCommands 1.3** is not supported, as described in [Use runtime checks in your JavaScript code](../develop/specify-office-hosts-and-api-requirements.md#use-runtime-checks-in-your-javascript-code).</span></span> <span data-ttu-id="30e78-135">Например, если ваша надстройка содержит инструкции, которые предполагают, что настраиваемая вкладка находится там, где она нужна, можно использовать альтернативную версию, которая предполагает, что вкладка является самой правой.</span><span class="sxs-lookup"><span data-stu-id="30e78-135">For example, if your add-in contains instructions that assume the custom tab is where you want it, you could have an alternate version that assumes the tab is the rightmost.</span></span>
