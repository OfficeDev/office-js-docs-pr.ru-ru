---
title: Размещение настраиваемой вкладки на ленте
description: Узнайте, как управлять, где настраиваемая вкладка отображается на ленте Office и имеет ли она фокус по умолчанию.
ms.date: 01/22/2022
ms.localizationpriority: medium
ms.openlocfilehash: bced5bf5506d0366b29d8e2ad6803b0ddfaad80b
ms.sourcegitcommit: ae3a09d905beb4305a6ffcbc7051ad70745f79f9
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/26/2022
ms.locfileid: "62222096"
---
# <a name="position-a-custom-tab-on-the-ribbon"></a>Размещение настраиваемой вкладки на ленте

Вы можете указать, где нужно, чтобы настраиваемая вкладка надстройки появлялась на ленте Office приложения с помощью разметки в манифесте надстройки.

> [!NOTE]
> В этой статье предполагается, что вы знакомы со статьей Основные понятия для команд [надстройки](add-in-commands.md). Пожалуйста, просмотрите его, если вы не сделали этого в последнее время.

> [!IMPORTANT]
>
> - Функция надстройки и разметка, описанные в этой статье, доступна только в *PowerPoint в Интернете*.
> - Разметка, описанная в этой статье, работает только на платформах, поддерживаюх набор **требований AddinCommands 1.3.** См. [ниже "Поведение" на неподтверченных платформах.](#behavior-on-unsupported-platforms)

Укажите, где должна отображаться настраиваемая вкладка, определяя встроенную вкладку Office, которая должна быть рядом, и укажите, должна ли она быть на левой или правой стороне встроенной вкладки. Сделайте эти спецификации, включив элемент [InsertBefore](../reference/manifest/customtab.md#insertbefore) (слева) или [insertAfter](../reference/manifest/customtab.md#insertafter) (справа) в элемент [CustomTab](../reference/manifest/customtab.md) манифеста надстройки. (Вы не можете иметь оба элемента.)

В следующем примере настраиваемая вкладка настроена на то, чтобы отображаться *сразу после вкладки* **Обзор.** Обратите внимание, что значение элемента **InsertAfter** — это ID встроенной вкладки Office. 

```xml
<ExtensionPoint xsi:type="ContosoRibbonTab">
  <CustomTab id="Contoso.TabCustom2">
    <Group id="Contoso.TabCustom2.group2">
       <!-- additional markup omitted -->
    </Group>
    <Label resid="customTabLabel1" />
    <InsertAfter>TabReview</InsertAfter>
  </CustomTab>
</ExtensionPoint>
```

Имейте в виду следующие точки.

- Элементы **InsertBefore и** **InsertAfter** необязательны. Если вы не используете ни то, то ваша настраиваемая вкладка будет отображаться как самая правая вкладка на ленте.
- Элементы **InsertBefore и** **InsertAfter** являются взаимоисключающими. Нельзя использовать и то, и другое.
- Если пользователь установит несколько надстройки, настраиваемая вкладка которых настроена для того же места, скажем, после вкладки **Обзор,** то в этом месте будет расположена вкладка для последней установленной надстройки. Вкладки ранее установленных надстройок будут перемещены в одном месте. Например, пользователь устанавливает надстройки A, B и C в этом порядке, и все  настроены для вставки вкладки после вкладки Обзор, затем вкладки будут отображаться в этом порядке: **Обзор**, **AddinCTab**, **AddinBTab**, **AddinATab**.
- Пользователи могут настроить ленту в Office приложении. Например, пользователь может переместить или скрыть вкладку надстройки. Вы не можете предотвратить это или обнаружить, что это произошло.
- Если пользователь перемещает одну из встроенных вкладок, Office интерпретирует элементы **InsertBefore** и **InsertAfter** с точки зрения расположения встроенной вкладки по *умолчанию.* Например, если пользователь перемещает вкладку **Обзор** в правый конец ленты, Office будет интерпретировать разметку в предыдущем примере как значение "поместите настраиваемую вкладку справа от того, где вкладка ***Обзор*** будет по умолчанию".

## <a name="specify-which-tab-has-focus-when-the-document-opens"></a>Укажите, какая вкладка имеет фокус при открываемом документе

Office всегда фокусируется по умолчанию на вкладке, которая находится справа от вкладки **File.** По умолчанию это вкладка **Главная.** Если настраивать настраиваемую вкладку перед вкладками **Home,** с помощью , то ваша настраиваемая вкладка будет фокусироваться `<InsertBefore>TabHome</InsertBefore>` при открываемом документе.

> [!IMPORTANT]
> Чрезмерное выделение вашей надстройки создает неудобства и раздражает пользователей и администраторов. Не устройте настраиваемую вкладку перед вкладками **Home,** если только ваша надстройка не является основным способом взаимодействия пользователей с документом.

## <a name="behavior-on-unsupported-platforms"></a>Поведение на неподтверченных платформах

Если надстройка установлена на платформе, которая не поддерживает набор требований [AddinCommands 1.3,](../reference/requirement-sets/add-in-commands-requirement-sets.md)то разметка, описанная в этой статье, игнорируется, и ваша настраиваемая вкладка будет отображаться как самая правая вкладка на ленте. Чтобы не допустить установки надстройки на платформах, которые не поддерживают разметку, добавьте ссылку на набор требований в разделе **Требования** манифеста. Инструкции см. в Office версии и платформы, на которых может быть организована [надстройка.](../develop/specify-office-hosts-and-api-requirements.md#specify-which-office-versions-and-platforms-can-host-your-add-in) Кроме того, разработать надстройку, чтобы иметь альтернативный опыт, когда **AddinCommands 1.3** не поддерживается, как описано в [design for alternate experiences.](../develop/specify-office-hosts-and-api-requirements.md#design-for-alternate-experiences) Например, если надстройка содержит инструкции, предполагаемые, что настраиваемая вкладка находится там, где она нужна, вы можете иметь альтернативную версию, которая предполагает, что вкладка является самой правильной.
