---
title: Размещение настраиваемой вкладки на ленте
description: Узнайте, как контролировать, где настраиваемая вкладка отображается на ленте Office и имеет ли она фокус по умолчанию.
ms.date: 02/25/2021
localization_priority: Normal
ms.openlocfilehash: 6718a69191d1d84d96512c01b2544094ce276ab6
ms.sourcegitcommit: e7009c565b18c607fe0868db2e26e250ad308dce
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/05/2021
ms.locfileid: "50505208"
---
# <a name="position-a-custom-tab-on-the-ribbon"></a>Размещение настраиваемой вкладки на ленте

Вы можете указать, где нужно, чтобы настраиваемая вкладка надстройки появлялась на ленте приложения Office с помощью разметки в манифесте надстройки.

> [!NOTE]
> В этой статье предполагается, что вы знакомы со статьей Основные понятия для команд [надстройки](add-in-commands.md). Пожалуйста, просмотрите его, если вы не сделали этого в последнее время.

> [!IMPORTANT]
>
> - Функция надстройки и разметка, описанные в этой статье, доступна только *в PowerPoint в Интернете.*
> - Разметка, описанная в этой статье, работает только на платформах, поддерживаюх набор **требований AddinCommands 1.3.** См. [ниже "Поведение" на неподтверченных платформах.](#behavior-on-unsupported-platforms)

Укажите, где должна отображаться настраиваемая вкладка, указав, какая встроенная вкладка Office должна быть рядом, и укажите, должна ли она быть на левой или правой стороне встроенной вкладки. Сделайте эти спецификации, включив элемент [InsertBefore](../reference/manifest/customtab.md#insertbefore) (слева) или [insertAfter](../reference/manifest/customtab.md#insertafter) (справа) в элемент [CustomTab](../reference/manifest/customtab.md) манифеста надстройки. (Вы не можете иметь оба элемента.)

В следующем примере настраиваемая вкладка настроена на то, чтобы отображаться *сразу после вкладки* **Обзор.** Обратите внимание, что значение элемента — это ID встроенной `<InsertAfter>` вкладки Office. 

```xml
<ExtensionPoint xsi:type="ContosoRibbonTab">
  <CustomTab id="TabCustom1">
    <Group id="myCustomTab.group1">
       <!-- additional markup omitted -->
    </Group>
    <Label resid="customTabLabel1" />
    <InsertAfter>TabReview</InsertAfter>
  </CustomTab>
</ExtensionPoint>
```

Имейте в виду следующие точки.

- Элементы  `<InsertBefore>` и  `<InsertAfter>` элементы необязательны. Если вы не используете ни то, то ваша настраиваемая вкладка будет отображаться как самая правая вкладка на ленте.
- Элементы  `<InsertBefore>` и элементы являются  `<InsertAfter>` взаимоисключающими. Нельзя использовать и то, и другое.
- Если пользователь установит несколько надстройки, настраиваемая вкладка которых настроена для того же места, скажем, после вкладки **Обзор,** то в этом месте будет расположена вкладка для последней установленной надстройки. Вкладки ранее установленных надстройок будут перемещены в одном месте. Например, пользователь устанавливает надстройки A, B и C в этом порядке, и все  настроены для вставки вкладки после вкладки Обзор, затем вкладки будут отображаться в этом порядке: **Обзор**, **AddinCTab**, **AddinBTab**, **AddinATab**.
- Пользователи могут настроить ленту в приложении Office. Например, пользователь может переместить или скрыть вкладку надстройки. Вы не можете предотвратить это или обнаружить, что это произошло.
- Если пользователь перемещает одну из встроенных вкладок, Office интерпретирует элементы и элементы с точки зрения расположения встроенной `<InsertBefore>`  `<InsertAfter>` вкладки по *умолчанию.* Например, если пользователь перемещает вкладку **Обзор** в правый конец ленты, Office интерпретирует разметку в примере выше как значение "поместите настраиваемую вкладку справа от того, где вкладка ***Review*** будет по умолчанию".

## <a name="specifying-which-tab-has-focus-when-the-document-opens"></a>Указание фокуса вкладки при открываемом документе

Office всегда фокусируется по умолчанию на вкладке, которая находится справа от вкладки **File.** По умолчанию это вкладка **Главная.** Если настраивать настраиваемую вкладку перед вкладками **Home,** с помощью , то ваша настраиваемая вкладка будет фокусироваться `<InsertBefore>TabHome</InsertBefore>` при открываемом документе.

> [!IMPORTANT]
> Чрезмерное выделение вашей надстройки создает неудобства и раздражает пользователей и администраторов. Не устройте настраиваемую вкладку перед вкладками **Home,** если только ваша надстройка не является основным способом взаимодействия пользователей с документом.

## <a name="behavior-on-unsupported-platforms"></a>Поведение на неподтверченных платформах

Если надстройка установлена на платформе, которая не поддерживает набор требований [AddinCommands 1.3,](../reference/requirement-sets/add-in-commands-requirement-sets.md)то разметка, описанная в этой статье, игнорируется, и ваша настраиваемая вкладка будет отображаться как самая правая вкладка на ленте. Чтобы не допустить установки надстройки на платформах, которые не поддерживают разметку, добавьте ссылку на набор требований в разделе `<Requirements>` манифест. Инструкции см. в [элементе Set the Requirements in the manifest.](../develop/specify-office-hosts-and-api-requirements.md#set-the-requirements-element-in-the-manifest) Кроме того, вы можете создать надстройку, чтобы иметь альтернативный опыт, когда **AddinCommands 1.3** не поддерживается, как описано в описании Использования проверок времени запуска в коде [JavaScript.](../develop/specify-office-hosts-and-api-requirements.md#use-runtime-checks-in-your-javascript-code) Например, если надстройка содержит инструкции, предполагаемые, что настраиваемая вкладка находится там, где она нужна, вы можете иметь альтернативную версию, которая предполагает, что вкладка является самой правильной.
