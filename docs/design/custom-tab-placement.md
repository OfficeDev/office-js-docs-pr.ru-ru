---
title: Размещение настраиваемой вкладки на ленте
description: Узнайте, как контролировать, где настраиваемая вкладка отображается на ленте Office и имеет ли она фокус по умолчанию.
ms.date: 02/25/2021
localization_priority: Normal
ms.openlocfilehash: 6718a69191d1d84d96512c01b2544094ce276ab6
ms.sourcegitcommit: e7009c565b18c607fe0868db2e26e250ad308dce
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/05/2021
ms.locfileid: "50505208"
---
# <a name="position-a-custom-tab-on-the-ribbon"></a><span data-ttu-id="6ab24-103">Размещение настраиваемой вкладки на ленте</span><span class="sxs-lookup"><span data-stu-id="6ab24-103">Position a custom tab on the ribbon</span></span>

<span data-ttu-id="6ab24-104">Вы можете указать, где нужно, чтобы настраиваемая вкладка надстройки появлялась на ленте приложения Office с помощью разметки в манифесте надстройки.</span><span class="sxs-lookup"><span data-stu-id="6ab24-104">You can specify where you want your add-in's custom tab to appear on the Office application's ribbon by using markup in the add-in's manifest.</span></span>

> [!NOTE]
> <span data-ttu-id="6ab24-105">В этой статье предполагается, что вы знакомы со статьей Основные понятия для команд [надстройки](add-in-commands.md).</span><span class="sxs-lookup"><span data-stu-id="6ab24-105">This article assumes that you are familiar with the article [Basic concepts for add-in commands](add-in-commands.md).</span></span> <span data-ttu-id="6ab24-106">Пожалуйста, просмотрите его, если вы не сделали этого в последнее время.</span><span class="sxs-lookup"><span data-stu-id="6ab24-106">Please review it if you have not done so recently.</span></span>

> [!IMPORTANT]
>
> - <span data-ttu-id="6ab24-107">Функция надстройки и разметка, описанные в этой статье, доступна только *в PowerPoint в Интернете.*</span><span class="sxs-lookup"><span data-stu-id="6ab24-107">The add-in feature and markup described in this article is *only available in PowerPoint on the web*.</span></span>
> - <span data-ttu-id="6ab24-108">Разметка, описанная в этой статье, работает только на платформах, поддерживаюх набор **требований AddinCommands 1.3.**</span><span class="sxs-lookup"><span data-stu-id="6ab24-108">The markup described in this article only works on platforms that support requirement set **AddinCommands 1.3**.</span></span> <span data-ttu-id="6ab24-109">См. [ниже "Поведение" на неподтверченных платформах.](#behavior-on-unsupported-platforms)</span><span class="sxs-lookup"><span data-stu-id="6ab24-109">See [Behavior on unsupported platforms](#behavior-on-unsupported-platforms) below.</span></span>

<span data-ttu-id="6ab24-110">Укажите, где должна отображаться настраиваемая вкладка, указав, какая встроенная вкладка Office должна быть рядом, и укажите, должна ли она быть на левой или правой стороне встроенной вкладки. Сделайте эти спецификации, включив элемент [InsertBefore](../reference/manifest/customtab.md#insertbefore) (слева) или [insertAfter](../reference/manifest/customtab.md#insertafter) (справа) в элемент [CustomTab](../reference/manifest/customtab.md) манифеста надстройки.</span><span class="sxs-lookup"><span data-stu-id="6ab24-110">Specify where you want a custom tab to appear by identifying which built-in Office tab you want it to be next to and specifying whether it should be on the left or right side of the built-in tab. Make these specifications by including either an [InsertBefore](../reference/manifest/customtab.md#insertbefore) (left) or an [InsertAfter](../reference/manifest/customtab.md#insertafter) (right) element in the [CustomTab](../reference/manifest/customtab.md) element of your add-in's manifest.</span></span> <span data-ttu-id="6ab24-111">(Вы не можете иметь оба элемента.)</span><span class="sxs-lookup"><span data-stu-id="6ab24-111">(You cannot have both elements.)</span></span>

<span data-ttu-id="6ab24-112">В следующем примере настраиваемая вкладка настроена на то, чтобы отображаться *сразу после вкладки* **Обзор.** Обратите внимание, что значение элемента — это ID встроенной `<InsertAfter>` вкладки Office.</span><span class="sxs-lookup"><span data-stu-id="6ab24-112">In the following example, the custom tab is configured to appear *just after* the **Review** tab. Note that the value of the `<InsertAfter>` element is the ID of the built-in Office tab.</span></span> 

```xml
<ExtensionPoint xsi:type="ContosoRibbonTab">
  <CustomTab id="TabCustom1">
    <Group id="myCustomTab.group1">
       <!-- additional markup omitted -->
    </Group>
    <Label resid="customTabLabel1" />
    <InsertAfter>TabReview</InsertAfter>
  </CustomTab>
</ExtensionPoint>
```

<span data-ttu-id="6ab24-113">Имейте в виду следующие точки.</span><span class="sxs-lookup"><span data-stu-id="6ab24-113">Keep the following points in mind.</span></span>

- <span data-ttu-id="6ab24-114">Элементы  `<InsertBefore>` и  `<InsertAfter>` элементы необязательны.</span><span class="sxs-lookup"><span data-stu-id="6ab24-114">The  `<InsertBefore>` and  `<InsertAfter>` elements are optional.</span></span> <span data-ttu-id="6ab24-115">Если вы не используете ни то, то ваша настраиваемая вкладка будет отображаться как самая правая вкладка на ленте.</span><span class="sxs-lookup"><span data-stu-id="6ab24-115">If you use neither, then your custom tab will appear as the rightmost tab on the ribbon.</span></span>
- <span data-ttu-id="6ab24-116">Элементы  `<InsertBefore>` и элементы являются  `<InsertAfter>` взаимоисключающими.</span><span class="sxs-lookup"><span data-stu-id="6ab24-116">The  `<InsertBefore>` and  `<InsertAfter>` elements are mutually exclusive.</span></span> <span data-ttu-id="6ab24-117">Нельзя использовать и то, и другое.</span><span class="sxs-lookup"><span data-stu-id="6ab24-117">You cannot use both.</span></span>
- <span data-ttu-id="6ab24-118">Если пользователь установит несколько надстройки, настраиваемая вкладка которых настроена для того же места, скажем, после вкладки **Обзор,** то в этом месте будет расположена вкладка для последней установленной надстройки.</span><span class="sxs-lookup"><span data-stu-id="6ab24-118">If the user installs more than one add-in whose custom tab is configured for the same place, say after the **Review** tab, then the tab for the most recently installed add-in will be located in that place.</span></span> <span data-ttu-id="6ab24-119">Вкладки ранее установленных надстройок будут перемещены в одном месте.</span><span class="sxs-lookup"><span data-stu-id="6ab24-119">The tabs of the previously installed add-ins will be moved over one place.</span></span> <span data-ttu-id="6ab24-120">Например, пользователь устанавливает надстройки A, B и C в этом порядке, и все  настроены для вставки вкладки после вкладки Обзор, затем вкладки будут отображаться в этом порядке: **Обзор**, **AddinCTab**, **AddinBTab**, **AddinATab**.</span><span class="sxs-lookup"><span data-stu-id="6ab24-120">For example, the user installs add-ins A, B, and C in that order and all are configured to insert a tab after the **Review** tab, then the tabs will appear in this order: **Review**, **AddinCTab**, **AddinBTab**, **AddinATab**.</span></span>
- <span data-ttu-id="6ab24-121">Пользователи могут настроить ленту в приложении Office.</span><span class="sxs-lookup"><span data-stu-id="6ab24-121">Users can customize the ribbon in the Office application.</span></span> <span data-ttu-id="6ab24-122">Например, пользователь может переместить или скрыть вкладку надстройки. Вы не можете предотвратить это или обнаружить, что это произошло.</span><span class="sxs-lookup"><span data-stu-id="6ab24-122">For example, a user can move or hide your add-in's tab. You cannot prevent this or detect that it has happened.</span></span>
- <span data-ttu-id="6ab24-123">Если пользователь перемещает одну из встроенных вкладок, Office интерпретирует элементы и элементы с точки зрения расположения встроенной `<InsertBefore>`  `<InsertAfter>` вкладки по *умолчанию.* Например, если пользователь перемещает вкладку **Обзор** в правый конец ленты, Office интерпретирует разметку в примере выше как значение "поместите настраиваемую вкладку справа от того, где вкладка ***Review*** будет по умолчанию".</span><span class="sxs-lookup"><span data-stu-id="6ab24-123">If a user moves one of the built-in tabs, then Office interprets the `<InsertBefore>` and  `<InsertAfter>` elements in terms of *the default location of the built-in tab*. For example, if the user moves the **Review** tab to the right end of the ribbon, Office will interpret the markup in the example above as meaning "put the custom tab just to the right of *where the **Review** tab would be by default*."</span></span>

## <a name="specifying-which-tab-has-focus-when-the-document-opens"></a><span data-ttu-id="6ab24-124">Указание фокуса вкладки при открываемом документе</span><span class="sxs-lookup"><span data-stu-id="6ab24-124">Specifying which tab has focus when the document opens</span></span>

<span data-ttu-id="6ab24-125">Office всегда фокусируется по умолчанию на вкладке, которая находится справа от вкладки **File.** По умолчанию это вкладка **Главная.** Если настраивать настраиваемую вкладку перед вкладками **Home,** с помощью , то ваша настраиваемая вкладка будет фокусироваться `<InsertBefore>TabHome</InsertBefore>` при открываемом документе.</span><span class="sxs-lookup"><span data-stu-id="6ab24-125">Office always gives default focus to the tab that is immediately to the right of the **File** tab. By default this is the **Home** tab. If you configure your custom tab to be before the **Home** tab, with `<InsertBefore>TabHome</InsertBefore>`, then your custom tab will have focus when the document opens.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="6ab24-126">Чрезмерное выделение вашей надстройки создает неудобства и раздражает пользователей и администраторов.</span><span class="sxs-lookup"><span data-stu-id="6ab24-126">Giving excessive prominence to your add-in inconveniences and annoys users and administrators.</span></span> <span data-ttu-id="6ab24-127">Не устройте настраиваемую вкладку перед вкладками **Home,** если только ваша надстройка не является основным способом взаимодействия пользователей с документом.</span><span class="sxs-lookup"><span data-stu-id="6ab24-127">Do not position a custom tab before the **Home** tab unless your add-in is the primary way users will interact with the document.</span></span>

## <a name="behavior-on-unsupported-platforms"></a><span data-ttu-id="6ab24-128">Поведение на неподтверченных платформах</span><span class="sxs-lookup"><span data-stu-id="6ab24-128">Behavior on unsupported platforms</span></span>

<span data-ttu-id="6ab24-129">Если надстройка установлена на платформе, которая не поддерживает набор требований [AddinCommands 1.3,](../reference/requirement-sets/add-in-commands-requirement-sets.md)то разметка, описанная в этой статье, игнорируется, и ваша настраиваемая вкладка будет отображаться как самая правая вкладка на ленте.</span><span class="sxs-lookup"><span data-stu-id="6ab24-129">If your add-in is installed on a platform that doesn't support [requirement set AddinCommands 1.3](../reference/requirement-sets/add-in-commands-requirement-sets.md), then the markup described in this article is ignored and your custom tab will appear as the rightmost tab on the ribbon.</span></span> <span data-ttu-id="6ab24-130">Чтобы не допустить установки надстройки на платформах, которые не поддерживают разметку, добавьте ссылку на набор требований в разделе `<Requirements>` манифест.</span><span class="sxs-lookup"><span data-stu-id="6ab24-130">To prevent your add-in from being installed on platforms that don't support the markup, add a reference to the requirement set in the `<Requirements>` section of the manifest.</span></span> <span data-ttu-id="6ab24-131">Инструкции см. в [элементе Set the Requirements in the manifest.](../develop/specify-office-hosts-and-api-requirements.md#set-the-requirements-element-in-the-manifest)</span><span class="sxs-lookup"><span data-stu-id="6ab24-131">For instructions, see [Set the Requirements element in the manifest](../develop/specify-office-hosts-and-api-requirements.md#set-the-requirements-element-in-the-manifest).</span></span> <span data-ttu-id="6ab24-132">Кроме того, вы можете создать надстройку, чтобы иметь альтернативный опыт, когда **AddinCommands 1.3** не поддерживается, как описано в описании Использования проверок времени запуска в коде [JavaScript.](../develop/specify-office-hosts-and-api-requirements.md#use-runtime-checks-in-your-javascript-code)</span><span class="sxs-lookup"><span data-stu-id="6ab24-132">Alternatively, you can design your add-in to have an alternate experience when **AddinCommands 1.3** is not supported, as described in [Use runtime checks in your JavaScript code](../develop/specify-office-hosts-and-api-requirements.md#use-runtime-checks-in-your-javascript-code).</span></span> <span data-ttu-id="6ab24-133">Например, если надстройка содержит инструкции, предполагаемые, что настраиваемая вкладка находится там, где она нужна, вы можете иметь альтернативную версию, которая предполагает, что вкладка является самой правильной.</span><span class="sxs-lookup"><span data-stu-id="6ab24-133">For example, if your add-in contains instructions that assume the custom tab is where you want it, you could have an alternate version that assumes the tab is the rightmost.</span></span>
