---
title: Размещение настраиваемой вкладки на ленте
description: Узнайте, как управлять размещением настраиваемой вкладки на ленте Office и наличием фокуса по умолчанию.
ms.date: 11/01/2020
localization_priority: Normal
ms.openlocfilehash: 2c1e2ae66805212e78868cf7c07a0e5c14cd4025
ms.sourcegitcommit: 3189c4bd62dbe5950b19f28ac2c1314b6d304dca
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/17/2020
ms.locfileid: "49088180"
---
# <a name="position-a-custom-tab-on-the-ribbon-preview"></a>Размещение настраиваемой вкладки на ленте (Предварительная версия)

Вы можете указать, где должна отображаться настраиваемая вкладка надстройки на ленте приложения Office, используя разметку в манифесте надстройки.

> [!NOTE]
> В этой статье предполагается, что вы знакомы с [основными понятиями, изложенными в](add-in-commands.md)статьях, посвященных командам надстроек. Изучите его, если это не было сделано недавно.

> [!IMPORTANT]
>
> - Функция надстройки и разметка, описанные в этой статье, *доступны только в PowerPoint в Интернете*. Мы рекомендуем испытать разметку только в средах тестирования и разработки. Не используйте разметку предварительного просмотра в рабочей среде или в критически важных для бизнеса документах.
> - Разметка, описанная в этой статье, работает только на платформах, поддерживающих набор требований **аддинкоммандс 1,3**. Просмотр [поведения на неподдерживаемых платформах](#behavior-on-unsupported-platforms) .

Укажите, где должна отображаться настраиваемая вкладка, указав, на какую из встроенных вкладок Office она должна располагаться, и укажите, будет ли она находиться в левой или правой части встроенной вкладки. Сделайте эти спецификации, включив элемент [InsertBefore](../reference/manifest/customtab.md#insertbefore) (Left) или [InsertAfter](../reference/manifest/customtab.md#insertafter) (Right) в элемент [CustomTab](../reference/manifest/customtab.md) манифеста надстройки. (Не допускается наличие обоих элементов.)

В следующем примере настраиваемая вкладка отображается *сразу после* вкладки " **Рецензирование** ". Обратите внимание, что значением `<InsertAfter>` элемента является идентификатор встроенной вкладки Office. 

```xml
<ExtensionPoint xsi:type="ContosoRibbonTab">
  <CustomTab id="TabCustom1">
    <Group id="myCustomTab.group1">
       <!-- additional markup omitted -->
    </Group>
    <Label resid="customTabLabel1" />
    <InsertAfter>TabReview</InsertAfter>
  </CustomTab>
</ExtensionPoint>
```

Учитывайте следующие моменты.

- `<InsertBefore>`Элементы и `<InsertAfter>` являются необязательными. Если вы не используете ни один из них, настраиваемая вкладка появится в виде крайней правой вкладки на ленте.
- `<InsertBefore>`Элементы и являются взаимоисключающими `<InsertAfter>` . Вы не можете использовать оба варианта.
- Если пользователь устанавливает несколько надстроек, настраиваемая вкладка которых настроена для одного и того же места, скажите после вкладки **Рецензирование** , и вкладка для последней установленной надстройки будет размещена в этой позиции. Вкладки ранее установленных надстроек будут перемещены в одном месте. Например, пользователь устанавливает надстройки A, B и C в этом порядке и все они настраиваются для вставки вкладки после вкладки " **Рецензирование** ", после чего вкладки отображаются в следующем порядке: **Проверка**, **аддинктаб**, **аддинбтаб**, **аддинатаб**.
- Пользователи могут настраивать ленту в приложении Office. Например, пользователь может переместить или скрыть вкладку надстройки. Вы не можете предотвратить это или определить, что это произошло.
- Если пользователь переместит одну из встроенных вкладок, Office интерпретирует `<InsertBefore>`  `<InsertAfter>` элементы и в терминах *расположения по умолчанию встроенной вкладки*. Например, если пользователь переместит вкладку " **Рецензирование** " в правый конец ленты, Office будет интерпретировать разметку в примере выше, как это означает "помещать настраиваемую вкладку справа от того, *где будет отображаться вкладка" **Рецензирование** "по умолчанию*."

## <a name="specifying-which-tab-has-focus-when-the-document-opens"></a>Указание фокуса на вкладке при открытии документа

Office всегда предоставляет фокус по умолчанию на вкладку, находящийся непосредственно справа от вкладки **файл** . По умолчанию это вкладка **Главная** . Если вы настроили пользовательскую вкладку до вкладки **Главная** , на `<InsertBefore>TabHome</InsertBefore>` настраиваемой вкладке будет отображаться фокус при открытии документа.

> [!IMPORTANT]
> Чрезмерное выразительное удобство надстроек и аннойс пользователей и администраторов. Не разместите настраиваемую вкладку перед вкладкой " **Главная** ", если ваша надстройка не будет основным способом взаимодействия пользователей с документом.

## <a name="behavior-on-unsupported-platforms"></a>Поведение на неподдерживаемых платформах

Если ваша надстройка установлена на платформе, которая не поддерживает [набор требований аддинкоммандс 1,3](../reference/requirement-sets/add-in-commands-requirement-sets.md), разметка, описанная в этой статье, игнорируется, а настраиваемая вкладка отображается в виде крайней правой вкладки на ленте. Чтобы запретить установку надстройки на платформах, которые не поддерживают разметку, добавьте ссылку на набор требований в `<Requirements>` разделе манифеста. Инструкции см в разделе [set the требований element в манифесте](../develop/specify-office-hosts-and-api-requirements.md#set-the-requirements-element-in-the-manifest). Кроме того, вы можете создать альтернативный интерфейс для надстройки, когда **аддинкоммандс 1,3** не поддерживается, как описано в статье [Использование проверок среды выполнения в коде JavaScript](../develop/specify-office-hosts-and-api-requirements.md#use-runtime-checks-in-your-javascript-code). Например, если ваша надстройка содержит инструкции, которые предполагают, что настраиваемая вкладка находится там, где она нужна, можно использовать альтернативную версию, которая предполагает, что вкладка является самой правой.
