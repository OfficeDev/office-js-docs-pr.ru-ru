---
title: Рекомендации по разработке аутентификации для надстроек Office
ms.date: 02/09/2021
description: Узнайте, как визуально спроектировать страницу регистрации или регистрации в Office надстройки.
ms.localizationpriority: medium
ms.openlocfilehash: 0188487f7a4a32bf16c00eed3f151d0a9a52be87
ms.sourcegitcommit: b66ba72aee8ccb2916cd6012e66316df2130f640
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/26/2022
ms.locfileid: "64483933"
---
# <a name="authentication-patterns"></a>Шаблоны аутентификации

Для получения доступа к функциям надстройки может требоваться вход или регистрация. В интерфейс часто встраиваются поля для ввода имени пользователя и пароля или кнопки, которые запускают сторонние потоки идентификации. Простая и эффективная аутентификация — важный первый шаг к началу работы с надстройкой.

## <a name="best-practices"></a>Рекомендации

|Правильно|Неправильно|
|:----|:----|
|Опишите значение надстройки или продемонстрируйте функции, не требуя создания учетной записи. |Не ожидайте, что пользователи выполнят вход, не понимая значения и преимуществ надстройки.|
|Направляйте пользователей, используя основную, хорошо видимую кнопку на каждом экране. |Не обращайте внимание на второстепенные и производные задачи с помощью конкурирующих кнопок и призывов к действию.|
|Используйте понятные подписи кнопок с указанием конкретных задач, например "Войти" или "Создать учетную запись". |Не используйте абстрактные подписи, например "Отправить" или "Начать".|
|Используйте диалоговое окно, чтобы обратить внимание пользователей на формы аутентификации. |Не перегружайте область задач инструкциями при первом запуске и формами аутентификации.|
|Добавьте небольшие полезные действия, например автофокусировку на полях ввода. |Не добавляйте ненужные шаги, например не требуйте нажимать на поля формы.|
|Предоставление пользователям способа регистрации и повторной регистрации. |Не заставляйте пользователей удалять надстройку, чтобы сменить учетную запись.|

## <a name="authentication-flow"></a>Последовательность аутентификации

1. Первый запуск. Разместите кнопку для входа как четкий призыв к действию при первом запуске надстройки.

    ![Снимок экрана, показывающий области задач надстройки в Office приложении.](../images/add-in-fre-value-placemat.png)

1. Диалоговое окно выбора службы идентификации. Покажите список служб идентификации, включая, при необходимости, форму для ввода имени пользователя и пароля. Пользовательский интерфейс вашей надстройки может быть заблокирован, когда открыто диалоговое окно аутентификации.

    ![Снимок экрана, показывающий диалоговое окно Выбор поставщика удостоверений в Office приложении.](../images/add-in-auth-choices-dialog.png)

1. Вход через службу идентификации. Отобразится пользовательский интерфейс службы идентификации. Microsoft Azure Active Directory позволяет настраивать страницы для входов и доступа к панели для согласованного внешний вид с вашей службой. [Дополнительные.](/azure/active-directory/fundamentals/customize-branding)

    ![Снимок экрана, показывающий диалоговое окно поставщика удостоверений в Office приложении.](../images/add-in-auth-identity-sign-in.png)

1. Ход выполнения. Показывайте ход загрузки параметров и пользовательского интерфейса.

    ![Снимок экрана, показывающий диалоговое окно с индикатором прогресса в Office приложении.](../images/add-in-auth-modal-interstitial.png)

> [!NOTE]
> Используя службу идентификации Майкрософт, вы получите возможность использовать фирменную кнопку входа, которую можно настроить под светлую и темную темы. Узнайте больше.

## <a name="single-sign-on-authentication-flow"></a>Поток Sign-On проверки подлинности

> [!NOTE]
> Единый API входов в настоящее время поддерживается для Word, Excel, Outlook и PowerPoint. Дополнительные сведения о поддержке единого входного знака см. в наборе [требований IdentityAPI](/javascript/api/requirement-sets/identity-api-requirement-sets). Если вы работаете с надстройкой Outlook, обязательно включите современную проверку подлинности для клиента Microsoft 365. Сведения о том, как это сделать, см. в статье [Exchange Online: как включить в клиенте современную проверку подлинности](https://social.technet.microsoft.com/wiki/contents/articles/32711.exchange-online-how-to-enable-your-tenant-for-modern-authentication.aspx).

Использование единой входной записи для более плавного интерфейса для конечных пользователей. Удостоверение пользователя в Office (учетная запись Майкрософт или Microsoft 365) используется для регистрации в вашей надстройки. В результате пользователи впишутся только один раз. Это упрощает начало работы для пользователей.

1. При установке надстройки пользователь увидит окно согласия, аналогичное следующему:

    ![Снимок экрана, показывающий окно согласия Office приложения при установке надстройки.](../images/add-in-auth-SSO-consent-dialog.png)

    > [!NOTE]
    > Издатель надстройки может выбирать логотип, строки и разрешения, включаемые в окно запроса. Пользовательский интерфейс определяет Майкрософт.

1. Надстройка загрузится после того, как пользователь предоставит разрешения. Она может извлечь и отобразить необходимую персонализированную информацию.

    ![Снимок экрана, Office приложение с кнопками надстройки, отображаемой на ленте.](../images/add-in-ribbon.png)

## <a name="see-also"></a>См. также

- Дополнительные новости о [разработке надстройок SSO](../develop/sso-in-office-add-ins.md)
