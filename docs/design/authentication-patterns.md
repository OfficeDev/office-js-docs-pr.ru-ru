---
title: Рекомендации по разработке аутентификации для надстроек Office
description: Сведения о том, как визуально разработать страницу входа или регистрации в надстройке Office.
ms.date: 03/19/2019
localization_priority: Normal
ms.openlocfilehash: 36465fbf156820cfc8980758cec0ed19c545588d
ms.sourcegitcommit: 472b81642e9eb5fb2a55cd98a7b0826d37eb7f73
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/17/2020
ms.locfileid: "45159621"
---
# <a name="authentication-patterns"></a><span data-ttu-id="53c2e-103">Шаблоны аутентификации</span><span class="sxs-lookup"><span data-stu-id="53c2e-103">Authentication patterns</span></span>

<span data-ttu-id="53c2e-104">Для получения доступа к функциям надстройки может требоваться вход или регистрация.</span><span class="sxs-lookup"><span data-stu-id="53c2e-104">Add-ins may require users to sign-in or sign-up in order to access features and functionality.</span></span> <span data-ttu-id="53c2e-105">В интерфейс часто встраиваются поля для ввода имени пользователя и пароля или кнопки, которые запускают сторонние потоки идентификации.</span><span class="sxs-lookup"><span data-stu-id="53c2e-105">Input boxes for username and password or buttons that start third party credential flows are common interface controls in authentication experiences.</span></span> <span data-ttu-id="53c2e-106">Простая и эффективная аутентификация — важный первый шаг к началу работы с надстройкой.</span><span class="sxs-lookup"><span data-stu-id="53c2e-106">A simple and efficient authentication experience is an important first step to getting users started with your add-in.</span></span>

## <a name="best-practices"></a><span data-ttu-id="53c2e-107">Рекомендации</span><span class="sxs-lookup"><span data-stu-id="53c2e-107">Best practices</span></span>

|<span data-ttu-id="53c2e-108">Правильно</span><span class="sxs-lookup"><span data-stu-id="53c2e-108">Do</span></span>|<span data-ttu-id="53c2e-109">Неправильно</span><span class="sxs-lookup"><span data-stu-id="53c2e-109">Don't</span></span>|
|:----|:----|
|<span data-ttu-id="53c2e-110">Опишите значение надстройки или продемонстрируйте функции, не требуя создания учетной записи.</span><span class="sxs-lookup"><span data-stu-id="53c2e-110">Prior to sign-in, describe the value of your add-in or demonstrate functionality without requiring an account.</span></span> |<span data-ttu-id="53c2e-111">Не ожидайте, что пользователи выполнят вход, не понимая значения и преимуществ надстройки.</span><span class="sxs-lookup"><span data-stu-id="53c2e-111">Expect users to sign-in without understanding the value and benefits of your add-in.</span></span>|
|<span data-ttu-id="53c2e-112">Направляйте пользователей, используя основную, хорошо видимую кнопку на каждом экране.</span><span class="sxs-lookup"><span data-stu-id="53c2e-112">Guide users through authentication flows with a primary, highly visible button on each screen.</span></span> |<span data-ttu-id="53c2e-113">Не обращайте внимание на второстепенные и производные задачи с помощью конкурирующих кнопок и призывов к действию.</span><span class="sxs-lookup"><span data-stu-id="53c2e-113">Draw attention to secondary and tertiary tasks with competing buttons and calls to action.</span></span>|
|<span data-ttu-id="53c2e-114">Используйте понятные подписи кнопок с указанием конкретных задач, например "Войти" или "Создать учетную запись".</span><span class="sxs-lookup"><span data-stu-id="53c2e-114">Use clear button labels that describe specific tasks like "Sign in" or "Create account".</span></span>   |<span data-ttu-id="53c2e-115">Не используйте абстрактные подписи, например "Отправить" или "Начать".</span><span class="sxs-lookup"><span data-stu-id="53c2e-115">Use vague button labels like "Submit" or "Get started" to guide users through authentication flows.</span></span>|
|<span data-ttu-id="53c2e-116">Используйте диалоговое окно, чтобы обратить внимание пользователей на формы аутентификации.</span><span class="sxs-lookup"><span data-stu-id="53c2e-116">Use a dialog to focus users' attention on authentication forms.</span></span>    |<span data-ttu-id="53c2e-117">Не перегружайте область задач инструкциями при первом запуске и формами аутентификации.</span><span class="sxs-lookup"><span data-stu-id="53c2e-117">Overcrowd your task pane with a first run experience and authentication forms.</span></span>|
|<span data-ttu-id="53c2e-118">Добавьте небольшие полезные действия, например автофокусировку на полях ввода.</span><span class="sxs-lookup"><span data-stu-id="53c2e-118">Find small efficiencies in the flow like auto-focusing on input boxes.</span></span> |<span data-ttu-id="53c2e-119">Не добавляйте ненужные шаги, например не требуйте нажимать на поля формы.</span><span class="sxs-lookup"><span data-stu-id="53c2e-119">Add unnecessary steps to the interaction like requiring users to click into form fields.</span></span>|
|<span data-ttu-id="53c2e-120">Предоставьте пользователям возможность выйти и пройти аутентификацию еще раз.</span><span class="sxs-lookup"><span data-stu-id="53c2e-120">Provide a way for users to sign-out and reauthenticate.</span></span>    |<span data-ttu-id="53c2e-121">Не заставляйте пользователей удалять надстройку, чтобы сменить учетную запись.</span><span class="sxs-lookup"><span data-stu-id="53c2e-121">Force users to uninstall to switch identities.</span></span>|

## <a name="authentication-flow"></a><span data-ttu-id="53c2e-122">Последовательность аутентификации</span><span class="sxs-lookup"><span data-stu-id="53c2e-122">Authentication flow</span></span>

<span data-ttu-id="53c2e-123">Пока система единого входа находится на этапе тестирования, у пользователей должен быть выбор, как войти в производственную надстройку — непосредственно через вашу службу или через службу идентификации, например Майкрософт.</span><span class="sxs-lookup"><span data-stu-id="53c2e-123">Until single sign-on is out of preview, production add-ins should give users a choice to sign-in directly with your service or an identity provider like Microsoft.</span></span>

1. <span data-ttu-id="53c2e-124">Первый запуск. Разместите кнопку для входа как четкий призыв к действию при первом запуске надстройки.</span><span class="sxs-lookup"><span data-stu-id="53c2e-124">First Run Placemat - Place your sign-in button as a clear call-to action inside your add-in's first run experience.</span></span>
<span data-ttu-id="53c2e-125">![Снимок экрана: область задач надстройки в приложении Office](../images/add-in-fre-value-placemat.png)</span><span class="sxs-lookup"><span data-stu-id="53c2e-125">![A screenshot of an add-in task pane in an Office application](../images/add-in-fre-value-placemat.png)</span></span>

2. <span data-ttu-id="53c2e-126">Диалоговое окно выбора службы идентификации. Покажите список служб идентификации, включая, при необходимости, форму для ввода имени пользователя и пароля.</span><span class="sxs-lookup"><span data-stu-id="53c2e-126">Identity Provider Choices Dialog - Display a clear list of identity providers including a username and password form if applicable.</span></span> <span data-ttu-id="53c2e-127">Пользовательский интерфейс вашей надстройки может быть заблокирован, когда открыто диалоговое окно аутентификации.</span><span class="sxs-lookup"><span data-stu-id="53c2e-127">Your add-in UI may be blocked while the authentication dialog is open.</span></span>
<span data-ttu-id="53c2e-128">![Снимок экрана: диалоговое окно выбора поставщика удостоверений в приложении Office](../images/add-in-auth-choices-dialog.png)</span><span class="sxs-lookup"><span data-stu-id="53c2e-128">![A screenshot of the Identity Provider Choices dialog in an Office application](../images/add-in-auth-choices-dialog.png)</span></span>



3. <span data-ttu-id="53c2e-129">Вход через службу идентификации. Отобразится пользовательский интерфейс службы идентификации.</span><span class="sxs-lookup"><span data-stu-id="53c2e-129">Identity Provider Sign-in - The identity provider will have their own UI.</span></span> <span data-ttu-id="53c2e-130">Microsoft Azure Active Directory позволяет настроить страницы входа и панели доступа, чтобы они соответствовали оформлению вашей службы.  [Подробнее](/azure/active-directory/fundamentals/customize-branding).</span><span class="sxs-lookup"><span data-stu-id="53c2e-130">Microsoft Azure Active Directory allows customization of sign-in and access panel pages for consistent look and feel with your service. [Learn More](/azure/active-directory/fundamentals/customize-branding).</span></span>
<span data-ttu-id="53c2e-131">![Снимок экрана: диалоговое окно входа поставщика удостоверений в приложении Office](../images/add-in-auth-identity-sign-in.png)</span><span class="sxs-lookup"><span data-stu-id="53c2e-131">![A screenshot of the Identity Provider Sign-in dialog in an Office application](../images/add-in-auth-identity-sign-in.png)</span></span>

4. <span data-ttu-id="53c2e-132">Ход выполнения. Показывайте ход загрузки параметров и пользовательского интерфейса.</span><span class="sxs-lookup"><span data-stu-id="53c2e-132">Progress - Indicate progress while settings and UI load.</span></span>
<span data-ttu-id="53c2e-133">![Снимок экрана: диалоговое окно, демонстрирующее индикатор хода выполнения в приложении Office](../images/add-in-auth-modal-interstitial.png)</span><span class="sxs-lookup"><span data-stu-id="53c2e-133">![A screenshot of a dialog that shows a progress indicator in an Office application](../images/add-in-auth-modal-interstitial.png)</span></span>

> [!NOTE] 
> <span data-ttu-id="53c2e-134">Используя службу идентификации Майкрософт, вы получите возможность использовать фирменную кнопку входа, которую можно настроить под светлую и темную темы.</span><span class="sxs-lookup"><span data-stu-id="53c2e-134">When using Microsoft's Identity service you'll have the opportunity to use a branded sign-in button that is customizable to light and dark themes.</span></span><span data-ttu-id="53c2e-135">Узнайте больше.</span><span class="sxs-lookup"><span data-stu-id="53c2e-135"> Learn more.</span></span>

## <a name="single-sign-on-authentication-flow-preview"></a><span data-ttu-id="53c2e-136">Последовательность аутентификации при едином входе (предварительная версия)</span><span class="sxs-lookup"><span data-stu-id="53c2e-136">Single Sign-On authentication flow (preview)</span></span>

> [!NOTE]
> <span data-ttu-id="53c2e-137">В настоящее время API единого входа поддерживается в тестовом режиме для Word, Excel, Outlook и PowerPoint.</span><span class="sxs-lookup"><span data-stu-id="53c2e-137">The single sign-on API is currently supported in preview for Word, Excel, Outlook, and PowerPoint.</span></span> <span data-ttu-id="53c2e-138">Дополнительную информацию о поддержке единого входа см. в статье  [Наборы требований IdentityAPI](../reference/requirement-sets/identity-api-requirement-sets.md).</span><span class="sxs-lookup"><span data-stu-id="53c2e-138">For more information about single sign-on support, see [IdentityAPI requirement sets](../reference/requirement-sets/identity-api-requirement-sets.md).</span></span> <span data-ttu-id="53c2e-139">Если вы работаете с надстройкой Outlook, обязательно включите современную проверку подлинности для клиента Microsoft 365.</span><span class="sxs-lookup"><span data-stu-id="53c2e-139">If you are working with an Outlook add-in, be sure to enable Modern Authentication for the Microsoft 365 tenancy.</span></span> <span data-ttu-id="53c2e-140">Информацию о том, как это сделать, см. в статье  [Exchange Online: как включить в клиенте современную проверку подлинности](https://social.technet.microsoft.com/wiki/contents/articles/32711.exchange-online-how-to-enable-your-tenant-for-modern-authentication.aspx).</span><span class="sxs-lookup"><span data-stu-id="53c2e-140">For information about how to do this, see [Exchange Online: How to enable your tenant for modern authentication](https://social.technet.microsoft.com/wiki/contents/articles/32711.exchange-online-how-to-enable-your-tenant-for-modern-authentication.aspx).</span></span>

<span data-ttu-id="53c2e-141">Когда единый вход будет доступен для производственных надстроек, используйте его, чтобы сделать надстройку удобнее для конечных пользователей.</span><span class="sxs-lookup"><span data-stu-id="53c2e-141">Once single sign-on is generally available for production add-ins, use it for the smoother end-user experience.</span></span> <span data-ttu-id="53c2e-142">Удостоверение пользователя в Office (учетная запись Майкрософт или удостоверение Microsoft 365) используется для входа в надстройку.</span><span class="sxs-lookup"><span data-stu-id="53c2e-142">The user's identity within Office (either a Microsoft account or a Microsoft 365 identity) is used to sign-in to your add-in.</span></span> <span data-ttu-id="53c2e-143">В результате пользователь входит только один раз.</span><span class="sxs-lookup"><span data-stu-id="53c2e-143">As a result users only sign-in once.</span></span> <span data-ttu-id="53c2e-144">Это упрощает начало работы для пользователей.</span><span class="sxs-lookup"><span data-stu-id="53c2e-144">This removes friction in the experience making it easier for your customers to get started.</span></span>

1. <span data-ttu-id="53c2e-145">Во время установки надстройки пользователь увидит окно запроса, подобное приведенному ниже. ![Снимок экрана: окно запроса согласия в приложении Office во время установки надстройки](../images/add-in-auth-SSO-consent-dialog.png)</span><span class="sxs-lookup"><span data-stu-id="53c2e-145">As an add-in is being installed, a user will see a consent window similar to the one below: ![A screenshot of the consent window in an Office application when an add-in is being installed](../images/add-in-auth-SSO-consent-dialog.png)</span></span>
> [!NOTE]
> <span data-ttu-id="53c2e-146">Издатель надстройки может выбирать логотип, строки и разрешения, включаемые в окно запроса.</span><span class="sxs-lookup"><span data-stu-id="53c2e-146">The add-in publisher will have control over the logo, strings and permission scopes included in the consent window.</span></span> <span data-ttu-id="53c2e-147">Пользовательский интерфейс определяет Майкрософт.</span><span class="sxs-lookup"><span data-stu-id="53c2e-147">The UI is pre-configured by Microsoft.</span></span>

2. <span data-ttu-id="53c2e-148">Надстройка загрузится после того, как пользователь предоставит разрешения.</span><span class="sxs-lookup"><span data-stu-id="53c2e-148">The add-in will load after the user consents.</span></span> <span data-ttu-id="53c2e-149">Она может извлечь и отобразить необходимую персонализированную информацию.</span><span class="sxs-lookup"><span data-stu-id="53c2e-149">It can extract and display any necessary user customized information.</span></span>
<span data-ttu-id="53c2e-150">![Снимок экрана: приложение Office с кнопками надстроек на ленте](../images/add-in-ribbon.png)</span><span class="sxs-lookup"><span data-stu-id="53c2e-150">![A screenshot of an Office application with add-in buttons displayed in the ribbon](../images/add-in-ribbon.png)</span></span>

## <a name="see-also"></a><span data-ttu-id="53c2e-151">См. также</span><span class="sxs-lookup"><span data-stu-id="53c2e-151">See also</span></span>

- <span data-ttu-id="53c2e-152">Узнайте больше о [разработке надстроек с единым входом (предварительная версия)](../develop/sso-in-office-add-ins.md)</span><span class="sxs-lookup"><span data-stu-id="53c2e-152">Learn more about [developing SSO Add-ins (preview)](../develop/sso-in-office-add-ins.md)</span></span>
