---
title: Основные концепции команд надстроек
description: Как добавить настраиваемые кнопки ленты и элементы меню в Office в составе надстройки Office
ms.date: 07/05/2022
ms.localizationpriority: high
ms.openlocfilehash: a85c3e5cf4bf1a22ac3e6fe440514e19d80b2448
ms.sourcegitcommit: 4ba5f750358c139c93eb2170ff2c97322dfb50df
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/06/2022
ms.locfileid: "66659677"
---
# <a name="add-in-commands-for-excel-powerpoint-and-word"></a>Команды надстроек для Excel, PowerPoint и Word

Команды надстроек — это элементы, которые расширяют пользовательский интерфейс Office и запускают действия в надстройке. Команды надстроек можно использовать для добавления кнопки на ленту или элемента в контекстное меню. Когда пользователи выбирают команду надстройки, они инициируют действия, такие как запуск кода JavaScript или отображение страницы надстройки в области задач. Команды надстройки помогают пользователям находить и использовать вашу надстройку, что может повысить показатель внедрения надстройки и коэффициент удержания клиентов.

> [!NOTE]
> - В каталогах SharePoint команды надстроек не поддерживаются. Развернуть их можно с помощью [интегрированных приложений](/microsoft-365/admin/manage/test-and-deploy-microsoft-365-apps) или [AppSource](/office/dev/store/submit-to-appsource-via-partner-center). Чтобы развернуть команду надстройки для тестирования, используйте [загрузку неопубликованного приложения](../testing/create-a-network-shared-folder-catalog-for-task-pane-and-content-add-ins.md).
> - Контентные надстройки на данный момент не поддерживают команды.

> [!IMPORTANT]
> В Outlook также поддерживаются команды надстроек. Дополнительные сведения см. в статье [Команды надстроек для Outlook](../outlook/add-in-commands-for-outlook.md).

*Рисунок 1. Надстройка с командами, работающая в классическом приложении Excel*

![Снимок экрана, на котором выделены команды надстройки на ленте Excel.](../images/add-in-commands-1.png)

*Рисунок 2. Надстройка с командами, работающая в Excel в Интернете*

![Снимок экрана с командами надстроек в Excel в Интернете.](../images/add-in-commands-2.png)

## <a name="types-of-add-in-commands"></a>Типы команд надстроек

Существует два типа команд надстроек, основанных на типе действия, активируемого командой.

- **Команды области задач**: кнопка или элемент меню открывает панель задач надстроек. Этот тип команды надстройки добавляется с разметкой в манифесте. "Код программной части" команды предоставляется Office.
- **Команды функций**: кнопка или элемент меню запускает любой произвольный JavaScript. Код почти всегда вызывает API в библиотеке JavaScript для Office, но это не обязательно. Этот тип надстройки обычно не отображает пользовательский интерфейс, кроме самой кнопки или элемента меню. Обратите внимание на следующие сведения о командах функций:

   - Запущенная функция может вызвать метод [displayDialogAsync](/javascript/api/office/office.ui?view=common-js&preserve-view=true#office-office-ui-displaydialogasync-member(1)) для отображения диалогового окна, что является хорошим способом отобразить ошибку, показать прогресс или запросить ввод от пользователя. Если надстройка настроена на использование общей среды выполнения, функция также может вызвать метод [showAsTaskpane](/javascript/api/office/office.addin#office-office-addin-showastaskpane-member(1)).
   - Среда выполнения JavaScript, в которой выполняется команда функции, является полноценной средой выполнения на основе браузера. Она может отображать HTML и обращаться к Интернету для отправки или получения данных.

## <a name="command-capabilities"></a>Возможности команд

В настоящее время поддерживаются указанные ниже возможности команд.

### <a name="extension-points"></a>Точки расширения

- Вкладки ленты — расширение встроенных вкладок или создание настраиваемой вкладки. Надстройка может содержать только одну настраиваемую вкладку.
- Контекстные меню: расширение возможностей выбранных контекстных меню.

### <a name="control-types"></a>Типы элементов управления

- Простые кнопки, запускающие определенные действия.
- Простые раскрывающиеся меню с кнопками, которые запускают действия.

### <a name="default-enabled-or-disabled-status"></a>Состояние по умолчанию: "Включено" или "Отключено"

Вы можете указать, включена или отключена команда при запуске надстройки, а также изменять параметр программными средствами.

> [!NOTE]
> Эта функция поддерживается не всеми приложениями Office и сценариями. Дополнительные сведения см. в статье о [Включение и отключение команд надстроек](disable-add-in-commands.md).

### <a name="position-on-the-ribbon-preview"></a>Расположение на ленте (предварительная версия)

Вы можете указать, где настраиваемая вкладка будет отображаться на ленте приложения Office, например "справа от вкладки «Главная»".

> [!NOTE]
> Эта функция поддерживается не всеми приложениями Office и сценариями. Дополнительные сведения см. в статье [Расположение настраиваемой вкладки на ленте](custom-tab-placement.md).

### <a name="integration-of-built-in-office-buttons"></a>Интеграция встроенных кнопок Office

Вы можете вставлять встроенные кнопки ленты Office в свои группы настраиваемых команд и настраиваемую вкладку ленты.

> [!NOTE]
> Эта функция поддерживается не всеми приложениями Office и сценариями. Дополнительные сведения см. в статье [Интеграция встроенных кнопок Office в настраиваемые вкладки](built-in-button-integration.md).

### <a name="contextual-tabs"></a>контекстные вкладки;

Вы можете настроить отображение вкладки на ленте только в определенных контекстах, например при выборе диаграммы в Excel.

> [!NOTE]
> Эта функция поддерживается не всеми приложениями Office и сценариями. Дополнительные сведения см. в статье [Создание пользовательских контекстных вкладок в надстройках Office](contextual-tabs.md).

## <a name="supported-platforms"></a>Поддерживаемые платформы

В настоящее время команды надстроек поддерживаются на следующих платформах (за исключением ограничений, указанных в подразделах [Возможности команд](#command-capabilities) ранее).

- Office для Windows (сборка 16.0.6769+, подключенная к подписке на Microsoft 365)
- Office 2019 или более поздней версии для Windows
- Office для Mac (сборка 15.33+, подключенная к подписке на Microsoft 365)
- Office 2019 или более поздней версии для Mac
- Office в Интернете

> [!NOTE]
> Сведения о поддержке Outlook см. в[Команды надстройки для Outlook](../outlook/add-in-commands-for-outlook.md).

## <a name="debug"></a>Отладка

Чтобы отлаживать команду надстройки, необходимо запустить ее в Office в Интернете. Дополнительные сведения см. в статье [Отладка надстроек в Office в Интернете](../testing/debug-add-ins-in-office-online.md)

## <a name="best-practices"></a>Рекомендации

При разработке надстроек придерживайтесь следующих рекомендаций.

- Каждая команда должна представлять определенное действие с очевидным и конкретным исходом для пользователей. Не совмещайте несколько действий в одной кнопке.
- Предоставляйте точные действия, которые делают выполнение распространенных задач в надстройке более эффективным. Максимально сократите количество шагов, необходимых для выполнения действия.
- Расположение команд на ленте приложения Office:
  - Помещайте команды на имеющиеся вкладки ("Вставка", "Рецензирование" и т. д.), если соответствующая функция подходит для них. Например, если надстройка позволяет вставлять файлы мультимедиа, добавьте группу на вкладку "Вставка". Обратите внимание, что некоторые вкладки доступны не во всех версиях Office. Дополнительные сведения см. в статье [XML-манифест надстроек Office](../develop/add-in-manifests.md).
  - Добавляйте команды на вкладку "Главная", если соответствующие функции не относятся к другим вкладкам, а надстройка содержит менее шести команд верхнего уровня. Вы также можете добавлять команды на вкладку "Главная", если надстройка должна работать в разных версиях Office (например, Office в Интернете и классических приложениях Office), а нужная вкладка доступна не во всех версиях (например, вкладка "Конструктор" отсутствует в Office в Интернете).  
  - Добавляйте команды на пользовательскую вкладку, если надстройка содержит более шести команд верхнего уровня.
  - Название группы должно соответствовать названию надстройки. Если у вас есть несколько групп, их имена должны быть связаны с функциями, которые выполняют команды из этих групп.
  - Не добавляйте избыточные кнопки, чтобы надстройка занимала больше места на экране.
  - Не размещайте настраиваемую вкладку слева от вкладки "Главная" или переводите на нее фокус по умолчанию при открытии документа, если ваша надстройка не является основным способом взаимодействия с документом. Чрезмерное выделение вашей надстройки создает неудобства и раздражает пользователей и администраторов.
  - Если надстройка является основным способом взаимодействия пользователей с документом и у вас есть настраиваемая вкладка ленты, рассмотрите возможность интеграции кнопок во вкладку для применения функций Office, которые часто требуются пользователям.
  - Если функции, предоставляемые в настраиваемой вкладке, должны быть доступны только в определенных контекстах, используйте [настраиваемые контекстные вкладки](contextual-tabs.md). Если вы используете настраиваемые контекстные вкладки, реализуйте [резервный интерфейс, когда ваша надстройка запускается на платформах, не поддерживающих настраиваемые контекстные вкладки](contextual-tabs.md#implement-an-alternate-ui-experience-when-custom-contextual-tabs-are-not-supported).

  > [!NOTE]
  > Надстройки, которые занимают слишком много места, могут не пройти [проверку в AppSource](/legal/marketplace/certification-policies).

- [Руководство по оформлению значков](add-in-icons.md) подходит для всех значков.
- Предоставьте версию надстройки, которая работает в приложениях Office, не поддерживающих команды. Один манифест надстройки может работать в приложениях независимо от того, поддерживают ли они команды.

   *Рис. 3. Надстройка области задач в Office 2013 и эта же надстройка, использующая команды надстройки в Office 2016*

   ![Снимок экрана со сравнением надстройки области задач в Office 2013 и этой же надстройки, использующей команды надстройки в Office 2016. В версии 2013 в области задач должны содержаться все команды, в то время как в версии 2016 эти команды могут быть на ленте.](../images/office-task-pane-add-ins.png)

## <a name="next-steps"></a>Дальнейшие действия

Лучший способ начать работу с командами надстроек Office — ознакомиться с [примерами](https://github.com/OfficeDev/Office-Add-in-Commands-Samples/) на сайте GitHub.

Дополнительные сведения об указании команд надстройки в манифесте см. в статье [Создание команд надстроек в манифесте](../develop/create-addin-commands.md) и справочных материалах по [VersionOverrides](/javascript/api/manifest/versionoverrides).
